<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE Safe #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="annot"><span class="hs-comment">{-| == Introduction
Through this module, this library provides platform-independent support for
control character sequences following the \'ANSI\' standards (see further below)
for terminal software that supports those sequences, running on a Unix-like
operating system or on Windows (see further below).

The sequences of control characters (also referred to as \'escape\' sequences or
codes) provide a rich range of functionality for terminal control, which
includes:

 * Colored text output, with control over foreground, background and (where
   supported) underlining colors

 * Clearing parts of a line or the screen

 * Hiding or showing the cursor

 * Moving the cursor around

 * Reporting the position of the cursor

 * Enabling or disabling automatic line wrapping

 * Scrolling the screen up or down

 * Switching between the Alternate and Normal Screen Buffers

 * Clickable hyperlinks to URIs

 * Changing the title of the terminal

A terminal that supports control character sequences acts on them when they
are flushed from the output buffer (with a newline character @\&quot;\\n\&quot;@ or, for
the standard output channel, @hFlush stdout@).

== \'ANSI\' standards
The \'ANSI\' standards refer to (1) standard ECMA-48 \`Control Functions for
Coded Character Sets\' (5th edition, 1991); (2) extensions in ITU-T
Recommendation (previously CCITT Recommendation) T.416 (03/93) \'Information
Technology &#8211; Open Document Architecture (ODA) and Interchange Format: Character
Content Architectures\` (also published as ISO/IEC International Standard
8613-6); and (3) further extensions used by \'XTerm\', a terminal emulator for
the X Window System. The escape codes are described in a
  [Wikipedia article](http://en.wikipedia.org/wiki/ANSI_escape_code) and those
codes supported on current versions of Windows are descibed in
  [Microsoft's documentation](https://docs.microsoft.com/en-us/windows/console/console-virtual-terminal-sequences).

The whole of the \'ANSI\' standards are not supported by this library but most
(if not all) of the parts that are popular and well-supported by terminal
software are supported (see further below).

== Cursor positions
The functions moving the cursor to an absolute position are 0-based (the
top-left corner is considered to be at row 0 column 0) (see 'setCursorPosition')
and so is 'getCursorPosition'. The \'ANSI\' standards themselves are 1-based
(that is, the top-left corner is considered to be at row 1 column 1) and some
functions reporting the position of the cursor are too (see
'reportCursorPosition').

== Windows and control character sequences
The native terminal software on Windows has developed over time. Before
Windows 10 version 1511 (known as the \'November [2015] Update\' or
\'Threshold 2\') that software did not support control character sequences. From
2018, Microsoft introduced the Windows Pseudo Console (\'ConPTY\') API and then
Windows Terminal, with the objective of replacing most of the Windows Console
API with the use of control character sequences and retiring the historical
user-interface role of Windows Console Host (\'ConHost\').

Windows Terminal is supported on Windows 10 version 19041.0 or higher and
provided with Windows 11. It can be downloaded from the Microsoft Store. Windows
Terminal can be set as the default terminal application on Windows 10 (from
the 22H2 update) and is the default application on Windows 11 (from the 22H2
update).

Despite the above developments, some Windows users may continue to use ConHost.
ConHost does not enable the processing of \'ANSI\' control characters in output
by default. See 'hNowSupportsANSI' for a function that can try to enable such
processing.

Terminal software other than the native software exists for Windows. One example
is the \'mintty\' terminal emulator for \'Cygwin\', \'MSYS\' or \'MSYS2\', and
dervied projects, and for \'WSL\' (Windows Subsystem for Linux).

GHC's management of input and output (IO) on Windows has also developed over
time. If they are supported by the terminal software, some control character
sequences cause data to be emitted into the console input stream. For GHC's
historical and default IO manager, the function 'System.IO.hGetBufNonBlocking'
in module &quot;System.IO&quot; does not work on Windows. This has been attributed to the
lack of non-blocking primatives in the operating system (see
  [GHC bug report #806](https://ghc.haskell.org/trac/ghc/ticket/806). GHC's
native IO manager on Windows (\'WinIO\'), introduced as a preview in
  [GHC 9.0.1](https://downloads.haskell.org/ghc/9.0.1/docs/html/users_guide/9.0.1-notes.html#highlights),
has not yet provided a solution. On Windows, this library uses emulation based
on the Windows Console API to try to read data emitted into the console input
stream. Functions that use that emulation are not supported on consoles, such
as mintty, that are not based on that API.

== Function variants provided
Every function exported by this module comes in three variants, namely:

 * A variant that has an @IO ()@ type and doesn't take a @Handle@ (for example,
   @clearScreen :: IO ()@). This variant just outputs the \`ANSI\` command
   directly to the standard output channel ('stdout') and any terminal
   corresponding to it. Commands issued like this should work as you expect on
   both Unix-like operating systems and Windows (unless exceptions on Windows
   are stated).

 * An \'@h@...\' variant that has an @IO ()@ type but takes a @Handle@ (for
   example, @hClearScreen :: Handle -&gt; IO ()@). This variant outputs the
   \`ANSI\` command to the supplied handle and any terminal corresponding to it.
   Commands issued like this should also work as you expect on both Unix-like
   operating systems and Windows (unless exceptions on Windows are stated).

 * A \'...@Code@\' variant that has a @String@ type (for example,
   @clearScreenCode :: String@). This variant outputs the sequence of control
   characters as a 'String', which can be added to any other bit of text before
   being output. If a high degree of backwards compatability is rewuired, the
   use of these codes is discouraged because they will not work on legacy
   versions of Windows where the terminal in use is not ANSI-enabled (see
   further above). On Windows, where emulation has been necessary, these
   variants will always output the empty string. That is done so that it is
   possible to use them portably; for example, coloring console output on the
   understanding that you will see colors only if you are running on a Unix-like
   operating system or a version of Windows where emulation has not been
   necessary. If the control characters are always required, see module
   &quot;System.Console.ANSI.Codes&quot;.

== Examples of use

A simple example is below:

&gt; module Main where
&gt;
&gt; import System.Console.ANSI
&gt; import System.IO (stdout)
&gt;
&gt; -- Set colors and write some text in those colors.
&gt; main :: IO ()
&gt; main = do
&gt;   stdoutSupportsANSI &lt;- hNowSupportsANSI stdout
&gt;   if stdoutSupportsANSI
&gt;     then do
&gt;       setSGR [SetColor Foreground Vivid Red]
&gt;       setSGR [SetColor Background Vivid Blue]
&gt;       putStrLn &quot;Red-On-Blue&quot;
&gt;       setSGR [Reset]  -- Reset to default colour scheme
&gt;       putStrLn &quot;Default colors.&quot;
&gt;     else
&gt;       putStrLn &quot;Standard output does not support 'ANSI' escape codes.&quot;

Another example is below:

&gt; module Main where
&gt;
&gt; import System.IO (hFlush, stdout)
&gt; import System.Console.ANSI
&gt;
&gt; main :: IO ()
&gt; main = do
&gt;   stdoutSupportsANSI &lt;- hNowSupportsANSI stdout
&gt;   if stdoutSupportsANSI
&gt;     then do
&gt;       setSGR [SetColor Foreground Dull Blue]
&gt;       putStr &quot;Enter your name: &quot;
&gt;       setSGR [SetColor Foreground Dull Yellow]
&gt;       hFlush stdout  -- flush the output buffer before getLine
&gt;       name &lt;- getLine
&gt;       setSGR [SetColor Foreground Dull Blue]
&gt;       putStrLn $ &quot;Hello, &quot; ++ name ++ &quot;!&quot;
&gt;       setSGR [Reset]  -- reset to default colour scheme
&gt;     else
&gt;       putStrLn &quot;Standard output does not support 'ANSI' escape codes.&quot;

For many more examples, see the project's extensive
&lt;https://github.com/UnkindPartition/ansi-terminal/blob/master/app/Example.hs Example.hs&gt; file.
-}</span></span><span>
</span><span id="line-179"></span><span>
</span><span id="line-180"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="System.Console.ANSI.html"><span class="hs-identifier">System.Console.ANSI</span></a></span><span>
</span><span id="line-181"></span><span>  </span><span class="hs-special">(</span><span>
</span><span id="line-182"></span><span>    </span><span class="hs-comment">-- * Basic data types</span><span>
</span><span id="line-183"></span><span>    </span><span class="hs-keyword">module</span><span> </span><span class="annot"><span class="hs-identifier">System.Console.ANSI.Types</span></span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span>    </span><span class="hs-comment">-- * Cursor movement by character</span><span>
</span><span id="line-186"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#cursorUp"><span class="hs-identifier">cursorUp</span></a></span><span>
</span><span id="line-187"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#cursorDown"><span class="hs-identifier">cursorDown</span></a></span><span>
</span><span id="line-188"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#cursorForward"><span class="hs-identifier">cursorForward</span></a></span><span>
</span><span id="line-189"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#cursorBackward"><span class="hs-identifier">cursorBackward</span></a></span><span>
</span><span id="line-190"></span><span>    </span><span class="hs-comment">-- ** \'h...\' variants</span><span>
</span><span id="line-191"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#hCursorUp"><span class="hs-identifier">hCursorUp</span></a></span><span>
</span><span id="line-192"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#hCursorDown"><span class="hs-identifier">hCursorDown</span></a></span><span>
</span><span id="line-193"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#hCursorForward"><span class="hs-identifier">hCursorForward</span></a></span><span>
</span><span id="line-194"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#hCursorBackward"><span class="hs-identifier">hCursorBackward</span></a></span><span>
</span><span id="line-195"></span><span>    </span><span class="hs-comment">-- ** \'...Code\' variants</span><span>
</span><span id="line-196"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">cursorUpCode</span></span><span>
</span><span id="line-197"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">cursorDownCode</span></span><span>
</span><span id="line-198"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">cursorForwardCode</span></span><span>
</span><span id="line-199"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">cursorBackwardCode</span></span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span>    </span><span class="hs-comment">-- * Cursor movement by line</span><span>
</span><span id="line-202"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-203"></span><span>    </span><span class="hs-comment">-- | The difference between movements \&quot;by character\&quot; and \&quot;by line\&quot; is</span><span>
</span><span id="line-204"></span><span>    </span><span class="hs-comment">-- that @*Line@ functions additionally move the cursor to the start of the</span><span>
</span><span id="line-205"></span><span>    </span><span class="hs-comment">-- line, while functions like @cursorUp@ and @cursorDown@ keep the column</span><span>
</span><span id="line-206"></span><span>    </span><span class="hs-comment">-- the same.</span><span>
</span><span id="line-207"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#cursorUpLine"><span class="hs-identifier">cursorUpLine</span></a></span><span>
</span><span id="line-208"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#cursorDownLine"><span class="hs-identifier">cursorDownLine</span></a></span><span>
</span><span id="line-209"></span><span>    </span><span class="hs-comment">-- ** \'h...\' variants</span><span>
</span><span id="line-210"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#hCursorUpLine"><span class="hs-identifier">hCursorUpLine</span></a></span><span>
</span><span id="line-211"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#hCursorDownLine"><span class="hs-identifier">hCursorDownLine</span></a></span><span>
</span><span id="line-212"></span><span>    </span><span class="hs-comment">-- ** \'...Code\' variants</span><span>
</span><span id="line-213"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">cursorUpLineCode</span></span><span>
</span><span id="line-214"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">cursorDownLineCode</span></span><span>
</span><span id="line-215"></span><span>
</span><span id="line-216"></span><span>    </span><span class="hs-comment">-- * Directly changing cursor position</span><span>
</span><span id="line-217"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#setCursorColumn"><span class="hs-identifier">setCursorColumn</span></a></span><span>
</span><span id="line-218"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#setCursorPosition"><span class="hs-identifier">setCursorPosition</span></a></span><span>
</span><span id="line-219"></span><span>    </span><span class="hs-comment">-- ** \'h...\' variants</span><span>
</span><span id="line-220"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#hSetCursorColumn"><span class="hs-identifier">hSetCursorColumn</span></a></span><span>
</span><span id="line-221"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#hSetCursorPosition"><span class="hs-identifier">hSetCursorPosition</span></a></span><span>
</span><span id="line-222"></span><span>    </span><span class="hs-comment">-- ** \'...Code\' variants</span><span>
</span><span id="line-223"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">setCursorColumnCode</span></span><span>
</span><span id="line-224"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">setCursorPositionCode</span></span><span>
</span><span id="line-225"></span><span>
</span><span id="line-226"></span><span>    </span><span class="hs-comment">-- * Saving, restoring and reporting cursor position</span><span>
</span><span id="line-227"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-228"></span><span>    </span><span class="hs-comment">-- | These code sequences are not part of ECMA-48 standard; they are popular,</span><span>
</span><span id="line-229"></span><span>    </span><span class="hs-comment">-- but non-portable extensions. E. g., Terminal.app on MacOS</span><span>
</span><span id="line-230"></span><span>    </span><span class="hs-comment">-- &lt;https://stackoverflow.com/questions/25879183 does not support them&gt;.</span><span>
</span><span id="line-231"></span><span>    </span><span class="hs-comment">-- A more portable way would be to query @terminfo@ database</span><span>
</span><span id="line-232"></span><span>    </span><span class="hs-comment">-- for @rc@ and @sc@ capabilities.</span><span>
</span><span id="line-233"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-234"></span><span>    </span><span class="hs-comment">-- Cursor positions</span><span>
</span><span id="line-235"></span><span>    </span><span class="hs-comment">-- &lt;https://unix.stackexchange.com/questions/565597 are relative to the viewport, not to its content&gt;.</span><span>
</span><span id="line-236"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-237"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#saveCursor"><span class="hs-identifier">saveCursor</span></a></span><span>
</span><span id="line-238"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#restoreCursor"><span class="hs-identifier">restoreCursor</span></a></span><span>
</span><span id="line-239"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#reportCursorPosition"><span class="hs-identifier">reportCursorPosition</span></a></span><span>
</span><span id="line-240"></span><span>    </span><span class="hs-comment">-- ** \'h...\' variants</span><span>
</span><span id="line-241"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#hSaveCursor"><span class="hs-identifier">hSaveCursor</span></a></span><span>
</span><span id="line-242"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#hRestoreCursor"><span class="hs-identifier">hRestoreCursor</span></a></span><span>
</span><span id="line-243"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#hReportCursorPosition"><span class="hs-identifier">hReportCursorPosition</span></a></span><span>
</span><span id="line-244"></span><span>    </span><span class="hs-comment">-- ** \'...Code\' variants</span><span>
</span><span id="line-245"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">saveCursorCode</span></span><span>
</span><span id="line-246"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">restoreCursorCode</span></span><span>
</span><span id="line-247"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">reportCursorPositionCode</span></span><span>
</span><span id="line-248"></span><span>
</span><span id="line-249"></span><span>    </span><span class="hs-comment">-- * Clearing parts of the screen</span><span>
</span><span id="line-250"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-251"></span><span>    </span><span class="hs-comment">-- | Note that these functions only clear parts of the screen. They do not</span><span>
</span><span id="line-252"></span><span>    </span><span class="hs-comment">-- move the cursor. Some functions are based on the whole screen and others</span><span>
</span><span id="line-253"></span><span>    </span><span class="hs-comment">-- are based on the line in which the cursor is located.</span><span>
</span><span id="line-254"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#clearFromCursorToScreenEnd"><span class="hs-identifier">clearFromCursorToScreenEnd</span></a></span><span>
</span><span id="line-255"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#clearFromCursorToScreenBeginning"><span class="hs-identifier">clearFromCursorToScreenBeginning</span></a></span><span>
</span><span id="line-256"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#clearScreen"><span class="hs-identifier">clearScreen</span></a></span><span>
</span><span id="line-257"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#clearFromCursorToLineEnd"><span class="hs-identifier">clearFromCursorToLineEnd</span></a></span><span>
</span><span id="line-258"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#clearFromCursorToLineBeginning"><span class="hs-identifier">clearFromCursorToLineBeginning</span></a></span><span>
</span><span id="line-259"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#clearLine"><span class="hs-identifier">clearLine</span></a></span><span>
</span><span id="line-260"></span><span>    </span><span class="hs-comment">-- ** \'h...\' variants</span><span>
</span><span id="line-261"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#hClearFromCursorToScreenEnd"><span class="hs-identifier">hClearFromCursorToScreenEnd</span></a></span><span>
</span><span id="line-262"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#hClearFromCursorToScreenBeginning"><span class="hs-identifier">hClearFromCursorToScreenBeginning</span></a></span><span>
</span><span id="line-263"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#hClearScreen"><span class="hs-identifier">hClearScreen</span></a></span><span>
</span><span id="line-264"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#hClearFromCursorToLineEnd"><span class="hs-identifier">hClearFromCursorToLineEnd</span></a></span><span>
</span><span id="line-265"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#hClearFromCursorToLineBeginning"><span class="hs-identifier">hClearFromCursorToLineBeginning</span></a></span><span>
</span><span id="line-266"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#hClearLine"><span class="hs-identifier">hClearLine</span></a></span><span>
</span><span id="line-267"></span><span>    </span><span class="hs-comment">-- ** \'...Code\' variants</span><span>
</span><span id="line-268"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">clearFromCursorToScreenEndCode</span></span><span>
</span><span id="line-269"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">clearFromCursorToScreenBeginningCode</span></span><span>
</span><span id="line-270"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">clearScreenCode</span></span><span>
</span><span id="line-271"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">clearFromCursorToLineEndCode</span></span><span>
</span><span id="line-272"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">clearFromCursorToLineBeginningCode</span></span><span>
</span><span id="line-273"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">clearLineCode</span></span><span>
</span><span id="line-274"></span><span>
</span><span id="line-275"></span><span>    </span><span class="hs-comment">-- * Enabling and disabling automatic line wrapping</span><span>
</span><span id="line-276"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-277"></span><span>    </span><span class="hs-comment">-- | These functions control whether or not characters automatically wrap to</span><span>
</span><span id="line-278"></span><span>    </span><span class="hs-comment">-- the next line when the cursor reaches the right border.</span><span>
</span><span id="line-279"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#enableLineWrap"><span class="hs-identifier">enableLineWrap</span></a></span><span>
</span><span id="line-280"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#disableLineWrap"><span class="hs-identifier">disableLineWrap</span></a></span><span>
</span><span id="line-281"></span><span>    </span><span class="hs-comment">-- ** \'h...\' variants</span><span>
</span><span id="line-282"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#hEnableLineWrap"><span class="hs-identifier">hEnableLineWrap</span></a></span><span>
</span><span id="line-283"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#hDisableLineWrap"><span class="hs-identifier">hDisableLineWrap</span></a></span><span>
</span><span id="line-284"></span><span>    </span><span class="hs-comment">-- ** \'...Code\' variants</span><span>
</span><span id="line-285"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">enableLineWrapCode</span></span><span>
</span><span id="line-286"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">disableLineWrapCode</span></span><span>
</span><span id="line-287"></span><span>
</span><span id="line-288"></span><span>    </span><span class="hs-comment">-- * Scrolling the screen</span><span>
</span><span id="line-289"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#scrollPageUp"><span class="hs-identifier">scrollPageUp</span></a></span><span>
</span><span id="line-290"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#scrollPageDown"><span class="hs-identifier">scrollPageDown</span></a></span><span>
</span><span id="line-291"></span><span>    </span><span class="hs-comment">-- ** \'h...\' variants</span><span>
</span><span id="line-292"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#hScrollPageUp"><span class="hs-identifier">hScrollPageUp</span></a></span><span>
</span><span id="line-293"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#hScrollPageDown"><span class="hs-identifier">hScrollPageDown</span></a></span><span>
</span><span id="line-294"></span><span>    </span><span class="hs-comment">-- ** \'...Code\' variants</span><span>
</span><span id="line-295"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">scrollPageUpCode</span></span><span>
</span><span id="line-296"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">scrollPageDownCode</span></span><span>
</span><span id="line-297"></span><span>
</span><span id="line-298"></span><span>    </span><span class="hs-comment">-- * Using screen buffers</span><span>
</span><span id="line-299"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-300"></span><span>    </span><span class="hs-comment">-- | These code sequences are not part of ECMA-48 standard; they are popular,</span><span>
</span><span id="line-301"></span><span>    </span><span class="hs-comment">-- but non-portable extensions, corresponding to @smcup@ and @rmcup@ capabilities</span><span>
</span><span id="line-302"></span><span>    </span><span class="hs-comment">-- in @terminfo@ database.</span><span>
</span><span id="line-303"></span><span>    </span><span class="hs-comment">-- On Windows, if emulation is required, switching between alternate and</span><span>
</span><span id="line-304"></span><span>    </span><span class="hs-comment">-- normal screen buffers is not emulated.</span><span>
</span><span id="line-305"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#useAlternateScreenBuffer"><span class="hs-identifier">useAlternateScreenBuffer</span></a></span><span>
</span><span id="line-306"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#useNormalScreenBuffer"><span class="hs-identifier">useNormalScreenBuffer</span></a></span><span>
</span><span id="line-307"></span><span>    </span><span class="hs-comment">-- ** \'h...\' variants</span><span>
</span><span id="line-308"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#hUseAlternateScreenBuffer"><span class="hs-identifier">hUseAlternateScreenBuffer</span></a></span><span>
</span><span id="line-309"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#hUseNormalScreenBuffer"><span class="hs-identifier">hUseNormalScreenBuffer</span></a></span><span>
</span><span id="line-310"></span><span>    </span><span class="hs-comment">-- ** \'...Code\' variants</span><span>
</span><span id="line-311"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">useAlternateScreenBufferCode</span></span><span>
</span><span id="line-312"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">useNormalScreenBufferCode</span></span><span>
</span><span id="line-313"></span><span>
</span><span id="line-314"></span><span>    </span><span class="hs-comment">-- * Reporting the background or foreground colors</span><span>
</span><span id="line-315"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#reportLayerColor"><span class="hs-identifier">reportLayerColor</span></a></span><span>
</span><span id="line-316"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#hReportLayerColor"><span class="hs-identifier">hReportLayerColor</span></a></span><span>
</span><span id="line-317"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">reportLayerColorCode</span></span><span>
</span><span id="line-318"></span><span>
</span><span id="line-319"></span><span>    </span><span class="hs-comment">-- * Select Graphic Rendition mode: colors and other whizzy stuff</span><span>
</span><span id="line-320"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#setSGR"><span class="hs-identifier">setSGR</span></a></span><span>
</span><span id="line-321"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#hSetSGR"><span class="hs-identifier">hSetSGR</span></a></span><span>
</span><span id="line-322"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">setSGRCode</span></span><span>
</span><span id="line-323"></span><span>
</span><span id="line-324"></span><span>    </span><span class="hs-comment">-- * Cursor visibilty changes</span><span>
</span><span id="line-325"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-326"></span><span>    </span><span class="hs-comment">-- | Strictly speaking, these code sequences are not part of ECMA-48 standard;</span><span>
</span><span id="line-327"></span><span>    </span><span class="hs-comment">-- they are popular, but non-portable extensions. However, in practice they seem</span><span>
</span><span id="line-328"></span><span>    </span><span class="hs-comment">-- to work pretty much everywhere.</span><span>
</span><span id="line-329"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#hideCursor"><span class="hs-identifier">hideCursor</span></a></span><span>
</span><span id="line-330"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#showCursor"><span class="hs-identifier">showCursor</span></a></span><span>
</span><span id="line-331"></span><span>    </span><span class="hs-comment">-- ** \'h...\' variants</span><span>
</span><span id="line-332"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#hHideCursor"><span class="hs-identifier">hHideCursor</span></a></span><span>
</span><span id="line-333"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#hShowCursor"><span class="hs-identifier">hShowCursor</span></a></span><span>
</span><span id="line-334"></span><span>    </span><span class="hs-comment">-- ** \'...Code\' variants</span><span>
</span><span id="line-335"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">hideCursorCode</span></span><span>
</span><span id="line-336"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">showCursorCode</span></span><span>
</span><span id="line-337"></span><span>
</span><span id="line-338"></span><span>    </span><span class="hs-comment">-- * Hyperlinks</span><span>
</span><span id="line-339"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-340"></span><span>    </span><span class="hs-comment">-- | These code sequences are not part of ECMA-48 standard and not even an</span><span>
</span><span id="line-341"></span><span>    </span><span class="hs-comment">-- @xterm@ extension. Nevertheless</span><span>
</span><span id="line-342"></span><span>    </span><span class="hs-comment">-- &lt;https://gist.github.com/egmontkob/eb114294efbcd5adb1944c9f3cb5feda many terminals&gt;</span><span>
</span><span id="line-343"></span><span>    </span><span class="hs-comment">-- support them. On Windows, if emulation is required,</span><span>
</span><span id="line-344"></span><span>    </span><span class="hs-comment">-- hyperlinks are not emulated.</span><span>
</span><span id="line-345"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#hyperlink"><span class="hs-identifier">hyperlink</span></a></span><span>
</span><span id="line-346"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#hyperlinkWithId"><span class="hs-identifier">hyperlinkWithId</span></a></span><span>
</span><span id="line-347"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#hyperlinkWithParams"><span class="hs-identifier">hyperlinkWithParams</span></a></span><span>
</span><span id="line-348"></span><span>    </span><span class="hs-comment">-- ** \'h...\' variants</span><span>
</span><span id="line-349"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#hHyperlink"><span class="hs-identifier">hHyperlink</span></a></span><span>
</span><span id="line-350"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#hHyperlinkWithId"><span class="hs-identifier">hHyperlinkWithId</span></a></span><span>
</span><span id="line-351"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#hHyperlinkWithParams"><span class="hs-identifier">hHyperlinkWithParams</span></a></span><span>
</span><span id="line-352"></span><span>    </span><span class="hs-comment">-- ** \'...Code\' variants</span><span>
</span><span id="line-353"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">hyperlinkCode</span></span><span>
</span><span id="line-354"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">hyperlinkWithIdCode</span></span><span>
</span><span id="line-355"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">hyperlinkWithParamsCode</span></span><span>
</span><span id="line-356"></span><span>
</span><span id="line-357"></span><span>    </span><span class="hs-comment">-- * Changing the title</span><span>
</span><span id="line-358"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#setTitle"><span class="hs-identifier">setTitle</span></a></span><span>
</span><span id="line-359"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#hSetTitle"><span class="hs-identifier">hSetTitle</span></a></span><span>
</span><span id="line-360"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">setTitleCode</span></span><span>
</span><span id="line-361"></span><span>
</span><span id="line-362"></span><span>    </span><span class="hs-comment">-- * Checking if handle supports ANSI (not portable: GHC only)</span><span>
</span><span id="line-363"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#hSupportsANSI"><span class="hs-identifier">hSupportsANSI</span></a></span><span>
</span><span id="line-364"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#hNowSupportsANSI"><span class="hs-identifier">hNowSupportsANSI</span></a></span><span>
</span><span id="line-365"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#hSupportsANSIColor"><span class="hs-identifier">hSupportsANSIColor</span></a></span><span>
</span><span id="line-366"></span><span>
</span><span id="line-367"></span><span>    </span><span class="hs-comment">-- * Getting the cursor position</span><span>
</span><span id="line-368"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#getCursorPosition"><span class="hs-identifier">getCursorPosition</span></a></span><span>
</span><span id="line-369"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#hGetCursorPosition"><span class="hs-identifier">hGetCursorPosition</span></a></span><span>
</span><span id="line-370"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#getReportedCursorPosition"><span class="hs-identifier">getReportedCursorPosition</span></a></span><span>
</span><span id="line-371"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#cursorPosition"><span class="hs-identifier">cursorPosition</span></a></span><span>
</span><span id="line-372"></span><span>
</span><span id="line-373"></span><span>    </span><span class="hs-comment">-- * Getting the terminal size</span><span>
</span><span id="line-374"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#getTerminalSize"><span class="hs-identifier">getTerminalSize</span></a></span><span>
</span><span id="line-375"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#hGetTerminalSize"><span class="hs-identifier">hGetTerminalSize</span></a></span><span>
</span><span id="line-376"></span><span>
</span><span id="line-377"></span><span>    </span><span class="hs-comment">-- * Getting the background or foreground colors</span><span>
</span><span id="line-378"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#getLayerColor"><span class="hs-identifier">getLayerColor</span></a></span><span>
</span><span id="line-379"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#hGetLayerColor"><span class="hs-identifier">hGetLayerColor</span></a></span><span>
</span><span id="line-380"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#getReportedLayerColor"><span class="hs-identifier">getReportedLayerColor</span></a></span><span>
</span><span id="line-381"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#layerColor"><span class="hs-identifier">layerColor</span></a></span><span>
</span><span id="line-382"></span><span>
</span><span id="line-383"></span><span>    </span><span class="hs-comment">-- * Deprecated</span><span>
</span><span id="line-384"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#hSupportsANSIWithoutEmulation"><span class="hs-identifier">hSupportsANSIWithoutEmulation</span></a></span><span>
</span><span id="line-385"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-386"></span><span>
</span><span id="line-387"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Exception.Base</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">bracket</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-388"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">when</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">void</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-389"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Char</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">digitToInt</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">isDigit</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">isHexDigit</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-390"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Colour.SRGB</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">RGB</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-391"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Word</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Word16</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-392"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.IO</span></span><span>
</span><span id="line-393"></span><span>         </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">BufferMode</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Handle</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">hFlush</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">hGetBuffering</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">hGetEcho</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">hPutStr</span></span><span>
</span><span id="line-394"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">hReady</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">hSetBuffering</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">hSetEcho</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">stdin</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">stdout</span></span><span>
</span><span id="line-395"></span><span>         </span><span class="hs-special">)</span><span>
</span><span id="line-396"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.ParserCombinators.ReadP</span></span><span>
</span><span id="line-397"></span><span>         </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">ReadP</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(&lt;++)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">char</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">many1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">readP_to_S</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">satisfy</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">string</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-398"></span><span>
</span><span id="line-399"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Console.ANSI.Codes</span></span><span>
</span><span id="line-400"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="System.Console.ANSI.Internal.html"><span class="hs-identifier">System.Console.ANSI.Internal</span></a></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Internal</span></span><span>
</span><span id="line-401"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Console.ANSI.Types</span></span><span>
</span><span id="line-402"></span><span>
</span><span id="line-403"></span><span class="annot"><a href="System.Console.ANSI.html#hCursorUp"><span class="hs-identifier hs-type">hCursorUp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#hCursorDown"><span class="hs-identifier hs-type">hCursorDown</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#hCursorForward"><span class="hs-identifier hs-type">hCursorForward</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#hCursorBackward"><span class="hs-identifier hs-type">hCursorBackward</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-404"></span><span>     </span><span class="annot"><span class="hs-identifier hs-type">Handle</span></span><span>
</span><span id="line-405"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- Number of lines or characters to move</span><span>
</span><span id="line-406"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-407"></span><span id="hCursorUp"><span class="annot"><span class="annottext">hCursorUp :: Handle -&gt; Int -&gt; IO ()
</span><a href="System.Console.ANSI.html#hCursorUp"><span class="hs-identifier hs-var hs-var">hCursorUp</span></a></span></span><span> </span><span id="local-6989586621679031629"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031629"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679031630"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679031630"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; String -&gt; IO ()
</span><span class="hs-identifier hs-var">hPutStr</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031629"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
</span><span class="hs-identifier hs-var">cursorUpCode</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679031630"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-408"></span><span id="hCursorDown"><span class="annot"><span class="annottext">hCursorDown :: Handle -&gt; Int -&gt; IO ()
</span><a href="System.Console.ANSI.html#hCursorDown"><span class="hs-identifier hs-var hs-var">hCursorDown</span></a></span></span><span> </span><span id="local-6989586621679031631"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031631"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679031632"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679031632"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; String -&gt; IO ()
</span><span class="hs-identifier hs-var">hPutStr</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031631"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
</span><span class="hs-identifier hs-var">cursorDownCode</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679031632"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-409"></span><span id="hCursorForward"><span class="annot"><span class="annottext">hCursorForward :: Handle -&gt; Int -&gt; IO ()
</span><a href="System.Console.ANSI.html#hCursorForward"><span class="hs-identifier hs-var hs-var">hCursorForward</span></a></span></span><span> </span><span id="local-6989586621679031633"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031633"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679031634"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679031634"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; String -&gt; IO ()
</span><span class="hs-identifier hs-var">hPutStr</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031633"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
</span><span class="hs-identifier hs-var">cursorForwardCode</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679031634"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-410"></span><span id="hCursorBackward"><span class="annot"><span class="annottext">hCursorBackward :: Handle -&gt; Int -&gt; IO ()
</span><a href="System.Console.ANSI.html#hCursorBackward"><span class="hs-identifier hs-var hs-var">hCursorBackward</span></a></span></span><span> </span><span id="local-6989586621679031635"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031635"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679031636"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679031636"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; String -&gt; IO ()
</span><span class="hs-identifier hs-var">hPutStr</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031635"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
</span><span class="hs-identifier hs-var">cursorBackwardCode</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679031636"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-411"></span><span>
</span><span id="line-412"></span><span class="annot"><a href="System.Console.ANSI.html#cursorUp"><span class="hs-identifier hs-type">cursorUp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#cursorDown"><span class="hs-identifier hs-type">cursorDown</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#cursorForward"><span class="hs-identifier hs-type">cursorForward</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#cursorBackward"><span class="hs-identifier hs-type">cursorBackward</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-413"></span><span>     </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ Number of lines or characters to move</span><span>
</span><span id="line-414"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-415"></span><span id="cursorUp"><span class="annot"><span class="annottext">cursorUp :: Int -&gt; IO ()
</span><a href="System.Console.ANSI.html#cursorUp"><span class="hs-identifier hs-var hs-var">cursorUp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; Int -&gt; IO ()
</span><a href="System.Console.ANSI.html#hCursorUp"><span class="hs-identifier hs-var">hCursorUp</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stdout</span></span><span>
</span><span id="line-416"></span><span id="cursorDown"><span class="annot"><span class="annottext">cursorDown :: Int -&gt; IO ()
</span><a href="System.Console.ANSI.html#cursorDown"><span class="hs-identifier hs-var hs-var">cursorDown</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; Int -&gt; IO ()
</span><a href="System.Console.ANSI.html#hCursorDown"><span class="hs-identifier hs-var">hCursorDown</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stdout</span></span><span>
</span><span id="line-417"></span><span id="cursorForward"><span class="annot"><span class="annottext">cursorForward :: Int -&gt; IO ()
</span><a href="System.Console.ANSI.html#cursorForward"><span class="hs-identifier hs-var hs-var">cursorForward</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; Int -&gt; IO ()
</span><a href="System.Console.ANSI.html#hCursorForward"><span class="hs-identifier hs-var">hCursorForward</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stdout</span></span><span>
</span><span id="line-418"></span><span id="cursorBackward"><span class="annot"><span class="annottext">cursorBackward :: Int -&gt; IO ()
</span><a href="System.Console.ANSI.html#cursorBackward"><span class="hs-identifier hs-var hs-var">cursorBackward</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; Int -&gt; IO ()
</span><a href="System.Console.ANSI.html#hCursorBackward"><span class="hs-identifier hs-var">hCursorBackward</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stdout</span></span><span>
</span><span id="line-419"></span><span>
</span><span id="line-420"></span><span class="annot"><a href="System.Console.ANSI.html#hCursorDownLine"><span class="hs-identifier hs-type">hCursorDownLine</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#hCursorUpLine"><span class="hs-identifier hs-type">hCursorUpLine</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-421"></span><span>     </span><span class="annot"><span class="hs-identifier hs-type">Handle</span></span><span>
</span><span id="line-422"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- Number of lines to move</span><span>
</span><span id="line-423"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-424"></span><span id="hCursorDownLine"><span class="annot"><span class="annottext">hCursorDownLine :: Handle -&gt; Int -&gt; IO ()
</span><a href="System.Console.ANSI.html#hCursorDownLine"><span class="hs-identifier hs-var hs-var">hCursorDownLine</span></a></span></span><span> </span><span id="local-6989586621679031637"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031637"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679031638"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679031638"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; String -&gt; IO ()
</span><span class="hs-identifier hs-var">hPutStr</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031637"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
</span><span class="hs-identifier hs-var">cursorDownLineCode</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679031638"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-425"></span><span id="hCursorUpLine"><span class="annot"><span class="annottext">hCursorUpLine :: Handle -&gt; Int -&gt; IO ()
</span><a href="System.Console.ANSI.html#hCursorUpLine"><span class="hs-identifier hs-var hs-var">hCursorUpLine</span></a></span></span><span> </span><span id="local-6989586621679031639"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031639"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679031640"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679031640"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; String -&gt; IO ()
</span><span class="hs-identifier hs-var">hPutStr</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031639"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
</span><span class="hs-identifier hs-var">cursorUpLineCode</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679031640"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-426"></span><span>
</span><span id="line-427"></span><span class="annot"><a href="System.Console.ANSI.html#cursorDownLine"><span class="hs-identifier hs-type">cursorDownLine</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#cursorUpLine"><span class="hs-identifier hs-type">cursorUpLine</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-428"></span><span>     </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ Number of lines to move</span><span>
</span><span id="line-429"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-430"></span><span id="cursorDownLine"><span class="annot"><span class="annottext">cursorDownLine :: Int -&gt; IO ()
</span><a href="System.Console.ANSI.html#cursorDownLine"><span class="hs-identifier hs-var hs-var">cursorDownLine</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; Int -&gt; IO ()
</span><a href="System.Console.ANSI.html#hCursorDownLine"><span class="hs-identifier hs-var">hCursorDownLine</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stdout</span></span><span>
</span><span id="line-431"></span><span id="cursorUpLine"><span class="annot"><span class="annottext">cursorUpLine :: Int -&gt; IO ()
</span><a href="System.Console.ANSI.html#cursorUpLine"><span class="hs-identifier hs-var hs-var">cursorUpLine</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; Int -&gt; IO ()
</span><a href="System.Console.ANSI.html#hCursorUpLine"><span class="hs-identifier hs-var">hCursorUpLine</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stdout</span></span><span>
</span><span id="line-432"></span><span>
</span><span id="line-433"></span><span class="annot"><a href="System.Console.ANSI.html#hSetCursorColumn"><span class="hs-identifier hs-type">hSetCursorColumn</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-434"></span><span>     </span><span class="annot"><span class="hs-identifier hs-type">Handle</span></span><span>
</span><span id="line-435"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- 0-based column to move to</span><span>
</span><span id="line-436"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-437"></span><span id="hSetCursorColumn"><span class="annot"><span class="annottext">hSetCursorColumn :: Handle -&gt; Int -&gt; IO ()
</span><a href="System.Console.ANSI.html#hSetCursorColumn"><span class="hs-identifier hs-var hs-var">hSetCursorColumn</span></a></span></span><span> </span><span id="local-6989586621679031641"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031641"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679031642"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679031642"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; String -&gt; IO ()
</span><span class="hs-identifier hs-var">hPutStr</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031641"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
</span><span class="hs-identifier hs-var">setCursorColumnCode</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679031642"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-438"></span><span>
</span><span id="line-439"></span><span class="hs-comment">-- | Move the cursor to the specified column. The column numbering is 0-based</span><span>
</span><span id="line-440"></span><span class="hs-comment">-- (that is, the left-most column is numbered 0).</span><span>
</span><span id="line-441"></span><span class="annot"><a href="System.Console.ANSI.html#setCursorColumn"><span class="hs-identifier hs-type">setCursorColumn</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-442"></span><span>     </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ 0-based column to move to</span><span>
</span><span id="line-443"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-444"></span><span id="setCursorColumn"><span class="annot"><span class="annottext">setCursorColumn :: Int -&gt; IO ()
</span><a href="System.Console.ANSI.html#setCursorColumn"><span class="hs-identifier hs-var hs-var">setCursorColumn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; Int -&gt; IO ()
</span><a href="System.Console.ANSI.html#hSetCursorColumn"><span class="hs-identifier hs-var">hSetCursorColumn</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stdout</span></span><span>
</span><span id="line-445"></span><span>
</span><span id="line-446"></span><span class="annot"><a href="System.Console.ANSI.html#hSetCursorPosition"><span class="hs-identifier hs-type">hSetCursorPosition</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-447"></span><span>     </span><span class="annot"><span class="hs-identifier hs-type">Handle</span></span><span>
</span><span id="line-448"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- 0-based row to move to</span><span>
</span><span id="line-449"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- 0-based column to move to</span><span>
</span><span id="line-450"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-451"></span><span id="hSetCursorPosition"><span class="annot"><span class="annottext">hSetCursorPosition :: Handle -&gt; Int -&gt; Int -&gt; IO ()
</span><a href="System.Console.ANSI.html#hSetCursorPosition"><span class="hs-identifier hs-var hs-var">hSetCursorPosition</span></a></span></span><span> </span><span id="local-6989586621679031643"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031643"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679031644"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679031644"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679031645"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679031645"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; String -&gt; IO ()
</span><span class="hs-identifier hs-var">hPutStr</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031643"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; String
</span><span class="hs-identifier hs-var">setCursorPositionCode</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679031644"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679031645"><span class="hs-identifier hs-var">m</span></a></span><span>
</span><span id="line-452"></span><span>
</span><span id="line-453"></span><span class="hs-comment">-- | Move the cursor to the specified position (row and column). The position is</span><span>
</span><span id="line-454"></span><span class="hs-comment">-- 0-based (that is, the top-left corner is at row 0 column 0).</span><span>
</span><span id="line-455"></span><span class="annot"><a href="System.Console.ANSI.html#setCursorPosition"><span class="hs-identifier hs-type">setCursorPosition</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-456"></span><span>     </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ 0-based row to move to</span><span>
</span><span id="line-457"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ 0-based column to move to</span><span>
</span><span id="line-458"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-459"></span><span id="setCursorPosition"><span class="annot"><span class="annottext">setCursorPosition :: Int -&gt; Int -&gt; IO ()
</span><a href="System.Console.ANSI.html#setCursorPosition"><span class="hs-identifier hs-var hs-var">setCursorPosition</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; Int -&gt; Int -&gt; IO ()
</span><a href="System.Console.ANSI.html#hSetCursorPosition"><span class="hs-identifier hs-var">hSetCursorPosition</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stdout</span></span><span>
</span><span id="line-460"></span><span>
</span><span id="line-461"></span><span class="annot"><a href="System.Console.ANSI.html#hSaveCursor"><span class="hs-identifier hs-type">hSaveCursor</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#hRestoreCursor"><span class="hs-identifier hs-type">hRestoreCursor</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#hReportCursorPosition"><span class="hs-identifier hs-type">hReportCursorPosition</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Handle</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-462"></span><span id="hSaveCursor"><span class="annot"><span class="annottext">hSaveCursor :: Handle -&gt; IO ()
</span><a href="System.Console.ANSI.html#hSaveCursor"><span class="hs-identifier hs-var hs-var">hSaveCursor</span></a></span></span><span> </span><span id="local-6989586621679031646"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031646"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; String -&gt; IO ()
</span><span class="hs-identifier hs-var">hPutStr</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031646"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier hs-var">saveCursorCode</span></span><span>
</span><span id="line-463"></span><span id="hRestoreCursor"><span class="annot"><span class="annottext">hRestoreCursor :: Handle -&gt; IO ()
</span><a href="System.Console.ANSI.html#hRestoreCursor"><span class="hs-identifier hs-var hs-var">hRestoreCursor</span></a></span></span><span> </span><span id="local-6989586621679031647"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031647"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; String -&gt; IO ()
</span><span class="hs-identifier hs-var">hPutStr</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031647"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier hs-var">restoreCursorCode</span></span><span>
</span><span id="line-464"></span><span id="hReportCursorPosition"><span class="annot"><span class="annottext">hReportCursorPosition :: Handle -&gt; IO ()
</span><a href="System.Console.ANSI.html#hReportCursorPosition"><span class="hs-identifier hs-var hs-var">hReportCursorPosition</span></a></span></span><span> </span><span id="local-6989586621679031648"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031648"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; String -&gt; IO ()
</span><span class="hs-identifier hs-var">hPutStr</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031648"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier hs-var">reportCursorPositionCode</span></span><span>
</span><span id="line-465"></span><span>
</span><span id="line-466"></span><span class="hs-comment">-- | Save the cursor position in memory. The only way to access the saved value</span><span>
</span><span id="line-467"></span><span class="hs-comment">-- is with the 'restoreCursor' command.</span><span>
</span><span id="line-468"></span><span class="hs-comment">--</span><span>
</span><span id="line-469"></span><span class="hs-comment">-- @since 0.7.1</span><span>
</span><span id="line-470"></span><span class="annot"><a href="System.Console.ANSI.html#saveCursor"><span class="hs-identifier hs-type">saveCursor</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-471"></span><span id="saveCursor"><span class="annot"><span class="annottext">saveCursor :: IO ()
</span><a href="System.Console.ANSI.html#saveCursor"><span class="hs-identifier hs-var hs-var">saveCursor</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; IO ()
</span><a href="System.Console.ANSI.html#hSaveCursor"><span class="hs-identifier hs-var">hSaveCursor</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stdout</span></span><span>
</span><span id="line-472"></span><span>
</span><span id="line-473"></span><span class="hs-comment">-- | Restore the cursor position from memory. There will be no value saved in</span><span>
</span><span id="line-474"></span><span class="hs-comment">-- memory until the first use of the 'saveCursor' command.</span><span>
</span><span id="line-475"></span><span class="hs-comment">--</span><span>
</span><span id="line-476"></span><span class="hs-comment">-- @since 0.7.1</span><span>
</span><span id="line-477"></span><span class="annot"><a href="System.Console.ANSI.html#restoreCursor"><span class="hs-identifier hs-type">restoreCursor</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-478"></span><span id="restoreCursor"><span class="annot"><span class="annottext">restoreCursor :: IO ()
</span><a href="System.Console.ANSI.html#restoreCursor"><span class="hs-identifier hs-var hs-var">restoreCursor</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; IO ()
</span><a href="System.Console.ANSI.html#hRestoreCursor"><span class="hs-identifier hs-var">hRestoreCursor</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stdout</span></span><span>
</span><span id="line-479"></span><span>
</span><span id="line-480"></span><span class="hs-comment">-- | Looking for a way to get the cursors position? See</span><span>
</span><span id="line-481"></span><span class="hs-comment">-- 'getCursorPosition'.</span><span>
</span><span id="line-482"></span><span class="hs-comment">--</span><span>
</span><span id="line-483"></span><span class="hs-comment">-- Emit the cursor position into the console input stream, immediately after</span><span>
</span><span id="line-484"></span><span class="hs-comment">-- being recognised on the output stream, as:</span><span>
</span><span id="line-485"></span><span class="hs-comment">-- @ESC [ \&lt;cursor row&gt; ; \&lt;cursor column&gt; R@</span><span>
</span><span id="line-486"></span><span class="hs-comment">--</span><span>
</span><span id="line-487"></span><span class="hs-comment">-- Note that the information that is emitted is 1-based (the top-left corner is</span><span>
</span><span id="line-488"></span><span class="hs-comment">-- at row 1 column 1) but 'setCursorColumn' and 'setCursorPosition' are</span><span>
</span><span id="line-489"></span><span class="hs-comment">-- 0-based.</span><span>
</span><span id="line-490"></span><span class="hs-comment">--</span><span>
</span><span id="line-491"></span><span class="hs-comment">-- In isolation of 'getReportedCursorPosition' or 'getCursorPosition', this</span><span>
</span><span id="line-492"></span><span class="hs-comment">-- function may be of limited use on Windows operating systems because of</span><span>
</span><span id="line-493"></span><span class="hs-comment">-- difficulties in obtaining the data emitted into the console input stream.</span><span>
</span><span id="line-494"></span><span class="hs-comment">--</span><span>
</span><span id="line-495"></span><span class="hs-comment">-- @since 0.7.1</span><span>
</span><span id="line-496"></span><span class="annot"><a href="System.Console.ANSI.html#reportCursorPosition"><span class="hs-identifier hs-type">reportCursorPosition</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-497"></span><span id="reportCursorPosition"><span class="annot"><span class="annottext">reportCursorPosition :: IO ()
</span><a href="System.Console.ANSI.html#reportCursorPosition"><span class="hs-identifier hs-var hs-var">reportCursorPosition</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; IO ()
</span><a href="System.Console.ANSI.html#hReportCursorPosition"><span class="hs-identifier hs-var">hReportCursorPosition</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stdout</span></span><span>
</span><span id="line-498"></span><span>
</span><span id="line-499"></span><span class="annot"><a href="System.Console.ANSI.html#hHideCursor"><span class="hs-identifier hs-type">hHideCursor</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#hShowCursor"><span class="hs-identifier hs-type">hShowCursor</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Handle</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-500"></span><span id="hHideCursor"><span class="annot"><span class="annottext">hHideCursor :: Handle -&gt; IO ()
</span><a href="System.Console.ANSI.html#hHideCursor"><span class="hs-identifier hs-var hs-var">hHideCursor</span></a></span></span><span> </span><span id="local-6989586621679031649"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031649"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; String -&gt; IO ()
</span><span class="hs-identifier hs-var">hPutStr</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031649"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier hs-var">hideCursorCode</span></span><span>
</span><span id="line-501"></span><span id="hShowCursor"><span class="annot"><span class="annottext">hShowCursor :: Handle -&gt; IO ()
</span><a href="System.Console.ANSI.html#hShowCursor"><span class="hs-identifier hs-var hs-var">hShowCursor</span></a></span></span><span> </span><span id="local-6989586621679031650"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031650"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; String -&gt; IO ()
</span><span class="hs-identifier hs-var">hPutStr</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031650"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier hs-var">showCursorCode</span></span><span>
</span><span id="line-502"></span><span>
</span><span id="line-503"></span><span class="annot"><a href="System.Console.ANSI.html#hideCursor"><span class="hs-identifier hs-type">hideCursor</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#showCursor"><span class="hs-identifier hs-type">showCursor</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-504"></span><span id="hideCursor"><span class="annot"><span class="annottext">hideCursor :: IO ()
</span><a href="System.Console.ANSI.html#hideCursor"><span class="hs-identifier hs-var hs-var">hideCursor</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; IO ()
</span><a href="System.Console.ANSI.html#hHideCursor"><span class="hs-identifier hs-var">hHideCursor</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stdout</span></span><span>
</span><span id="line-505"></span><span id="showCursor"><span class="annot"><span class="annottext">showCursor :: IO ()
</span><a href="System.Console.ANSI.html#showCursor"><span class="hs-identifier hs-var hs-var">showCursor</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; IO ()
</span><a href="System.Console.ANSI.html#hShowCursor"><span class="hs-identifier hs-var">hShowCursor</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stdout</span></span><span>
</span><span id="line-506"></span><span>
</span><span id="line-507"></span><span class="annot"><a href="System.Console.ANSI.html#hUseAlternateScreenBuffer"><span class="hs-identifier hs-type">hUseAlternateScreenBuffer</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Handle</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-508"></span><span id="hUseAlternateScreenBuffer"><span class="annot"><span class="annottext">hUseAlternateScreenBuffer :: Handle -&gt; IO ()
</span><a href="System.Console.ANSI.html#hUseAlternateScreenBuffer"><span class="hs-identifier hs-var hs-var">hUseAlternateScreenBuffer</span></a></span></span><span> </span><span id="local-6989586621679031651"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031651"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; String -&gt; IO ()
</span><span class="hs-identifier hs-var">hPutStr</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031651"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier hs-var">useAlternateScreenBufferCode</span></span><span>
</span><span id="line-509"></span><span>
</span><span id="line-510"></span><span class="annot"><a href="System.Console.ANSI.html#hUseNormalScreenBuffer"><span class="hs-identifier hs-type">hUseNormalScreenBuffer</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Handle</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-511"></span><span id="hUseNormalScreenBuffer"><span class="annot"><span class="annottext">hUseNormalScreenBuffer :: Handle -&gt; IO ()
</span><a href="System.Console.ANSI.html#hUseNormalScreenBuffer"><span class="hs-identifier hs-var hs-var">hUseNormalScreenBuffer</span></a></span></span><span> </span><span id="local-6989586621679031652"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031652"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; String -&gt; IO ()
</span><span class="hs-identifier hs-var">hPutStr</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031652"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier hs-var">useNormalScreenBufferCode</span></span><span>
</span><span id="line-512"></span><span>
</span><span id="line-513"></span><span class="hs-comment">-- | Use the Alternate Screen Buffer. If currently using the Normal Screen</span><span>
</span><span id="line-514"></span><span class="hs-comment">-- Buffer, it will save the cursor position and switch to the Alternate Screen</span><span>
</span><span id="line-515"></span><span class="hs-comment">-- Buffer. It will always clear the Alternate Screen Buffer. The Alternate</span><span>
</span><span id="line-516"></span><span class="hs-comment">-- Screen Buffer has no scroll back facility.</span><span>
</span><span id="line-517"></span><span class="hs-comment">--</span><span>
</span><span id="line-518"></span><span class="hs-comment">-- It is an application's responsibility to ensure that it switches back to the</span><span>
</span><span id="line-519"></span><span class="hs-comment">-- Normal Screen Buffer if an exception is raised while the Alternate Screen</span><span>
</span><span id="line-520"></span><span class="hs-comment">-- Buffer is being used. For example, by using 'Control.Exception.bracket_':</span><span>
</span><span id="line-521"></span><span class="hs-comment">--</span><span>
</span><span id="line-522"></span><span class="hs-comment">-- &gt; bracket_ useAlternateScreenBuffer useNormalScreenBuffer action</span><span>
</span><span id="line-523"></span><span class="hs-comment">--</span><span>
</span><span id="line-524"></span><span class="hs-comment">-- @since 0.11.4</span><span>
</span><span id="line-525"></span><span class="annot"><a href="System.Console.ANSI.html#useAlternateScreenBuffer"><span class="hs-identifier hs-type">useAlternateScreenBuffer</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-526"></span><span id="useAlternateScreenBuffer"><span class="annot"><span class="annottext">useAlternateScreenBuffer :: IO ()
</span><a href="System.Console.ANSI.html#useAlternateScreenBuffer"><span class="hs-identifier hs-var hs-var">useAlternateScreenBuffer</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; IO ()
</span><a href="System.Console.ANSI.html#hUseAlternateScreenBuffer"><span class="hs-identifier hs-var">hUseAlternateScreenBuffer</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stdout</span></span><span>
</span><span id="line-527"></span><span>
</span><span id="line-528"></span><span class="hs-comment">-- | Use the Normal Screen Buffer. If currently using the Alternate Screen</span><span>
</span><span id="line-529"></span><span class="hs-comment">-- Buffer, it will clear the Alternate Screen Buffer, and switch to the Normal</span><span>
</span><span id="line-530"></span><span class="hs-comment">-- Screen Buffer. It will always restore the saved cursor position.</span><span>
</span><span id="line-531"></span><span class="hs-comment">--</span><span>
</span><span id="line-532"></span><span class="hs-comment">-- @since 0.11.4</span><span>
</span><span id="line-533"></span><span class="annot"><a href="System.Console.ANSI.html#useNormalScreenBuffer"><span class="hs-identifier hs-type">useNormalScreenBuffer</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-534"></span><span id="useNormalScreenBuffer"><span class="annot"><span class="annottext">useNormalScreenBuffer :: IO ()
</span><a href="System.Console.ANSI.html#useNormalScreenBuffer"><span class="hs-identifier hs-var hs-var">useNormalScreenBuffer</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; IO ()
</span><a href="System.Console.ANSI.html#hUseNormalScreenBuffer"><span class="hs-identifier hs-var">hUseNormalScreenBuffer</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stdout</span></span><span>
</span><span id="line-535"></span><span>
</span><span id="line-536"></span><span class="hs-comment">-- Introduce a hyperlink with (key, value) parameters. Some terminals support</span><span>
</span><span id="line-537"></span><span class="hs-comment">-- an @id@ parameter key, so that hyperlinks with the same @id@ value are</span><span>
</span><span id="line-538"></span><span class="hs-comment">-- treated as connected.</span><span>
</span><span id="line-539"></span><span class="hs-comment">--</span><span>
</span><span id="line-540"></span><span class="hs-comment">-- @since 0.11.3</span><span>
</span><span id="line-541"></span><span class="annot"><a href="System.Console.ANSI.html#hHyperlinkWithParams"><span class="hs-identifier hs-type">hHyperlinkWithParams</span></a></span><span class="hs-glyph">::</span><span>
</span><span id="line-542"></span><span>     </span><span class="annot"><span class="hs-identifier hs-type">Handle</span></span><span>
</span><span id="line-543"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- Parameters</span><span>
</span><span id="line-544"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>              </span><span class="hs-comment">-- URI</span><span>
</span><span id="line-545"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>              </span><span class="hs-comment">-- Link text</span><span>
</span><span id="line-546"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-547"></span><span id="hHyperlinkWithParams"><span class="annot"><span class="annottext">hHyperlinkWithParams :: Handle -&gt; [(String, String)] -&gt; String -&gt; String -&gt; IO ()
</span><a href="System.Console.ANSI.html#hHyperlinkWithParams"><span class="hs-identifier hs-var hs-var">hHyperlinkWithParams</span></a></span></span><span> </span><span id="local-6989586621679031653"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031653"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679031654"><span class="annot"><span class="annottext">[(String, String)]
</span><a href="#local-6989586621679031654"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span id="local-6989586621679031655"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679031655"><span class="hs-identifier hs-var">uri</span></a></span></span><span> </span><span id="local-6989586621679031656"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679031656"><span class="hs-identifier hs-var">link</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-548"></span><span>  </span><span class="annot"><span class="annottext">Handle -&gt; String -&gt; IO ()
</span><span class="hs-identifier hs-var">hPutStr</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031653"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(String, String)] -&gt; String -&gt; String -&gt; String
</span><span class="hs-identifier hs-var">hyperlinkWithParamsCode</span></span><span> </span><span class="annot"><span class="annottext">[(String, String)]
</span><a href="#local-6989586621679031654"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679031655"><span class="hs-identifier hs-var">uri</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679031656"><span class="hs-identifier hs-var">link</span></a></span><span>
</span><span id="line-549"></span><span>
</span><span id="line-550"></span><span class="hs-comment">-- | Introduce a hyperlink with (key, value) parameters. Some terminals support</span><span>
</span><span id="line-551"></span><span class="hs-comment">-- an @id@ parameter key, so that hyperlinks with the same @id@ value are</span><span>
</span><span id="line-552"></span><span class="hs-comment">-- treated as connected.</span><span>
</span><span id="line-553"></span><span class="hs-comment">--</span><span>
</span><span id="line-554"></span><span class="hs-comment">-- @since 0.11.3</span><span>
</span><span id="line-555"></span><span class="annot"><a href="System.Console.ANSI.html#hyperlinkWithParams"><span class="hs-identifier hs-type">hyperlinkWithParams</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-556"></span><span>     </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>  </span><span class="hs-comment">-- ^ Parameters</span><span>
</span><span id="line-557"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>              </span><span class="hs-comment">-- ^ URI</span><span>
</span><span id="line-558"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>              </span><span class="hs-comment">-- ^ Link text</span><span>
</span><span id="line-559"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-560"></span><span id="hyperlinkWithParams"><span class="annot"><span class="annottext">hyperlinkWithParams :: [(String, String)] -&gt; String -&gt; String -&gt; IO ()
</span><a href="System.Console.ANSI.html#hyperlinkWithParams"><span class="hs-identifier hs-var hs-var">hyperlinkWithParams</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; [(String, String)] -&gt; String -&gt; String -&gt; IO ()
</span><a href="System.Console.ANSI.html#hHyperlinkWithParams"><span class="hs-identifier hs-var">hHyperlinkWithParams</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stdout</span></span><span>
</span><span id="line-561"></span><span>
</span><span id="line-562"></span><span class="hs-comment">-- Introduce a hyperlink.</span><span>
</span><span id="line-563"></span><span class="hs-comment">--</span><span>
</span><span id="line-564"></span><span class="hs-comment">-- @since 0.11.3</span><span>
</span><span id="line-565"></span><span class="annot"><a href="System.Console.ANSI.html#hHyperlink"><span class="hs-identifier hs-type">hHyperlink</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-566"></span><span>     </span><span class="annot"><span class="hs-identifier hs-type">Handle</span></span><span>
</span><span id="line-567"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>  </span><span class="hs-comment">-- URI</span><span>
</span><span id="line-568"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>  </span><span class="hs-comment">-- Link text</span><span>
</span><span id="line-569"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-570"></span><span id="hHyperlink"><span class="annot"><span class="annottext">hHyperlink :: Handle -&gt; String -&gt; String -&gt; IO ()
</span><a href="System.Console.ANSI.html#hHyperlink"><span class="hs-identifier hs-var hs-var">hHyperlink</span></a></span></span><span> </span><span id="local-6989586621679031657"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031657"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; [(String, String)] -&gt; String -&gt; String -&gt; IO ()
</span><a href="System.Console.ANSI.html#hHyperlinkWithParams"><span class="hs-identifier hs-var">hHyperlinkWithParams</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031657"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-571"></span><span>
</span><span id="line-572"></span><span class="hs-comment">-- | Introduce a hyperlink.</span><span>
</span><span id="line-573"></span><span class="hs-comment">--</span><span>
</span><span id="line-574"></span><span class="hs-comment">-- @since 0.11.3</span><span>
</span><span id="line-575"></span><span class="annot"><a href="System.Console.ANSI.html#hyperlink"><span class="hs-identifier hs-type">hyperlink</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-576"></span><span>     </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>  </span><span class="hs-comment">-- ^ URI</span><span>
</span><span id="line-577"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>  </span><span class="hs-comment">-- ^ Link text</span><span>
</span><span id="line-578"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-579"></span><span id="hyperlink"><span class="annot"><span class="annottext">hyperlink :: String -&gt; String -&gt; IO ()
</span><a href="System.Console.ANSI.html#hyperlink"><span class="hs-identifier hs-var hs-var">hyperlink</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; String -&gt; String -&gt; IO ()
</span><a href="System.Console.ANSI.html#hHyperlink"><span class="hs-identifier hs-var">hHyperlink</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stdout</span></span><span>
</span><span id="line-580"></span><span>
</span><span id="line-581"></span><span class="hs-comment">-- Introduce a hyperlink with an identifier for the link. Some terminals</span><span>
</span><span id="line-582"></span><span class="hs-comment">-- support an identifier, so that hyperlinks with the same identifier are</span><span>
</span><span id="line-583"></span><span class="hs-comment">-- treated as connected.</span><span>
</span><span id="line-584"></span><span class="hs-comment">--</span><span>
</span><span id="line-585"></span><span class="hs-comment">-- @since 0.11.3</span><span>
</span><span id="line-586"></span><span class="annot"><a href="System.Console.ANSI.html#hHyperlinkWithId"><span class="hs-identifier hs-type">hHyperlinkWithId</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-587"></span><span>     </span><span class="annot"><span class="hs-identifier hs-type">Handle</span></span><span>
</span><span id="line-588"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>  </span><span class="hs-comment">-- Identifier for the link</span><span>
</span><span id="line-589"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>  </span><span class="hs-comment">-- URI</span><span>
</span><span id="line-590"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>  </span><span class="hs-comment">-- Link text</span><span>
</span><span id="line-591"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-592"></span><span id="hHyperlinkWithId"><span class="annot"><span class="annottext">hHyperlinkWithId :: Handle -&gt; String -&gt; String -&gt; String -&gt; IO ()
</span><a href="System.Console.ANSI.html#hHyperlinkWithId"><span class="hs-identifier hs-var hs-var">hHyperlinkWithId</span></a></span></span><span> </span><span id="local-6989586621679031658"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031658"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679031659"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679031659"><span class="hs-identifier hs-var">linkId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; [(String, String)] -&gt; String -&gt; String -&gt; IO ()
</span><a href="System.Console.ANSI.html#hHyperlinkWithParams"><span class="hs-identifier hs-var">hHyperlinkWithParams</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031658"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;id&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679031659"><span class="hs-identifier hs-var">linkId</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-593"></span><span>
</span><span id="line-594"></span><span class="hs-comment">-- | Introduce a hyperlink with an identifier for the link. Some terminals</span><span>
</span><span id="line-595"></span><span class="hs-comment">-- support an identifier, so that hyperlinks with the same identifier are</span><span>
</span><span id="line-596"></span><span class="hs-comment">-- treated as connected.</span><span>
</span><span id="line-597"></span><span class="hs-comment">--</span><span>
</span><span id="line-598"></span><span class="hs-comment">-- @since 0.11.3</span><span>
</span><span id="line-599"></span><span class="annot"><a href="System.Console.ANSI.html#hyperlinkWithId"><span class="hs-identifier hs-type">hyperlinkWithId</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-600"></span><span>     </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>  </span><span class="hs-comment">-- ^ Identifier for the link</span><span>
</span><span id="line-601"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>  </span><span class="hs-comment">-- ^ URI</span><span>
</span><span id="line-602"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>  </span><span class="hs-comment">-- ^ Link text</span><span>
</span><span id="line-603"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-604"></span><span id="hyperlinkWithId"><span class="annot"><span class="annottext">hyperlinkWithId :: String -&gt; String -&gt; String -&gt; IO ()
</span><a href="System.Console.ANSI.html#hyperlinkWithId"><span class="hs-identifier hs-var hs-var">hyperlinkWithId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; String -&gt; String -&gt; String -&gt; IO ()
</span><a href="System.Console.ANSI.html#hHyperlinkWithId"><span class="hs-identifier hs-var">hHyperlinkWithId</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stdout</span></span><span>
</span><span id="line-605"></span><span>
</span><span id="line-606"></span><span class="hs-comment">-- Set the terminal window title and icon name (that is, the text for the</span><span>
</span><span id="line-607"></span><span class="hs-comment">-- window in the Start bar, or similar).</span><span>
</span><span id="line-608"></span><span class="annot"><a href="System.Console.ANSI.html#hSetTitle"><span class="hs-identifier hs-type">hSetTitle</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-609"></span><span>     </span><span class="annot"><span class="hs-identifier hs-type">Handle</span></span><span>
</span><span id="line-610"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-comment">-- New window title and icon name</span><span>
</span><span id="line-611"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-612"></span><span id="hSetTitle"><span class="annot"><span class="annottext">hSetTitle :: Handle -&gt; String -&gt; IO ()
</span><a href="System.Console.ANSI.html#hSetTitle"><span class="hs-identifier hs-var hs-var">hSetTitle</span></a></span></span><span> </span><span id="local-6989586621679031660"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031660"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679031661"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679031661"><span class="hs-identifier hs-var">title</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; String -&gt; IO ()
</span><span class="hs-identifier hs-var">hPutStr</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031660"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String
</span><span class="hs-identifier hs-var">setTitleCode</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679031661"><span class="hs-identifier hs-var">title</span></a></span><span>
</span><span id="line-613"></span><span>
</span><span id="line-614"></span><span class="hs-comment">-- | Set the terminal window title and icon name (that is, the text for the</span><span>
</span><span id="line-615"></span><span class="hs-comment">-- window in the Start bar, or similar).</span><span>
</span><span id="line-616"></span><span class="annot"><a href="System.Console.ANSI.html#setTitle"><span class="hs-identifier hs-type">setTitle</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-comment">-- ^ New window title and icon name</span><span>
</span><span id="line-617"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-618"></span><span id="setTitle"><span class="annot"><span class="annottext">setTitle :: String -&gt; IO ()
</span><a href="System.Console.ANSI.html#setTitle"><span class="hs-identifier hs-var hs-var">setTitle</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; String -&gt; IO ()
</span><a href="System.Console.ANSI.html#hSetTitle"><span class="hs-identifier hs-var">hSetTitle</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stdout</span></span><span>
</span><span id="line-619"></span><span>
</span><span id="line-620"></span><span class="hs-comment">-- | Use heuristics to determine whether the functions defined in this package</span><span>
</span><span id="line-621"></span><span class="hs-comment">-- will work with a given handle.</span><span>
</span><span id="line-622"></span><span class="hs-comment">--</span><span>
</span><span id="line-623"></span><span class="hs-comment">-- If the handle is not writable (that is, it cannot manage output - see</span><span>
</span><span id="line-624"></span><span class="hs-comment">-- 'System.IO.hIsWritable'), then @pure False@ is returned.</span><span>
</span><span id="line-625"></span><span class="hs-comment">--</span><span>
</span><span id="line-626"></span><span class="hs-comment">-- For Unix-like operating systems, the current implementation checks</span><span>
</span><span id="line-627"></span><span class="hs-comment">-- that: (1) the handle is a terminal; and (2) a @TERM@ environment variable is</span><span>
</span><span id="line-628"></span><span class="hs-comment">-- not set to @dumb@ (which is what the GNU Emacs text editor sets for its</span><span>
</span><span id="line-629"></span><span class="hs-comment">-- integrated terminal).</span><span>
</span><span id="line-630"></span><span class="hs-comment">--</span><span>
</span><span id="line-631"></span><span class="hs-comment">-- For Windows, the current implementation checks: first that (1) the handle is</span><span>
</span><span id="line-632"></span><span class="hs-comment">-- a terminal, (2) a @TERM@ environment variable is not set to @dumb@, and (3)</span><span>
</span><span id="line-633"></span><span class="hs-comment">-- the processing of \'ANSI\' control characters in output is enabled; and</span><span>
</span><span id="line-634"></span><span class="hs-comment">-- second, as an alternative, whether the handle is connected to a \'mintty\'</span><span>
</span><span id="line-635"></span><span class="hs-comment">-- terminal. (That is because the function 'System.IO.hIsTerminalDevice' is used</span><span>
</span><span id="line-636"></span><span class="hs-comment">-- to check if the handle is a terminal. However, where a non-native Windows</span><span>
</span><span id="line-637"></span><span class="hs-comment">-- terminal (such as \'mintty\') is implemented using redirection, that function</span><span>
</span><span id="line-638"></span><span class="hs-comment">-- will not identify a handle to the terminal as a terminal.) If it is not</span><span>
</span><span id="line-639"></span><span class="hs-comment">-- already enabled, this function does *not* enable the processing of \'ANSI\'</span><span>
</span><span id="line-640"></span><span class="hs-comment">-- control characters in output (see 'hNowSupportsANSI').</span><span>
</span><span id="line-641"></span><span class="hs-comment">--</span><span>
</span><span id="line-642"></span><span class="hs-comment">-- @since 0.6.2</span><span>
</span><span id="line-643"></span><span class="annot"><a href="System.Console.ANSI.html#hSupportsANSI"><span class="hs-identifier hs-type">hSupportsANSI</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Handle</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-644"></span><span id="hSupportsANSI"><span class="annot"><span class="annottext">hSupportsANSI :: Handle -&gt; IO Bool
</span><a href="System.Console.ANSI.html#hSupportsANSI"><span class="hs-identifier hs-var hs-var">hSupportsANSI</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; IO Bool
</span><a href="System.Console.ANSI.Internal.html#hSupportsANSI"><span class="hs-identifier hs-var">Internal.hSupportsANSI</span></a></span><span>
</span><span id="line-645"></span><span>
</span><span id="line-646"></span><span class="hs-comment">-- | With one exception, equivalent to 'hSupportsANSI'. The exception is that,</span><span>
</span><span id="line-647"></span><span class="hs-comment">-- on Windows only, if a @TERM@ environment variable is not set to @dumb@ and</span><span>
</span><span id="line-648"></span><span class="hs-comment">-- the processing of \'ANSI\' control characters in output is not enabled, this</span><span>
</span><span id="line-649"></span><span class="hs-comment">-- function first tries to enable such processing.</span><span>
</span><span id="line-650"></span><span class="hs-comment">--</span><span>
</span><span id="line-651"></span><span class="hs-comment">-- @Since 1.0.1</span><span>
</span><span id="line-652"></span><span class="annot"><a href="System.Console.ANSI.html#hNowSupportsANSI"><span class="hs-identifier hs-type">hNowSupportsANSI</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Handle</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-653"></span><span id="hNowSupportsANSI"><span class="annot"><span class="annottext">hNowSupportsANSI :: Handle -&gt; IO Bool
</span><a href="System.Console.ANSI.html#hNowSupportsANSI"><span class="hs-identifier hs-var hs-var">hNowSupportsANSI</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; IO Bool
</span><a href="System.Console.ANSI.Internal.html#hNowSupportsANSI"><span class="hs-identifier hs-var">Internal.hNowSupportsANSI</span></a></span><span>
</span><span id="line-654"></span><span>
</span><span id="line-655"></span><span class="hs-comment">-- | Some terminals (e.g. Emacs) are not fully ANSI compliant but can support</span><span>
</span><span id="line-656"></span><span class="hs-comment">-- ANSI colors. This can be used in such cases, if colors are all that is</span><span>
</span><span id="line-657"></span><span class="hs-comment">-- needed.</span><span>
</span><span id="line-658"></span><span class="hs-comment">--</span><span>
</span><span id="line-659"></span><span class="hs-comment">-- @since 0.9</span><span>
</span><span id="line-660"></span><span class="annot"><a href="System.Console.ANSI.html#hSupportsANSIColor"><span class="hs-identifier hs-type">hSupportsANSIColor</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Handle</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-661"></span><span id="hSupportsANSIColor"><span class="annot"><span class="annottext">hSupportsANSIColor :: Handle -&gt; IO Bool
</span><a href="System.Console.ANSI.html#hSupportsANSIColor"><span class="hs-identifier hs-var hs-var">hSupportsANSIColor</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; IO Bool
</span><a href="System.Console.ANSI.Internal.html#hSupportsANSIColor"><span class="hs-identifier hs-var">Internal.hSupportsANSIColor</span></a></span><span>
</span><span id="line-662"></span><span>
</span><span id="line-663"></span><span class="hs-comment">-- | Use heuristics to determine whether a given handle will support \'ANSI\'</span><span>
</span><span id="line-664"></span><span class="hs-comment">-- control characters in output. The function is consistent with</span><span>
</span><span id="line-665"></span><span class="hs-comment">-- 'hNowSupportsANSI'.</span><span>
</span><span id="line-666"></span><span class="hs-comment">--</span><span>
</span><span id="line-667"></span><span class="hs-comment">-- This function is deprecated as, from version 1.0, the package no longer</span><span>
</span><span id="line-668"></span><span class="hs-comment">-- supports legacy versions of Windows that required emulation.</span><span>
</span><span id="line-669"></span><span class="hs-comment">--</span><span>
</span><span id="line-670"></span><span class="hs-comment">-- @since 0.8.1</span><span>
</span><span id="line-671"></span><span class="hs-pragma">{-# DEPRECATED</span><span> </span><span class="hs-pragma">hSupportsANSIWithoutEmulation</span><span> </span><span class="hs-pragma">&quot;See Haddock documentation and hNowSupportsANSI.&quot;</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-672"></span><span class="annot"><a href="System.Console.ANSI.html#hSupportsANSIWithoutEmulation"><span class="hs-identifier hs-type">hSupportsANSIWithoutEmulation</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Handle</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span>
</span><span id="line-673"></span><span id="hSupportsANSIWithoutEmulation"><span class="annot"><span class="annottext">hSupportsANSIWithoutEmulation :: Handle -&gt; IO (Maybe Bool)
</span><a href="System.Console.ANSI.html#hSupportsANSIWithoutEmulation"><span class="hs-identifier hs-var hs-var">hSupportsANSIWithoutEmulation</span></a></span></span><span> </span><span id="local-6989586621679031665"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031665"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe Bool
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Maybe Bool) -&gt; IO Bool -&gt; IO (Maybe Bool)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Handle -&gt; IO Bool
</span><a href="System.Console.ANSI.html#hNowSupportsANSI"><span class="hs-identifier hs-var">hNowSupportsANSI</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031665"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-674"></span><span>
</span><span id="line-675"></span><span class="hs-comment">-- | Parses the characters emitted by 'reportCursorPosition' into the console</span><span>
</span><span id="line-676"></span><span class="hs-comment">-- input stream. Returns the cursor row and column as a tuple.</span><span>
</span><span id="line-677"></span><span class="hs-comment">--</span><span>
</span><span id="line-678"></span><span class="hs-comment">-- For example, if the characters emitted by 'reportCursorPosition' are in</span><span>
</span><span id="line-679"></span><span class="hs-comment">-- 'String' @input@ then the parser could be applied like this:</span><span>
</span><span id="line-680"></span><span class="hs-comment">--</span><span>
</span><span id="line-681"></span><span class="hs-comment">-- &gt; let result = readP_to_S cursorPosition input</span><span>
</span><span id="line-682"></span><span class="hs-comment">-- &gt; case result of</span><span>
</span><span id="line-683"></span><span class="hs-comment">-- &gt;     [] -&gt; putStrLn $ &quot;Error: could not parse &quot; ++ show input</span><span>
</span><span id="line-684"></span><span class="hs-comment">-- &gt;     [((row, column), _)] -&gt; putStrLn $ &quot;The cursor was at row &quot; ++ show row</span><span>
</span><span id="line-685"></span><span class="hs-comment">-- &gt;         ++ &quot; and column&quot; ++ show column ++ &quot;.&quot;</span><span>
</span><span id="line-686"></span><span class="hs-comment">-- &gt;     (_:_) -&gt; putStrLn $ &quot;Error: parse not unique&quot;</span><span>
</span><span id="line-687"></span><span class="hs-comment">--</span><span>
</span><span id="line-688"></span><span class="hs-comment">-- @since 0.7.1</span><span>
</span><span id="line-689"></span><span class="annot"><a href="System.Console.ANSI.html#cursorPosition"><span class="hs-identifier hs-type">cursorPosition</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ReadP</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-690"></span><span id="cursorPosition"><span class="annot"><span class="annottext">cursorPosition :: ReadP (Int, Int)
</span><a href="System.Console.ANSI.html#cursorPosition"><span class="hs-identifier hs-var hs-var">cursorPosition</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-691"></span><span>  </span><span class="annot"><span class="annottext">ReadP Char -&gt; ReadP ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(ReadP Char -&gt; ReadP ()) -&gt; ReadP Char -&gt; ReadP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; ReadP Char
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'\ESC'</span></span><span>
</span><span id="line-692"></span><span>  </span><span class="annot"><span class="annottext">ReadP Char -&gt; ReadP ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(ReadP Char -&gt; ReadP ()) -&gt; ReadP Char -&gt; ReadP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; ReadP Char
</span><span class="hs-identifier hs-var">char</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'['</span></span><span>
</span><span id="line-693"></span><span>  </span><span id="local-6989586621679031667"><span class="annot"><a href="#local-6989586621679031667"><span class="hs-identifier hs-var">row</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadP String
</span><a href="#local-6989586621679031668"><span class="hs-identifier hs-var">decimal</span></a></span><span> </span><span class="hs-comment">-- A non-negative whole decimal number</span><span>
</span><span id="line-694"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">void</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">char</span></span><span> </span><span class="annot"><span class="hs-char">';'</span></span><span>
</span><span id="line-695"></span><span>  </span><span id="local-6989586621679031669"><span class="annot"><a href="#local-6989586621679031669"><span class="hs-identifier hs-var">col</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621679031668"><span class="hs-identifier hs-type">decimal</span></a></span><span> </span><span class="hs-comment">-- A non-negative whole decimal number</span><span>
</span><span id="line-696"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">void</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">char</span></span><span> </span><span class="annot"><span class="hs-char">'R'</span></span><span>
</span><span id="line-697"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">read</span></span><span> </span><span class="annot"><a href="#local-6989586621679031667"><span class="hs-identifier hs-type">row</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">read</span></span><span> </span><span class="annot"><a href="#local-6989586621679031669"><span class="hs-identifier hs-type">col</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-698"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-699"></span><span>  </span><span id="local-6989586621679031671"><span class="annot"><span class="annottext">digit :: ReadP Char
</span><a href="#local-6989586621679031671"><span class="hs-identifier hs-var hs-var">digit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; ReadP Char
</span><span class="hs-identifier hs-var">satisfy</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isDigit</span></span><span>
</span><span id="line-700"></span><span>  </span><span id="local-6989586621679031668"><span class="annot"><span class="annottext">decimal :: ReadP String
</span><a href="#local-6989586621679031668"><span class="hs-identifier hs-var hs-var">decimal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReadP Char -&gt; ReadP String
forall a. ReadP a -&gt; ReadP [a]
</span><span class="hs-identifier hs-var">many1</span></span><span> </span><span class="annot"><span class="annottext">ReadP Char
</span><a href="#local-6989586621679031671"><span class="hs-identifier hs-var">digit</span></a></span><span>
</span><span id="line-701"></span><span>
</span><span id="line-702"></span><span class="hs-comment">-- | Attempts to get the reported cursor position data from the console input</span><span>
</span><span id="line-703"></span><span class="hs-comment">-- stream. The function is intended to be called immediately after</span><span>
</span><span id="line-704"></span><span class="hs-comment">-- 'reportCursorPosition' (or related functions) have caused characters to be</span><span>
</span><span id="line-705"></span><span class="hs-comment">-- emitted into the stream.</span><span>
</span><span id="line-706"></span><span class="hs-comment">--</span><span>
</span><span id="line-707"></span><span class="hs-comment">-- For example, on a Unix-like operating system:</span><span>
</span><span id="line-708"></span><span class="hs-comment">--</span><span>
</span><span id="line-709"></span><span class="hs-comment">-- &gt; -- set no buffering (if 'no buffering' is not already set, the contents of</span><span>
</span><span id="line-710"></span><span class="hs-comment">-- &gt; -- the buffer will be discarded, so this needs to be done before the cursor</span><span>
</span><span id="line-711"></span><span class="hs-comment">-- &gt; -- positon is emitted)</span><span>
</span><span id="line-712"></span><span class="hs-comment">-- &gt; hSetBuffering stdin NoBuffering</span><span>
</span><span id="line-713"></span><span class="hs-comment">-- &gt; -- ensure that echoing is off</span><span>
</span><span id="line-714"></span><span class="hs-comment">-- &gt; input &lt;- bracket (hGetEcho stdin) (hSetEcho stdin) $ \_ -&gt; do</span><span>
</span><span id="line-715"></span><span class="hs-comment">-- &gt;   hSetEcho stdin False</span><span>
</span><span id="line-716"></span><span class="hs-comment">-- &gt;   reportCursorPosition</span><span>
</span><span id="line-717"></span><span class="hs-comment">-- &gt;   hFlush stdout -- ensure the report cursor position code is sent to the</span><span>
</span><span id="line-718"></span><span class="hs-comment">-- &gt;                 -- operating system</span><span>
</span><span id="line-719"></span><span class="hs-comment">-- &gt;   getReportedCursorPosition</span><span>
</span><span id="line-720"></span><span class="hs-comment">--</span><span>
</span><span id="line-721"></span><span class="hs-comment">-- On Windows operating systems, the function is not supported on consoles, such</span><span>
</span><span id="line-722"></span><span class="hs-comment">-- as mintty, that are not based on the Windows' Console API. (Command Prompt</span><span>
</span><span id="line-723"></span><span class="hs-comment">-- and PowerShell are based on the Console API.)</span><span>
</span><span id="line-724"></span><span class="hs-comment">--</span><span>
</span><span id="line-725"></span><span class="hs-comment">-- @since 0.7.1</span><span>
</span><span id="line-726"></span><span class="annot"><a href="System.Console.ANSI.html#getReportedCursorPosition"><span class="hs-identifier hs-type">getReportedCursorPosition</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-727"></span><span id="getReportedCursorPosition"><span class="annot"><span class="annottext">getReportedCursorPosition :: IO String
</span><a href="System.Console.ANSI.html#getReportedCursorPosition"><span class="hs-identifier hs-var hs-var">getReportedCursorPosition</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO String
</span><a href="System.Console.ANSI.Internal.html#getReportedCursorPosition"><span class="hs-identifier hs-var">Internal.getReportedCursorPosition</span></a></span><span>
</span><span id="line-728"></span><span>
</span><span id="line-729"></span><span class="hs-comment">-- | Attempts to get the reported cursor position, combining the functions</span><span>
</span><span id="line-730"></span><span class="hs-comment">-- 'reportCursorPosition', 'getReportedCursorPosition' and 'cursorPosition'. Any</span><span>
</span><span id="line-731"></span><span class="hs-comment">-- position @(row, column)@ is translated to be 0-based (that is, the top-left</span><span>
</span><span id="line-732"></span><span class="hs-comment">-- corner is at @(0, 0)@), consistent with `setCursorColumn` and</span><span>
</span><span id="line-733"></span><span class="hs-comment">-- `setCursorPosition`. (Note that the information emitted into the console</span><span>
</span><span id="line-734"></span><span class="hs-comment">-- input stream by 'reportCursorPosition' is 1-based.) Returns 'Nothing' if any</span><span>
</span><span id="line-735"></span><span class="hs-comment">-- data emitted by 'reportCursorPosition', obtained by</span><span>
</span><span id="line-736"></span><span class="hs-comment">-- 'getReportedCursorPosition', cannot be parsed by 'cursorPosition'. Uses</span><span>
</span><span id="line-737"></span><span class="hs-comment">-- 'stdout'. If 'stdout' will be redirected, see 'hGetCursorPosition' for a more</span><span>
</span><span id="line-738"></span><span class="hs-comment">-- general function.</span><span>
</span><span id="line-739"></span><span class="hs-comment">--</span><span>
</span><span id="line-740"></span><span class="hs-comment">-- On Windows operating systems, the function is not supported on consoles, such</span><span>
</span><span id="line-741"></span><span class="hs-comment">-- as mintty, that are not based on the Windows' Console API. (Command Prompt</span><span>
</span><span id="line-742"></span><span class="hs-comment">-- and PowerShell are based on the Console API.)</span><span>
</span><span id="line-743"></span><span class="hs-comment">--</span><span>
</span><span id="line-744"></span><span class="hs-comment">-- @since 0.10.3</span><span>
</span><span id="line-745"></span><span class="annot"><a href="System.Console.ANSI.html#getCursorPosition"><span class="hs-identifier hs-type">getCursorPosition</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-746"></span><span id="getCursorPosition"><span class="annot"><span class="annottext">getCursorPosition :: IO (Maybe (Int, Int))
</span><a href="System.Console.ANSI.html#getCursorPosition"><span class="hs-identifier hs-var hs-var">getCursorPosition</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; IO (Maybe (Int, Int))
</span><a href="System.Console.ANSI.html#hGetCursorPosition"><span class="hs-identifier hs-var">hGetCursorPosition</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stdout</span></span><span>
</span><span id="line-747"></span><span>
</span><span id="line-748"></span><span class="hs-comment">-- | Attempts to get the reported cursor position, combining the functions</span><span>
</span><span id="line-749"></span><span class="hs-comment">-- 'hReportCursorPosition' (with the specified handle),</span><span>
</span><span id="line-750"></span><span class="hs-comment">-- 'getReportedCursorPosition' and 'cursorPosition'. Any position</span><span>
</span><span id="line-751"></span><span class="hs-comment">-- @(row, column)@ is translated to be 0-based (that is, the top-left corner is</span><span>
</span><span id="line-752"></span><span class="hs-comment">-- at @(0, 0)@), consistent with 'hSetCursorColumn' and 'hSetCursorPosition'.</span><span>
</span><span id="line-753"></span><span class="hs-comment">-- (Note that the information emitted into the console input stream by</span><span>
</span><span id="line-754"></span><span class="hs-comment">-- 'hReportCursorPosition' is 1-based.) Returns 'Nothing' if any data emitted by</span><span>
</span><span id="line-755"></span><span class="hs-comment">-- 'hReportCursorPosition', obtained by 'getReportedCursorPosition', cannot be</span><span>
</span><span id="line-756"></span><span class="hs-comment">-- parsed by 'cursorPosition'.</span><span>
</span><span id="line-757"></span><span class="hs-comment">--</span><span>
</span><span id="line-758"></span><span class="hs-comment">-- On Windows operating systems, the function is not supported on consoles, such</span><span>
</span><span id="line-759"></span><span class="hs-comment">-- as mintty, that are not based on the Windows' Console API. (Command Prompt</span><span>
</span><span id="line-760"></span><span class="hs-comment">-- and PowerShell are based on the Console API.)</span><span>
</span><span id="line-761"></span><span class="hs-comment">--</span><span>
</span><span id="line-762"></span><span class="hs-comment">-- @since 0.10.1</span><span>
</span><span id="line-763"></span><span class="annot"><a href="System.Console.ANSI.html#hGetCursorPosition"><span class="hs-identifier hs-type">hGetCursorPosition</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Handle</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-764"></span><span id="hGetCursorPosition"><span class="annot"><span class="annottext">hGetCursorPosition :: Handle -&gt; IO (Maybe (Int, Int))
</span><a href="System.Console.ANSI.html#hGetCursorPosition"><span class="hs-identifier hs-var hs-var">hGetCursorPosition</span></a></span></span><span> </span><span id="local-6989586621679031673"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031673"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((Int, Int) -&gt; (Int, Int)) -&gt; Maybe (Int, Int) -&gt; Maybe (Int, Int)
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; (Int, Int)
forall {a} {b}. (Num a, Num b) =&gt; (a, b) -&gt; (a, b)
</span><a href="#local-6989586621679031674"><span class="hs-identifier hs-var">to0base</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe (Int, Int) -&gt; Maybe (Int, Int))
-&gt; IO (Maybe (Int, Int)) -&gt; IO (Maybe (Int, Int))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">IO (Maybe (Int, Int))
</span><a href="#local-6989586621679031675"><span class="hs-identifier hs-var">getCursorPosition'</span></a></span><span>
</span><span id="line-765"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-766"></span><span>  </span><span id="local-6989586621679031674"><span class="annot"><span class="annottext">to0base :: (a, b) -&gt; (a, b)
</span><a href="#local-6989586621679031674"><span class="hs-identifier hs-var hs-var">to0base</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679031682"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679031682"><span class="hs-identifier hs-var">row</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679031683"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679031683"><span class="hs-identifier hs-var">col</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679031682"><span class="hs-identifier hs-var">row</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679031683"><span class="hs-identifier hs-var">col</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; b -&gt; b
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-767"></span><span>  </span><span id="local-6989586621679031675"><span class="annot"><span class="annottext">getCursorPosition' :: IO (Maybe (Int, Int))
</span><a href="#local-6989586621679031675"><span class="hs-identifier hs-var hs-var">getCursorPosition'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-768"></span><span>    </span><span id="local-6989586621679031693"><span class="annot"><a href="#local-6989586621679031693"><span class="hs-identifier hs-var">input</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO BufferMode
-&gt; (BufferMode -&gt; IO ()) -&gt; (BufferMode -&gt; IO String) -&gt; IO String
forall a b c. IO a -&gt; (a -&gt; IO b) -&gt; (a -&gt; IO c) -&gt; IO c
</span><span class="hs-identifier hs-var">bracket</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Handle -&gt; IO BufferMode
</span><span class="hs-identifier hs-var">hGetBuffering</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stdin</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Handle -&gt; BufferMode -&gt; IO ()
</span><span class="hs-identifier hs-var">hSetBuffering</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stdin</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((BufferMode -&gt; IO String) -&gt; IO String)
-&gt; (BufferMode -&gt; IO String) -&gt; IO String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">BufferMode
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-769"></span><span>      </span><span class="hs-comment">-- set no buffering (if 'no buffering' is not already set, the contents of</span><span>
</span><span id="line-770"></span><span>      </span><span class="hs-comment">-- the buffer will be discarded, so this needs to be done before the</span><span>
</span><span id="line-771"></span><span>      </span><span class="hs-comment">-- cursor positon is emitted)</span><span>
</span><span id="line-772"></span><span>      </span><span class="annot"><span class="annottext">Handle -&gt; BufferMode -&gt; IO ()
</span><span class="hs-identifier hs-var">hSetBuffering</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stdin</span></span><span> </span><span class="annot"><span class="annottext">BufferMode
</span><span class="hs-identifier hs-var">NoBuffering</span></span><span>
</span><span id="line-773"></span><span>      </span><span class="hs-comment">-- ensure that echoing is off</span><span>
</span><span id="line-774"></span><span>      </span><span class="annot"><span class="annottext">IO Bool -&gt; (Bool -&gt; IO ()) -&gt; (Bool -&gt; IO String) -&gt; IO String
forall a b c. IO a -&gt; (a -&gt; IO b) -&gt; (a -&gt; IO c) -&gt; IO c
</span><span class="hs-identifier hs-var">bracket</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Handle -&gt; IO Bool
</span><span class="hs-identifier hs-var">hGetEcho</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stdin</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Handle -&gt; Bool -&gt; IO ()
</span><span class="hs-identifier hs-var">hSetEcho</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stdin</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Bool -&gt; IO String) -&gt; IO String)
-&gt; (Bool -&gt; IO String) -&gt; IO String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-775"></span><span>        </span><span class="annot"><span class="annottext">Handle -&gt; Bool -&gt; IO ()
</span><span class="hs-identifier hs-var">hSetEcho</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stdin</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-776"></span><span>        </span><span class="annot"><span class="annottext">IO ()
</span><a href="#local-6989586621679031695"><span class="hs-identifier hs-var">clearStdin</span></a></span><span>
</span><span id="line-777"></span><span>        </span><span class="annot"><span class="annottext">Handle -&gt; IO ()
</span><a href="System.Console.ANSI.html#hReportCursorPosition"><span class="hs-identifier hs-var">hReportCursorPosition</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031673"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-778"></span><span>        </span><span class="annot"><span class="annottext">Handle -&gt; IO ()
</span><span class="hs-identifier hs-var">hFlush</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031673"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-comment">-- ensure the report cursor position code is sent to the</span><span>
</span><span id="line-779"></span><span>                 </span><span class="hs-comment">-- operating system</span><span>
</span><span id="line-780"></span><span>        </span><span class="annot"><span class="annottext">IO String
</span><a href="System.Console.ANSI.html#getReportedCursorPosition"><span class="hs-identifier hs-var">getReportedCursorPosition</span></a></span><span>
</span><span id="line-781"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="hs-identifier hs-type">readP_to_S</span></span><span> </span><span class="annot"><a href="System.Console.ANSI.html#cursorPosition"><span class="hs-identifier hs-type">cursorPosition</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679031693"><span class="hs-identifier hs-type">input</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-782"></span><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Int, Int) -&gt; IO (Maybe (Int, Int))
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Int, Int)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-783"></span><span>      </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679031696"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679031696"><span class="hs-identifier hs-var">row</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679031697"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679031697"><span class="hs-identifier hs-var">col</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Int, Int) -&gt; IO (Maybe (Int, Int))
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (Int, Int) -&gt; IO (Maybe (Int, Int)))
-&gt; Maybe (Int, Int) -&gt; IO (Maybe (Int, Int))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; Maybe (Int, Int)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679031696"><span class="hs-identifier hs-var">row</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679031697"><span class="hs-identifier hs-var">col</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-784"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Int, Int), String)
</span><span class="hs-identifier">_</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[((Int, Int), String)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Int, Int) -&gt; IO (Maybe (Int, Int))
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe (Int, Int)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-785"></span><span>  </span><span id="local-6989586621679031695"><span class="annot"><span class="annottext">clearStdin :: IO ()
</span><a href="#local-6989586621679031695"><span class="hs-identifier hs-var hs-var">clearStdin</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-786"></span><span>    </span><span id="local-6989586621679031701"><span class="annot"><a href="#local-6989586621679031701"><span class="hs-identifier hs-var">isReady</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; IO Bool
</span><span class="hs-identifier hs-var">hReady</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stdin</span></span><span>
</span><span id="line-787"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">when</span></span><span> </span><span class="annot"><a href="#local-6989586621679031701"><span class="hs-identifier hs-type">isReady</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-788"></span><span>      </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span class="annot"><span class="hs-identifier hs-type">getChar</span></span><span>
</span><span id="line-789"></span><span>      </span><span class="annot"><a href="#local-6989586621679031695"><span class="hs-identifier hs-type">clearStdin</span></a></span><span>
</span><span id="line-790"></span><span>
</span><span id="line-791"></span><span class="hs-comment">-- | Looking for a way to get layer colors? See 'getLayerColor'.</span><span>
</span><span id="line-792"></span><span class="hs-comment">--</span><span>
</span><span id="line-793"></span><span class="hs-comment">-- Emit the layerColor into the console input stream, immediately after</span><span>
</span><span id="line-794"></span><span class="hs-comment">-- being recognised on the output stream, as:</span><span>
</span><span id="line-795"></span><span class="hs-comment">-- @ESC ] \&lt;Ps&gt; ; rgb: \&lt;red&gt; ; \&lt;green&gt; ; \&lt;blue&gt; \&lt;ST&gt;@</span><span>
</span><span id="line-796"></span><span class="hs-comment">-- where @\&lt;Ps&gt;@ is @10@ for 'Foreground' and @11@ for 'Background'; @\&lt;red&gt;@,</span><span>
</span><span id="line-797"></span><span class="hs-comment">-- @\&lt;green&gt;@ and @\&lt;blue&gt;@ are the color channel values in hexadecimal (4, 8,</span><span>
</span><span id="line-798"></span><span class="hs-comment">-- 12 and 16 bit values are possible, although 16 bit values are most common);</span><span>
</span><span id="line-799"></span><span class="hs-comment">-- and @\&lt;ST&gt;@ is the STRING TERMINATOR (ST). ST depends on the terminal</span><span>
</span><span id="line-800"></span><span class="hs-comment">-- software and may be the @BEL@ character or @ESC \\@ characters.</span><span>
</span><span id="line-801"></span><span class="hs-comment">--</span><span>
</span><span id="line-802"></span><span class="hs-comment">-- This function may be of limited, or no, use on Windows operating systems</span><span>
</span><span id="line-803"></span><span class="hs-comment">-- because (1) the function is not supported on native terminals and is</span><span>
</span><span id="line-804"></span><span class="hs-comment">-- emulated, but the emulation does not work on Windows Terminal and (2) of</span><span>
</span><span id="line-805"></span><span class="hs-comment">-- difficulties in obtaining the data emitted into the console input stream.</span><span>
</span><span id="line-806"></span><span class="hs-comment">--</span><span>
</span><span id="line-807"></span><span class="hs-comment">-- Underlining is not supported.</span><span>
</span><span id="line-808"></span><span class="hs-comment">--</span><span>
</span><span id="line-809"></span><span class="hs-comment">-- @since 0.11.4</span><span>
</span><span id="line-810"></span><span class="annot"><a href="System.Console.ANSI.html#reportLayerColor"><span class="hs-identifier hs-type">reportLayerColor</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ConsoleLayer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-811"></span><span id="reportLayerColor"><span class="annot"><span class="annottext">reportLayerColor :: ConsoleLayer -&gt; IO ()
</span><a href="System.Console.ANSI.html#reportLayerColor"><span class="hs-identifier hs-var hs-var">reportLayerColor</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; ConsoleLayer -&gt; IO ()
</span><a href="System.Console.ANSI.html#hReportLayerColor"><span class="hs-identifier hs-var">hReportLayerColor</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stdout</span></span><span>
</span><span id="line-812"></span><span>
</span><span id="line-813"></span><span class="hs-comment">-- @since 0.11.4</span><span>
</span><span id="line-814"></span><span class="annot"><a href="System.Console.ANSI.html#hReportLayerColor"><span class="hs-identifier hs-type">hReportLayerColor</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Handle</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ConsoleLayer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-815"></span><span id="hReportLayerColor"><span class="annot"><span class="annottext">hReportLayerColor :: Handle -&gt; ConsoleLayer -&gt; IO ()
</span><a href="System.Console.ANSI.html#hReportLayerColor"><span class="hs-identifier hs-var hs-var">hReportLayerColor</span></a></span></span><span> </span><span id="local-6989586621679031705"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031705"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679031706"><span class="annot"><span class="annottext">ConsoleLayer
</span><a href="#local-6989586621679031706"><span class="hs-identifier hs-var">layer</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; String -&gt; IO ()
</span><span class="hs-identifier hs-var">hPutStr</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031705"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ConsoleLayer -&gt; String
</span><span class="hs-identifier hs-var">reportLayerColorCode</span></span><span> </span><span class="annot"><span class="annottext">ConsoleLayer
</span><a href="#local-6989586621679031706"><span class="hs-identifier hs-var">layer</span></a></span><span>
</span><span id="line-816"></span><span>
</span><span id="line-817"></span><span class="hs-comment">-- | Attempts to get the reported layer color data from the console input</span><span>
</span><span id="line-818"></span><span class="hs-comment">-- stream. The function is intended to be called immediately after</span><span>
</span><span id="line-819"></span><span class="hs-comment">-- 'reportLayerColor' (or related functions) have caused characters to be</span><span>
</span><span id="line-820"></span><span class="hs-comment">-- emitted into the stream.</span><span>
</span><span id="line-821"></span><span class="hs-comment">--</span><span>
</span><span id="line-822"></span><span class="hs-comment">-- For example, on a Unix-like operating system:</span><span>
</span><span id="line-823"></span><span class="hs-comment">--</span><span>
</span><span id="line-824"></span><span class="hs-comment">-- &gt; -- set no buffering (if 'no buffering' is not already set, the contents of</span><span>
</span><span id="line-825"></span><span class="hs-comment">-- &gt; -- the buffer will be discarded, so this needs to be done before the cursor</span><span>
</span><span id="line-826"></span><span class="hs-comment">-- &gt; -- positon is emitted)</span><span>
</span><span id="line-827"></span><span class="hs-comment">-- &gt; hSetBuffering stdin NoBuffering</span><span>
</span><span id="line-828"></span><span class="hs-comment">-- &gt; -- ensure that echoing is off</span><span>
</span><span id="line-829"></span><span class="hs-comment">-- &gt; input &lt;- bracket (hGetEcho stdin) (hSetEcho stdin) $ \_ -&gt; do</span><span>
</span><span id="line-830"></span><span class="hs-comment">-- &gt;   hSetEcho stdin False</span><span>
</span><span id="line-831"></span><span class="hs-comment">-- &gt;   reportLayerColor Foreground</span><span>
</span><span id="line-832"></span><span class="hs-comment">-- &gt;   hFlush stdout -- ensure the report cursor position code is sent to the</span><span>
</span><span id="line-833"></span><span class="hs-comment">-- &gt;                 -- operating system</span><span>
</span><span id="line-834"></span><span class="hs-comment">-- &gt;   getReportedLayerColor Foreground</span><span>
</span><span id="line-835"></span><span class="hs-comment">--</span><span>
</span><span id="line-836"></span><span class="hs-comment">-- On Windows operating systems, the function is not supported on consoles, such</span><span>
</span><span id="line-837"></span><span class="hs-comment">-- as mintty, that are not based on the Windows' Console API. (Command Prompt</span><span>
</span><span id="line-838"></span><span class="hs-comment">-- and PowerShell are based on the Console API.)</span><span>
</span><span id="line-839"></span><span class="hs-comment">--</span><span>
</span><span id="line-840"></span><span class="hs-comment">-- Underlining is not supported.</span><span>
</span><span id="line-841"></span><span class="hs-comment">--</span><span>
</span><span id="line-842"></span><span class="hs-comment">-- @since 0.11.4</span><span>
</span><span id="line-843"></span><span class="annot"><a href="System.Console.ANSI.html#getReportedLayerColor"><span class="hs-identifier hs-type">getReportedLayerColor</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ConsoleLayer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-844"></span><span id="getReportedLayerColor"><span class="annot"><span class="annottext">getReportedLayerColor :: ConsoleLayer -&gt; IO String
</span><a href="System.Console.ANSI.html#getReportedLayerColor"><span class="hs-identifier hs-var hs-var">getReportedLayerColor</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConsoleLayer -&gt; IO String
</span><a href="System.Console.ANSI.Internal.html#getReportedLayerColor"><span class="hs-identifier hs-var">Internal.getReportedLayerColor</span></a></span><span>
</span><span id="line-845"></span><span>
</span><span id="line-846"></span><span class="hs-comment">-- | Attempts to get the reported layer color, combining the functions</span><span>
</span><span id="line-847"></span><span class="hs-comment">-- 'reportLayerColor', 'getReportedLayerColor' and 'layerColor'. Any RGB color</span><span>
</span><span id="line-848"></span><span class="hs-comment">-- is scaled to be 16 bits per channel, the most common format reported by</span><span>
</span><span id="line-849"></span><span class="hs-comment">-- terminal software. Returns 'Nothing' if any data emitted by</span><span>
</span><span id="line-850"></span><span class="hs-comment">-- 'reportLayerColor', obtained by 'getReportedLayerColor', cannot be parsed by</span><span>
</span><span id="line-851"></span><span class="hs-comment">-- 'layerColor'. Uses 'stdout'. If 'stdout' will be redirected, see</span><span>
</span><span id="line-852"></span><span class="hs-comment">-- 'hGetLayerColor' for a more general function.</span><span>
</span><span id="line-853"></span><span class="hs-comment">--</span><span>
</span><span id="line-854"></span><span class="hs-comment">-- On Windows operating systems, the function is not supported on consoles, such</span><span>
</span><span id="line-855"></span><span class="hs-comment">-- as mintty, that are not based on the Windows' Console API. (Command Prompt</span><span>
</span><span id="line-856"></span><span class="hs-comment">-- and PowerShell are based on the Console API.) This function also relies on</span><span>
</span><span id="line-857"></span><span class="hs-comment">-- emulation that does not work on Windows Terminal.</span><span>
</span><span id="line-858"></span><span class="hs-comment">--</span><span>
</span><span id="line-859"></span><span class="hs-comment">-- Underlining is not supported.</span><span>
</span><span id="line-860"></span><span class="hs-comment">--</span><span>
</span><span id="line-861"></span><span class="hs-comment">-- @since 0.11.4</span><span>
</span><span id="line-862"></span><span class="annot"><a href="System.Console.ANSI.html#getLayerColor"><span class="hs-identifier hs-type">getLayerColor</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ConsoleLayer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RGB</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word16</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-863"></span><span id="getLayerColor"><span class="annot"><span class="annottext">getLayerColor :: ConsoleLayer -&gt; IO (Maybe (RGB Word16))
</span><a href="System.Console.ANSI.html#getLayerColor"><span class="hs-identifier hs-var hs-var">getLayerColor</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; ConsoleLayer -&gt; IO (Maybe (RGB Word16))
</span><a href="System.Console.ANSI.html#hGetLayerColor"><span class="hs-identifier hs-var">hGetLayerColor</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stdout</span></span><span>
</span><span id="line-864"></span><span>
</span><span id="line-865"></span><span class="hs-comment">-- | Attempts to get the reported layer color, combining the functions</span><span>
</span><span id="line-866"></span><span class="hs-comment">-- 'hReportLayerColor', 'getReportedLayerColor' and 'layerColor'. Any RGB color</span><span>
</span><span id="line-867"></span><span class="hs-comment">-- is scaled to be 16 bits per channel, the most common format reported by</span><span>
</span><span id="line-868"></span><span class="hs-comment">-- terminal software. Returns 'Nothing' if any data emitted by</span><span>
</span><span id="line-869"></span><span class="hs-comment">-- 'hReportLayerColor', obtained by 'getReportedLayerColor', cannot be parsed by</span><span>
</span><span id="line-870"></span><span class="hs-comment">-- 'layerColor'.</span><span>
</span><span id="line-871"></span><span class="hs-comment">--</span><span>
</span><span id="line-872"></span><span class="hs-comment">-- On Windows operating systems, the function is not supported on consoles, such</span><span>
</span><span id="line-873"></span><span class="hs-comment">-- as mintty, that are not based on the Windows' Console API. (Command Prompt</span><span>
</span><span id="line-874"></span><span class="hs-comment">-- and PowerShell are based on the Console API.) This function also relies on</span><span>
</span><span id="line-875"></span><span class="hs-comment">-- emulation that does not work on Windows Terminal.</span><span>
</span><span id="line-876"></span><span class="hs-comment">--</span><span>
</span><span id="line-877"></span><span class="hs-comment">-- Underlining is not supported.</span><span>
</span><span id="line-878"></span><span class="hs-comment">--</span><span>
</span><span id="line-879"></span><span class="hs-comment">-- @since 0.11.4</span><span>
</span><span id="line-880"></span><span class="annot"><a href="System.Console.ANSI.html#hGetLayerColor"><span class="hs-identifier hs-type">hGetLayerColor</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Handle</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ConsoleLayer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RGB</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word16</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-881"></span><span id="hGetLayerColor"><span class="annot"><span class="annottext">hGetLayerColor :: Handle -&gt; ConsoleLayer -&gt; IO (Maybe (RGB Word16))
</span><a href="System.Console.ANSI.html#hGetLayerColor"><span class="hs-identifier hs-var hs-var">hGetLayerColor</span></a></span></span><span> </span><span id="local-6989586621679031708"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031708"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679031709"><span class="annot"><span class="annottext">ConsoleLayer
</span><a href="#local-6989586621679031709"><span class="hs-identifier hs-var">layer</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-882"></span><span>  </span><span id="local-6989586621679031710"><span class="annot"><a href="#local-6989586621679031710"><span class="hs-identifier hs-var">input</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO BufferMode
-&gt; (BufferMode -&gt; IO ()) -&gt; (BufferMode -&gt; IO String) -&gt; IO String
forall a b c. IO a -&gt; (a -&gt; IO b) -&gt; (a -&gt; IO c) -&gt; IO c
</span><span class="hs-identifier hs-var">bracket</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Handle -&gt; IO BufferMode
</span><span class="hs-identifier hs-var">hGetBuffering</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stdin</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Handle -&gt; BufferMode -&gt; IO ()
</span><span class="hs-identifier hs-var">hSetBuffering</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stdin</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((BufferMode -&gt; IO String) -&gt; IO String)
-&gt; (BufferMode -&gt; IO String) -&gt; IO String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">BufferMode
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-883"></span><span>    </span><span class="hs-comment">-- set no buffering (if 'no buffering' is not already set, the contents of</span><span>
</span><span id="line-884"></span><span>    </span><span class="hs-comment">-- the buffer will be discarded, so this needs to be done before the</span><span>
</span><span id="line-885"></span><span>    </span><span class="hs-comment">-- cursor positon is emitted)</span><span>
</span><span id="line-886"></span><span>    </span><span class="annot"><span class="annottext">Handle -&gt; BufferMode -&gt; IO ()
</span><span class="hs-identifier hs-var">hSetBuffering</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stdin</span></span><span> </span><span class="annot"><span class="annottext">BufferMode
</span><span class="hs-identifier hs-var">NoBuffering</span></span><span>
</span><span id="line-887"></span><span>    </span><span class="hs-comment">-- ensure that echoing is off</span><span>
</span><span id="line-888"></span><span>    </span><span class="annot"><span class="annottext">IO Bool -&gt; (Bool -&gt; IO ()) -&gt; (Bool -&gt; IO String) -&gt; IO String
forall a b c. IO a -&gt; (a -&gt; IO b) -&gt; (a -&gt; IO c) -&gt; IO c
</span><span class="hs-identifier hs-var">bracket</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Handle -&gt; IO Bool
</span><span class="hs-identifier hs-var">hGetEcho</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stdin</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Handle -&gt; Bool -&gt; IO ()
</span><span class="hs-identifier hs-var">hSetEcho</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stdin</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((Bool -&gt; IO String) -&gt; IO String)
-&gt; (Bool -&gt; IO String) -&gt; IO String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-889"></span><span>      </span><span class="annot"><span class="annottext">Handle -&gt; Bool -&gt; IO ()
</span><span class="hs-identifier hs-var">hSetEcho</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stdin</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-890"></span><span>      </span><span class="annot"><span class="annottext">IO ()
</span><a href="#local-6989586621679031711"><span class="hs-identifier hs-var">clearStdin</span></a></span><span>
</span><span id="line-891"></span><span>      </span><span class="annot"><span class="annottext">Handle -&gt; ConsoleLayer -&gt; IO ()
</span><a href="System.Console.ANSI.html#hReportLayerColor"><span class="hs-identifier hs-var">hReportLayerColor</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031708"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">ConsoleLayer
</span><a href="#local-6989586621679031709"><span class="hs-identifier hs-var">layer</span></a></span><span>
</span><span id="line-892"></span><span>      </span><span class="annot"><span class="annottext">Handle -&gt; IO ()
</span><span class="hs-identifier hs-var">hFlush</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031708"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-comment">-- ensure the report cursor position code is sent to the</span><span>
</span><span id="line-893"></span><span>               </span><span class="hs-comment">-- operating system</span><span>
</span><span id="line-894"></span><span>      </span><span class="annot"><span class="annottext">ConsoleLayer -&gt; IO String
</span><a href="System.Console.ANSI.html#getReportedLayerColor"><span class="hs-identifier hs-var">getReportedLayerColor</span></a></span><span> </span><span class="annot"><span class="annottext">ConsoleLayer
</span><a href="#local-6989586621679031709"><span class="hs-identifier hs-var">layer</span></a></span><span>
</span><span id="line-895"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="hs-identifier hs-type">readP_to_S</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="System.Console.ANSI.html#layerColor"><span class="hs-identifier hs-type">layerColor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679031709"><span class="hs-identifier hs-type">layer</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679031710"><span class="hs-identifier hs-type">input</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-896"></span><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (RGB Word16) -&gt; IO (Maybe (RGB Word16))
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe (RGB Word16)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-897"></span><span>      </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621679031712"><span class="annot"><span class="annottext">RGB Word16
</span><a href="#local-6989586621679031712"><span class="hs-identifier hs-var">col</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (RGB Word16) -&gt; IO (Maybe (RGB Word16))
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (RGB Word16) -&gt; IO (Maybe (RGB Word16)))
-&gt; Maybe (RGB Word16) -&gt; IO (Maybe (RGB Word16))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">RGB Word16 -&gt; Maybe (RGB Word16)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">RGB Word16
</span><a href="#local-6989586621679031712"><span class="hs-identifier hs-var">col</span></a></span><span>
</span><span id="line-898"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(RGB Word16, String)
</span><span class="hs-identifier">_</span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span class="annot"><span class="annottext">[(RGB Word16, String)]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (RGB Word16) -&gt; IO (Maybe (RGB Word16))
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Maybe (RGB Word16)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-899"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-900"></span><span>  </span><span id="local-6989586621679031711"><span class="annot"><span class="annottext">clearStdin :: IO ()
</span><a href="#local-6989586621679031711"><span class="hs-identifier hs-var hs-var">clearStdin</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-901"></span><span>    </span><span id="local-6989586621679031716"><span class="annot"><a href="#local-6989586621679031716"><span class="hs-identifier hs-var">isReady</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; IO Bool
</span><span class="hs-identifier hs-var">hReady</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stdin</span></span><span>
</span><span id="line-902"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">when</span></span><span> </span><span class="annot"><a href="#local-6989586621679031716"><span class="hs-identifier hs-type">isReady</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-903"></span><span>      </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span class="annot"><span class="hs-identifier hs-type">getChar</span></span><span>
</span><span id="line-904"></span><span>      </span><span class="annot"><a href="#local-6989586621679031711"><span class="hs-identifier hs-type">clearStdin</span></a></span><span>
</span><span id="line-905"></span><span>
</span><span id="line-906"></span><span class="hs-comment">-- | Parses the characters emitted by 'reportLayerColor' into the console input</span><span>
</span><span id="line-907"></span><span class="hs-comment">-- stream.</span><span>
</span><span id="line-908"></span><span class="hs-comment">--</span><span>
</span><span id="line-909"></span><span class="hs-comment">-- For example, if the characters emitted by 'reportLayerColor' are in 'String'</span><span>
</span><span id="line-910"></span><span class="hs-comment">-- @input@ then the parser could be applied like this:</span><span>
</span><span id="line-911"></span><span class="hs-comment">--</span><span>
</span><span id="line-912"></span><span class="hs-comment">-- &gt; let result = readP_to_S (layerColor layer) input</span><span>
</span><span id="line-913"></span><span class="hs-comment">-- &gt; case result of</span><span>
</span><span id="line-914"></span><span class="hs-comment">-- &gt;     [] -&gt; putStrLn $ &quot;Error: could not parse &quot; ++ show input</span><span>
</span><span id="line-915"></span><span class="hs-comment">-- &gt;     [(col, _)] -&gt; putStrLn $ &quot;The color was &quot; ++ show col ++ &quot;.&quot;</span><span>
</span><span id="line-916"></span><span class="hs-comment">-- &gt;     (_:_) -&gt; putStrLn $ &quot;Error: parse not unique&quot;</span><span>
</span><span id="line-917"></span><span class="hs-comment">--</span><span>
</span><span id="line-918"></span><span class="hs-comment">-- Underlining is not supported.</span><span>
</span><span id="line-919"></span><span class="hs-comment">--</span><span>
</span><span id="line-920"></span><span class="hs-comment">-- @since 0.11.4</span><span>
</span><span id="line-921"></span><span class="annot"><a href="System.Console.ANSI.html#layerColor"><span class="hs-identifier hs-type">layerColor</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ConsoleLayer</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ReadP</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">RGB</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word16</span></span><span class="hs-special">)</span><span>
</span><span id="line-922"></span><span id="layerColor"><span class="annot"><span class="annottext">layerColor :: ConsoleLayer -&gt; ReadP (RGB Word16)
</span><a href="System.Console.ANSI.html#layerColor"><span class="hs-identifier hs-var hs-var">layerColor</span></a></span></span><span> </span><span id="local-6989586621679031717"><span class="annot"><span class="annottext">ConsoleLayer
</span><a href="#local-6989586621679031717"><span class="hs-identifier hs-var">layer</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-923"></span><span>  </span><span class="annot"><span class="annottext">ReadP String -&gt; ReadP ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(ReadP String -&gt; ReadP ()) -&gt; ReadP String -&gt; ReadP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ReadP String
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\ESC]&quot;</span></span><span>
</span><span id="line-924"></span><span>  </span><span class="annot"><span class="annottext">ReadP String -&gt; ReadP ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(ReadP String -&gt; ReadP ()) -&gt; ReadP String -&gt; ReadP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ReadP String
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; ReadP String) -&gt; String -&gt; ReadP String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ConsoleLayer
</span><a href="#local-6989586621679031717"><span class="hs-identifier hs-var">layer</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-925"></span><span>    </span><span class="annot"><span class="annottext">ConsoleLayer
</span><span class="hs-identifier hs-var">Foreground</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;10&quot;</span></span><span>
</span><span id="line-926"></span><span>    </span><span class="annot"><span class="annottext">ConsoleLayer
</span><span class="hs-identifier hs-var">Background</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;11&quot;</span></span><span>
</span><span id="line-927"></span><span>    </span><span class="annot"><span class="annottext">ConsoleLayer
</span><span class="hs-identifier hs-var">Underlining</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; String
forall a. String -&gt; [a]
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;reportLayerColor does not support underlining&quot;</span></span><span>
</span><span id="line-928"></span><span>  </span><span class="annot"><span class="annottext">ReadP String -&gt; ReadP ()
forall (f :: * -&gt; *) a. Functor f =&gt; f a -&gt; f ()
</span><span class="hs-identifier hs-var">void</span></span><span> </span><span class="annot"><span class="annottext">(ReadP String -&gt; ReadP ()) -&gt; ReadP String -&gt; ReadP ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ReadP String
</span><span class="hs-identifier hs-var">string</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;;rgb:&quot;</span></span><span>
</span><span id="line-929"></span><span>  </span><span id="local-6989586621679031719"><span class="annot"><a href="#local-6989586621679031719"><span class="hs-identifier hs-var">redHex</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReadP String
</span><a href="#local-6989586621679031720"><span class="hs-identifier hs-var">hexadecimal</span></a></span><span> </span><span class="hs-comment">-- A non-negative whole hexadecimal number</span><span>
</span><span id="line-930"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">void</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">char</span></span><span> </span><span class="annot"><span class="hs-char">'/'</span></span><span>
</span><span id="line-931"></span><span>  </span><span id="local-6989586621679031721"><span class="annot"><a href="#local-6989586621679031721"><span class="hs-identifier hs-var">greenHex</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621679031720"><span class="hs-identifier hs-type">hexadecimal</span></a></span><span> </span><span class="hs-comment">-- A non-negative whole hexadecimal number</span><span>
</span><span id="line-932"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">void</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">char</span></span><span> </span><span class="annot"><span class="hs-char">'/'</span></span><span>
</span><span id="line-933"></span><span>  </span><span id="local-6989586621679031722"><span class="annot"><a href="#local-6989586621679031722"><span class="hs-identifier hs-var">blueHex</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621679031720"><span class="hs-identifier hs-type">hexadecimal</span></a></span><span> </span><span class="hs-comment">-- A non-negative whole hexadecimal number</span><span>
</span><span id="line-934"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">void</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">string</span></span><span> </span><span class="annot"><span class="hs-string">&quot;\BEL&quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;++</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">string</span></span><span> </span><span class="annot"><span class="hs-string">&quot;\ESC\\&quot;</span></span><span>
</span><span id="line-935"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679031725"><span class="annot"><a href="#local-6989586621679031725"><span class="hs-identifier hs-var hs-var">lenRed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679031719"><span class="hs-identifier hs-var">redHex</span></a></span><span>
</span><span id="line-936"></span><span>      </span><span id="local-6989586621679031728"><span class="annot"><a href="#local-6989586621679031728"><span class="hs-identifier hs-var hs-var">lenGreen</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679031721"><span class="hs-identifier hs-var">greenHex</span></a></span><span>
</span><span id="line-937"></span><span>      </span><span id="local-6989586621679031730"><span class="annot"><a href="#local-6989586621679031730"><span class="hs-identifier hs-var hs-var">lenBlue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679031722"><span class="hs-identifier hs-var">blueHex</span></a></span><span>
</span><span id="line-938"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621679031725"><span class="hs-identifier hs-type">lenRed</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="#local-6989586621679031728"><span class="hs-identifier hs-type">lenGreen</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&amp;&amp;</span></span><span> </span><span class="annot"><a href="#local-6989586621679031728"><span class="hs-identifier hs-type">lenGreen</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><a href="#local-6989586621679031730"><span class="hs-identifier hs-type">lenBlue</span></a></span><span>
</span><span id="line-939"></span><span>    </span><span class="hs-keyword">then</span><span>
</span><span id="line-940"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621679031725"><span class="hs-identifier hs-type">lenRed</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">==</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">||</span></span><span> </span><span class="annot"><a href="#local-6989586621679031725"><span class="hs-identifier hs-type">lenRed</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&gt;</span></span><span> </span><span class="annot"><span class="hs-number">4</span></span><span>
</span><span id="line-941"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="hs-identifier hs-type">fail</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Color format not recognised&quot;</span></span><span>
</span><span id="line-942"></span><span>        </span><span class="hs-keyword">else</span><span>
</span><span id="line-943"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679031740"><span class="annot"><a href="#local-6989586621679031740"><span class="hs-identifier hs-var hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">16</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a b. (Num a, Integral b) =&gt; a -&gt; b -&gt; a
</span><span class="hs-operator hs-var">^</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679031725"><span class="hs-identifier hs-var">lenRed</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-944"></span><span>              </span><span id="local-6989586621679031746"><span class="annot"><a href="#local-6989586621679031746"><span class="hs-identifier hs-var hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word16
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Word16) -&gt; Int -&gt; Word16
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679031740"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Int
</span><a href="#local-6989586621679031748"><span class="hs-identifier hs-var">hexToInt</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679031719"><span class="hs-identifier hs-var">redHex</span></a></span><span>
</span><span id="line-945"></span><span>              </span><span id="local-6989586621679031752"><span class="annot"><a href="#local-6989586621679031752"><span class="hs-identifier hs-var hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word16
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Word16) -&gt; Int -&gt; Word16
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679031740"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Int
</span><a href="#local-6989586621679031748"><span class="hs-identifier hs-var">hexToInt</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679031721"><span class="hs-identifier hs-var">greenHex</span></a></span><span>
</span><span id="line-946"></span><span>              </span><span id="local-6989586621679031756"><span class="annot"><a href="#local-6989586621679031756"><span class="hs-identifier hs-var hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Word16
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Word16) -&gt; Int -&gt; Word16
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679031740"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Int
</span><a href="#local-6989586621679031748"><span class="hs-identifier hs-var">hexToInt</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679031722"><span class="hs-identifier hs-var">blueHex</span></a></span><span>
</span><span id="line-947"></span><span>          </span><span class="hs-keyword">in</span><span>  </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">RGB</span></span><span> </span><span class="annot"><a href="#local-6989586621679031746"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679031752"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679031756"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-948"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="hs-identifier hs-type">fail</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Color format not recognised&quot;</span></span><span>
</span><span id="line-949"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-950"></span><span>  </span><span id="local-6989586621679031758"><span class="annot"><span class="annottext">hexDigit :: ReadP Char
</span><a href="#local-6989586621679031758"><span class="hs-identifier hs-var hs-var">hexDigit</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; ReadP Char
</span><span class="hs-identifier hs-var">satisfy</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Bool
</span><span class="hs-identifier hs-var">isHexDigit</span></span><span>
</span><span id="line-951"></span><span>  </span><span id="local-6989586621679031720"><span class="annot"><span class="annottext">hexadecimal :: ReadP String
</span><a href="#local-6989586621679031720"><span class="hs-identifier hs-var hs-var">hexadecimal</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReadP Char -&gt; ReadP String
forall a. ReadP a -&gt; ReadP [a]
</span><span class="hs-identifier hs-var">many1</span></span><span> </span><span class="annot"><span class="annottext">ReadP Char
</span><a href="#local-6989586621679031758"><span class="hs-identifier hs-var">hexDigit</span></a></span><span>
</span><span id="line-952"></span><span>  </span><span id="local-6989586621679031748"><span class="annot"><span class="annottext">hexToInt :: String -&gt; Int
</span><a href="#local-6989586621679031748"><span class="hs-identifier hs-var hs-var">hexToInt</span></a></span></span><span> </span><span id="local-6989586621679031764"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679031764"><span class="hs-identifier hs-var">hex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int -&gt; Int) -&gt; Int -&gt; [Int] -&gt; Int
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679031766"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679031766"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679031767"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679031767"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679031766"><span class="hs-identifier hs-var">d</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">16</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679031767"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Char -&gt; Int) -&gt; String -&gt; [Int]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Int
</span><span class="hs-identifier hs-var">digitToInt</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679031764"><span class="hs-identifier hs-var">hex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-953"></span><span>
</span><span id="line-954"></span><span class="hs-comment">-- | Attempts to get the current terminal size (height in rows, width in</span><span>
</span><span id="line-955"></span><span class="hs-comment">-- columns).</span><span>
</span><span id="line-956"></span><span class="hs-comment">--</span><span>
</span><span id="line-957"></span><span class="hs-comment">-- There is no \'ANSI\' control character sequence that reports the terminal</span><span>
</span><span id="line-958"></span><span class="hs-comment">-- size. So, it attempts to set the cursor position beyond the bottom right</span><span>
</span><span id="line-959"></span><span class="hs-comment">-- corner of the terminal and then use 'getCursorPosition' to query the console</span><span>
</span><span id="line-960"></span><span class="hs-comment">-- input stream. It works only on terminals that support each step and if data</span><span>
</span><span id="line-961"></span><span class="hs-comment">-- can be emitted to 'stdin'. (Use 'System.IO.hIsTerminalDevice' to test if</span><span>
</span><span id="line-962"></span><span class="hs-comment">-- 'stdin' is connected to a terminal.) Uses 'stdout'. If 'stdout' will be</span><span>
</span><span id="line-963"></span><span class="hs-comment">-- redirected, see 'System.IO.hGetTerminalSize' for a more general function.</span><span>
</span><span id="line-964"></span><span class="hs-comment">--</span><span>
</span><span id="line-965"></span><span class="hs-comment">-- On Windows operating systems, the function is not supported on consoles, such</span><span>
</span><span id="line-966"></span><span class="hs-comment">-- as mintty, that are not based on Windows' Console API. (Command Prompt and</span><span>
</span><span id="line-967"></span><span class="hs-comment">-- PowerShell are based on the Console API.)</span><span>
</span><span id="line-968"></span><span class="hs-comment">--</span><span>
</span><span id="line-969"></span><span class="hs-comment">-- For a different approach, one that does not use control character sequences</span><span>
</span><span id="line-970"></span><span class="hs-comment">-- and works when 'stdin' is redirected, see the</span><span>
</span><span id="line-971"></span><span class="hs-comment">-- &lt;https://hackage.haskell.org/package/terminal-size terminal-size&gt; package.</span><span>
</span><span id="line-972"></span><span class="hs-comment">--</span><span>
</span><span id="line-973"></span><span class="hs-comment">-- @since 0.9</span><span>
</span><span id="line-974"></span><span class="annot"><a href="System.Console.ANSI.html#getTerminalSize"><span class="hs-identifier hs-type">getTerminalSize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-975"></span><span id="getTerminalSize"><span class="annot"><span class="annottext">getTerminalSize :: IO (Maybe (Int, Int))
</span><a href="System.Console.ANSI.html#getTerminalSize"><span class="hs-identifier hs-var hs-var">getTerminalSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; IO (Maybe (Int, Int))
</span><a href="System.Console.ANSI.html#hGetTerminalSize"><span class="hs-identifier hs-var">hGetTerminalSize</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stdout</span></span><span>
</span><span id="line-976"></span><span>
</span><span id="line-977"></span><span class="hs-comment">-- | Attempts to get the current terminal size (height in rows, width in</span><span>
</span><span id="line-978"></span><span class="hs-comment">-- columns), by writing control character sequences to the specified handle</span><span>
</span><span id="line-979"></span><span class="hs-comment">-- (which will typically be 'stdout' or 'System.IO.stderr').</span><span>
</span><span id="line-980"></span><span class="hs-comment">--</span><span>
</span><span id="line-981"></span><span class="hs-comment">-- There is no \'ANSI\' control character sequence that reports the terminal</span><span>
</span><span id="line-982"></span><span class="hs-comment">-- size. So, it attempts to set the cursor position beyond the bottom right</span><span>
</span><span id="line-983"></span><span class="hs-comment">-- corner of the terminal and then use 'hGetCursorPosition' to query the console</span><span>
</span><span id="line-984"></span><span class="hs-comment">-- input stream. It works only on terminals that support each step and if data</span><span>
</span><span id="line-985"></span><span class="hs-comment">-- can be emitted to 'stdin'. (Use 'System.IO.hIsTerminalDevice' to test if</span><span>
</span><span id="line-986"></span><span class="hs-comment">-- 'stdin' is connected to a terminal.)</span><span>
</span><span id="line-987"></span><span class="hs-comment">--</span><span>
</span><span id="line-988"></span><span class="hs-comment">-- On Windows operating systems, the function is not supported on consoles, such</span><span>
</span><span id="line-989"></span><span class="hs-comment">-- as mintty, that are not based on the Windows' Console API. (Command Prompt</span><span>
</span><span id="line-990"></span><span class="hs-comment">-- and PowerShell are based on the Console API.)</span><span>
</span><span id="line-991"></span><span class="hs-comment">--</span><span>
</span><span id="line-992"></span><span class="hs-comment">-- For a different approach, one that does not use control character sequences</span><span>
</span><span id="line-993"></span><span class="hs-comment">-- and works when 'stdin' is redirected, see the</span><span>
</span><span id="line-994"></span><span class="hs-comment">-- &lt;https://hackage.haskell.org/package/terminal-size terminal-size&gt; package.</span><span>
</span><span id="line-995"></span><span class="hs-comment">--</span><span>
</span><span id="line-996"></span><span class="hs-comment">-- @since 0.10.1</span><span>
</span><span id="line-997"></span><span class="annot"><a href="System.Console.ANSI.html#hGetTerminalSize"><span class="hs-identifier hs-type">hGetTerminalSize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Handle</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-998"></span><span id="hGetTerminalSize"><span class="annot"><span class="annottext">hGetTerminalSize :: Handle -&gt; IO (Maybe (Int, Int))
</span><a href="System.Console.ANSI.html#hGetTerminalSize"><span class="hs-identifier hs-var hs-var">hGetTerminalSize</span></a></span></span><span> </span><span id="local-6989586621679031769"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031769"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-999"></span><span>  </span><span class="annot"><span class="annottext">Handle -&gt; IO ()
</span><a href="System.Console.ANSI.html#hSaveCursor"><span class="hs-identifier hs-var">hSaveCursor</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031769"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-1000"></span><span>  </span><span class="annot"><span class="annottext">Handle -&gt; Int -&gt; Int -&gt; IO ()
</span><a href="System.Console.ANSI.html#hSetCursorPosition"><span class="hs-identifier hs-var">hSetCursorPosition</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031769"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">9999</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">9999</span></span><span>  </span><span class="hs-comment">-- Attempt to set the cursor position beyond</span><span>
</span><span id="line-1001"></span><span>                                  </span><span class="hs-comment">-- the bottom right corner of the terminal.</span><span>
</span><span id="line-1002"></span><span>  </span><span id="local-6989586621679031770"><span class="annot"><a href="#local-6989586621679031770"><span class="hs-identifier hs-var">mPos</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; IO (Maybe (Int, Int))
</span><a href="System.Console.ANSI.html#hGetCursorPosition"><span class="hs-identifier hs-var">hGetCursorPosition</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031769"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-1003"></span><span>  </span><span class="annot"><a href="System.Console.ANSI.html#hRestoreCursor"><span class="hs-identifier hs-type">hRestoreCursor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679031769"><span class="hs-identifier hs-type">h</span></a></span><span>
</span><span id="line-1004"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">hFlush</span></span><span> </span><span class="annot"><a href="#local-6989586621679031769"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="hs-comment">-- ensure the restore cursor position code is sent to the</span><span>
</span><span id="line-1005"></span><span>           </span><span class="hs-comment">-- operating system</span><span>
</span><span id="line-1006"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679031771"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679031771"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679031772"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679031772"><span class="hs-identifier hs-var">c</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679031771"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679031772"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679031770"><span class="hs-identifier hs-type">mPos</span></a></span><span>
</span><span id="line-1007"></span><span>
</span><span id="line-1008"></span><span class="hs-comment">-- Set the Select Graphic Rendition mode</span><span>
</span><span id="line-1009"></span><span class="annot"><a href="System.Console.ANSI.html#hSetSGR"><span class="hs-identifier hs-type">hSetSGR</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1010"></span><span>     </span><span class="annot"><span class="hs-identifier hs-type">Handle</span></span><span>
</span><span id="line-1011"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">SGR</span></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- Commands: these will typically be applied on top of the</span><span>
</span><span id="line-1012"></span><span>           </span><span class="hs-comment">-- current console SGR mode. An empty list of commands is</span><span>
</span><span id="line-1013"></span><span>           </span><span class="hs-comment">-- equivalent to the list @[Reset]@. Commands are applied left to</span><span>
</span><span id="line-1014"></span><span>           </span><span class="hs-comment">-- right.</span><span>
</span><span id="line-1015"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1016"></span><span id="hSetSGR"><span class="annot"><span class="annottext">hSetSGR :: Handle -&gt; [SGR] -&gt; IO ()
</span><a href="System.Console.ANSI.html#hSetSGR"><span class="hs-identifier hs-var hs-var">hSetSGR</span></a></span></span><span> </span><span id="local-6989586621679031773"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031773"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679031774"><span class="annot"><span class="annottext">[SGR]
</span><a href="#local-6989586621679031774"><span class="hs-identifier hs-var">sgrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; String -&gt; IO ()
</span><span class="hs-identifier hs-var">hPutStr</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031773"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[SGR] -&gt; String
</span><span class="hs-identifier hs-var">setSGRCode</span></span><span> </span><span class="annot"><span class="annottext">[SGR]
</span><a href="#local-6989586621679031774"><span class="hs-identifier hs-var">sgrs</span></a></span><span>
</span><span id="line-1017"></span><span>
</span><span id="line-1018"></span><span class="hs-comment">-- | Set the Select Graphic Rendition mode</span><span>
</span><span id="line-1019"></span><span class="annot"><a href="System.Console.ANSI.html#setSGR"><span class="hs-identifier hs-type">setSGR</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1020"></span><span>     </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">SGR</span></span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- ^ Commands: these will typically be applied on top of the</span><span>
</span><span id="line-1021"></span><span>           </span><span class="hs-comment">-- current console SGR mode. An empty list of commands is</span><span>
</span><span id="line-1022"></span><span>           </span><span class="hs-comment">-- equivalent to the list @[Reset]@. Commands are applied left to</span><span>
</span><span id="line-1023"></span><span>           </span><span class="hs-comment">-- right.</span><span>
</span><span id="line-1024"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1025"></span><span id="setSGR"><span class="annot"><span class="annottext">setSGR :: [SGR] -&gt; IO ()
</span><a href="System.Console.ANSI.html#setSGR"><span class="hs-identifier hs-var hs-var">setSGR</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; [SGR] -&gt; IO ()
</span><a href="System.Console.ANSI.html#hSetSGR"><span class="hs-identifier hs-var">hSetSGR</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stdout</span></span><span>
</span><span id="line-1026"></span><span>
</span><span id="line-1027"></span><span class="annot"><a href="System.Console.ANSI.html#hClearFromCursorToScreenEnd"><span class="hs-identifier hs-type">hClearFromCursorToScreenEnd</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#hClearFromCursorToScreenBeginning"><span class="hs-identifier hs-type">hClearFromCursorToScreenBeginning</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#hClearScreen"><span class="hs-identifier hs-type">hClearScreen</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1028"></span><span>     </span><span class="annot"><span class="hs-identifier hs-type">Handle</span></span><span>
</span><span id="line-1029"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1030"></span><span id="hClearFromCursorToScreenEnd"><span class="annot"><span class="annottext">hClearFromCursorToScreenEnd :: Handle -&gt; IO ()
</span><a href="System.Console.ANSI.html#hClearFromCursorToScreenEnd"><span class="hs-identifier hs-var hs-var">hClearFromCursorToScreenEnd</span></a></span></span><span> </span><span id="local-6989586621679031775"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031775"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; String -&gt; IO ()
</span><span class="hs-identifier hs-var">hPutStr</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031775"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier hs-var">clearFromCursorToScreenEndCode</span></span><span>
</span><span id="line-1031"></span><span id="hClearFromCursorToScreenBeginning"><span class="annot"><span class="annottext">hClearFromCursorToScreenBeginning :: Handle -&gt; IO ()
</span><a href="System.Console.ANSI.html#hClearFromCursorToScreenBeginning"><span class="hs-identifier hs-var hs-var">hClearFromCursorToScreenBeginning</span></a></span></span><span> </span><span id="local-6989586621679031776"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031776"><span class="hs-identifier hs-var">h</span></a></span></span><span>
</span><span id="line-1032"></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; String -&gt; IO ()
</span><span class="hs-identifier hs-var">hPutStr</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031776"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier hs-var">clearFromCursorToScreenBeginningCode</span></span><span>
</span><span id="line-1033"></span><span id="hClearScreen"><span class="annot"><span class="annottext">hClearScreen :: Handle -&gt; IO ()
</span><a href="System.Console.ANSI.html#hClearScreen"><span class="hs-identifier hs-var hs-var">hClearScreen</span></a></span></span><span> </span><span id="local-6989586621679031777"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031777"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; String -&gt; IO ()
</span><span class="hs-identifier hs-var">hPutStr</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031777"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier hs-var">clearScreenCode</span></span><span>
</span><span id="line-1034"></span><span>
</span><span id="line-1035"></span><span class="annot"><a href="System.Console.ANSI.html#clearFromCursorToScreenEnd"><span class="hs-identifier hs-type">clearFromCursorToScreenEnd</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#clearFromCursorToScreenBeginning"><span class="hs-identifier hs-type">clearFromCursorToScreenBeginning</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#clearScreen"><span class="hs-identifier hs-type">clearScreen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1036"></span><span id="clearFromCursorToScreenEnd"><span class="annot"><span class="annottext">clearFromCursorToScreenEnd :: IO ()
</span><a href="System.Console.ANSI.html#clearFromCursorToScreenEnd"><span class="hs-identifier hs-var hs-var">clearFromCursorToScreenEnd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; IO ()
</span><a href="System.Console.ANSI.html#hClearFromCursorToScreenEnd"><span class="hs-identifier hs-var">hClearFromCursorToScreenEnd</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stdout</span></span><span>
</span><span id="line-1037"></span><span id="clearFromCursorToScreenBeginning"><span class="annot"><span class="annottext">clearFromCursorToScreenBeginning :: IO ()
</span><a href="System.Console.ANSI.html#clearFromCursorToScreenBeginning"><span class="hs-identifier hs-var hs-var">clearFromCursorToScreenBeginning</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; IO ()
</span><a href="System.Console.ANSI.html#hClearFromCursorToScreenBeginning"><span class="hs-identifier hs-var">hClearFromCursorToScreenBeginning</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stdout</span></span><span>
</span><span id="line-1038"></span><span id="clearScreen"><span class="annot"><span class="annottext">clearScreen :: IO ()
</span><a href="System.Console.ANSI.html#clearScreen"><span class="hs-identifier hs-var hs-var">clearScreen</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; IO ()
</span><a href="System.Console.ANSI.html#hClearScreen"><span class="hs-identifier hs-var">hClearScreen</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stdout</span></span><span>
</span><span id="line-1039"></span><span>
</span><span id="line-1040"></span><span class="annot"><a href="System.Console.ANSI.html#hClearFromCursorToLineEnd"><span class="hs-identifier hs-type">hClearFromCursorToLineEnd</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#hClearFromCursorToLineBeginning"><span class="hs-identifier hs-type">hClearFromCursorToLineBeginning</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#hClearLine"><span class="hs-identifier hs-type">hClearLine</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1041"></span><span>     </span><span class="annot"><span class="hs-identifier hs-type">Handle</span></span><span>
</span><span id="line-1042"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1043"></span><span id="hClearFromCursorToLineEnd"><span class="annot"><span class="annottext">hClearFromCursorToLineEnd :: Handle -&gt; IO ()
</span><a href="System.Console.ANSI.html#hClearFromCursorToLineEnd"><span class="hs-identifier hs-var hs-var">hClearFromCursorToLineEnd</span></a></span></span><span> </span><span id="local-6989586621679031778"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031778"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; String -&gt; IO ()
</span><span class="hs-identifier hs-var">hPutStr</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031778"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier hs-var">clearFromCursorToLineEndCode</span></span><span>
</span><span id="line-1044"></span><span id="hClearFromCursorToLineBeginning"><span class="annot"><span class="annottext">hClearFromCursorToLineBeginning :: Handle -&gt; IO ()
</span><a href="System.Console.ANSI.html#hClearFromCursorToLineBeginning"><span class="hs-identifier hs-var hs-var">hClearFromCursorToLineBeginning</span></a></span></span><span> </span><span id="local-6989586621679031779"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031779"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; String -&gt; IO ()
</span><span class="hs-identifier hs-var">hPutStr</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031779"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier hs-var">clearFromCursorToLineBeginningCode</span></span><span>
</span><span id="line-1045"></span><span id="hClearLine"><span class="annot"><span class="annottext">hClearLine :: Handle -&gt; IO ()
</span><a href="System.Console.ANSI.html#hClearLine"><span class="hs-identifier hs-var hs-var">hClearLine</span></a></span></span><span> </span><span id="local-6989586621679031780"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031780"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; String -&gt; IO ()
</span><span class="hs-identifier hs-var">hPutStr</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031780"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier hs-var">clearLineCode</span></span><span>
</span><span id="line-1046"></span><span>
</span><span id="line-1047"></span><span class="annot"><a href="System.Console.ANSI.html#clearFromCursorToLineEnd"><span class="hs-identifier hs-type">clearFromCursorToLineEnd</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#clearFromCursorToLineBeginning"><span class="hs-identifier hs-type">clearFromCursorToLineBeginning</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#clearLine"><span class="hs-identifier hs-type">clearLine</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1048"></span><span id="clearFromCursorToLineEnd"><span class="annot"><span class="annottext">clearFromCursorToLineEnd :: IO ()
</span><a href="System.Console.ANSI.html#clearFromCursorToLineEnd"><span class="hs-identifier hs-var hs-var">clearFromCursorToLineEnd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; IO ()
</span><a href="System.Console.ANSI.html#hClearFromCursorToLineEnd"><span class="hs-identifier hs-var">hClearFromCursorToLineEnd</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stdout</span></span><span>
</span><span id="line-1049"></span><span id="clearFromCursorToLineBeginning"><span class="annot"><span class="annottext">clearFromCursorToLineBeginning :: IO ()
</span><a href="System.Console.ANSI.html#clearFromCursorToLineBeginning"><span class="hs-identifier hs-var hs-var">clearFromCursorToLineBeginning</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; IO ()
</span><a href="System.Console.ANSI.html#hClearFromCursorToLineBeginning"><span class="hs-identifier hs-var">hClearFromCursorToLineBeginning</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stdout</span></span><span>
</span><span id="line-1050"></span><span id="clearLine"><span class="annot"><span class="annottext">clearLine :: IO ()
</span><a href="System.Console.ANSI.html#clearLine"><span class="hs-identifier hs-var hs-var">clearLine</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; IO ()
</span><a href="System.Console.ANSI.html#hClearLine"><span class="hs-identifier hs-var">hClearLine</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stdout</span></span><span>
</span><span id="line-1051"></span><span>
</span><span id="line-1052"></span><span class="annot"><a href="System.Console.ANSI.html#hEnableLineWrap"><span class="hs-identifier hs-type">hEnableLineWrap</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#hDisableLineWrap"><span class="hs-identifier hs-type">hDisableLineWrap</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1053"></span><span>     </span><span class="annot"><span class="hs-identifier hs-type">Handle</span></span><span>
</span><span id="line-1054"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1055"></span><span id="hEnableLineWrap"><span class="annot"><span class="annottext">hEnableLineWrap :: Handle -&gt; IO ()
</span><a href="System.Console.ANSI.html#hEnableLineWrap"><span class="hs-identifier hs-var hs-var">hEnableLineWrap</span></a></span></span><span> </span><span id="local-6989586621679031781"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031781"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; String -&gt; IO ()
</span><span class="hs-identifier hs-var">hPutStr</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031781"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier hs-var">enableLineWrapCode</span></span><span>
</span><span id="line-1056"></span><span id="hDisableLineWrap"><span class="annot"><span class="annottext">hDisableLineWrap :: Handle -&gt; IO ()
</span><a href="System.Console.ANSI.html#hDisableLineWrap"><span class="hs-identifier hs-var hs-var">hDisableLineWrap</span></a></span></span><span> </span><span id="local-6989586621679031782"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031782"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; String -&gt; IO ()
</span><span class="hs-identifier hs-var">hPutStr</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031782"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier hs-var">disableLineWrapCode</span></span><span>
</span><span id="line-1057"></span><span>
</span><span id="line-1058"></span><span class="annot"><a href="System.Console.ANSI.html#enableLineWrap"><span class="hs-identifier hs-type">enableLineWrap</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#disableLineWrap"><span class="hs-identifier hs-type">disableLineWrap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1059"></span><span id="enableLineWrap"><span class="annot"><span class="annottext">enableLineWrap :: IO ()
</span><a href="System.Console.ANSI.html#enableLineWrap"><span class="hs-identifier hs-var hs-var">enableLineWrap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; IO ()
</span><a href="System.Console.ANSI.html#hEnableLineWrap"><span class="hs-identifier hs-var">hEnableLineWrap</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stdout</span></span><span>
</span><span id="line-1060"></span><span id="disableLineWrap"><span class="annot"><span class="annottext">disableLineWrap :: IO ()
</span><a href="System.Console.ANSI.html#disableLineWrap"><span class="hs-identifier hs-var hs-var">disableLineWrap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; IO ()
</span><a href="System.Console.ANSI.html#hDisableLineWrap"><span class="hs-identifier hs-var">hDisableLineWrap</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stdout</span></span><span>
</span><span id="line-1061"></span><span>
</span><span id="line-1062"></span><span class="annot"><a href="System.Console.ANSI.html#hScrollPageUp"><span class="hs-identifier hs-type">hScrollPageUp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#hScrollPageDown"><span class="hs-identifier hs-type">hScrollPageDown</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1063"></span><span>     </span><span class="annot"><span class="hs-identifier hs-type">Handle</span></span><span>
</span><span id="line-1064"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- Number of lines to scroll by</span><span>
</span><span id="line-1065"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1066"></span><span id="hScrollPageUp"><span class="annot"><span class="annottext">hScrollPageUp :: Handle -&gt; Int -&gt; IO ()
</span><a href="System.Console.ANSI.html#hScrollPageUp"><span class="hs-identifier hs-var hs-var">hScrollPageUp</span></a></span></span><span> </span><span id="local-6989586621679031783"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031783"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679031784"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679031784"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; String -&gt; IO ()
</span><span class="hs-identifier hs-var">hPutStr</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031783"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
</span><span class="hs-identifier hs-var">scrollPageUpCode</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679031784"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1067"></span><span id="hScrollPageDown"><span class="annot"><span class="annottext">hScrollPageDown :: Handle -&gt; Int -&gt; IO ()
</span><a href="System.Console.ANSI.html#hScrollPageDown"><span class="hs-identifier hs-var hs-var">hScrollPageDown</span></a></span></span><span> </span><span id="local-6989586621679031785"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031785"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span id="local-6989586621679031786"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679031786"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; String -&gt; IO ()
</span><span class="hs-identifier hs-var">hPutStr</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679031785"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String
</span><span class="hs-identifier hs-var">scrollPageDownCode</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679031786"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-1068"></span><span>
</span><span id="line-1069"></span><span class="annot"><a href="System.Console.ANSI.html#scrollPageUp"><span class="hs-identifier hs-type">scrollPageUp</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.Console.ANSI.html#scrollPageDown"><span class="hs-identifier hs-type">scrollPageDown</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-1070"></span><span>     </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-comment">-- ^ Number of lines to scroll by</span><span>
</span><span id="line-1071"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-1072"></span><span id="scrollPageUp"><span class="annot"><span class="annottext">scrollPageUp :: Int -&gt; IO ()
</span><a href="System.Console.ANSI.html#scrollPageUp"><span class="hs-identifier hs-var hs-var">scrollPageUp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; Int -&gt; IO ()
</span><a href="System.Console.ANSI.html#hScrollPageUp"><span class="hs-identifier hs-var">hScrollPageUp</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stdout</span></span><span>
</span><span id="line-1073"></span><span id="scrollPageDown"><span class="annot"><span class="annottext">scrollPageDown :: Int -&gt; IO ()
</span><a href="System.Console.ANSI.html#scrollPageDown"><span class="hs-identifier hs-var hs-var">scrollPageDown</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; Int -&gt; IO ()
</span><a href="System.Console.ANSI.html#hScrollPageDown"><span class="hs-identifier hs-var">hScrollPageDown</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stdout</span></span><span>
</span><span id="line-1074"></span></pre></body></html>