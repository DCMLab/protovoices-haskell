<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE PartialTypeSignatures #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-incomplete-patterns #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# OPTIONS_HADDOCK ignore-exports #-}</span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span class="annot"><span class="hs-comment">{- | This module contains a simple greedy parser for path grammars.
 The grammar is provided by an evaluator ('Eval').
 In addition, the parser takes a policy function
 that picks a reduction option in each step.
-}</span></span><span>
</span><span id="line-10"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="GreedyParser.html"><span class="hs-identifier">GreedyParser</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span class="hs-comment">-- TODO: add back export list once haddock's ignore-exports works again.</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- ( parseGreedy</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- , pickRandom</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- , parseRandom</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- , parseRandom'</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- ) where</span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Common.html"><span class="hs-identifier">Common</span></a></span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Except</span></span><span>
</span><span id="line-22"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">ExceptT</span></span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">MonadError</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">throwError</span></span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.IO.Class</span></span><span>
</span><span id="line-26"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">MonadIO</span></span><span>
</span><span id="line-27"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Class</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">lift</span></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>
</span><span id="line-30"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">catMaybes</span></span><span>
</span><span id="line-31"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">mapMaybe</span></span><span>
</span><span id="line-32"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">maybeToList</span></span><span>
</span><span id="line-33"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Random</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">initStdGen</span></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Random.Stateful</span></span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">StatefulGen</span></span><span>
</span><span id="line-37"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">newIOGenM</span></span><span>
</span><span id="line-38"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">uniformRM</span></span><span>
</span><span id="line-39"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="annot"><span class="hs-comment">-- * Parsing State</span></span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span class="hs-comment">-- {- | A transition during greedy parsing.</span><span>
</span><span id="line-44"></span><span class="hs-comment">--  Augments transition data with a flag</span><span>
</span><span id="line-45"></span><span class="hs-comment">--  that indicates whether the transition is a transitive right (2nd) parent of a spread</span><span>
</span><span id="line-46"></span><span class="hs-comment">--  and/or the direct parent of a left/single-split or thaw.</span><span>
</span><span id="line-47"></span><span class="hs-comment">--  This allows the parser to enforce the following constraints:</span><span>
</span><span id="line-48"></span><span class="hs-comment">--  - right splits are not allowed directly before a left split or freeze</span><span>
</span><span id="line-49"></span><span class="hs-comment">--  - right splits</span><span>
</span><span id="line-50"></span><span class="hs-comment">-- -}</span><span>
</span><span id="line-51"></span><span class="hs-comment">-- data Trans tr = Trans</span><span>
</span><span id="line-52"></span><span class="hs-comment">--   { gtContent :: !tr</span><span>
</span><span id="line-53"></span><span class="hs-comment">--   -- ^ content of the transition</span><span>
</span><span id="line-54"></span><span class="hs-comment">--   , gtSpread2nd :: !Bool</span><span>
</span><span id="line-55"></span><span class="hs-comment">--   -- ^ flag that indicates (transitive) right parents of spreads</span><span>
</span><span id="line-56"></span><span class="hs-comment">--   , gtStage1Parent :: !Bool</span><span>
</span><span id="line-57"></span><span class="hs-comment">--   -- ^ flag that indicates that the edge is the parent of a freeze or left split,</span><span>
</span><span id="line-58"></span><span class="hs-comment">--   -- preventing it from being used for a right split.</span><span>
</span><span id="line-59"></span><span class="hs-comment">--   }</span><span>
</span><span id="line-60"></span><span class="hs-comment">--   deriving (Show)</span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span class="annot"><span class="hs-comment">{- | The state of the greedy parse between steps.
 Generally, the current reduction consists of frozen transitions
 between the &#8906; and the current location
 and open transitions between the current location and &#8905;.

 &gt; &#8906;==[1]==[2]==[3]&#8212;&#8212;[4]&#8212;&#8212;[5]&#8212;&#8212;&#8905;
 &gt;   &#9492; frozen  &#9496;  | &#9492;   open  &#9496;
 &gt;             midSlice (current position)
 &gt;
 &gt; frozen:   ==[2]==[1]==
 &gt; midSlice: [3]
 &gt; open:     &#8212;&#8212;[4]&#8212;&#8212;[5]&#8212;&#8212;

 This is the 'GSSemiOpen' case:
 The slice at the current pointer (@[3]@)
 is represented as an individual slice (@midSlice@).
 The frozen part is represented by a 'Path' of frozen transitions (@tr'@) and slices (@slc@).
 __in reverse direction__, i.e. from @midslice@ back to &#8906; (excluding &#8906;).
 The open part is a 'Path' of open transitions (@tr@) and slices (@slc@)
 in forward direction from @midSlice@ up to &#8905;.

 There are two special cases.
 All transitions can be frozen ('GSFrozen'),
 in which case state only contains the backward 'Path' of frozen transitions
 (excluding &#8906; and &#8905;):

 &gt; &#8906;==[1]==[2]==[3]==&#8905;
 &gt;                    &#9492; current position
 &gt; represented as: ==[3]==[2]==[1]==

 Or all transitions can be open ('GSOpen'),
 in which case the state is just the forward path of open transitions:

 &gt; &#8906;&#8212;&#8212;[1]&#8212;&#8212;[2]&#8212;&#8212;[3]&#8212;&#8212;&#8905;
 &gt; &#9492; current position
 &gt; represented as: &#8212;&#8212;[1]&#8212;&#8212;[2]&#8212;&#8212;[3]&#8212;&#8212;

 The open and semiopen case additionally have a list of operations in generative order,
 and a flag that indicates whether the previous step was a left operation,
 which would prevent continuing with a right unsplit.
-}</span></span><span>
</span><span id="line-103"></span><span class="hs-keyword">data</span><span> </span><span id="GreedyState"><span class="annot"><a href="GreedyParser.html#GreedyState"><span class="hs-identifier hs-var">GreedyState</span></a></span></span><span> </span><span id="local-6989586621679463425"><span class="annot"><a href="#local-6989586621679463425"><span class="hs-identifier hs-type">tr</span></a></span></span><span> </span><span id="local-6989586621679463426"><span class="annot"><a href="#local-6989586621679463426"><span class="hs-identifier hs-type">tr'</span></a></span></span><span> </span><span id="local-6989586621679463427"><span class="annot"><a href="#local-6989586621679463427"><span class="hs-identifier hs-type">slc</span></a></span></span><span> </span><span id="local-6989586621679463428"><span class="annot"><a href="#local-6989586621679463428"><span class="hs-identifier hs-type">op</span></a></span></span><span>
</span><span id="line-104"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="GSFrozen"><span class="annot"><a href="GreedyParser.html#GSFrozen"><span class="hs-identifier hs-var">GSFrozen</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679463426"><span class="hs-identifier hs-type">tr'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679463427"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="GSSemiOpen"><span class="annot"><a href="GreedyParser.html#GSSemiOpen"><span class="hs-identifier hs-var">GSSemiOpen</span></a></span></span><span>
</span><span id="line-106"></span><span>      </span><span class="hs-special">{</span><span> </span><span id="_gsFrozen"><span class="annot"><span class="annottext">forall tr tr' slc op.
GreedyState tr tr' slc op -&gt; Path (Maybe tr') slc
</span><a href="GreedyParser.html#_gsFrozen"><span class="hs-identifier hs-var hs-var">_gsFrozen</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679463426"><span class="hs-identifier hs-type">tr'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679463427"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-107"></span><span>      </span><span class="annot"><span class="hs-comment">-- ^ frozen transitions and slices from current point leftward</span></span><span>
</span><span id="line-108"></span><span>      </span><span class="hs-special">,</span><span> </span><span id="_gsMidSlice"><span class="annot"><span class="annottext">forall tr tr' slc op. GreedyState tr tr' slc op -&gt; slc
</span><a href="GreedyParser.html#_gsMidSlice"><span class="hs-identifier hs-var hs-var">_gsMidSlice</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679463427"><span class="hs-identifier hs-type">slc</span></a></span><span>
</span><span id="line-109"></span><span>      </span><span class="annot"><span class="hs-comment">-- ^ the slice at the current posision between gsFrozen and gsOpen</span></span><span>
</span><span id="line-110"></span><span>      </span><span class="hs-special">,</span><span> </span><span id="_gsOpen"><span class="annot"><span class="annottext">forall tr tr' slc op. GreedyState tr tr' slc op -&gt; Path tr slc
</span><a href="GreedyParser.html#_gsOpen"><span class="hs-identifier hs-var hs-var">_gsOpen</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463425"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463427"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span>      </span><span class="annot"><span class="hs-comment">-- ^ non-frozen transitions and slices from current point rightward</span></span><span>
</span><span id="line-112"></span><span>      </span><span class="hs-special">,</span><span> </span><span id="_gsDeriv"><span class="annot"><span class="annottext">forall tr tr' slc op. GreedyState tr tr' slc op -&gt; [op]
</span><a href="GreedyParser.html#_gsDeriv"><span class="hs-identifier hs-var hs-var">_gsDeriv</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679463428"><span class="hs-identifier hs-type">op</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-113"></span><span>      </span><span class="annot"><span class="hs-comment">-- ^ derivation from current reduction to original surface</span></span><span>
</span><span id="line-114"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-115"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="GSOpen"><span class="annot"><a href="GreedyParser.html#GSOpen"><span class="hs-identifier hs-var">GSOpen</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463425"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463427"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679463428"><span class="hs-identifier hs-type">op</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-116"></span><span>
</span><span id="line-117"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679463453"><span id="local-6989586621679463454"><span id="local-6989586621679463455"><span id="local-6989586621679463456"><span id="local-6989586621679463949"><span id="local-6989586621679463954"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679463453"><span class="hs-identifier hs-type">tr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679463454"><span class="hs-identifier hs-type">tr'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679463455"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679463456"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#GreedyState"><span class="hs-identifier hs-type">GreedyState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463453"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463454"><span class="hs-identifier hs-type">tr'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463455"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463456"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-118"></span><span>  </span><span id="local-6989586621679463973"><span class="annot"><span class="annottext">show :: GreedyState tr tr' slc o -&gt; String
</span><a href="#local-6989586621679463973"><span class="hs-identifier hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#GSFrozen"><span class="hs-identifier hs-type">GSFrozen</span></a></span><span> </span><span id="local-6989586621679463975"><span class="annot"><span class="annottext">Path (Maybe tr') slc
</span><a href="#local-6989586621679463975"><span class="hs-identifier hs-var">frozen</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Path (Maybe tr') slc -&gt; String
forall slc tr'. (Show slc, Show tr') =&gt; Path tr' slc -&gt; String
</span><a href="GreedyParser.html#showFrozen"><span class="hs-identifier hs-var">showFrozen</span></a></span><span> </span><span class="annot"><span class="annottext">Path (Maybe tr') slc
</span><a href="#local-6989586621679463975"><span class="hs-identifier hs-var">frozen</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&#8905;&quot;</span></span><span>
</span><span id="line-119"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#GSOpen"><span class="hs-identifier hs-type">GSOpen</span></a></span><span> </span><span id="local-6989586621679463977"><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679463977"><span class="hs-identifier hs-var">open</span></a></span></span><span> </span><span id="local-6989586621679463978"><span class="annot"><span class="annottext">[o]
</span><a href="#local-6989586621679463978"><span class="hs-identifier hs-var">_ops</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&#8906;&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Path tr slc -&gt; String
forall slc tr'. (Show slc, Show tr') =&gt; Path tr' slc -&gt; String
</span><a href="GreedyParser.html#showOpen"><span class="hs-identifier hs-var">showOpen</span></a></span><span> </span><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679463977"><span class="hs-identifier hs-var">open</span></a></span><span> </span><span class="hs-comment">-- &lt;&gt; showOps ops</span><span>
</span><span id="line-120"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#GSSemiOpen"><span class="hs-identifier hs-type">GSSemiOpen</span></a></span><span> </span><span id="local-6989586621679463980"><span class="annot"><span class="annottext">Path (Maybe tr') slc
</span><a href="#local-6989586621679463980"><span class="hs-identifier hs-var">frozen</span></a></span></span><span> </span><span id="local-6989586621679463981"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679463981"><span class="hs-identifier hs-var">mid</span></a></span></span><span> </span><span id="local-6989586621679463982"><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679463982"><span class="hs-identifier hs-var">open</span></a></span></span><span> </span><span id="local-6989586621679463983"><span class="annot"><span class="annottext">[o]
</span><a href="#local-6989586621679463983"><span class="hs-identifier hs-var">_ops</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-121"></span><span>    </span><span class="annot"><span class="annottext">Path (Maybe tr') slc -&gt; String
forall slc tr'. (Show slc, Show tr') =&gt; Path tr' slc -&gt; String
</span><a href="GreedyParser.html#showFrozen"><span class="hs-identifier hs-var">showFrozen</span></a></span><span> </span><span class="annot"><span class="annottext">Path (Maybe tr') slc
</span><a href="#local-6989586621679463980"><span class="hs-identifier hs-var">frozen</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">slc -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679463981"><span class="hs-identifier hs-var">mid</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Path tr slc -&gt; String
forall slc tr'. (Show slc, Show tr') =&gt; Path tr' slc -&gt; String
</span><a href="GreedyParser.html#showOpen"><span class="hs-identifier hs-var">showOpen</span></a></span><span> </span><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679463982"><span class="hs-identifier hs-var">open</span></a></span><span> </span><span class="hs-comment">-- &lt;&gt; showOps ops</span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span class="annot"><span class="hs-comment">-- | Helper function for showing the frozen part of a piece.</span></span><span>
</span><span id="line-124"></span><span id="local-6989586621679463459"><span id="local-6989586621679463460"><span class="annot"><a href="GreedyParser.html#showFrozen"><span class="hs-identifier hs-type">showFrozen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679463459"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679463460"><span class="hs-identifier hs-type">tr'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463460"><span class="hs-identifier hs-type">tr'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463459"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span></span></span><span>
</span><span id="line-125"></span><span id="showFrozen"><span class="annot"><span class="annottext">showFrozen :: forall slc tr'. (Show slc, Show tr') =&gt; Path tr' slc -&gt; String
</span><a href="GreedyParser.html#showFrozen"><span class="hs-identifier hs-var hs-var">showFrozen</span></a></span></span><span> </span><span id="local-6989586621679463989"><span class="annot"><span class="annottext">Path tr' slc
</span><a href="#local-6989586621679463989"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&#8906;&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Path tr' slc -&gt; String
forall {a} {a}. (Show a, Show a) =&gt; Path a a -&gt; String
</span><a href="#local-6989586621679463990"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Path tr' slc
</span><a href="#local-6989586621679463989"><span class="hs-identifier hs-var">path</span></a></span><span>
</span><span id="line-126"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-127"></span><span>  </span><span id="local-6989586621679463990"><span class="annot"><span class="annottext">go :: Path a a -&gt; String
</span><a href="#local-6989586621679463990"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span id="local-6989586621679464002"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679464002"><span class="hs-identifier hs-var">tr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&#8214; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679464002"><span class="hs-identifier hs-var">tr</span></a></span><span>
</span><span id="line-128"></span><span>  </span><span class="annot"><a href="#local-6989586621679463990"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679464003"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679464003"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span id="local-6989586621679464004"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679464004"><span class="hs-identifier hs-var">slc</span></a></span></span><span> </span><span id="local-6989586621679464005"><span class="annot"><span class="annottext">Path a a
</span><a href="#local-6989586621679464005"><span class="hs-identifier hs-var">rst</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Path a a -&gt; String
</span><a href="#local-6989586621679463990"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Path a a
</span><a href="#local-6989586621679464005"><span class="hs-identifier hs-var">rst</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679464004"><span class="hs-identifier hs-var">slc</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&#8214; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679464003"><span class="hs-identifier hs-var">tr</span></a></span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span class="annot"><span class="hs-comment">-- | Helper function for showing the open part of a piece.</span></span><span>
</span><span id="line-131"></span><span id="local-6989586621679464006"><span id="local-6989586621679464007"><span class="annot"><a href="GreedyParser.html#showOpen"><span class="hs-identifier hs-type">showOpen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679464006"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679464007"><span class="hs-identifier hs-type">tr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679464007"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679464006"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span></span></span><span>
</span><span id="line-132"></span><span id="showOpen"><span class="annot"><span class="annottext">showOpen :: forall slc tr'. (Show slc, Show tr') =&gt; Path tr' slc -&gt; String
</span><a href="GreedyParser.html#showOpen"><span class="hs-identifier hs-var hs-var">showOpen</span></a></span></span><span> </span><span id="local-6989586621679464013"><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679464013"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Path tr slc -&gt; String
forall {a} {a}. (Show a, Show a) =&gt; Path a a -&gt; String
</span><a href="#local-6989586621679464014"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679464013"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&#8905;&quot;</span></span><span>
</span><span id="line-133"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-134"></span><span>  </span><span id="local-6989586621679464014"><span class="annot"><span class="annottext">go :: Path a a -&gt; String
</span><a href="#local-6989586621679464014"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span id="local-6989586621679464025"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679464025"><span class="hs-identifier hs-var">tr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n| &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679464025"><span class="hs-identifier hs-var">tr</span></a></span><span>
</span><span id="line-135"></span><span>  </span><span class="annot"><a href="#local-6989586621679464014"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679464026"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679464026"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span id="local-6989586621679464027"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679464027"><span class="hs-identifier hs-var">slc</span></a></span></span><span> </span><span id="local-6989586621679464028"><span class="annot"><span class="annottext">Path a a
</span><a href="#local-6989586621679464028"><span class="hs-identifier hs-var">rst</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n| &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679464026"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679464027"><span class="hs-identifier hs-var">slc</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Path a a -&gt; String
</span><a href="#local-6989586621679464014"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Path a a
</span><a href="#local-6989586621679464028"><span class="hs-identifier hs-var">rst</span></a></span><span>
</span><span id="line-136"></span><span>
</span><span id="line-137"></span><span id="local-6989586621679463470"><span class="annot"><a href="GreedyParser.html#showOps"><span class="hs-identifier hs-type">showOps</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679463470"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679463470"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span></span><span>
</span><span id="line-138"></span><span id="showOps"><span class="annot"><span class="annottext">showOps :: forall o. Show o =&gt; [o] -&gt; String
</span><a href="GreedyParser.html#showOps"><span class="hs-identifier hs-var hs-var">showOps</span></a></span></span><span> </span><span id="local-6989586621679464036"><span class="annot"><span class="annottext">[o]
</span><a href="#local-6989586621679464036"><span class="hs-identifier hs-var">ops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\nops: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(o -&gt; String) -&gt; [o] -&gt; String
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679464038"><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679464038"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n- &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">o -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679464038"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[o]
</span><a href="#local-6989586621679464036"><span class="hs-identifier hs-var">ops</span></a></span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span id="local-6989586621679464039"><span id="local-6989586621679464040"><span id="local-6989586621679464041"><span id="local-6989586621679464042"><span class="annot"><a href="GreedyParser.html#gsOps"><span class="hs-identifier hs-type">gsOps</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GreedyParser.html#GreedyState"><span class="hs-identifier hs-type">GreedyState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679464039"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679464040"><span class="hs-identifier hs-type">tr'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679464041"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679464042"><span class="hs-identifier hs-type">op</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679464042"><span class="hs-identifier hs-type">op</span></a></span><span class="hs-special">]</span></span></span></span></span><span>
</span><span id="line-141"></span><span id="gsOps"><span class="annot"><span class="annottext">gsOps :: forall tr tr' slc op. GreedyState tr tr' slc op -&gt; [op]
</span><a href="GreedyParser.html#gsOps"><span class="hs-identifier hs-var hs-var">gsOps</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#GSFrozen"><span class="hs-identifier hs-type">GSFrozen</span></a></span><span> </span><span class="annot"><span class="annottext">Path (Maybe tr') slc
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-142"></span><span class="annot"><a href="GreedyParser.html#gsOps"><span class="hs-identifier hs-var">gsOps</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#GSOpen"><span class="hs-identifier hs-type">GSOpen</span></a></span><span> </span><span class="annot"><span class="annottext">Path tr slc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679464044"><span class="annot"><span class="annottext">[op]
</span><a href="#local-6989586621679464044"><span class="hs-identifier hs-var">ops</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[op]
</span><a href="#local-6989586621679464044"><span class="hs-identifier hs-var">ops</span></a></span><span>
</span><span id="line-143"></span><span class="annot"><a href="GreedyParser.html#gsOps"><span class="hs-identifier hs-var">gsOps</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#GSSemiOpen"><span class="hs-identifier hs-type">GSSemiOpen</span></a></span><span> </span><span class="annot"><span class="annottext">Path (Maybe tr') slc
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">slc
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Path tr slc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679464045"><span class="annot"><span class="annottext">[op]
</span><a href="#local-6989586621679464045"><span class="hs-identifier hs-var">ops</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[op]
</span><a href="#local-6989586621679464045"><span class="hs-identifier hs-var">ops</span></a></span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span class="annot"><span class="hs-comment">-- * Parsing Actions</span></span><span>
</span><span id="line-146"></span><span>
</span><span id="line-147"></span><span class="annot"><span class="hs-comment">-- | Single parent of a parsing action</span></span><span>
</span><span id="line-148"></span><span class="hs-keyword">data</span><span> </span><span id="SingleParent"><span class="annot"><a href="GreedyParser.html#SingleParent"><span class="hs-identifier hs-var">SingleParent</span></a></span></span><span> </span><span id="local-6989586621679463730"><span class="annot"><a href="#local-6989586621679463730"><span class="hs-identifier hs-type">slc</span></a></span></span><span> </span><span id="local-6989586621679463731"><span class="annot"><a href="#local-6989586621679463731"><span class="hs-identifier hs-type">tr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="SingleParent"><span class="annot"><a href="GreedyParser.html#SingleParent"><span class="hs-identifier hs-var">SingleParent</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463730"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679463731"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463730"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-149"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679464050"><span id="local-6989586621679464058"><span id="local-6989586621679464062"><span class="annot"><span class="annottext">Int -&gt; SingleParent slc tr -&gt; ShowS
[SingleParent slc tr] -&gt; ShowS
SingleParent slc tr -&gt; String
(Int -&gt; SingleParent slc tr -&gt; ShowS)
-&gt; (SingleParent slc tr -&gt; String)
-&gt; ([SingleParent slc tr] -&gt; ShowS)
-&gt; Show (SingleParent slc tr)
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall slc tr.
(Show slc, Show tr) =&gt;
Int -&gt; SingleParent slc tr -&gt; ShowS
forall slc tr.
(Show slc, Show tr) =&gt;
[SingleParent slc tr] -&gt; ShowS
forall slc tr. (Show slc, Show tr) =&gt; SingleParent slc tr -&gt; String
$cshowsPrec :: forall slc tr.
(Show slc, Show tr) =&gt;
Int -&gt; SingleParent slc tr -&gt; ShowS
showsPrec :: Int -&gt; SingleParent slc tr -&gt; ShowS
$cshow :: forall slc tr. (Show slc, Show tr) =&gt; SingleParent slc tr -&gt; String
show :: SingleParent slc tr -&gt; String
$cshowList :: forall slc tr.
(Show slc, Show tr) =&gt;
[SingleParent slc tr] -&gt; ShowS
showList :: [SingleParent slc tr] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span class="annot"><span class="hs-comment">{- | A parsing action (reduction step) with a single parent transition.
 Combines the parent elements with a single-transition derivation operation.
-}</span></span><span>
</span><span id="line-154"></span><span class="hs-keyword">data</span><span> </span><span id="ActionSingle"><span class="annot"><a href="GreedyParser.html#ActionSingle"><span class="hs-identifier hs-var">ActionSingle</span></a></span></span><span> </span><span id="local-6989586621679463726"><span class="annot"><a href="#local-6989586621679463726"><span class="hs-identifier hs-type">slc</span></a></span></span><span> </span><span id="local-6989586621679463727"><span class="annot"><a href="#local-6989586621679463727"><span class="hs-identifier hs-type">tr</span></a></span></span><span> </span><span id="local-6989586621679463728"><span class="annot"><a href="#local-6989586621679463728"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679463729"><span class="annot"><a href="#local-6989586621679463729"><span class="hs-identifier hs-type">f</span></a></span></span><span>
</span><span id="line-155"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="ActionSingle"><span class="annot"><a href="GreedyParser.html#ActionSingle"><span class="hs-identifier hs-var">ActionSingle</span></a></span></span><span>
</span><span id="line-156"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#SingleParent"><span class="hs-identifier hs-type">SingleParent</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463726"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463727"><span class="hs-identifier hs-type">tr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-157"></span><span>      </span><span class="annot"><span class="hs-comment">-- ^ parent transition (and adjacent slices)</span></span><span>
</span><span id="line-158"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#LeftmostSingle"><span class="hs-identifier hs-type">LeftmostSingle</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463728"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463729"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-159"></span><span>      </span><span class="annot"><span class="hs-comment">-- ^ single-transition operation</span></span><span>
</span><span id="line-160"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679464071"><span id="local-6989586621679464077"><span id="local-6989586621679464081"><span class="annot"><span class="annottext">Int -&gt; ActionSingle slc tr s f -&gt; ShowS
[ActionSingle slc tr s f] -&gt; ShowS
ActionSingle slc tr s f -&gt; String
(Int -&gt; ActionSingle slc tr s f -&gt; ShowS)
-&gt; (ActionSingle slc tr s f -&gt; String)
-&gt; ([ActionSingle slc tr s f] -&gt; ShowS)
-&gt; Show (ActionSingle slc tr s f)
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall slc tr s f.
(Show slc, Show tr, Show s, Show f) =&gt;
Int -&gt; ActionSingle slc tr s f -&gt; ShowS
forall slc tr s f.
(Show slc, Show tr, Show s, Show f) =&gt;
[ActionSingle slc tr s f] -&gt; ShowS
forall slc tr s f.
(Show slc, Show tr, Show s, Show f) =&gt;
ActionSingle slc tr s f -&gt; String
$cshowsPrec :: forall slc tr s f.
(Show slc, Show tr, Show s, Show f) =&gt;
Int -&gt; ActionSingle slc tr s f -&gt; ShowS
showsPrec :: Int -&gt; ActionSingle slc tr s f -&gt; ShowS
$cshow :: forall slc tr s f.
(Show slc, Show tr, Show s, Show f) =&gt;
ActionSingle slc tr s f -&gt; String
show :: ActionSingle slc tr s f -&gt; String
$cshowList :: forall slc tr s f.
(Show slc, Show tr, Show s, Show f) =&gt;
[ActionSingle slc tr s f] -&gt; ShowS
showList :: [ActionSingle slc tr s f] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span class="annot"><span class="hs-comment">-- | Single parent of a parsing action</span></span><span>
</span><span id="line-163"></span><span class="hs-keyword">data</span><span> </span><span id="DoubleParent"><span class="annot"><a href="GreedyParser.html#DoubleParent"><span class="hs-identifier hs-var">DoubleParent</span></a></span></span><span> </span><span id="local-6989586621679463747"><span class="annot"><a href="#local-6989586621679463747"><span class="hs-identifier hs-type">slc</span></a></span></span><span> </span><span id="local-6989586621679463748"><span class="annot"><a href="#local-6989586621679463748"><span class="hs-identifier hs-type">tr</span></a></span></span><span>
</span><span id="line-164"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="DoubleParent"><span class="annot"><a href="GreedyParser.html#DoubleParent"><span class="hs-identifier hs-var">DoubleParent</span></a></span></span><span>
</span><span id="line-165"></span><span>      </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463747"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-166"></span><span>      </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679463748"><span class="hs-identifier hs-type">tr</span></a></span><span>
</span><span id="line-167"></span><span>      </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679463747"><span class="hs-identifier hs-type">slc</span></a></span><span>
</span><span id="line-168"></span><span>      </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679463748"><span class="hs-identifier hs-type">tr</span></a></span><span>
</span><span id="line-169"></span><span>      </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463747"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-170"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679464087"><span id="local-6989586621679464095"><span id="local-6989586621679464099"><span class="annot"><span class="annottext">Int -&gt; DoubleParent slc tr -&gt; ShowS
[DoubleParent slc tr] -&gt; ShowS
DoubleParent slc tr -&gt; String
(Int -&gt; DoubleParent slc tr -&gt; ShowS)
-&gt; (DoubleParent slc tr -&gt; String)
-&gt; ([DoubleParent slc tr] -&gt; ShowS)
-&gt; Show (DoubleParent slc tr)
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall slc tr.
(Show slc, Show tr) =&gt;
Int -&gt; DoubleParent slc tr -&gt; ShowS
forall slc tr.
(Show slc, Show tr) =&gt;
[DoubleParent slc tr] -&gt; ShowS
forall slc tr. (Show slc, Show tr) =&gt; DoubleParent slc tr -&gt; String
$cshowsPrec :: forall slc tr.
(Show slc, Show tr) =&gt;
Int -&gt; DoubleParent slc tr -&gt; ShowS
showsPrec :: Int -&gt; DoubleParent slc tr -&gt; ShowS
$cshow :: forall slc tr. (Show slc, Show tr) =&gt; DoubleParent slc tr -&gt; String
show :: DoubleParent slc tr -&gt; String
$cshowList :: forall slc tr.
(Show slc, Show tr) =&gt;
[DoubleParent slc tr] -&gt; ShowS
showList :: [DoubleParent slc tr] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span class="annot"><span class="hs-comment">{- | A parsing action (reduction step) with two parent transitions.
 Combines the parent elements with a double-transition derivation operation.
-}</span></span><span>
</span><span id="line-175"></span><span class="hs-keyword">data</span><span> </span><span id="ActionDouble"><span class="annot"><a href="GreedyParser.html#ActionDouble"><span class="hs-identifier hs-var">ActionDouble</span></a></span></span><span> </span><span id="local-6989586621679463742"><span class="annot"><a href="#local-6989586621679463742"><span class="hs-identifier hs-type">slc</span></a></span></span><span> </span><span id="local-6989586621679463743"><span class="annot"><a href="#local-6989586621679463743"><span class="hs-identifier hs-type">tr</span></a></span></span><span> </span><span id="local-6989586621679463744"><span class="annot"><a href="#local-6989586621679463744"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679463745"><span class="annot"><a href="#local-6989586621679463745"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679463746"><span class="annot"><a href="#local-6989586621679463746"><span class="hs-identifier hs-type">h</span></a></span></span><span>
</span><span id="line-176"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="ActionDouble"><span class="annot"><a href="GreedyParser.html#ActionDouble"><span class="hs-identifier hs-var">ActionDouble</span></a></span></span><span>
</span><span id="line-177"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#DoubleParent"><span class="hs-identifier hs-type">DoubleParent</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463742"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463743"><span class="hs-identifier hs-type">tr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-178"></span><span>      </span><span class="annot"><span class="hs-comment">-- ^ parent transitions and slice</span></span><span>
</span><span id="line-179"></span><span>      </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#LeftmostDouble"><span class="hs-identifier hs-type">LeftmostDouble</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463744"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463745"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463746"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-180"></span><span>      </span><span class="annot"><span class="hs-comment">-- ^ double-transition operation</span></span><span>
</span><span id="line-181"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679464108"><span id="local-6989586621679464114"><span id="local-6989586621679464118"><span class="annot"><span class="annottext">Int -&gt; ActionDouble slc tr s f h -&gt; ShowS
[ActionDouble slc tr s f h] -&gt; ShowS
ActionDouble slc tr s f h -&gt; String
(Int -&gt; ActionDouble slc tr s f h -&gt; ShowS)
-&gt; (ActionDouble slc tr s f h -&gt; String)
-&gt; ([ActionDouble slc tr s f h] -&gt; ShowS)
-&gt; Show (ActionDouble slc tr s f h)
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall slc tr s f h.
(Show slc, Show tr, Show f, Show s, Show h) =&gt;
Int -&gt; ActionDouble slc tr s f h -&gt; ShowS
forall slc tr s f h.
(Show slc, Show tr, Show f, Show s, Show h) =&gt;
[ActionDouble slc tr s f h] -&gt; ShowS
forall slc tr s f h.
(Show slc, Show tr, Show f, Show s, Show h) =&gt;
ActionDouble slc tr s f h -&gt; String
$cshowsPrec :: forall slc tr s f h.
(Show slc, Show tr, Show f, Show s, Show h) =&gt;
Int -&gt; ActionDouble slc tr s f h -&gt; ShowS
showsPrec :: Int -&gt; ActionDouble slc tr s f h -&gt; ShowS
$cshow :: forall slc tr s f h.
(Show slc, Show tr, Show f, Show s, Show h) =&gt;
ActionDouble slc tr s f h -&gt; String
show :: ActionDouble slc tr s f h -&gt; String
$cshowList :: forall slc tr s f h.
(Show slc, Show tr, Show f, Show s, Show h) =&gt;
[ActionDouble slc tr s f h] -&gt; ShowS
showList :: [ActionDouble slc tr s f h] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-182"></span><span>
</span><span id="line-183"></span><span class="annot"><span class="hs-comment">-- | An alias that combines 'ActionSingle' and 'ActionDouble', representing all possible reduction steps.</span></span><span>
</span><span id="line-184"></span><span class="hs-keyword">type</span><span> </span><span id="Action"><span class="annot"><a href="GreedyParser.html#Action"><span class="hs-identifier hs-var">Action</span></a></span></span><span> </span><span id="local-6989586621679464120"><span class="annot"><a href="#local-6989586621679464120"><span class="hs-identifier hs-type">slc</span></a></span></span><span> </span><span id="local-6989586621679464121"><span class="annot"><a href="#local-6989586621679464121"><span class="hs-identifier hs-type">tr</span></a></span></span><span> </span><span id="local-6989586621679464122"><span class="annot"><a href="#local-6989586621679464122"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679464123"><span class="annot"><a href="#local-6989586621679464123"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679464124"><span class="annot"><a href="#local-6989586621679464124"><span class="hs-identifier hs-type">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#ActionSingle"><span class="hs-identifier hs-type">ActionSingle</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679464120"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679464121"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679464122"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679464123"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#ActionDouble"><span class="hs-identifier hs-type">ActionDouble</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679464120"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679464121"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679464122"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679464123"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679464124"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span class="annot"><span class="hs-comment">{- | A helper function that checks whether an action:
- - is a double action and goes left ('Just True')
- - is a double action and goes right ('Just False')
- - is a single action ('Nothing', doesn't have to choose).
- (See 'opGoesLeft'.)
-}</span></span><span>
</span><span id="line-192"></span><span id="local-6989586621679463519"><span id="local-6989586621679463520"><span id="local-6989586621679463521"><span id="local-6989586621679463522"><span id="local-6989586621679463523"><span class="annot"><a href="GreedyParser.html#actionGoesLeft"><span class="hs-identifier hs-type">actionGoesLeft</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="GreedyParser.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463519"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463520"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463521"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463522"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463523"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span></span></span></span><span>
</span><span id="line-193"></span><span id="actionGoesLeft"><span class="annot"><span class="annottext">actionGoesLeft :: forall slc tr s f h. Action slc tr s f h -&gt; Maybe Bool
</span><a href="GreedyParser.html#actionGoesLeft"><span class="hs-identifier hs-var hs-var">actionGoesLeft</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#ActionDouble"><span class="hs-identifier hs-type">ActionDouble</span></a></span><span> </span><span class="annot"><span class="annottext">DoubleParent slc tr
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679464127"><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><a href="#local-6989586621679464127"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><a href="#local-6989586621679464127"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-194"></span><span>  </span><span class="annot"><a href="Common.html#LMDoubleFreezeLeft"><span class="hs-identifier hs-type">LMDoubleFreezeLeft</span></a></span><span> </span><span class="annot"><span class="annottext">f
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe Bool
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-195"></span><span>  </span><span class="annot"><a href="Common.html#LMDoubleSplitLeft"><span class="hs-identifier hs-type">LMDoubleSplitLeft</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe Bool
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-196"></span><span>  </span><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe Bool
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-197"></span><span class="annot"><a href="GreedyParser.html#actionGoesLeft"><span class="hs-identifier hs-var">actionGoesLeft</span></a></span><span> </span><span class="annot"><span class="annottext">Either (ActionSingle slc tr s f) (ActionDouble slc tr s f h)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Bool
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-198"></span><span>
</span><span id="line-199"></span><span class="annot"><span class="hs-comment">{- | A helper function that checks whether a derivation operation:
- - is a double op and goes left ('Just True')
- - is a double op and goes right ('Just False')
- - is a single op ('Nothing', doesn't have to choose).
- (See 'actionGoesLeft'.)
-}</span></span><span>
</span><span id="line-205"></span><span id="local-6989586621679463530"><span id="local-6989586621679463531"><span id="local-6989586621679463532"><span class="annot"><a href="GreedyParser.html#opGoesLeft"><span class="hs-identifier hs-type">opGoesLeft</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Common.html#Leftmost"><span class="hs-identifier hs-type">Leftmost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463530"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463531"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463532"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span></span><span>
</span><span id="line-206"></span><span id="opGoesLeft"><span class="annot"><span class="annottext">opGoesLeft :: forall s f h. Leftmost s f h -&gt; Maybe Bool
</span><a href="GreedyParser.html#opGoesLeft"><span class="hs-identifier hs-var hs-var">opGoesLeft</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#LMDouble"><span class="hs-identifier hs-type">LMDouble</span></a></span><span> </span><span id="local-6989586621679464131"><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><a href="#local-6989586621679464131"><span class="hs-identifier hs-var">lmd</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><a href="#local-6989586621679464131"><span class="hs-identifier hs-var">lmd</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-207"></span><span>  </span><span class="annot"><a href="Common.html#LMDoubleFreezeLeft"><span class="hs-identifier hs-type">LMDoubleFreezeLeft</span></a></span><span> </span><span class="annot"><span class="annottext">f
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe Bool
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-208"></span><span>  </span><span class="annot"><a href="Common.html#LMDoubleSplitLeft"><span class="hs-identifier hs-type">LMDoubleSplitLeft</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe Bool
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-209"></span><span>  </span><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Maybe Bool
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-210"></span><span class="annot"><a href="GreedyParser.html#opGoesLeft"><span class="hs-identifier hs-var">opGoesLeft</span></a></span><span> </span><span class="annot"><span class="annottext">Leftmost s f h
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Bool
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-211"></span><span>
</span><span id="line-212"></span><span class="annot"><span class="hs-comment">-- * Parsing Algorithm</span></span><span>
</span><span id="line-213"></span><span>
</span><span id="line-214"></span><span class="annot"><span class="hs-comment">{- | Parse a piece in a greedy fashion.
 At each step, a policy chooses from the possible reduction actions,
 the reduction is applied, and parsing continues
 until the piece is fully reduced or no more reduction operations are available.
 Returns the full derivation from the top (@&#8906;&#8212;&#8212;&#8905;@) or an error message.
-}</span></span><span>
</span><span id="line-220"></span><span class="annot"><a href="GreedyParser.html#parseGreedy"><span class="hs-identifier hs-type">parseGreedy</span></a></span><span>
</span><span id="line-221"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679463537"><span class="annot"><a href="#local-6989586621679463537"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679463541"><span class="annot"><a href="#local-6989586621679463541"><span class="hs-identifier hs-type">tr</span></a></span></span><span> </span><span id="local-6989586621679463539"><span class="annot"><a href="#local-6989586621679463539"><span class="hs-identifier hs-type">tr'</span></a></span></span><span> </span><span id="local-6989586621679463540"><span class="annot"><a href="#local-6989586621679463540"><span class="hs-identifier hs-type">slc</span></a></span></span><span> </span><span id="local-6989586621679463545"><span class="annot"><a href="#local-6989586621679463545"><span class="hs-identifier hs-type">slc'</span></a></span></span><span> </span><span id="local-6989586621679463542"><span class="annot"><a href="#local-6989586621679463542"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679463543"><span class="annot"><a href="#local-6989586621679463543"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679463544"><span class="annot"><a href="#local-6989586621679463544"><span class="hs-identifier hs-type">h</span></a></span></span><span>
</span><span id="line-222"></span><span>   </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679463537"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MonadIO</span></span><span> </span><span class="annot"><a href="#local-6989586621679463537"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679463539"><span class="hs-identifier hs-type">tr'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679463540"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679463541"><span class="hs-identifier hs-type">tr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679463542"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679463543"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679463544"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-223"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Common.html#Eval"><span class="hs-identifier hs-type">Eval</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463541"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463539"><span class="hs-identifier hs-type">tr'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463540"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463545"><span class="hs-identifier hs-type">slc'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463544"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Leftmost"><span class="hs-identifier hs-type">Leftmost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463542"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463543"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463544"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-224"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ the evaluator of the grammar to be used</span></span><span>
</span><span id="line-225"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GreedyParser.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463540"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463541"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463542"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463543"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463544"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="#local-6989586621679463537"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463540"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463541"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463542"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463543"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463544"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-226"></span><span>  </span><span class="hs-comment">-- ^ the policy: picks a parsing action from a list of options</span><span>
</span><span id="line-227"></span><span>  </span><span class="hs-comment">-- (determines the 'Monad' @m@, e.g., for randomness).</span><span>
</span><span id="line-228"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463545"><span class="hs-identifier hs-type">slc'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463539"><span class="hs-identifier hs-type">tr'</span></a></span><span>
</span><span id="line-229"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ the input piece</span></span><span>
</span><span id="line-230"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="#local-6989586621679463537"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Analysis"><span class="hs-identifier hs-type">Analysis</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463542"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463543"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463544"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463541"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463540"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-231"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ the full parse or an error message</span></span><span>
</span><span id="line-232"></span><span id="parseGreedy"><span class="annot"><span class="annottext">parseGreedy :: forall (m :: * -&gt; *) tr tr' slc slc' s f h.
(Monad m, MonadIO m, Show tr', Show slc, Show tr, Show s, Show f,
 Show h) =&gt;
Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; ([Action slc tr s f h]
    -&gt; ExceptT String m (Action slc tr s f h))
-&gt; Path slc' tr'
-&gt; ExceptT String m (Analysis s f h tr slc)
</span><a href="GreedyParser.html#parseGreedy"><span class="hs-identifier hs-var hs-var">parseGreedy</span></a></span></span><span> </span><span id="local-6989586621679464149"><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
</span><a href="#local-6989586621679464149"><span class="hs-identifier hs-var">eval</span></a></span></span><span> </span><span id="local-6989586621679464150"><span class="annot"><span class="annottext">[Action slc tr s f h] -&gt; ExceptT String m (Action slc tr s f h)
</span><a href="#local-6989586621679464150"><span class="hs-identifier hs-var">pick</span></a></span></span><span> </span><span id="local-6989586621679464151"><span class="annot"><span class="annottext">Path slc' tr'
</span><a href="#local-6989586621679464151"><span class="hs-identifier hs-var">input</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-233"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679464152"><span class="annot"><a href="#local-6989586621679464152"><span class="hs-identifier hs-var">top</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679464153"><span class="annot"><a href="#local-6989586621679464153"><span class="hs-identifier hs-var">deriv</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">GreedyState tr tr' slc (Leftmost s f h)
-&gt; ExceptT String m (tr, [Leftmost s f h])
</span><a href="#local-6989586621679464154"><span class="hs-identifier hs-var">parse</span></a></span><span> </span><span class="annot"><span class="annottext">GreedyState tr tr' slc (Leftmost s f h)
forall {op}. GreedyState tr tr' slc op
</span><a href="#local-6989586621679464155"><span class="hs-identifier hs-var">state0</span></a></span><span>
</span><span id="line-234"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Common.html#Analysis"><span class="hs-identifier hs-type">Analysis</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679464153"><span class="hs-identifier hs-type">deriv</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679464152"><span class="hs-identifier hs-type">top</span></a></span><span>
</span><span id="line-235"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-236"></span><span>  </span><span id="local-6989586621679464155"><span class="annot"><span class="annottext">state0 :: GreedyState tr tr' slc op
</span><a href="#local-6989586621679464155"><span class="hs-identifier hs-var hs-var">state0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; Path slc' tr' -&gt; GreedyState tr tr' slc op
forall tr tr' slc slc' h v op.
Eval tr tr' slc slc' h v
-&gt; Path slc' tr' -&gt; GreedyState tr tr' slc op
</span><a href="GreedyParser.html#initParseState"><span class="hs-identifier hs-var">initParseState</span></a></span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
</span><a href="#local-6989586621679464149"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">Path slc' tr'
</span><a href="#local-6989586621679464151"><span class="hs-identifier hs-var">input</span></a></span><span>
</span><span id="line-237"></span><span>  </span><span id="local-6989586621679464154"><span class="annot"><span class="annottext">parse :: GreedyState tr tr' slc (Leftmost s f h)
-&gt; ExceptT String m (tr, [Leftmost s f h])
</span><a href="#local-6989586621679464154"><span class="hs-identifier hs-var hs-var">parse</span></a></span></span><span> </span><span id="local-6989586621679464165"><span class="annot"><span class="annottext">GreedyState tr tr' slc (Leftmost s f h)
</span><a href="#local-6989586621679464165"><span class="hs-identifier hs-var">state</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-238"></span><span>    </span><span id="local-6989586621679464166"><span class="annot"><a href="#local-6989586621679464166"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; ([Action slc tr s f h]
    -&gt; ExceptT String m (Action slc tr s f h))
-&gt; GreedyState tr tr' slc (Leftmost s f h)
-&gt; ExceptT
     String
     m
     (Either
        (GreedyState tr tr' slc (Leftmost s f h)) (tr, [Leftmost s f h]))
forall (m :: * -&gt; *) tr tr' slc slc' s f h.
Monad m =&gt;
Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; ([Action slc tr s f h]
    -&gt; ExceptT String m (Action slc tr s f h))
-&gt; GreedyState tr tr' slc (Leftmost s f h)
-&gt; ExceptT
     String
     m
     (Either
        (GreedyState tr tr' slc (Leftmost s f h)) (tr, [Leftmost s f h]))
</span><a href="GreedyParser.html#parseStep"><span class="hs-identifier hs-var">parseStep</span></a></span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
</span><a href="#local-6989586621679464149"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">[Action slc tr s f h] -&gt; ExceptT String m (Action slc tr s f h)
</span><a href="#local-6989586621679464150"><span class="hs-identifier hs-var">pick</span></a></span><span> </span><span class="annot"><span class="annottext">GreedyState tr tr' slc (Leftmost s f h)
</span><a href="#local-6989586621679464165"><span class="hs-identifier hs-var">state</span></a></span><span>
</span><span id="line-239"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621679464166"><span class="hs-identifier hs-type">result</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-240"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span id="local-6989586621679464168"><span class="annot"><span class="annottext">GreedyState tr tr' slc (Leftmost s f h)
</span><a href="#local-6989586621679464168"><span class="hs-identifier hs-var">state'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GreedyState tr tr' slc (Leftmost s f h)
-&gt; ExceptT String m (tr, [Leftmost s f h])
</span><a href="#local-6989586621679464154"><span class="hs-identifier hs-var">parse</span></a></span><span> </span><span class="annot"><span class="annottext">GreedyState tr tr' slc (Leftmost s f h)
</span><a href="#local-6989586621679464168"><span class="hs-identifier hs-var">state'</span></a></span><span>
</span><span id="line-241"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span id="local-6989586621679464169"><span class="annot"><span class="annottext">(tr, [Leftmost s f h])
</span><a href="#local-6989586621679464169"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(tr, [Leftmost s f h]) -&gt; ExceptT String m (tr, [Leftmost s f h])
forall a. a -&gt; ExceptT String m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(tr, [Leftmost s f h])
</span><a href="#local-6989586621679464169"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-242"></span><span>
</span><span id="line-243"></span><span class="annot"><span class="hs-comment">{- | Initializes a parse state.
Takes an evaluator and a (frozen) input path.
Returns the parsing state that corresponds to the unparsed input.
-}</span></span><span>
</span><span id="line-247"></span><span class="annot"><a href="GreedyParser.html#initParseState"><span class="hs-identifier hs-type">initParseState</span></a></span><span>
</span><span id="line-248"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679463576"><span class="annot"><a href="#local-6989586621679463576"><span class="hs-identifier hs-type">tr</span></a></span></span><span> </span><span id="local-6989586621679463577"><span class="annot"><a href="#local-6989586621679463577"><span class="hs-identifier hs-type">tr'</span></a></span></span><span> </span><span id="local-6989586621679463578"><span class="annot"><a href="#local-6989586621679463578"><span class="hs-identifier hs-type">slc</span></a></span></span><span> </span><span id="local-6989586621679463579"><span class="annot"><a href="#local-6989586621679463579"><span class="hs-identifier hs-type">slc'</span></a></span></span><span> </span><span id="local-6989586621679463580"><span class="annot"><a href="#local-6989586621679463580"><span class="hs-identifier hs-type">h</span></a></span></span><span> </span><span id="local-6989586621679463581"><span class="annot"><a href="#local-6989586621679463581"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span id="local-6989586621679463582"><span class="annot"><a href="#local-6989586621679463582"><span class="hs-identifier hs-type">op</span></a></span></span><span>
</span><span id="line-249"></span><span>   </span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Common.html#Eval"><span class="hs-identifier hs-type">Eval</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463576"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463577"><span class="hs-identifier hs-type">tr'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463578"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463579"><span class="hs-identifier hs-type">slc'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463580"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463581"><span class="hs-identifier hs-type">v</span></a></span><span>
</span><span id="line-250"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463579"><span class="hs-identifier hs-type">slc'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463577"><span class="hs-identifier hs-type">tr'</span></a></span><span>
</span><span id="line-251"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GreedyParser.html#GreedyState"><span class="hs-identifier hs-type">GreedyState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463576"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463577"><span class="hs-identifier hs-type">tr'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463578"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463582"><span class="hs-identifier hs-type">op</span></a></span><span>
</span><span id="line-252"></span><span id="initParseState"><span class="annot"><span class="annottext">initParseState :: forall tr tr' slc slc' h v op.
Eval tr tr' slc slc' h v
-&gt; Path slc' tr' -&gt; GreedyState tr tr' slc op
</span><a href="GreedyParser.html#initParseState"><span class="hs-identifier hs-var hs-var">initParseState</span></a></span></span><span> </span><span id="local-6989586621679464170"><span class="annot"><span class="annottext">Eval tr tr' slc slc' h v
</span><a href="#local-6989586621679464170"><span class="hs-identifier hs-var">eval</span></a></span></span><span> </span><span id="local-6989586621679464171"><span class="annot"><span class="annottext">Path slc' tr'
</span><a href="#local-6989586621679464171"><span class="hs-identifier hs-var">input</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Path (Maybe tr') slc -&gt; GreedyState tr tr' slc op
forall tr tr' slc op.
Path (Maybe tr') slc -&gt; GreedyState tr tr' slc op
</span><a href="GreedyParser.html#GSFrozen"><span class="hs-identifier hs-var">GSFrozen</span></a></span><span> </span><span class="annot"><span class="annottext">(Path (Maybe tr') slc -&gt; GreedyState tr tr' slc op)
-&gt; Path (Maybe tr') slc -&gt; GreedyState tr tr' slc op
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe tr' -&gt; Path slc' tr' -&gt; Path (Maybe tr') slc
</span><a href="#local-6989586621679464172"><span class="hs-identifier hs-var">wrapPath</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe tr'
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Path slc' tr' -&gt; Path slc' tr'
forall a b. Path a b -&gt; Path a b
</span><a href="Common.html#reversePath"><span class="hs-identifier hs-var">reversePath</span></a></span><span> </span><span class="annot"><span class="annottext">Path slc' tr'
</span><a href="#local-6989586621679464171"><span class="hs-identifier hs-var">input</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-253"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-254"></span><span>  </span><span class="hs-comment">-- prepare the input: eval slices, wrap in Inner, add Start/Stop</span><span>
</span><span id="line-255"></span><span>  </span><span class="annot"><a href="#local-6989586621679464172"><span class="hs-identifier hs-type">wrapPath</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679463577"><span class="hs-identifier hs-type">tr'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463579"><span class="hs-identifier hs-type">slc'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463577"><span class="hs-identifier hs-type">tr'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679463577"><span class="hs-identifier hs-type">tr'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679463578"><span class="hs-identifier hs-type">slc</span></a></span><span>
</span><span id="line-256"></span><span>  </span><span id="local-6989586621679464172"><span class="annot"><span class="annottext">wrapPath :: Maybe tr' -&gt; Path slc' tr' -&gt; Path (Maybe tr') slc
</span><a href="#local-6989586621679464172"><span class="hs-identifier hs-var hs-var">wrapPath</span></a></span></span><span> </span><span id="local-6989586621679464174"><span class="annot"><span class="annottext">Maybe tr'
</span><a href="#local-6989586621679464174"><span class="hs-identifier hs-var">eleft</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span id="local-6989586621679464175"><span class="annot"><span class="annottext">slc'
</span><a href="#local-6989586621679464175"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe tr' -&gt; slc -&gt; Path (Maybe tr') slc -&gt; Path (Maybe tr') slc
forall around between.
around -&gt; between -&gt; Path around between -&gt; Path around between
</span><a href="Common.html#Path"><span class="hs-identifier hs-var">Path</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe tr'
</span><a href="#local-6989586621679464174"><span class="hs-identifier hs-var">eleft</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h v -&gt; slc' -&gt; slc
forall tr tr' slc slc' h v. Eval tr tr' slc slc' h v -&gt; slc' -&gt; slc
</span><a href="Common.html#evalSlice"><span class="hs-identifier hs-var">evalSlice</span></a></span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h v
</span><a href="#local-6989586621679464170"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">slc'
</span><a href="#local-6989586621679464175"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Path (Maybe tr') slc -&gt; Path (Maybe tr') slc)
-&gt; Path (Maybe tr') slc -&gt; Path (Maybe tr') slc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe tr' -&gt; Path (Maybe tr') slc
forall around between. around -&gt; Path around between
</span><a href="Common.html#PathEnd"><span class="hs-identifier hs-var">PathEnd</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe tr'
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-257"></span><span>  </span><span class="annot"><a href="#local-6989586621679464172"><span class="hs-identifier hs-var">wrapPath</span></a></span><span> </span><span id="local-6989586621679464177"><span class="annot"><span class="annottext">Maybe tr'
</span><a href="#local-6989586621679464177"><span class="hs-identifier hs-var">eleft</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679464178"><span class="annot"><span class="annottext">slc'
</span><a href="#local-6989586621679464178"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679464179"><span class="annot"><span class="annottext">tr'
</span><a href="#local-6989586621679464179"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679464180"><span class="annot"><span class="annottext">Path slc' tr'
</span><a href="#local-6989586621679464180"><span class="hs-identifier hs-var">rst</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-258"></span><span>    </span><span class="annot"><span class="annottext">Maybe tr' -&gt; slc -&gt; Path (Maybe tr') slc -&gt; Path (Maybe tr') slc
forall around between.
around -&gt; between -&gt; Path around between -&gt; Path around between
</span><a href="Common.html#Path"><span class="hs-identifier hs-var">Path</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe tr'
</span><a href="#local-6989586621679464177"><span class="hs-identifier hs-var">eleft</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h v -&gt; slc' -&gt; slc
forall tr tr' slc slc' h v. Eval tr tr' slc slc' h v -&gt; slc' -&gt; slc
</span><a href="Common.html#evalSlice"><span class="hs-identifier hs-var">evalSlice</span></a></span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h v
</span><a href="#local-6989586621679464170"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">slc'
</span><a href="#local-6989586621679464178"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Path (Maybe tr') slc -&gt; Path (Maybe tr') slc)
-&gt; Path (Maybe tr') slc -&gt; Path (Maybe tr') slc
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Maybe tr' -&gt; Path slc' tr' -&gt; Path (Maybe tr') slc
</span><a href="#local-6989586621679464172"><span class="hs-identifier hs-var">wrapPath</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">tr' -&gt; Maybe tr'
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">tr'
</span><a href="#local-6989586621679464179"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Path slc' tr'
</span><a href="#local-6989586621679464180"><span class="hs-identifier hs-var">rst</span></a></span><span>
</span><span id="line-259"></span><span>
</span><span id="line-260"></span><span class="annot"><span class="hs-comment">{- | A single greedy parse step.
 Enumerates a list of possible actions in the current state
 and applies a policy function to select an action.
 The resulting state is returned,
 wrapped in a monad transformer stack containing
 'String' exceptions and the monad of the policy.
-}</span></span><span>
</span><span id="line-267"></span><span class="annot"><a href="GreedyParser.html#parseStep"><span class="hs-identifier hs-type">parseStep</span></a></span><span>
</span><span id="line-268"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679463583"><span class="annot"><a href="#local-6989586621679463583"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679463584"><span class="annot"><a href="#local-6989586621679463584"><span class="hs-identifier hs-type">tr</span></a></span></span><span> </span><span id="local-6989586621679463585"><span class="annot"><a href="#local-6989586621679463585"><span class="hs-identifier hs-type">tr'</span></a></span></span><span> </span><span id="local-6989586621679463586"><span class="annot"><a href="#local-6989586621679463586"><span class="hs-identifier hs-type">slc</span></a></span></span><span> </span><span id="local-6989586621679463587"><span class="annot"><a href="#local-6989586621679463587"><span class="hs-identifier hs-type">slc'</span></a></span></span><span> </span><span id="local-6989586621679463589"><span class="annot"><a href="#local-6989586621679463589"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679463590"><span class="annot"><a href="#local-6989586621679463590"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679463588"><span class="annot"><a href="#local-6989586621679463588"><span class="hs-identifier hs-type">h</span></a></span></span><span>
</span><span id="line-269"></span><span>   </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679463583"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-270"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Common.html#Eval"><span class="hs-identifier hs-type">Eval</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463584"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463585"><span class="hs-identifier hs-type">tr'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463586"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463587"><span class="hs-identifier hs-type">slc'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463588"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Leftmost"><span class="hs-identifier hs-type">Leftmost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463589"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463590"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463588"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-271"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ the evaluator of the grammar to be used</span></span><span>
</span><span id="line-272"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><a href="GreedyParser.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463586"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463584"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463589"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463590"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463588"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="#local-6989586621679463583"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463586"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463584"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463589"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463590"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463588"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-273"></span><span>  </span><span class="hs-comment">-- ^ the policy: picks a parsing action from a list of options</span><span>
</span><span id="line-274"></span><span>  </span><span class="hs-comment">-- (determines the 'Monad' @m@, e.g., for randomness).</span><span>
</span><span id="line-275"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GreedyParser.html#GreedyState"><span class="hs-identifier hs-type">GreedyState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463584"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463585"><span class="hs-identifier hs-type">tr'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463586"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Leftmost"><span class="hs-identifier hs-type">Leftmost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463589"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463590"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463588"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-276"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ the current parsing state</span></span><span>
</span><span id="line-277"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="#local-6989586621679463583"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#GreedyState"><span class="hs-identifier hs-type">GreedyState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463584"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463585"><span class="hs-identifier hs-type">tr'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463586"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Leftmost"><span class="hs-identifier hs-type">Leftmost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463589"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463590"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463588"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679463584"><span class="hs-identifier hs-type">tr</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Common.html#Leftmost"><span class="hs-identifier hs-type">Leftmost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463589"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463590"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463588"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-278"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ either the next state or the result of the parse.</span></span><span>
</span><span id="line-279"></span><span id="parseStep"><span class="annot"><span class="annottext">parseStep :: forall (m :: * -&gt; *) tr tr' slc slc' s f h.
Monad m =&gt;
Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; ([Action slc tr s f h]
    -&gt; ExceptT String m (Action slc tr s f h))
-&gt; GreedyState tr tr' slc (Leftmost s f h)
-&gt; ExceptT
     String
     m
     (Either
        (GreedyState tr tr' slc (Leftmost s f h)) (tr, [Leftmost s f h]))
</span><a href="GreedyParser.html#parseStep"><span class="hs-identifier hs-var hs-var">parseStep</span></a></span></span><span> </span><span id="local-6989586621679464208"><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
</span><a href="#local-6989586621679464208"><span class="hs-identifier hs-var">eval</span></a></span></span><span> </span><span id="local-6989586621679464209"><span class="annot"><span class="annottext">[Action slc tr s f h] -&gt; ExceptT String m (Action slc tr s f h)
</span><a href="#local-6989586621679464209"><span class="hs-identifier hs-var">pick</span></a></span></span><span> </span><span id="local-6989586621679464210"><span class="annot"><span class="annottext">GreedyState tr tr' slc (Leftmost s f h)
</span><a href="#local-6989586621679464210"><span class="hs-identifier hs-var">state</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-280"></span><span>  </span><span class="hs-comment">-- liftIO $ putStrLn &quot;&quot; &gt;&gt; print state</span><span>
</span><span id="line-281"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">GreedyState tr tr' slc (Leftmost s f h)
</span><a href="#local-6989586621679464210"><span class="hs-identifier hs-var">state</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-282"></span><span>    </span><span class="hs-comment">-- case 1: everything frozen</span><span>
</span><span id="line-283"></span><span>    </span><span class="annot"><a href="GreedyParser.html#GSFrozen"><span class="hs-identifier hs-type">GSFrozen</span></a></span><span> </span><span id="local-6989586621679464211"><span class="annot"><span class="annottext">Path (Maybe tr') slc
</span><a href="#local-6989586621679464211"><span class="hs-identifier hs-var">frozen</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Path (Maybe tr') slc
</span><a href="#local-6989586621679464211"><span class="hs-identifier hs-var">frozen</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-284"></span><span>      </span><span class="hs-comment">-- only one transition: unfreeze and terminate</span><span>
</span><span id="line-285"></span><span>      </span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span id="local-6989586621679464212"><span class="annot"><span class="annottext">Maybe tr'
</span><a href="#local-6989586621679464212"><span class="hs-identifier hs-var">trans</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-286"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679464213"><span class="annot"><a href="#local-6989586621679464213"><span class="hs-identifier hs-var">thawed</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679464214"><span class="annot"><a href="#local-6989586621679464214"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-287"></span><span>          </span><span class="annot"><span class="annottext">[ActionSingle slc tr s f]
-&gt; ExceptT String m (tr, LeftmostSingle s f)
</span><a href="#local-6989586621679464215"><span class="hs-identifier hs-var">pickSingle</span></a></span><span> </span><span class="annot"><span class="annottext">([ActionSingle slc tr s f]
 -&gt; ExceptT String m (tr, LeftmostSingle s f))
-&gt; [ActionSingle slc tr s f]
-&gt; ExceptT String m (tr, LeftmostSingle s f)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-288"></span><span>            </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; StartStop slc
-&gt; Maybe tr'
-&gt; StartStop slc
-&gt; [ActionSingle slc tr s f]
forall tr tr' slc slc' h s f.
Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; StartStop slc
-&gt; Maybe tr'
-&gt; StartStop slc
-&gt; [ActionSingle slc tr s f]
</span><a href="GreedyParser.html#collectThawSingle"><span class="hs-identifier hs-var">collectThawSingle</span></a></span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
</span><a href="#local-6989586621679464208"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
forall a. StartStop a
</span><a href="Common.html#Start"><span class="hs-identifier hs-var">Start</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe tr'
</span><a href="#local-6989586621679464212"><span class="hs-identifier hs-var">trans</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
forall a. StartStop a
</span><a href="Common.html#Stop"><span class="hs-identifier hs-var">Stop</span></a></span><span>
</span><span id="line-289"></span><span>        </span><span class="annot"><a href="#local-6989586621679464219"><span class="hs-identifier hs-type">finish</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679464213"><span class="hs-identifier hs-type">thawed</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Common.html#LMSingle"><span class="hs-identifier hs-type">LMSingle</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679464214"><span class="hs-identifier hs-type">op</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-290"></span><span>      </span><span class="hs-comment">-- several transition: unfreeze last and continue</span><span>
</span><span id="line-291"></span><span>      </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679464221"><span class="annot"><span class="annottext">Maybe tr'
</span><a href="#local-6989586621679464221"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679464222"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464222"><span class="hs-identifier hs-var">slice</span></a></span></span><span> </span><span id="local-6989586621679464223"><span class="annot"><span class="annottext">Path (Maybe tr') slc
</span><a href="#local-6989586621679464223"><span class="hs-identifier hs-var">rst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-292"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679464224"><span class="annot"><a href="#local-6989586621679464224"><span class="hs-identifier hs-var">thawed</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679464225"><span class="annot"><a href="#local-6989586621679464225"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[ActionSingle slc tr s f]
-&gt; ExceptT String m (tr, LeftmostSingle s f)
</span><a href="#local-6989586621679464215"><span class="hs-identifier hs-var">pickSingle</span></a></span><span> </span><span class="annot"><span class="annottext">([ActionSingle slc tr s f]
 -&gt; ExceptT String m (tr, LeftmostSingle s f))
-&gt; [ActionSingle slc tr s f]
-&gt; ExceptT String m (tr, LeftmostSingle s f)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; StartStop slc
-&gt; Maybe tr'
-&gt; StartStop slc
-&gt; [ActionSingle slc tr s f]
forall tr tr' slc slc' h s f.
Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; StartStop slc
-&gt; Maybe tr'
-&gt; StartStop slc
-&gt; [ActionSingle slc tr s f]
</span><a href="GreedyParser.html#collectThawSingle"><span class="hs-identifier hs-var">collectThawSingle</span></a></span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
</span><a href="#local-6989586621679464208"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">slc -&gt; StartStop slc
forall a. a -&gt; StartStop a
</span><a href="Common.html#Inner"><span class="hs-identifier hs-var">Inner</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464222"><span class="hs-identifier hs-var">slice</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe tr'
</span><a href="#local-6989586621679464221"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
forall a. StartStop a
</span><a href="Common.html#Stop"><span class="hs-identifier hs-var">Stop</span></a></span><span>
</span><span id="line-293"></span><span>        </span><span class="annot"><a href="#local-6989586621679464227"><span class="hs-identifier hs-type">continue</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GreedyParser.html#GSSemiOpen"><span class="hs-identifier hs-type">GSSemiOpen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679464223"><span class="hs-identifier hs-type">rst</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679464222"><span class="hs-identifier hs-type">slice</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679464224"><span class="hs-identifier hs-type">thawed</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Common.html#LMSingle"><span class="hs-identifier hs-type">LMSingle</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679464225"><span class="hs-identifier hs-type">op</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-294"></span><span>
</span><span id="line-295"></span><span>    </span><span class="hs-comment">-- case 2: everything open</span><span>
</span><span id="line-296"></span><span>    </span><span class="annot"><a href="GreedyParser.html#GSOpen"><span class="hs-identifier hs-type">GSOpen</span></a></span><span> </span><span id="local-6989586621679464228"><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679464228"><span class="hs-identifier hs-var">open</span></a></span></span><span> </span><span id="local-6989586621679464229"><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679464229"><span class="hs-identifier hs-var">ops</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679464228"><span class="hs-identifier hs-var">open</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-297"></span><span>      </span><span class="hs-comment">-- only one transition: terminate</span><span>
</span><span id="line-298"></span><span>      </span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span id="local-6989586621679464230"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464230"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(tr, [Leftmost s f h])
-&gt; ExceptT
     String
     m
     (Either
        (GreedyState tr tr' slc (Leftmost s f h)) (tr, [Leftmost s f h]))
forall {a} {a}. a -&gt; ExceptT String m (Either a a)
</span><a href="#local-6989586621679464219"><span class="hs-identifier hs-var">finish</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464230"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679464229"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-299"></span><span>      </span><span class="hs-comment">-- two transitions: unsplit single and terminate</span><span>
</span><span id="line-300"></span><span>      </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679464231"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464231"><span class="hs-identifier hs-var">tl</span></a></span></span><span> </span><span id="local-6989586621679464232"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464232"><span class="hs-identifier hs-var">slice</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span id="local-6989586621679464233"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464233"><span class="hs-identifier hs-var">tr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-301"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679464234"><span class="annot"><a href="#local-6989586621679464234"><span class="hs-identifier hs-var">ttop</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679464235"><span class="annot"><a href="#local-6989586621679464235"><span class="hs-identifier hs-var">optop</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-302"></span><span>          </span><span class="annot"><span class="annottext">[ActionSingle slc tr s f]
-&gt; ExceptT String m (tr, LeftmostSingle s f)
</span><a href="#local-6989586621679464215"><span class="hs-identifier hs-var">pickSingle</span></a></span><span> </span><span class="annot"><span class="annottext">([ActionSingle slc tr s f]
 -&gt; ExceptT String m (tr, LeftmostSingle s f))
-&gt; [ActionSingle slc tr s f]
-&gt; ExceptT String m (tr, LeftmostSingle s f)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-303"></span><span>            </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; StartStop slc
-&gt; tr
-&gt; slc
-&gt; tr
-&gt; StartStop slc
-&gt; [ActionSingle slc tr s f]
forall tr tr' slc slc' h s f.
Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; StartStop slc
-&gt; tr
-&gt; slc
-&gt; tr
-&gt; StartStop slc
-&gt; [ActionSingle slc tr s f]
</span><a href="GreedyParser.html#collectUnsplitSingle"><span class="hs-identifier hs-var">collectUnsplitSingle</span></a></span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
</span><a href="#local-6989586621679464208"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
forall a. StartStop a
</span><a href="Common.html#Start"><span class="hs-identifier hs-var">Start</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464231"><span class="hs-identifier hs-var">tl</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464232"><span class="hs-identifier hs-var">slice</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464233"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
forall a. StartStop a
</span><a href="Common.html#Stop"><span class="hs-identifier hs-var">Stop</span></a></span><span>
</span><span id="line-304"></span><span>        </span><span class="annot"><a href="#local-6989586621679464219"><span class="hs-identifier hs-type">finish</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679464234"><span class="hs-identifier hs-type">ttop</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#LMSingle"><span class="hs-identifier hs-type">LMSingle</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679464235"><span class="hs-identifier hs-type">optop</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="#local-6989586621679464229"><span class="hs-identifier hs-type">ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-305"></span><span>      </span><span class="hs-comment">-- more than two transitions: pick double operation and continue</span><span>
</span><span id="line-306"></span><span>      </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679464237"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464237"><span class="hs-identifier hs-var">tl</span></a></span></span><span> </span><span id="local-6989586621679464238"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464238"><span class="hs-identifier hs-var">sl</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679464239"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464239"><span class="hs-identifier hs-var">tm</span></a></span></span><span> </span><span id="local-6989586621679464240"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464240"><span class="hs-identifier hs-var">sr</span></a></span></span><span> </span><span id="local-6989586621679464241"><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679464241"><span class="hs-identifier hs-var">rst</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-307"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679464242"><span class="annot"><span class="annottext">doubles :: [ActionDouble slc tr s f h]
</span><a href="#local-6989586621679464242"><span class="hs-identifier hs-var hs-var hs-var">doubles</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; StartStop slc
-&gt; tr
-&gt; slc
-&gt; tr
-&gt; slc
-&gt; Path tr slc
-&gt; Bool
-&gt; [ActionDouble slc tr s f h]
forall tr tr' slc slc' h s f.
Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; StartStop slc
-&gt; tr
-&gt; slc
-&gt; tr
-&gt; slc
-&gt; Path tr slc
-&gt; Bool
-&gt; [ActionDouble slc tr s f h]
</span><a href="GreedyParser.html#collectDoubles"><span class="hs-identifier hs-var">collectDoubles</span></a></span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
</span><a href="#local-6989586621679464208"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
forall a. StartStop a
</span><a href="Common.html#Start"><span class="hs-identifier hs-var">Start</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464237"><span class="hs-identifier hs-var">tl</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464238"><span class="hs-identifier hs-var">sl</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464239"><span class="hs-identifier hs-var">tm</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464240"><span class="hs-identifier hs-var">sr</span></a></span><span> </span><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679464241"><span class="hs-identifier hs-var">rst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Leftmost s f h] -&gt; Bool
forall s f h. [Leftmost s f h] -&gt; Bool
</span><a href="GreedyParser.html#lastWasLeft"><span class="hs-identifier hs-var">lastWasLeft</span></a></span><span> </span><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679464229"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-308"></span><span>        </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679464245"><span class="annot"><a href="#local-6989586621679464245"><span class="hs-identifier hs-var">topl</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679464246"><span class="annot"><a href="#local-6989586621679464246"><span class="hs-identifier hs-var">tops</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679464247"><span class="annot"><a href="#local-6989586621679464247"><span class="hs-identifier hs-var">topr</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679464248"><span class="annot"><a href="#local-6989586621679464248"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[ActionDouble slc tr s f h]
-&gt; ExceptT String m ((tr, slc, tr), LeftmostDouble s f h)
</span><a href="#local-6989586621679464249"><span class="hs-identifier hs-var">pickDouble</span></a></span><span> </span><span class="annot"><span class="annottext">[ActionDouble slc tr s f h]
</span><a href="#local-6989586621679464242"><span class="hs-identifier hs-var">doubles</span></a></span><span>
</span><span id="line-309"></span><span>        </span><span class="annot"><a href="#local-6989586621679464227"><span class="hs-identifier hs-type">continue</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-310"></span><span>          </span><span class="annot"><a href="GreedyParser.html#GSOpen"><span class="hs-identifier hs-type">GSOpen</span></a></span><span>
</span><span id="line-311"></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679464245"><span class="hs-identifier hs-type">topl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679464246"><span class="hs-identifier hs-type">tops</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#pathSetHead"><span class="hs-identifier hs-type">pathSetHead</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679464241"><span class="hs-identifier hs-type">rst</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679464247"><span class="hs-identifier hs-type">topr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-312"></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#LMDouble"><span class="hs-identifier hs-type">LMDouble</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679464248"><span class="hs-identifier hs-type">op</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="#local-6989586621679464229"><span class="hs-identifier hs-type">ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-313"></span><span>
</span><span id="line-314"></span><span>    </span><span class="hs-comment">-- case 3: some parts frozen, some open</span><span>
</span><span id="line-315"></span><span>    </span><span class="annot"><a href="GreedyParser.html#GSSemiOpen"><span class="hs-identifier hs-type">GSSemiOpen</span></a></span><span> </span><span id="local-6989586621679464251"><span class="annot"><span class="annottext">Path (Maybe tr') slc
</span><a href="#local-6989586621679464251"><span class="hs-identifier hs-var">frozen</span></a></span></span><span> </span><span id="local-6989586621679464252"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464252"><span class="hs-identifier hs-var">mid</span></a></span></span><span> </span><span id="local-6989586621679464253"><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679464253"><span class="hs-identifier hs-var">open</span></a></span></span><span> </span><span id="local-6989586621679464254"><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679464254"><span class="hs-identifier hs-var">ops</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679464253"><span class="hs-identifier hs-var">open</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-316"></span><span>      </span><span class="hs-comment">-- only one open transition: thaw</span><span>
</span><span id="line-317"></span><span>      </span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span id="local-6989586621679464255"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464255"><span class="hs-identifier hs-var">topen</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Path (Maybe tr') slc
</span><a href="#local-6989586621679464251"><span class="hs-identifier hs-var">frozen</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-318"></span><span>        </span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span id="local-6989586621679464256"><span class="annot"><span class="annottext">Maybe tr'
</span><a href="#local-6989586621679464256"><span class="hs-identifier hs-var">tfrozen</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-319"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679464257"><span class="annot"><a href="#local-6989586621679464257"><span class="hs-identifier hs-var">thawed</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679464258"><span class="annot"><a href="#local-6989586621679464258"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-320"></span><span>            </span><span class="annot"><span class="annottext">[ActionDouble slc tr s f h]
-&gt; ExceptT String m ((tr, slc, tr), LeftmostDouble s f h)
</span><a href="#local-6989586621679464249"><span class="hs-identifier hs-var">pickDouble</span></a></span><span> </span><span class="annot"><span class="annottext">([ActionDouble slc tr s f h]
 -&gt; ExceptT String m ((tr, slc, tr), LeftmostDouble s f h))
-&gt; [ActionDouble slc tr s f h]
-&gt; ExceptT String m ((tr, slc, tr), LeftmostDouble s f h)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-321"></span><span>              </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; StartStop slc
-&gt; Maybe tr'
-&gt; slc
-&gt; tr
-&gt; StartStop slc
-&gt; [ActionDouble slc tr s f h]
forall tr tr' slc slc' h s f.
Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; StartStop slc
-&gt; Maybe tr'
-&gt; slc
-&gt; tr
-&gt; StartStop slc
-&gt; [ActionDouble slc tr s f h]
</span><a href="GreedyParser.html#collectThawLeft"><span class="hs-identifier hs-var">collectThawLeft</span></a></span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
</span><a href="#local-6989586621679464208"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
forall a. StartStop a
</span><a href="Common.html#Start"><span class="hs-identifier hs-var">Start</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe tr'
</span><a href="#local-6989586621679464256"><span class="hs-identifier hs-var">tfrozen</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464252"><span class="hs-identifier hs-var">mid</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464255"><span class="hs-identifier hs-var">topen</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
forall a. StartStop a
</span><a href="Common.html#Stop"><span class="hs-identifier hs-var">Stop</span></a></span><span>
</span><span id="line-322"></span><span>          </span><span class="annot"><a href="#local-6989586621679464227"><span class="hs-identifier hs-type">continue</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="GreedyParser.html#GSOpen"><span class="hs-identifier hs-type">GSOpen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679464257"><span class="hs-identifier hs-type">thawed</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679464252"><span class="hs-identifier hs-type">mid</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679464253"><span class="hs-identifier hs-type">open</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#LMDouble"><span class="hs-identifier hs-type">LMDouble</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679464258"><span class="hs-identifier hs-type">op</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="#local-6989586621679464254"><span class="hs-identifier hs-type">ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-323"></span><span>        </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679464260"><span class="annot"><span class="annottext">Maybe tr'
</span><a href="#local-6989586621679464260"><span class="hs-identifier hs-var">tfrozen</span></a></span></span><span> </span><span id="local-6989586621679464261"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464261"><span class="hs-identifier hs-var">sfrozen</span></a></span></span><span> </span><span id="local-6989586621679464262"><span class="annot"><span class="annottext">Path (Maybe tr') slc
</span><a href="#local-6989586621679464262"><span class="hs-identifier hs-var">rstFrozen</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-324"></span><span>          </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679464263"><span class="annot"><a href="#local-6989586621679464263"><span class="hs-identifier hs-var">thawed</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679464264"><span class="annot"><a href="#local-6989586621679464264"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-325"></span><span>            </span><span class="annot"><span class="annottext">[ActionDouble slc tr s f h]
-&gt; ExceptT String m ((tr, slc, tr), LeftmostDouble s f h)
</span><a href="#local-6989586621679464249"><span class="hs-identifier hs-var">pickDouble</span></a></span><span> </span><span class="annot"><span class="annottext">([ActionDouble slc tr s f h]
 -&gt; ExceptT String m ((tr, slc, tr), LeftmostDouble s f h))
-&gt; [ActionDouble slc tr s f h]
-&gt; ExceptT String m ((tr, slc, tr), LeftmostDouble s f h)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-326"></span><span>              </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; StartStop slc
-&gt; Maybe tr'
-&gt; slc
-&gt; tr
-&gt; StartStop slc
-&gt; [ActionDouble slc tr s f h]
forall tr tr' slc slc' h s f.
Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; StartStop slc
-&gt; Maybe tr'
-&gt; slc
-&gt; tr
-&gt; StartStop slc
-&gt; [ActionDouble slc tr s f h]
</span><a href="GreedyParser.html#collectThawLeft"><span class="hs-identifier hs-var">collectThawLeft</span></a></span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
</span><a href="#local-6989586621679464208"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">slc -&gt; StartStop slc
forall a. a -&gt; StartStop a
</span><a href="Common.html#Inner"><span class="hs-identifier hs-var">Inner</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464261"><span class="hs-identifier hs-var">sfrozen</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe tr'
</span><a href="#local-6989586621679464260"><span class="hs-identifier hs-var">tfrozen</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464252"><span class="hs-identifier hs-var">mid</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464255"><span class="hs-identifier hs-var">topen</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
forall a. StartStop a
</span><a href="Common.html#Stop"><span class="hs-identifier hs-var">Stop</span></a></span><span>
</span><span id="line-327"></span><span>          </span><span class="annot"><a href="#local-6989586621679464227"><span class="hs-identifier hs-type">continue</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-328"></span><span>            </span><span class="annot"><a href="GreedyParser.html#GSSemiOpen"><span class="hs-identifier hs-type">GSSemiOpen</span></a></span><span>
</span><span id="line-329"></span><span>              </span><span class="annot"><a href="#local-6989586621679464262"><span class="hs-identifier hs-type">rstFrozen</span></a></span><span>
</span><span id="line-330"></span><span>              </span><span class="annot"><a href="#local-6989586621679464261"><span class="hs-identifier hs-type">sfrozen</span></a></span><span>
</span><span id="line-331"></span><span>              </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679464263"><span class="hs-identifier hs-type">thawed</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679464252"><span class="hs-identifier hs-type">mid</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679464253"><span class="hs-identifier hs-type">open</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-332"></span><span>              </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#LMDouble"><span class="hs-identifier hs-type">LMDouble</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679464264"><span class="hs-identifier hs-type">op</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="#local-6989586621679464254"><span class="hs-identifier hs-type">ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-333"></span><span>      </span><span class="hs-comment">-- two open transitions: thaw or unsplit single</span><span>
</span><span id="line-334"></span><span>      </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679464265"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464265"><span class="hs-identifier hs-var">topenl</span></a></span></span><span> </span><span id="local-6989586621679464266"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464266"><span class="hs-identifier hs-var">sopen</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span id="local-6989586621679464267"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464267"><span class="hs-identifier hs-var">topenr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-335"></span><span>        </span><span class="hs-keyword">let</span><span>
</span><span id="line-336"></span><span>          </span><span id="local-6989586621679464269"><span class="annot"><span class="annottext">unsplits :: [Either (ActionSingle slc tr s f) b]
</span><a href="#local-6989586621679464269"><span class="hs-identifier hs-var hs-var">unsplits</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-337"></span><span>            </span><span class="annot"><span class="annottext">ActionSingle slc tr s f -&gt; Either (ActionSingle slc tr s f) b
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(ActionSingle slc tr s f -&gt; Either (ActionSingle slc tr s f) b)
-&gt; [ActionSingle slc tr s f]
-&gt; [Either (ActionSingle slc tr s f) b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; StartStop slc
-&gt; tr
-&gt; slc
-&gt; tr
-&gt; StartStop slc
-&gt; [ActionSingle slc tr s f]
forall tr tr' slc slc' h s f.
Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; StartStop slc
-&gt; tr
-&gt; slc
-&gt; tr
-&gt; StartStop slc
-&gt; [ActionSingle slc tr s f]
</span><a href="GreedyParser.html#collectUnsplitSingle"><span class="hs-identifier hs-var">collectUnsplitSingle</span></a></span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
</span><a href="#local-6989586621679464208"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">slc -&gt; StartStop slc
forall a. a -&gt; StartStop a
</span><a href="Common.html#Inner"><span class="hs-identifier hs-var">Inner</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464252"><span class="hs-identifier hs-var">mid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464265"><span class="hs-identifier hs-var">topenl</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464266"><span class="hs-identifier hs-var">sopen</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464267"><span class="hs-identifier hs-var">topenr</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
forall a. StartStop a
</span><a href="Common.html#Stop"><span class="hs-identifier hs-var">Stop</span></a></span><span>
</span><span id="line-338"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Path (Maybe tr') slc
</span><a href="#local-6989586621679464251"><span class="hs-identifier hs-var">frozen</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-339"></span><span>          </span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span id="local-6989586621679464271"><span class="annot"><span class="annottext">Maybe tr'
</span><a href="#local-6989586621679464271"><span class="hs-identifier hs-var">tfrozen</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-340"></span><span>            </span><span class="hs-keyword">let</span><span>
</span><span id="line-341"></span><span>              </span><span id="local-6989586621679464273"><span class="annot"><span class="annottext">thaws :: [Either a (ActionDouble slc tr s f h)]
</span><a href="#local-6989586621679464273"><span class="hs-identifier hs-var hs-var hs-var">thaws</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-342"></span><span>                </span><span class="annot"><span class="annottext">ActionDouble slc tr s f h -&gt; Either a (ActionDouble slc tr s f h)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span>
</span><span id="line-343"></span><span>                  </span><span class="annot"><span class="annottext">(ActionDouble slc tr s f h -&gt; Either a (ActionDouble slc tr s f h))
-&gt; [ActionDouble slc tr s f h]
-&gt; [Either a (ActionDouble slc tr s f h)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; StartStop slc
-&gt; Maybe tr'
-&gt; slc
-&gt; tr
-&gt; StartStop slc
-&gt; [ActionDouble slc tr s f h]
forall tr tr' slc slc' h s f.
Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; StartStop slc
-&gt; Maybe tr'
-&gt; slc
-&gt; tr
-&gt; StartStop slc
-&gt; [ActionDouble slc tr s f h]
</span><a href="GreedyParser.html#collectThawLeft"><span class="hs-identifier hs-var">collectThawLeft</span></a></span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
</span><a href="#local-6989586621679464208"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
forall a. StartStop a
</span><a href="Common.html#Start"><span class="hs-identifier hs-var">Start</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe tr'
</span><a href="#local-6989586621679464271"><span class="hs-identifier hs-var">tfrozen</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464252"><span class="hs-identifier hs-var">mid</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464265"><span class="hs-identifier hs-var">topenl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">slc -&gt; StartStop slc
forall a. a -&gt; StartStop a
</span><a href="Common.html#Inner"><span class="hs-identifier hs-var">Inner</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464266"><span class="hs-identifier hs-var">sopen</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-344"></span><span>            </span><span id="local-6989586621679464274"><span class="annot"><a href="#local-6989586621679464274"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Action slc tr s f h] -&gt; ExceptT String m (Action slc tr s f h)
</span><a href="#local-6989586621679464209"><span class="hs-identifier hs-var">pick</span></a></span><span> </span><span class="annot"><span class="annottext">([Action slc tr s f h] -&gt; ExceptT String m (Action slc tr s f h))
-&gt; [Action slc tr s f h] -&gt; ExceptT String m (Action slc tr s f h)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Action slc tr s f h]
forall {a}. [Either a (ActionDouble slc tr s f h)]
</span><a href="#local-6989586621679464273"><span class="hs-identifier hs-var">thaws</span></a></span><span> </span><span class="annot"><span class="annottext">[Action slc tr s f h]
-&gt; [Action slc tr s f h] -&gt; [Action slc tr s f h]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Action slc tr s f h]
forall {b}. [Either (ActionSingle slc tr s f) b]
</span><a href="#local-6989586621679464269"><span class="hs-identifier hs-var">unsplits</span></a></span><span>
</span><span id="line-345"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621679464274"><span class="hs-identifier hs-type">action</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-346"></span><span>              </span><span class="hs-comment">-- picked unsplit</span><span>
</span><span id="line-347"></span><span>              </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#ActionSingle"><span class="hs-identifier hs-type">ActionSingle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#SingleParent"><span class="hs-identifier hs-type">SingleParent</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679464275"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464275"><span class="hs-identifier hs-var">parent</span></a></span></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679464276"><span class="annot"><span class="annottext">LeftmostSingle s f
</span><a href="#local-6989586621679464276"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-348"></span><span>                </span><span class="annot"><span class="annottext">GreedyState tr tr' slc (Leftmost s f h)
-&gt; ExceptT
     String
     m
     (Either
        (GreedyState tr tr' slc (Leftmost s f h)) (tr, [Leftmost s f h]))
forall {a} {b}. a -&gt; ExceptT String m (Either a b)
</span><a href="#local-6989586621679464227"><span class="hs-identifier hs-var">continue</span></a></span><span> </span><span class="annot"><span class="annottext">(GreedyState tr tr' slc (Leftmost s f h)
 -&gt; ExceptT
      String
      m
      (Either
         (GreedyState tr tr' slc (Leftmost s f h)) (tr, [Leftmost s f h])))
-&gt; GreedyState tr tr' slc (Leftmost s f h)
-&gt; ExceptT
     String
     m
     (Either
        (GreedyState tr tr' slc (Leftmost s f h)) (tr, [Leftmost s f h]))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-349"></span><span>                  </span><span class="annot"><span class="annottext">Path (Maybe tr') slc
-&gt; slc
-&gt; Path tr slc
-&gt; [Leftmost s f h]
-&gt; GreedyState tr tr' slc (Leftmost s f h)
forall tr tr' slc op.
Path (Maybe tr') slc
-&gt; slc -&gt; Path tr slc -&gt; [op] -&gt; GreedyState tr tr' slc op
</span><a href="GreedyParser.html#GSSemiOpen"><span class="hs-identifier hs-var">GSSemiOpen</span></a></span><span>
</span><span id="line-350"></span><span>                    </span><span class="annot"><span class="annottext">Path (Maybe tr') slc
</span><a href="#local-6989586621679464251"><span class="hs-identifier hs-var">frozen</span></a></span><span>
</span><span id="line-351"></span><span>                    </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464252"><span class="hs-identifier hs-var">mid</span></a></span><span>
</span><span id="line-352"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">tr -&gt; Path tr slc
forall around between. around -&gt; Path around between
</span><a href="Common.html#PathEnd"><span class="hs-identifier hs-var">PathEnd</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464275"><span class="hs-identifier hs-var">parent</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-353"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LeftmostSingle s f -&gt; Leftmost s f h
forall s f h. LeftmostSingle s f -&gt; Leftmost s f h
</span><a href="Common.html#LMSingle"><span class="hs-identifier hs-var">LMSingle</span></a></span><span> </span><span class="annot"><span class="annottext">LeftmostSingle s f
</span><a href="#local-6989586621679464276"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Leftmost s f h -&gt; [Leftmost s f h] -&gt; [Leftmost s f h]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679464254"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-354"></span><span>              </span><span class="hs-comment">-- picked thaw</span><span>
</span><span id="line-355"></span><span>              </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#ActionDouble"><span class="hs-identifier hs-type">ActionDouble</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#DoubleParent"><span class="hs-identifier hs-type">DoubleParent</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679464277"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464277"><span class="hs-identifier hs-var">thawed</span></a></span></span><span> </span><span class="annot"><span class="annottext">slc
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">tr
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679464278"><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><a href="#local-6989586621679464278"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-356"></span><span>                </span><span class="annot"><span class="annottext">GreedyState tr tr' slc (Leftmost s f h)
-&gt; ExceptT
     String
     m
     (Either
        (GreedyState tr tr' slc (Leftmost s f h)) (tr, [Leftmost s f h]))
forall {a} {b}. a -&gt; ExceptT String m (Either a b)
</span><a href="#local-6989586621679464227"><span class="hs-identifier hs-var">continue</span></a></span><span> </span><span class="annot"><span class="annottext">(GreedyState tr tr' slc (Leftmost s f h)
 -&gt; ExceptT
      String
      m
      (Either
         (GreedyState tr tr' slc (Leftmost s f h)) (tr, [Leftmost s f h])))
-&gt; GreedyState tr tr' slc (Leftmost s f h)
-&gt; ExceptT
     String
     m
     (Either
        (GreedyState tr tr' slc (Leftmost s f h)) (tr, [Leftmost s f h]))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Path tr slc
-&gt; [Leftmost s f h] -&gt; GreedyState tr tr' slc (Leftmost s f h)
forall tr tr' slc op.
Path tr slc -&gt; [op] -&gt; GreedyState tr tr' slc op
</span><a href="GreedyParser.html#GSOpen"><span class="hs-identifier hs-var">GSOpen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">tr -&gt; slc -&gt; Path tr slc -&gt; Path tr slc
forall around between.
around -&gt; between -&gt; Path around between -&gt; Path around between
</span><a href="Common.html#Path"><span class="hs-identifier hs-var">Path</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464277"><span class="hs-identifier hs-var">thawed</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464252"><span class="hs-identifier hs-var">mid</span></a></span><span> </span><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679464253"><span class="hs-identifier hs-var">open</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LeftmostDouble s f h -&gt; Leftmost s f h
forall s f h. LeftmostDouble s f h -&gt; Leftmost s f h
</span><a href="Common.html#LMDouble"><span class="hs-identifier hs-var">LMDouble</span></a></span><span> </span><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><a href="#local-6989586621679464278"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Leftmost s f h -&gt; [Leftmost s f h] -&gt; [Leftmost s f h]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679464254"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-357"></span><span>          </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679464279"><span class="annot"><span class="annottext">Maybe tr'
</span><a href="#local-6989586621679464279"><span class="hs-identifier hs-var">tfrozen</span></a></span></span><span> </span><span id="local-6989586621679464280"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464280"><span class="hs-identifier hs-var">sfrozen</span></a></span></span><span> </span><span id="local-6989586621679464281"><span class="annot"><span class="annottext">Path (Maybe tr') slc
</span><a href="#local-6989586621679464281"><span class="hs-identifier hs-var">rstFrozen</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-358"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679464283"><span class="annot"><span class="annottext">thaws :: [Either a (ActionDouble slc tr s f h)]
</span><a href="#local-6989586621679464283"><span class="hs-identifier hs-var hs-var hs-var">thaws</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-359"></span><span>                  </span><span class="annot"><span class="annottext">ActionDouble slc tr s f h -&gt; Either a (ActionDouble slc tr s f h)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span>
</span><span id="line-360"></span><span>                    </span><span class="annot"><span class="annottext">(ActionDouble slc tr s f h -&gt; Either a (ActionDouble slc tr s f h))
-&gt; [ActionDouble slc tr s f h]
-&gt; [Either a (ActionDouble slc tr s f h)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; StartStop slc
-&gt; Maybe tr'
-&gt; slc
-&gt; tr
-&gt; StartStop slc
-&gt; [ActionDouble slc tr s f h]
forall tr tr' slc slc' h s f.
Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; StartStop slc
-&gt; Maybe tr'
-&gt; slc
-&gt; tr
-&gt; StartStop slc
-&gt; [ActionDouble slc tr s f h]
</span><a href="GreedyParser.html#collectThawLeft"><span class="hs-identifier hs-var">collectThawLeft</span></a></span><span>
</span><span id="line-361"></span><span>                      </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
</span><a href="#local-6989586621679464208"><span class="hs-identifier hs-var">eval</span></a></span><span>
</span><span id="line-362"></span><span>                      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">slc -&gt; StartStop slc
forall a. a -&gt; StartStop a
</span><a href="Common.html#Inner"><span class="hs-identifier hs-var">Inner</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464280"><span class="hs-identifier hs-var">sfrozen</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-363"></span><span>                      </span><span class="annot"><span class="annottext">Maybe tr'
</span><a href="#local-6989586621679464279"><span class="hs-identifier hs-var">tfrozen</span></a></span><span>
</span><span id="line-364"></span><span>                      </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464252"><span class="hs-identifier hs-var">mid</span></a></span><span>
</span><span id="line-365"></span><span>                      </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464265"><span class="hs-identifier hs-var">topenl</span></a></span><span>
</span><span id="line-366"></span><span>                      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">slc -&gt; StartStop slc
forall a. a -&gt; StartStop a
</span><a href="Common.html#Inner"><span class="hs-identifier hs-var">Inner</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464266"><span class="hs-identifier hs-var">sopen</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-367"></span><span>            </span><span id="local-6989586621679464284"><span class="annot"><a href="#local-6989586621679464284"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Action slc tr s f h] -&gt; ExceptT String m (Action slc tr s f h)
</span><a href="#local-6989586621679464209"><span class="hs-identifier hs-var">pick</span></a></span><span> </span><span class="annot"><span class="annottext">([Action slc tr s f h] -&gt; ExceptT String m (Action slc tr s f h))
-&gt; [Action slc tr s f h] -&gt; ExceptT String m (Action slc tr s f h)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[Action slc tr s f h]
forall {a}. [Either a (ActionDouble slc tr s f h)]
</span><a href="#local-6989586621679464283"><span class="hs-identifier hs-var">thaws</span></a></span><span> </span><span class="annot"><span class="annottext">[Action slc tr s f h]
-&gt; [Action slc tr s f h] -&gt; [Action slc tr s f h]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[Action slc tr s f h]
forall {b}. [Either (ActionSingle slc tr s f) b]
</span><a href="#local-6989586621679464269"><span class="hs-identifier hs-var">unsplits</span></a></span><span>
</span><span id="line-368"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621679464284"><span class="hs-identifier hs-type">action</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-369"></span><span>              </span><span class="hs-comment">-- picked unsplit</span><span>
</span><span id="line-370"></span><span>              </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#ActionSingle"><span class="hs-identifier hs-type">ActionSingle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#SingleParent"><span class="hs-identifier hs-type">SingleParent</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679464285"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464285"><span class="hs-identifier hs-var">parent</span></a></span></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679464286"><span class="annot"><span class="annottext">LeftmostSingle s f
</span><a href="#local-6989586621679464286"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-371"></span><span>                </span><span class="annot"><span class="annottext">GreedyState tr tr' slc (Leftmost s f h)
-&gt; ExceptT
     String
     m
     (Either
        (GreedyState tr tr' slc (Leftmost s f h)) (tr, [Leftmost s f h]))
forall {a} {b}. a -&gt; ExceptT String m (Either a b)
</span><a href="#local-6989586621679464227"><span class="hs-identifier hs-var">continue</span></a></span><span> </span><span class="annot"><span class="annottext">(GreedyState tr tr' slc (Leftmost s f h)
 -&gt; ExceptT
      String
      m
      (Either
         (GreedyState tr tr' slc (Leftmost s f h)) (tr, [Leftmost s f h])))
-&gt; GreedyState tr tr' slc (Leftmost s f h)
-&gt; ExceptT
     String
     m
     (Either
        (GreedyState tr tr' slc (Leftmost s f h)) (tr, [Leftmost s f h]))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-372"></span><span>                  </span><span class="annot"><span class="annottext">Path (Maybe tr') slc
-&gt; slc
-&gt; Path tr slc
-&gt; [Leftmost s f h]
-&gt; GreedyState tr tr' slc (Leftmost s f h)
forall tr tr' slc op.
Path (Maybe tr') slc
-&gt; slc -&gt; Path tr slc -&gt; [op] -&gt; GreedyState tr tr' slc op
</span><a href="GreedyParser.html#GSSemiOpen"><span class="hs-identifier hs-var">GSSemiOpen</span></a></span><span>
</span><span id="line-373"></span><span>                    </span><span class="annot"><span class="annottext">Path (Maybe tr') slc
</span><a href="#local-6989586621679464251"><span class="hs-identifier hs-var">frozen</span></a></span><span>
</span><span id="line-374"></span><span>                    </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464252"><span class="hs-identifier hs-var">mid</span></a></span><span>
</span><span id="line-375"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">tr -&gt; Path tr slc
forall around between. around -&gt; Path around between
</span><a href="Common.html#PathEnd"><span class="hs-identifier hs-var">PathEnd</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464285"><span class="hs-identifier hs-var">parent</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-376"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LeftmostSingle s f -&gt; Leftmost s f h
forall s f h. LeftmostSingle s f -&gt; Leftmost s f h
</span><a href="Common.html#LMSingle"><span class="hs-identifier hs-var">LMSingle</span></a></span><span> </span><span class="annot"><span class="annottext">LeftmostSingle s f
</span><a href="#local-6989586621679464286"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Leftmost s f h -&gt; [Leftmost s f h] -&gt; [Leftmost s f h]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679464254"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-377"></span><span>              </span><span class="hs-comment">-- picked thaw</span><span>
</span><span id="line-378"></span><span>              </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#ActionDouble"><span class="hs-identifier hs-type">ActionDouble</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#DoubleParent"><span class="hs-identifier hs-type">DoubleParent</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679464287"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464287"><span class="hs-identifier hs-var">thawed</span></a></span></span><span> </span><span class="annot"><span class="annottext">slc
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">tr
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679464288"><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><a href="#local-6989586621679464288"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-379"></span><span>                </span><span class="annot"><span class="annottext">GreedyState tr tr' slc (Leftmost s f h)
-&gt; ExceptT
     String
     m
     (Either
        (GreedyState tr tr' slc (Leftmost s f h)) (tr, [Leftmost s f h]))
forall {a} {b}. a -&gt; ExceptT String m (Either a b)
</span><a href="#local-6989586621679464227"><span class="hs-identifier hs-var">continue</span></a></span><span> </span><span class="annot"><span class="annottext">(GreedyState tr tr' slc (Leftmost s f h)
 -&gt; ExceptT
      String
      m
      (Either
         (GreedyState tr tr' slc (Leftmost s f h)) (tr, [Leftmost s f h])))
-&gt; GreedyState tr tr' slc (Leftmost s f h)
-&gt; ExceptT
     String
     m
     (Either
        (GreedyState tr tr' slc (Leftmost s f h)) (tr, [Leftmost s f h]))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-380"></span><span>                  </span><span class="annot"><span class="annottext">Path (Maybe tr') slc
-&gt; slc
-&gt; Path tr slc
-&gt; [Leftmost s f h]
-&gt; GreedyState tr tr' slc (Leftmost s f h)
forall tr tr' slc op.
Path (Maybe tr') slc
-&gt; slc -&gt; Path tr slc -&gt; [op] -&gt; GreedyState tr tr' slc op
</span><a href="GreedyParser.html#GSSemiOpen"><span class="hs-identifier hs-var">GSSemiOpen</span></a></span><span>
</span><span id="line-381"></span><span>                    </span><span class="annot"><span class="annottext">Path (Maybe tr') slc
</span><a href="#local-6989586621679464281"><span class="hs-identifier hs-var">rstFrozen</span></a></span><span>
</span><span id="line-382"></span><span>                    </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464280"><span class="hs-identifier hs-var">sfrozen</span></a></span><span>
</span><span id="line-383"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">tr -&gt; slc -&gt; Path tr slc -&gt; Path tr slc
forall around between.
around -&gt; between -&gt; Path around between -&gt; Path around between
</span><a href="Common.html#Path"><span class="hs-identifier hs-var">Path</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464287"><span class="hs-identifier hs-var">thawed</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464252"><span class="hs-identifier hs-var">mid</span></a></span><span> </span><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679464253"><span class="hs-identifier hs-var">open</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-384"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LeftmostDouble s f h -&gt; Leftmost s f h
forall s f h. LeftmostDouble s f h -&gt; Leftmost s f h
</span><a href="Common.html#LMDouble"><span class="hs-identifier hs-var">LMDouble</span></a></span><span> </span><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><a href="#local-6989586621679464288"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Leftmost s f h -&gt; [Leftmost s f h] -&gt; [Leftmost s f h]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679464254"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-385"></span><span>      </span><span class="hs-comment">-- more than two open transitions: thaw or any double operation</span><span>
</span><span id="line-386"></span><span>      </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679464289"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464289"><span class="hs-identifier hs-var">topenl</span></a></span></span><span> </span><span id="local-6989586621679464290"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464290"><span class="hs-identifier hs-var">sopenl</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679464291"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464291"><span class="hs-identifier hs-var">topenm</span></a></span></span><span> </span><span id="local-6989586621679464292"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464292"><span class="hs-identifier hs-var">sopenr</span></a></span></span><span> </span><span id="local-6989586621679464293"><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679464293"><span class="hs-identifier hs-var">rstOpen</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-387"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679464294"><span class="annot"><span class="annottext">doubles :: [ActionDouble slc tr s f h]
</span><a href="#local-6989586621679464294"><span class="hs-identifier hs-var hs-var">doubles</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-388"></span><span>              </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; StartStop slc
-&gt; tr
-&gt; slc
-&gt; tr
-&gt; slc
-&gt; Path tr slc
-&gt; Bool
-&gt; [ActionDouble slc tr s f h]
forall tr tr' slc slc' h s f.
Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; StartStop slc
-&gt; tr
-&gt; slc
-&gt; tr
-&gt; slc
-&gt; Path tr slc
-&gt; Bool
-&gt; [ActionDouble slc tr s f h]
</span><a href="GreedyParser.html#collectDoubles"><span class="hs-identifier hs-var">collectDoubles</span></a></span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
</span><a href="#local-6989586621679464208"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">slc -&gt; StartStop slc
forall a. a -&gt; StartStop a
</span><a href="Common.html#Inner"><span class="hs-identifier hs-var">Inner</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464252"><span class="hs-identifier hs-var">mid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464289"><span class="hs-identifier hs-var">topenl</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464290"><span class="hs-identifier hs-var">sopenl</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464291"><span class="hs-identifier hs-var">topenm</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464292"><span class="hs-identifier hs-var">sopenr</span></a></span><span> </span><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679464293"><span class="hs-identifier hs-var">rstOpen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Leftmost s f h] -&gt; Bool
forall s f h. [Leftmost s f h] -&gt; Bool
</span><a href="GreedyParser.html#lastWasLeft"><span class="hs-identifier hs-var">lastWasLeft</span></a></span><span> </span><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679464254"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-389"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Path (Maybe tr') slc
</span><a href="#local-6989586621679464251"><span class="hs-identifier hs-var">frozen</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-390"></span><span>          </span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span id="local-6989586621679464295"><span class="annot"><span class="annottext">Maybe tr'
</span><a href="#local-6989586621679464295"><span class="hs-identifier hs-var">tfrozen</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-391"></span><span>            </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679464296"><span class="annot"><span class="annottext">thaws :: [ActionDouble slc tr s f h]
</span><a href="#local-6989586621679464296"><span class="hs-identifier hs-var hs-var hs-var">thaws</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-392"></span><span>                  </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; StartStop slc
-&gt; Maybe tr'
-&gt; slc
-&gt; tr
-&gt; StartStop slc
-&gt; [ActionDouble slc tr s f h]
forall tr tr' slc slc' h s f.
Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; StartStop slc
-&gt; Maybe tr'
-&gt; slc
-&gt; tr
-&gt; StartStop slc
-&gt; [ActionDouble slc tr s f h]
</span><a href="GreedyParser.html#collectThawLeft"><span class="hs-identifier hs-var">collectThawLeft</span></a></span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
</span><a href="#local-6989586621679464208"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
forall a. StartStop a
</span><a href="Common.html#Start"><span class="hs-identifier hs-var">Start</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe tr'
</span><a href="#local-6989586621679464295"><span class="hs-identifier hs-var">tfrozen</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464252"><span class="hs-identifier hs-var">mid</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464289"><span class="hs-identifier hs-var">topenl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">slc -&gt; StartStop slc
forall a. a -&gt; StartStop a
</span><a href="Common.html#Inner"><span class="hs-identifier hs-var">Inner</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464290"><span class="hs-identifier hs-var">sopenl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-393"></span><span>            </span><span id="local-6989586621679464297"><span class="annot"><a href="#local-6989586621679464297"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[ActionDouble slc tr s f h]
-&gt; ExceptT String m ((tr, slc, tr), LeftmostDouble s f h)
</span><a href="#local-6989586621679464249"><span class="hs-identifier hs-var">pickDouble</span></a></span><span> </span><span class="annot"><span class="annottext">([ActionDouble slc tr s f h]
 -&gt; ExceptT String m ((tr, slc, tr), LeftmostDouble s f h))
-&gt; [ActionDouble slc tr s f h]
-&gt; ExceptT String m ((tr, slc, tr), LeftmostDouble s f h)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[ActionDouble slc tr s f h]
</span><a href="#local-6989586621679464296"><span class="hs-identifier hs-var">thaws</span></a></span><span> </span><span class="annot"><span class="annottext">[ActionDouble slc tr s f h]
-&gt; [ActionDouble slc tr s f h] -&gt; [ActionDouble slc tr s f h]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[ActionDouble slc tr s f h]
</span><a href="#local-6989586621679464294"><span class="hs-identifier hs-var">doubles</span></a></span><span>
</span><span id="line-394"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621679464297"><span class="hs-identifier hs-type">action</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-395"></span><span>              </span><span class="hs-comment">-- picked thaw</span><span>
</span><span id="line-396"></span><span>              </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679464298"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464298"><span class="hs-identifier hs-var">thawed</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">slc
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tr
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679464299"><span class="annot"><span class="annottext">op :: LeftmostDouble s f h
</span><a href="#local-6989586621679464299"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Common.html#LMDoubleFreezeLeft"><span class="hs-identifier hs-type">LMDoubleFreezeLeft</span></a></span><span> </span><span class="annot"><span class="annottext">f
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-397"></span><span>                </span><span class="annot"><span class="annottext">GreedyState tr tr' slc (Leftmost s f h)
-&gt; ExceptT
     String
     m
     (Either
        (GreedyState tr tr' slc (Leftmost s f h)) (tr, [Leftmost s f h]))
forall {a} {b}. a -&gt; ExceptT String m (Either a b)
</span><a href="#local-6989586621679464227"><span class="hs-identifier hs-var">continue</span></a></span><span> </span><span class="annot"><span class="annottext">(GreedyState tr tr' slc (Leftmost s f h)
 -&gt; ExceptT
      String
      m
      (Either
         (GreedyState tr tr' slc (Leftmost s f h)) (tr, [Leftmost s f h])))
-&gt; GreedyState tr tr' slc (Leftmost s f h)
-&gt; ExceptT
     String
     m
     (Either
        (GreedyState tr tr' slc (Leftmost s f h)) (tr, [Leftmost s f h]))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Path tr slc
-&gt; [Leftmost s f h] -&gt; GreedyState tr tr' slc (Leftmost s f h)
forall tr tr' slc op.
Path tr slc -&gt; [op] -&gt; GreedyState tr tr' slc op
</span><a href="GreedyParser.html#GSOpen"><span class="hs-identifier hs-var">GSOpen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">tr -&gt; slc -&gt; Path tr slc -&gt; Path tr slc
forall around between.
around -&gt; between -&gt; Path around between -&gt; Path around between
</span><a href="Common.html#Path"><span class="hs-identifier hs-var">Path</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464298"><span class="hs-identifier hs-var">thawed</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464252"><span class="hs-identifier hs-var">mid</span></a></span><span> </span><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679464253"><span class="hs-identifier hs-var">open</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LeftmostDouble s f h -&gt; Leftmost s f h
forall s f h. LeftmostDouble s f h -&gt; Leftmost s f h
</span><a href="Common.html#LMDouble"><span class="hs-identifier hs-var">LMDouble</span></a></span><span> </span><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><a href="#local-6989586621679464299"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Leftmost s f h -&gt; [Leftmost s f h] -&gt; [Leftmost s f h]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679464254"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-398"></span><span>              </span><span class="hs-comment">-- picked non-thaw</span><span>
</span><span id="line-399"></span><span>              </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679464300"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464300"><span class="hs-identifier hs-var">topl</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679464301"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464301"><span class="hs-identifier hs-var">tops</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679464302"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464302"><span class="hs-identifier hs-var">topr</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679464303"><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><a href="#local-6989586621679464303"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-400"></span><span>                </span><span class="annot"><span class="annottext">GreedyState tr tr' slc (Leftmost s f h)
-&gt; ExceptT
     String
     m
     (Either
        (GreedyState tr tr' slc (Leftmost s f h)) (tr, [Leftmost s f h]))
forall {a} {b}. a -&gt; ExceptT String m (Either a b)
</span><a href="#local-6989586621679464227"><span class="hs-identifier hs-var">continue</span></a></span><span> </span><span class="annot"><span class="annottext">(GreedyState tr tr' slc (Leftmost s f h)
 -&gt; ExceptT
      String
      m
      (Either
         (GreedyState tr tr' slc (Leftmost s f h)) (tr, [Leftmost s f h])))
-&gt; GreedyState tr tr' slc (Leftmost s f h)
-&gt; ExceptT
     String
     m
     (Either
        (GreedyState tr tr' slc (Leftmost s f h)) (tr, [Leftmost s f h]))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-401"></span><span>                  </span><span class="annot"><span class="annottext">Path (Maybe tr') slc
-&gt; slc
-&gt; Path tr slc
-&gt; [Leftmost s f h]
-&gt; GreedyState tr tr' slc (Leftmost s f h)
forall tr tr' slc op.
Path (Maybe tr') slc
-&gt; slc -&gt; Path tr slc -&gt; [op] -&gt; GreedyState tr tr' slc op
</span><a href="GreedyParser.html#GSSemiOpen"><span class="hs-identifier hs-var">GSSemiOpen</span></a></span><span>
</span><span id="line-402"></span><span>                    </span><span class="annot"><span class="annottext">Path (Maybe tr') slc
</span><a href="#local-6989586621679464251"><span class="hs-identifier hs-var">frozen</span></a></span><span>
</span><span id="line-403"></span><span>                    </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464252"><span class="hs-identifier hs-var">mid</span></a></span><span>
</span><span id="line-404"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">tr -&gt; slc -&gt; Path tr slc -&gt; Path tr slc
forall around between.
around -&gt; between -&gt; Path around between -&gt; Path around between
</span><a href="Common.html#Path"><span class="hs-identifier hs-var">Path</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464300"><span class="hs-identifier hs-var">topl</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464301"><span class="hs-identifier hs-var">tops</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Path tr slc -&gt; tr -&gt; Path tr slc
forall a b. Path a b -&gt; a -&gt; Path a b
</span><a href="Common.html#pathSetHead"><span class="hs-identifier hs-var">pathSetHead</span></a></span><span> </span><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679464293"><span class="hs-identifier hs-var">rstOpen</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464302"><span class="hs-identifier hs-var">topr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-405"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LeftmostDouble s f h -&gt; Leftmost s f h
forall s f h. LeftmostDouble s f h -&gt; Leftmost s f h
</span><a href="Common.html#LMDouble"><span class="hs-identifier hs-var">LMDouble</span></a></span><span> </span><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><a href="#local-6989586621679464303"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Leftmost s f h -&gt; [Leftmost s f h] -&gt; [Leftmost s f h]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679464254"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-406"></span><span>          </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679464304"><span class="annot"><span class="annottext">Maybe tr'
</span><a href="#local-6989586621679464304"><span class="hs-identifier hs-var">tfrozen</span></a></span></span><span> </span><span id="local-6989586621679464305"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464305"><span class="hs-identifier hs-var">sfrozen</span></a></span></span><span> </span><span id="local-6989586621679464306"><span class="annot"><span class="annottext">Path (Maybe tr') slc
</span><a href="#local-6989586621679464306"><span class="hs-identifier hs-var">rstFrozen</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-407"></span><span>            </span><span class="hs-keyword">let</span><span>
</span><span id="line-408"></span><span>              </span><span id="local-6989586621679464307"><span class="annot"><span class="annottext">thaws :: [ActionDouble slc tr s f h]
</span><a href="#local-6989586621679464307"><span class="hs-identifier hs-var hs-var hs-var">thaws</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-409"></span><span>                </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; StartStop slc
-&gt; Maybe tr'
-&gt; slc
-&gt; tr
-&gt; StartStop slc
-&gt; [ActionDouble slc tr s f h]
forall tr tr' slc slc' h s f.
Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; StartStop slc
-&gt; Maybe tr'
-&gt; slc
-&gt; tr
-&gt; StartStop slc
-&gt; [ActionDouble slc tr s f h]
</span><a href="GreedyParser.html#collectThawLeft"><span class="hs-identifier hs-var">collectThawLeft</span></a></span><span>
</span><span id="line-410"></span><span>                  </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
</span><a href="#local-6989586621679464208"><span class="hs-identifier hs-var">eval</span></a></span><span>
</span><span id="line-411"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">slc -&gt; StartStop slc
forall a. a -&gt; StartStop a
</span><a href="Common.html#Inner"><span class="hs-identifier hs-var">Inner</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464305"><span class="hs-identifier hs-var">sfrozen</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-412"></span><span>                  </span><span class="annot"><span class="annottext">Maybe tr'
</span><a href="#local-6989586621679464304"><span class="hs-identifier hs-var">tfrozen</span></a></span><span>
</span><span id="line-413"></span><span>                  </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464252"><span class="hs-identifier hs-var">mid</span></a></span><span>
</span><span id="line-414"></span><span>                  </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464289"><span class="hs-identifier hs-var">topenl</span></a></span><span>
</span><span id="line-415"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">slc -&gt; StartStop slc
forall a. a -&gt; StartStop a
</span><a href="Common.html#Inner"><span class="hs-identifier hs-var">Inner</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464290"><span class="hs-identifier hs-var">sopenl</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-416"></span><span>            </span><span id="local-6989586621679464308"><span class="annot"><a href="#local-6989586621679464308"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[ActionDouble slc tr s f h]
-&gt; ExceptT String m ((tr, slc, tr), LeftmostDouble s f h)
</span><a href="#local-6989586621679464249"><span class="hs-identifier hs-var">pickDouble</span></a></span><span> </span><span class="annot"><span class="annottext">([ActionDouble slc tr s f h]
 -&gt; ExceptT String m ((tr, slc, tr), LeftmostDouble s f h))
-&gt; [ActionDouble slc tr s f h]
-&gt; ExceptT String m ((tr, slc, tr), LeftmostDouble s f h)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[ActionDouble slc tr s f h]
</span><a href="#local-6989586621679464307"><span class="hs-identifier hs-var">thaws</span></a></span><span> </span><span class="annot"><span class="annottext">[ActionDouble slc tr s f h]
-&gt; [ActionDouble slc tr s f h] -&gt; [ActionDouble slc tr s f h]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[ActionDouble slc tr s f h]
</span><a href="#local-6989586621679464294"><span class="hs-identifier hs-var">doubles</span></a></span><span>
</span><span id="line-417"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621679464308"><span class="hs-identifier hs-type">action</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-418"></span><span>              </span><span class="hs-comment">-- picked thaw</span><span>
</span><span id="line-419"></span><span>              </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679464309"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464309"><span class="hs-identifier hs-var">thawed</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">slc
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tr
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679464310"><span class="annot"><span class="annottext">op :: LeftmostDouble s f h
</span><a href="#local-6989586621679464310"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Common.html#LMDoubleFreezeLeft"><span class="hs-identifier hs-type">LMDoubleFreezeLeft</span></a></span><span> </span><span class="annot"><span class="annottext">f
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-420"></span><span>                </span><span class="annot"><span class="annottext">GreedyState tr tr' slc (Leftmost s f h)
-&gt; ExceptT
     String
     m
     (Either
        (GreedyState tr tr' slc (Leftmost s f h)) (tr, [Leftmost s f h]))
forall {a} {b}. a -&gt; ExceptT String m (Either a b)
</span><a href="#local-6989586621679464227"><span class="hs-identifier hs-var">continue</span></a></span><span> </span><span class="annot"><span class="annottext">(GreedyState tr tr' slc (Leftmost s f h)
 -&gt; ExceptT
      String
      m
      (Either
         (GreedyState tr tr' slc (Leftmost s f h)) (tr, [Leftmost s f h])))
-&gt; GreedyState tr tr' slc (Leftmost s f h)
-&gt; ExceptT
     String
     m
     (Either
        (GreedyState tr tr' slc (Leftmost s f h)) (tr, [Leftmost s f h]))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-421"></span><span>                  </span><span class="annot"><span class="annottext">Path (Maybe tr') slc
-&gt; slc
-&gt; Path tr slc
-&gt; [Leftmost s f h]
-&gt; GreedyState tr tr' slc (Leftmost s f h)
forall tr tr' slc op.
Path (Maybe tr') slc
-&gt; slc -&gt; Path tr slc -&gt; [op] -&gt; GreedyState tr tr' slc op
</span><a href="GreedyParser.html#GSSemiOpen"><span class="hs-identifier hs-var">GSSemiOpen</span></a></span><span>
</span><span id="line-422"></span><span>                    </span><span class="annot"><span class="annottext">Path (Maybe tr') slc
</span><a href="#local-6989586621679464306"><span class="hs-identifier hs-var">rstFrozen</span></a></span><span>
</span><span id="line-423"></span><span>                    </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464305"><span class="hs-identifier hs-var">sfrozen</span></a></span><span>
</span><span id="line-424"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">tr -&gt; slc -&gt; Path tr slc -&gt; Path tr slc
forall around between.
around -&gt; between -&gt; Path around between -&gt; Path around between
</span><a href="Common.html#Path"><span class="hs-identifier hs-var">Path</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464309"><span class="hs-identifier hs-var">thawed</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464252"><span class="hs-identifier hs-var">mid</span></a></span><span> </span><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679464253"><span class="hs-identifier hs-var">open</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-425"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LeftmostDouble s f h -&gt; Leftmost s f h
forall s f h. LeftmostDouble s f h -&gt; Leftmost s f h
</span><a href="Common.html#LMDouble"><span class="hs-identifier hs-var">LMDouble</span></a></span><span> </span><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><a href="#local-6989586621679464310"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Leftmost s f h -&gt; [Leftmost s f h] -&gt; [Leftmost s f h]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679464254"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-426"></span><span>              </span><span class="hs-comment">-- picked non-thaw</span><span>
</span><span id="line-427"></span><span>              </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679464311"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464311"><span class="hs-identifier hs-var">topl</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679464312"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464312"><span class="hs-identifier hs-var">tops</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679464313"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464313"><span class="hs-identifier hs-var">topr</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679464314"><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><a href="#local-6989586621679464314"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-428"></span><span>                </span><span class="annot"><span class="annottext">GreedyState tr tr' slc (Leftmost s f h)
-&gt; ExceptT
     String
     m
     (Either
        (GreedyState tr tr' slc (Leftmost s f h)) (tr, [Leftmost s f h]))
forall {a} {b}. a -&gt; ExceptT String m (Either a b)
</span><a href="#local-6989586621679464227"><span class="hs-identifier hs-var">continue</span></a></span><span> </span><span class="annot"><span class="annottext">(GreedyState tr tr' slc (Leftmost s f h)
 -&gt; ExceptT
      String
      m
      (Either
         (GreedyState tr tr' slc (Leftmost s f h)) (tr, [Leftmost s f h])))
-&gt; GreedyState tr tr' slc (Leftmost s f h)
-&gt; ExceptT
     String
     m
     (Either
        (GreedyState tr tr' slc (Leftmost s f h)) (tr, [Leftmost s f h]))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-429"></span><span>                  </span><span class="annot"><span class="annottext">Path (Maybe tr') slc
-&gt; slc
-&gt; Path tr slc
-&gt; [Leftmost s f h]
-&gt; GreedyState tr tr' slc (Leftmost s f h)
forall tr tr' slc op.
Path (Maybe tr') slc
-&gt; slc -&gt; Path tr slc -&gt; [op] -&gt; GreedyState tr tr' slc op
</span><a href="GreedyParser.html#GSSemiOpen"><span class="hs-identifier hs-var">GSSemiOpen</span></a></span><span>
</span><span id="line-430"></span><span>                    </span><span class="annot"><span class="annottext">Path (Maybe tr') slc
</span><a href="#local-6989586621679464251"><span class="hs-identifier hs-var">frozen</span></a></span><span>
</span><span id="line-431"></span><span>                    </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464252"><span class="hs-identifier hs-var">mid</span></a></span><span>
</span><span id="line-432"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">tr -&gt; slc -&gt; Path tr slc -&gt; Path tr slc
forall around between.
around -&gt; between -&gt; Path around between -&gt; Path around between
</span><a href="Common.html#Path"><span class="hs-identifier hs-var">Path</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464311"><span class="hs-identifier hs-var">topl</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464312"><span class="hs-identifier hs-var">tops</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Path tr slc -&gt; tr -&gt; Path tr slc
forall a b. Path a b -&gt; a -&gt; Path a b
</span><a href="Common.html#pathSetHead"><span class="hs-identifier hs-var">pathSetHead</span></a></span><span> </span><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679464293"><span class="hs-identifier hs-var">rstOpen</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464313"><span class="hs-identifier hs-var">topr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-433"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LeftmostDouble s f h -&gt; Leftmost s f h
forall s f h. LeftmostDouble s f h -&gt; Leftmost s f h
</span><a href="Common.html#LMDouble"><span class="hs-identifier hs-var">LMDouble</span></a></span><span> </span><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><a href="#local-6989586621679464314"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Leftmost s f h -&gt; [Leftmost s f h] -&gt; [Leftmost s f h]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679464254"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-434"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-435"></span><span>  </span><span id="local-6989586621679464227"><span class="annot"><span class="annottext">continue :: a -&gt; ExceptT String m (Either a b)
</span><a href="#local-6989586621679464227"><span class="hs-identifier hs-var hs-var">continue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either a b -&gt; ExceptT String m (Either a b)
forall a. a -&gt; ExceptT String m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Either a b -&gt; ExceptT String m (Either a b))
-&gt; (a -&gt; Either a b) -&gt; a -&gt; ExceptT String m (Either a b)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Either a b
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span>
</span><span id="line-436"></span><span>  </span><span id="local-6989586621679464219"><span class="annot"><span class="annottext">finish :: a -&gt; ExceptT String m (Either a a)
</span><a href="#local-6989586621679464219"><span class="hs-identifier hs-var hs-var">finish</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either a a -&gt; ExceptT String m (Either a a)
forall a. a -&gt; ExceptT String m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Either a a -&gt; ExceptT String m (Either a a))
-&gt; (a -&gt; Either a a) -&gt; a -&gt; ExceptT String m (Either a a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Either a a
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span>
</span><span id="line-437"></span><span>
</span><span id="line-438"></span><span>  </span><span class="annot"><a href="#local-6989586621679464215"><span class="hs-identifier hs-type">pickSingle</span></a></span><span>
</span><span id="line-439"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GreedyParser.html#ActionSingle"><span class="hs-identifier hs-type">ActionSingle</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463586"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463584"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463589"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463590"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="#local-6989586621679463583"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679463584"><span class="hs-identifier hs-type">tr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#LeftmostSingle"><span class="hs-identifier hs-type">LeftmostSingle</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463589"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463590"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-440"></span><span>  </span><span id="local-6989586621679464215"><span class="annot"><span class="annottext">pickSingle :: [ActionSingle slc tr s f]
-&gt; ExceptT String m (tr, LeftmostSingle s f)
</span><a href="#local-6989586621679464215"><span class="hs-identifier hs-var hs-var">pickSingle</span></a></span></span><span> </span><span id="local-6989586621679464321"><span class="annot"><span class="annottext">[ActionSingle slc tr s f]
</span><a href="#local-6989586621679464321"><span class="hs-identifier hs-var">actions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-441"></span><span>    </span><span class="hs-comment">-- liftIO $ putStrLn $ &quot;pickSingle &quot; &lt;&gt; show actions</span><span>
</span><span id="line-442"></span><span>    </span><span id="local-6989586621679464322"><span class="annot"><a href="#local-6989586621679464322"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Action slc tr s f h] -&gt; ExceptT String m (Action slc tr s f h)
</span><a href="#local-6989586621679464209"><span class="hs-identifier hs-var">pick</span></a></span><span> </span><span class="annot"><span class="annottext">([Action slc tr s f h] -&gt; ExceptT String m (Action slc tr s f h))
-&gt; [Action slc tr s f h] -&gt; ExceptT String m (Action slc tr s f h)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ActionSingle slc tr s f -&gt; Action slc tr s f h
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(ActionSingle slc tr s f -&gt; Action slc tr s f h)
-&gt; [ActionSingle slc tr s f] -&gt; [Action slc tr s f h]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[ActionSingle slc tr s f]
</span><a href="#local-6989586621679464321"><span class="hs-identifier hs-var">actions</span></a></span><span>
</span><span id="line-443"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621679464322"><span class="hs-identifier hs-type">action</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-444"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#ActionSingle"><span class="hs-identifier hs-type">ActionSingle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#SingleParent"><span class="hs-identifier hs-type">SingleParent</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679464323"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464323"><span class="hs-identifier hs-var">top</span></a></span></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679464324"><span class="annot"><span class="annottext">LeftmostSingle s f
</span><a href="#local-6989586621679464324"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(tr, LeftmostSingle s f)
-&gt; ExceptT String m (tr, LeftmostSingle s f)
forall a. a -&gt; ExceptT String m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464323"><span class="hs-identifier hs-var">top</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LeftmostSingle s f
</span><a href="#local-6989586621679464324"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-445"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="annot"><span class="annottext">ActionDouble slc tr s f h
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; ExceptT String m (tr, LeftmostSingle s f)
forall a. String -&gt; ExceptT String m a
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;pickSingle returned a double action&quot;</span></span><span>
</span><span id="line-446"></span><span>
</span><span id="line-447"></span><span>  </span><span class="annot"><a href="#local-6989586621679464249"><span class="hs-identifier hs-type">pickDouble</span></a></span><span>
</span><span id="line-448"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GreedyParser.html#ActionDouble"><span class="hs-identifier hs-type">ActionDouble</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463586"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463584"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463589"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463590"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463588"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-449"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="#local-6989586621679463583"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679463584"><span class="hs-identifier hs-type">tr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679463586"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679463584"><span class="hs-identifier hs-type">tr</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#LeftmostDouble"><span class="hs-identifier hs-type">LeftmostDouble</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463589"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463590"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463588"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-450"></span><span>  </span><span id="local-6989586621679464249"><span class="annot"><span class="annottext">pickDouble :: [ActionDouble slc tr s f h]
-&gt; ExceptT String m ((tr, slc, tr), LeftmostDouble s f h)
</span><a href="#local-6989586621679464249"><span class="hs-identifier hs-var hs-var">pickDouble</span></a></span></span><span> </span><span id="local-6989586621679464325"><span class="annot"><span class="annottext">[ActionDouble slc tr s f h]
</span><a href="#local-6989586621679464325"><span class="hs-identifier hs-var">actions</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-451"></span><span>    </span><span class="hs-comment">-- liftIO $ putStrLn $ &quot;pickDouble &quot; &lt;&gt; show actions</span><span>
</span><span id="line-452"></span><span>    </span><span id="local-6989586621679464326"><span class="annot"><a href="#local-6989586621679464326"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Action slc tr s f h] -&gt; ExceptT String m (Action slc tr s f h)
</span><a href="#local-6989586621679464209"><span class="hs-identifier hs-var">pick</span></a></span><span> </span><span class="annot"><span class="annottext">([Action slc tr s f h] -&gt; ExceptT String m (Action slc tr s f h))
-&gt; [Action slc tr s f h] -&gt; ExceptT String m (Action slc tr s f h)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ActionDouble slc tr s f h -&gt; Action slc tr s f h
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(ActionDouble slc tr s f h -&gt; Action slc tr s f h)
-&gt; [ActionDouble slc tr s f h] -&gt; [Action slc tr s f h]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[ActionDouble slc tr s f h]
</span><a href="#local-6989586621679464325"><span class="hs-identifier hs-var">actions</span></a></span><span>
</span><span id="line-453"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621679464326"><span class="hs-identifier hs-type">action</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-454"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="annot"><span class="annottext">ActionSingle slc tr s f
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; ExceptT String m ((tr, slc, tr), LeftmostDouble s f h)
forall a. String -&gt; ExceptT String m a
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;pickDouble returned a single action&quot;</span></span><span>
</span><span id="line-455"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#ActionDouble"><span class="hs-identifier hs-type">ActionDouble</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#DoubleParent"><span class="hs-identifier hs-type">DoubleParent</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679464327"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464327"><span class="hs-identifier hs-var">topl</span></a></span></span><span> </span><span id="local-6989586621679464328"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464328"><span class="hs-identifier hs-var">tops</span></a></span></span><span> </span><span id="local-6989586621679464329"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464329"><span class="hs-identifier hs-var">topr</span></a></span></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679464330"><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><a href="#local-6989586621679464330"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-456"></span><span>        </span><span class="annot"><span class="annottext">((tr, slc, tr), LeftmostDouble s f h)
-&gt; ExceptT String m ((tr, slc, tr), LeftmostDouble s f h)
forall a. a -&gt; ExceptT String m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464327"><span class="hs-identifier hs-var">topl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464328"><span class="hs-identifier hs-var">tops</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464329"><span class="hs-identifier hs-var">topr</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><a href="#local-6989586621679464330"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-457"></span><span>
</span><span id="line-458"></span><span class="annot"><span class="hs-comment">-- | Enumerates the list of possible actions in the current state</span></span><span>
</span><span id="line-459"></span><span class="annot"><a href="GreedyParser.html#getActions"><span class="hs-identifier hs-type">getActions</span></a></span><span>
</span><span id="line-460"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679463682"><span class="annot"><a href="#local-6989586621679463682"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679463675"><span class="annot"><a href="#local-6989586621679463675"><span class="hs-identifier hs-type">tr</span></a></span></span><span> </span><span id="local-6989586621679463676"><span class="annot"><a href="#local-6989586621679463676"><span class="hs-identifier hs-type">tr'</span></a></span></span><span> </span><span id="local-6989586621679463677"><span class="annot"><a href="#local-6989586621679463677"><span class="hs-identifier hs-type">slc</span></a></span></span><span> </span><span id="local-6989586621679463678"><span class="annot"><a href="#local-6989586621679463678"><span class="hs-identifier hs-type">slc'</span></a></span></span><span> </span><span id="local-6989586621679463680"><span class="annot"><a href="#local-6989586621679463680"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679463681"><span class="annot"><a href="#local-6989586621679463681"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679463679"><span class="annot"><a href="#local-6989586621679463679"><span class="hs-identifier hs-type">h</span></a></span></span><span>
</span><span id="line-461"></span><span>   </span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Common.html#Eval"><span class="hs-identifier hs-type">Eval</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463675"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463676"><span class="hs-identifier hs-type">tr'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463677"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463678"><span class="hs-identifier hs-type">slc'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463679"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Leftmost"><span class="hs-identifier hs-type">Leftmost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463680"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463681"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463679"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-462"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ the evaluator of the grammar to be used</span></span><span>
</span><span id="line-463"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GreedyParser.html#GreedyState"><span class="hs-identifier hs-type">GreedyState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463675"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463676"><span class="hs-identifier hs-type">tr'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463677"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Leftmost"><span class="hs-identifier hs-type">Leftmost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463680"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463681"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463679"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-464"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ the current parsing state</span></span><span>
</span><span id="line-465"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GreedyParser.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463677"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463675"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463680"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463681"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463679"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-466"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ the list of possible actions</span></span><span>
</span><span id="line-467"></span><span id="getActions"><span class="annot"><span class="annottext">getActions :: forall {k} (m :: k) tr tr' slc slc' s f h.
Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; GreedyState tr tr' slc (Leftmost s f h) -&gt; [Action slc tr s f h]
</span><a href="GreedyParser.html#getActions"><span class="hs-identifier hs-var hs-var">getActions</span></a></span></span><span> </span><span id="local-6989586621679464342"><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
</span><a href="#local-6989586621679464342"><span class="hs-identifier hs-var">eval</span></a></span></span><span> </span><span id="local-6989586621679464343"><span class="annot"><span class="annottext">GreedyState tr tr' slc (Leftmost s f h)
</span><a href="#local-6989586621679464343"><span class="hs-identifier hs-var">state</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-468"></span><span>  </span><span class="hs-comment">-- check which type of state we are in</span><span>
</span><span id="line-469"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">GreedyState tr tr' slc (Leftmost s f h)
</span><a href="#local-6989586621679464343"><span class="hs-identifier hs-var">state</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-470"></span><span>    </span><span class="hs-comment">-- case 1: everything frozen</span><span>
</span><span id="line-471"></span><span>    </span><span class="annot"><a href="GreedyParser.html#GSFrozen"><span class="hs-identifier hs-type">GSFrozen</span></a></span><span> </span><span id="local-6989586621679464344"><span class="annot"><span class="annottext">Path (Maybe tr') slc
</span><a href="#local-6989586621679464344"><span class="hs-identifier hs-var">frozen</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Path (Maybe tr') slc
</span><a href="#local-6989586621679464344"><span class="hs-identifier hs-var">frozen</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-472"></span><span>      </span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span id="local-6989586621679464345"><span class="annot"><span class="annottext">Maybe tr'
</span><a href="#local-6989586621679464345"><span class="hs-identifier hs-var">trans</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ActionSingle slc tr s f -&gt; Action slc tr s f h
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(ActionSingle slc tr s f -&gt; Action slc tr s f h)
-&gt; [ActionSingle slc tr s f] -&gt; [Action slc tr s f h]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; StartStop slc
-&gt; Maybe tr'
-&gt; StartStop slc
-&gt; [ActionSingle slc tr s f]
forall tr tr' slc slc' h s f.
Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; StartStop slc
-&gt; Maybe tr'
-&gt; StartStop slc
-&gt; [ActionSingle slc tr s f]
</span><a href="GreedyParser.html#collectThawSingle"><span class="hs-identifier hs-var">collectThawSingle</span></a></span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
</span><a href="#local-6989586621679464342"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
forall a. StartStop a
</span><a href="Common.html#Start"><span class="hs-identifier hs-var">Start</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe tr'
</span><a href="#local-6989586621679464345"><span class="hs-identifier hs-var">trans</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
forall a. StartStop a
</span><a href="Common.html#Stop"><span class="hs-identifier hs-var">Stop</span></a></span><span>
</span><span id="line-473"></span><span>      </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679464346"><span class="annot"><span class="annottext">Maybe tr'
</span><a href="#local-6989586621679464346"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679464347"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464347"><span class="hs-identifier hs-var">slice</span></a></span></span><span> </span><span id="local-6989586621679464348"><span class="annot"><span class="annottext">Path (Maybe tr') slc
</span><a href="#local-6989586621679464348"><span class="hs-identifier hs-var">rst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ActionSingle slc tr s f -&gt; Action slc tr s f h
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(ActionSingle slc tr s f -&gt; Action slc tr s f h)
-&gt; [ActionSingle slc tr s f] -&gt; [Action slc tr s f h]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; StartStop slc
-&gt; Maybe tr'
-&gt; StartStop slc
-&gt; [ActionSingle slc tr s f]
forall tr tr' slc slc' h s f.
Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; StartStop slc
-&gt; Maybe tr'
-&gt; StartStop slc
-&gt; [ActionSingle slc tr s f]
</span><a href="GreedyParser.html#collectThawSingle"><span class="hs-identifier hs-var">collectThawSingle</span></a></span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
</span><a href="#local-6989586621679464342"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">slc -&gt; StartStop slc
forall a. a -&gt; StartStop a
</span><a href="Common.html#Inner"><span class="hs-identifier hs-var">Inner</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464347"><span class="hs-identifier hs-var">slice</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe tr'
</span><a href="#local-6989586621679464346"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
forall a. StartStop a
</span><a href="Common.html#Stop"><span class="hs-identifier hs-var">Stop</span></a></span><span>
</span><span id="line-474"></span><span>    </span><span class="hs-comment">-- case 2: everything open</span><span>
</span><span id="line-475"></span><span>    </span><span class="annot"><a href="GreedyParser.html#GSOpen"><span class="hs-identifier hs-type">GSOpen</span></a></span><span> </span><span id="local-6989586621679464349"><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679464349"><span class="hs-identifier hs-var">open</span></a></span></span><span> </span><span id="local-6989586621679464350"><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679464350"><span class="hs-identifier hs-var">ops</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679464349"><span class="hs-identifier hs-var">open</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-476"></span><span>      </span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span id="local-6989586621679464351"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464351"><span class="hs-identifier hs-var">_t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-477"></span><span>      </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679464352"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464352"><span class="hs-identifier hs-var">tl</span></a></span></span><span> </span><span id="local-6989586621679464353"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464353"><span class="hs-identifier hs-var">slice</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span id="local-6989586621679464354"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464354"><span class="hs-identifier hs-var">tr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ActionSingle slc tr s f -&gt; Action slc tr s f h
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(ActionSingle slc tr s f -&gt; Action slc tr s f h)
-&gt; [ActionSingle slc tr s f] -&gt; [Action slc tr s f h]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; StartStop slc
-&gt; tr
-&gt; slc
-&gt; tr
-&gt; StartStop slc
-&gt; [ActionSingle slc tr s f]
forall tr tr' slc slc' h s f.
Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; StartStop slc
-&gt; tr
-&gt; slc
-&gt; tr
-&gt; StartStop slc
-&gt; [ActionSingle slc tr s f]
</span><a href="GreedyParser.html#collectUnsplitSingle"><span class="hs-identifier hs-var">collectUnsplitSingle</span></a></span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
</span><a href="#local-6989586621679464342"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
forall a. StartStop a
</span><a href="Common.html#Start"><span class="hs-identifier hs-var">Start</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464352"><span class="hs-identifier hs-var">tl</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464353"><span class="hs-identifier hs-var">slice</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464354"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
forall a. StartStop a
</span><a href="Common.html#Stop"><span class="hs-identifier hs-var">Stop</span></a></span><span>
</span><span id="line-478"></span><span>      </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679464355"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464355"><span class="hs-identifier hs-var">tl</span></a></span></span><span> </span><span id="local-6989586621679464356"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464356"><span class="hs-identifier hs-var">sl</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679464357"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464357"><span class="hs-identifier hs-var">tm</span></a></span></span><span> </span><span id="local-6989586621679464358"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464358"><span class="hs-identifier hs-var">sr</span></a></span></span><span> </span><span id="local-6989586621679464359"><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679464359"><span class="hs-identifier hs-var">rst</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ActionDouble slc tr s f h -&gt; Action slc tr s f h
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(ActionDouble slc tr s f h -&gt; Action slc tr s f h)
-&gt; [ActionDouble slc tr s f h] -&gt; [Action slc tr s f h]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; StartStop slc
-&gt; tr
-&gt; slc
-&gt; tr
-&gt; slc
-&gt; Path tr slc
-&gt; Bool
-&gt; [ActionDouble slc tr s f h]
forall tr tr' slc slc' h s f.
Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; StartStop slc
-&gt; tr
-&gt; slc
-&gt; tr
-&gt; slc
-&gt; Path tr slc
-&gt; Bool
-&gt; [ActionDouble slc tr s f h]
</span><a href="GreedyParser.html#collectDoubles"><span class="hs-identifier hs-var">collectDoubles</span></a></span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
</span><a href="#local-6989586621679464342"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
forall a. StartStop a
</span><a href="Common.html#Start"><span class="hs-identifier hs-var">Start</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464355"><span class="hs-identifier hs-var">tl</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464356"><span class="hs-identifier hs-var">sl</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464357"><span class="hs-identifier hs-var">tm</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464358"><span class="hs-identifier hs-var">sr</span></a></span><span> </span><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679464359"><span class="hs-identifier hs-var">rst</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Leftmost s f h] -&gt; Bool
forall s f h. [Leftmost s f h] -&gt; Bool
</span><a href="GreedyParser.html#lastWasLeft"><span class="hs-identifier hs-var">lastWasLeft</span></a></span><span> </span><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679464350"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-479"></span><span>    </span><span class="hs-comment">-- case 3: some parts frozen, some open</span><span>
</span><span id="line-480"></span><span>    </span><span class="hs-comment">-- check how many transitions are open</span><span>
</span><span id="line-481"></span><span>    </span><span class="annot"><a href="GreedyParser.html#GSSemiOpen"><span class="hs-identifier hs-type">GSSemiOpen</span></a></span><span> </span><span id="local-6989586621679464360"><span class="annot"><span class="annottext">Path (Maybe tr') slc
</span><a href="#local-6989586621679464360"><span class="hs-identifier hs-var">frozen</span></a></span></span><span> </span><span id="local-6989586621679464361"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464361"><span class="hs-identifier hs-var">mid</span></a></span></span><span> </span><span id="local-6989586621679464362"><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679464362"><span class="hs-identifier hs-var">open</span></a></span></span><span> </span><span id="local-6989586621679464363"><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679464363"><span class="hs-identifier hs-var">ops</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679464362"><span class="hs-identifier hs-var">open</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-482"></span><span>      </span><span class="hs-comment">-- only one open transition: thaw</span><span>
</span><span id="line-483"></span><span>      </span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span id="local-6989586621679464364"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464364"><span class="hs-identifier hs-var">topen</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ActionDouble slc tr s f h -&gt; Action slc tr s f h
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(ActionDouble slc tr s f h -&gt; Action slc tr s f h)
-&gt; [ActionDouble slc tr s f h] -&gt; [Action slc tr s f h]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; Path (Maybe tr') slc
-&gt; slc
-&gt; tr
-&gt; StartStop slc
-&gt; [ActionDouble slc tr s f h]
forall tr tr' slc slc' h s f.
Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; Path (Maybe tr') slc
-&gt; slc
-&gt; tr
-&gt; StartStop slc
-&gt; [ActionDouble slc tr s f h]
</span><a href="GreedyParser.html#collectAllThawLeft"><span class="hs-identifier hs-var">collectAllThawLeft</span></a></span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
</span><a href="#local-6989586621679464342"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">Path (Maybe tr') slc
</span><a href="#local-6989586621679464360"><span class="hs-identifier hs-var">frozen</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464361"><span class="hs-identifier hs-var">mid</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464364"><span class="hs-identifier hs-var">topen</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
forall a. StartStop a
</span><a href="Common.html#Stop"><span class="hs-identifier hs-var">Stop</span></a></span><span>
</span><span id="line-484"></span><span>      </span><span class="hs-comment">-- two open transitions: thaw or unsplit single</span><span>
</span><span id="line-485"></span><span>      </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679464366"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464366"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621679464367"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464367"><span class="hs-identifier hs-var">s1</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span id="local-6989586621679464368"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464368"><span class="hs-identifier hs-var">t2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-486"></span><span>        </span><span class="hs-keyword">let</span><span>
</span><span id="line-487"></span><span>          </span><span id="local-6989586621679464369"><span class="annot"><span class="annottext">unsplits :: [ActionSingle slc tr s f]
</span><a href="#local-6989586621679464369"><span class="hs-identifier hs-var hs-var">unsplits</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; StartStop slc
-&gt; tr
-&gt; slc
-&gt; tr
-&gt; StartStop slc
-&gt; [ActionSingle slc tr s f]
forall tr tr' slc slc' h s f.
Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; StartStop slc
-&gt; tr
-&gt; slc
-&gt; tr
-&gt; StartStop slc
-&gt; [ActionSingle slc tr s f]
</span><a href="GreedyParser.html#collectUnsplitSingle"><span class="hs-identifier hs-var">collectUnsplitSingle</span></a></span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
</span><a href="#local-6989586621679464342"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">slc -&gt; StartStop slc
forall a. a -&gt; StartStop a
</span><a href="Common.html#Inner"><span class="hs-identifier hs-var">Inner</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464361"><span class="hs-identifier hs-var">mid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464366"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464367"><span class="hs-identifier hs-var">s1</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464368"><span class="hs-identifier hs-var">t2</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
forall a. StartStop a
</span><a href="Common.html#Stop"><span class="hs-identifier hs-var">Stop</span></a></span><span>
</span><span id="line-488"></span><span>          </span><span id="local-6989586621679464370"><span class="annot"><span class="annottext">thaws :: [ActionDouble slc tr s f h]
</span><a href="#local-6989586621679464370"><span class="hs-identifier hs-var hs-var">thaws</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; Path (Maybe tr') slc
-&gt; slc
-&gt; tr
-&gt; StartStop slc
-&gt; [ActionDouble slc tr s f h]
forall tr tr' slc slc' h s f.
Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; Path (Maybe tr') slc
-&gt; slc
-&gt; tr
-&gt; StartStop slc
-&gt; [ActionDouble slc tr s f h]
</span><a href="GreedyParser.html#collectAllThawLeft"><span class="hs-identifier hs-var">collectAllThawLeft</span></a></span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
</span><a href="#local-6989586621679464342"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">Path (Maybe tr') slc
</span><a href="#local-6989586621679464360"><span class="hs-identifier hs-var">frozen</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464361"><span class="hs-identifier hs-var">mid</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464366"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">slc -&gt; StartStop slc
forall a. a -&gt; StartStop a
</span><a href="Common.html#Inner"><span class="hs-identifier hs-var">Inner</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464367"><span class="hs-identifier hs-var">s1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-489"></span><span>         </span><span class="hs-keyword">in</span><span>
</span><span id="line-490"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ActionSingle slc tr s f -&gt; Action slc tr s f h
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">(ActionSingle slc tr s f -&gt; Action slc tr s f h)
-&gt; [ActionSingle slc tr s f] -&gt; [Action slc tr s f h]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[ActionSingle slc tr s f]
</span><a href="#local-6989586621679464369"><span class="hs-identifier hs-var">unsplits</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Action slc tr s f h]
-&gt; [Action slc tr s f h] -&gt; [Action slc tr s f h]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ActionDouble slc tr s f h -&gt; Action slc tr s f h
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(ActionDouble slc tr s f h -&gt; Action slc tr s f h)
-&gt; [ActionDouble slc tr s f h] -&gt; [Action slc tr s f h]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[ActionDouble slc tr s f h]
</span><a href="#local-6989586621679464370"><span class="hs-identifier hs-var">thaws</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-491"></span><span>      </span><span class="hs-comment">-- more than two open transitions: thaw or any double operation</span><span>
</span><span id="line-492"></span><span>      </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679464371"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464371"><span class="hs-identifier hs-var">t1</span></a></span></span><span> </span><span id="local-6989586621679464372"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464372"><span class="hs-identifier hs-var">s1</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679464373"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464373"><span class="hs-identifier hs-var">t2</span></a></span></span><span> </span><span id="local-6989586621679464374"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464374"><span class="hs-identifier hs-var">s2</span></a></span></span><span> </span><span id="local-6989586621679464375"><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679464375"><span class="hs-identifier hs-var">rstOpen</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-493"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679464376"><span class="annot"><span class="annottext">doubles :: [ActionDouble slc tr s f h]
</span><a href="#local-6989586621679464376"><span class="hs-identifier hs-var hs-var">doubles</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; StartStop slc
-&gt; tr
-&gt; slc
-&gt; tr
-&gt; slc
-&gt; Path tr slc
-&gt; Bool
-&gt; [ActionDouble slc tr s f h]
forall tr tr' slc slc' h s f.
Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; StartStop slc
-&gt; tr
-&gt; slc
-&gt; tr
-&gt; slc
-&gt; Path tr slc
-&gt; Bool
-&gt; [ActionDouble slc tr s f h]
</span><a href="GreedyParser.html#collectDoubles"><span class="hs-identifier hs-var">collectDoubles</span></a></span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
</span><a href="#local-6989586621679464342"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">slc -&gt; StartStop slc
forall a. a -&gt; StartStop a
</span><a href="Common.html#Inner"><span class="hs-identifier hs-var">Inner</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464361"><span class="hs-identifier hs-var">mid</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464371"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464372"><span class="hs-identifier hs-var">s1</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464373"><span class="hs-identifier hs-var">t2</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464374"><span class="hs-identifier hs-var">s2</span></a></span><span> </span><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679464375"><span class="hs-identifier hs-var">rstOpen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Leftmost s f h] -&gt; Bool
forall s f h. [Leftmost s f h] -&gt; Bool
</span><a href="GreedyParser.html#lastWasLeft"><span class="hs-identifier hs-var">lastWasLeft</span></a></span><span> </span><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679464363"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-494"></span><span>            </span><span id="local-6989586621679464377"><span class="annot"><span class="annottext">thaws :: [ActionDouble slc tr s f h]
</span><a href="#local-6989586621679464377"><span class="hs-identifier hs-var hs-var">thaws</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; Path (Maybe tr') slc
-&gt; slc
-&gt; tr
-&gt; StartStop slc
-&gt; [ActionDouble slc tr s f h]
forall tr tr' slc slc' h s f.
Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; Path (Maybe tr') slc
-&gt; slc
-&gt; tr
-&gt; StartStop slc
-&gt; [ActionDouble slc tr s f h]
</span><a href="GreedyParser.html#collectAllThawLeft"><span class="hs-identifier hs-var">collectAllThawLeft</span></a></span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
</span><a href="#local-6989586621679464342"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">Path (Maybe tr') slc
</span><a href="#local-6989586621679464360"><span class="hs-identifier hs-var">frozen</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464361"><span class="hs-identifier hs-var">mid</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464371"><span class="hs-identifier hs-var">t1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">slc -&gt; StartStop slc
forall a. a -&gt; StartStop a
</span><a href="Common.html#Inner"><span class="hs-identifier hs-var">Inner</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464372"><span class="hs-identifier hs-var">s1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-495"></span><span>        </span><span class="annot"><span class="annottext">ActionDouble slc tr s f h -&gt; Action slc tr s f h
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(ActionDouble slc tr s f h -&gt; Action slc tr s f h)
-&gt; [ActionDouble slc tr s f h] -&gt; [Action slc tr s f h]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[ActionDouble slc tr s f h]
</span><a href="#local-6989586621679464376"><span class="hs-identifier hs-var">doubles</span></a></span><span> </span><span class="annot"><span class="annottext">[ActionDouble slc tr s f h]
-&gt; [ActionDouble slc tr s f h] -&gt; [ActionDouble slc tr s f h]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[ActionDouble slc tr s f h]
</span><a href="#local-6989586621679464377"><span class="hs-identifier hs-var">thaws</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-496"></span><span>
</span><span id="line-497"></span><span class="hs-comment">-- helper functions for getActions and parseStep</span><span>
</span><span id="line-498"></span><span class="hs-comment">-- ---------------------------------------------</span><span>
</span><span id="line-499"></span><span>
</span><span id="line-500"></span><span id="local-6989586621679463646"><span id="local-6989586621679463647"><span id="local-6989586621679463648"><span class="annot"><a href="GreedyParser.html#lastWasLeft"><span class="hs-identifier hs-type">lastWasLeft</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Common.html#Leftmost"><span class="hs-identifier hs-type">Leftmost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463646"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463647"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463648"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span></span></span><span>
</span><span id="line-501"></span><span id="lastWasLeft"><span class="annot"><span class="annottext">lastWasLeft :: forall s f h. [Leftmost s f h] -&gt; Bool
</span><a href="GreedyParser.html#lastWasLeft"><span class="hs-identifier hs-var hs-var">lastWasLeft</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-502"></span><span class="annot"><a href="GreedyParser.html#lastWasLeft"><span class="hs-identifier hs-var">lastWasLeft</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679464378"><span class="annot"><span class="annottext">Leftmost s f h
</span><a href="#local-6989586621679464378"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><span class="annottext">[Leftmost s f h]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Leftmost s f h
</span><a href="#local-6989586621679464378"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-503"></span><span>  </span><span class="annot"><a href="Common.html#LMSplitLeft"><span class="hs-identifier hs-type">LMSplitLeft</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-504"></span><span>  </span><span class="annot"><a href="Common.html#LMFreezeLeft"><span class="hs-identifier hs-type">LMFreezeLeft</span></a></span><span> </span><span class="annot"><span class="annottext">f
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-505"></span><span>  </span><span class="annot"><span class="annottext">Leftmost s f h
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-506"></span><span>
</span><span id="line-507"></span><span id="local-6989586621679463690"><span id="local-6989586621679463691"><span id="local-6989586621679463692"><span id="local-6989586621679463693"><span id="local-6989586621679463694"><span id="local-6989586621679463695"><span id="local-6989586621679463696"><span class="annot"><a href="GreedyParser.html#collectAllThawLeft"><span class="hs-identifier hs-type">collectAllThawLeft</span></a></span><span>
</span><span id="line-508"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Common.html#Eval"><span class="hs-identifier hs-type">Eval</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463690"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463691"><span class="hs-identifier hs-type">tr'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463692"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463693"><span class="hs-identifier hs-type">slc'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463694"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Leftmost"><span class="hs-identifier hs-type">Leftmost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463695"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463696"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463694"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-509"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679463691"><span class="hs-identifier hs-type">tr'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679463692"><span class="hs-identifier hs-type">slc</span></a></span><span>
</span><span id="line-510"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679463692"><span class="hs-identifier hs-type">slc</span></a></span><span>
</span><span id="line-511"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679463690"><span class="hs-identifier hs-type">tr</span></a></span><span>
</span><span id="line-512"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463692"><span class="hs-identifier hs-type">slc</span></a></span><span>
</span><span id="line-513"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GreedyParser.html#ActionDouble"><span class="hs-identifier hs-type">ActionDouble</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463692"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463690"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463695"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463696"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463694"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">]</span></span></span></span></span></span></span></span><span>
</span><span id="line-514"></span><span id="collectAllThawLeft"><span class="annot"><span class="annottext">collectAllThawLeft :: forall tr tr' slc slc' h s f.
Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; Path (Maybe tr') slc
-&gt; slc
-&gt; tr
-&gt; StartStop slc
-&gt; [ActionDouble slc tr s f h]
</span><a href="GreedyParser.html#collectAllThawLeft"><span class="hs-identifier hs-var hs-var">collectAllThawLeft</span></a></span></span><span> </span><span id="local-6989586621679464381"><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
</span><a href="#local-6989586621679464381"><span class="hs-identifier hs-var">eval</span></a></span></span><span> </span><span id="local-6989586621679464382"><span class="annot"><span class="annottext">Path (Maybe tr') slc
</span><a href="#local-6989586621679464382"><span class="hs-identifier hs-var">frozen</span></a></span></span><span> </span><span id="local-6989586621679464383"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464383"><span class="hs-identifier hs-var">sm</span></a></span></span><span> </span><span id="local-6989586621679464384"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464384"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span id="local-6989586621679464385"><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679464385"><span class="hs-identifier hs-var">sr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-515"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Path (Maybe tr') slc
</span><a href="#local-6989586621679464382"><span class="hs-identifier hs-var">frozen</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-516"></span><span>    </span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span id="local-6989586621679464386"><span class="annot"><span class="annottext">Maybe tr'
</span><a href="#local-6989586621679464386"><span class="hs-identifier hs-var">tfrozen</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; StartStop slc
-&gt; Maybe tr'
-&gt; slc
-&gt; tr
-&gt; StartStop slc
-&gt; [ActionDouble slc tr s f h]
forall tr tr' slc slc' h s f.
Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; StartStop slc
-&gt; Maybe tr'
-&gt; slc
-&gt; tr
-&gt; StartStop slc
-&gt; [ActionDouble slc tr s f h]
</span><a href="GreedyParser.html#collectThawLeft"><span class="hs-identifier hs-var">collectThawLeft</span></a></span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
</span><a href="#local-6989586621679464381"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
forall a. StartStop a
</span><a href="Common.html#Start"><span class="hs-identifier hs-var">Start</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe tr'
</span><a href="#local-6989586621679464386"><span class="hs-identifier hs-var">tfrozen</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464383"><span class="hs-identifier hs-var">sm</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464384"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679464385"><span class="hs-identifier hs-var">sr</span></a></span><span>
</span><span id="line-517"></span><span>    </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679464387"><span class="annot"><span class="annottext">Maybe tr'
</span><a href="#local-6989586621679464387"><span class="hs-identifier hs-var">tfrozen</span></a></span></span><span> </span><span id="local-6989586621679464388"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464388"><span class="hs-identifier hs-var">sl</span></a></span></span><span> </span><span class="annot"><span class="annottext">Path (Maybe tr') slc
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; StartStop slc
-&gt; Maybe tr'
-&gt; slc
-&gt; tr
-&gt; StartStop slc
-&gt; [ActionDouble slc tr s f h]
forall tr tr' slc slc' h s f.
Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; StartStop slc
-&gt; Maybe tr'
-&gt; slc
-&gt; tr
-&gt; StartStop slc
-&gt; [ActionDouble slc tr s f h]
</span><a href="GreedyParser.html#collectThawLeft"><span class="hs-identifier hs-var">collectThawLeft</span></a></span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
</span><a href="#local-6989586621679464381"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">slc -&gt; StartStop slc
forall a. a -&gt; StartStop a
</span><a href="Common.html#Inner"><span class="hs-identifier hs-var">Inner</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464388"><span class="hs-identifier hs-var">sl</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe tr'
</span><a href="#local-6989586621679464387"><span class="hs-identifier hs-var">tfrozen</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464383"><span class="hs-identifier hs-var">sm</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464384"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679464385"><span class="hs-identifier hs-var">sr</span></a></span><span>
</span><span id="line-518"></span><span>
</span><span id="line-519"></span><span id="local-6989586621679463617"><span id="local-6989586621679463618"><span id="local-6989586621679463619"><span id="local-6989586621679463620"><span id="local-6989586621679463621"><span id="local-6989586621679463622"><span id="local-6989586621679463623"><span class="annot"><a href="GreedyParser.html#collectThawSingle"><span class="hs-identifier hs-type">collectThawSingle</span></a></span><span>
</span><span id="line-520"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Common.html#Eval"><span class="hs-identifier hs-type">Eval</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463617"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463618"><span class="hs-identifier hs-type">tr'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463619"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463620"><span class="hs-identifier hs-type">slc'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463621"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Leftmost"><span class="hs-identifier hs-type">Leftmost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463622"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463623"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463621"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-521"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463619"><span class="hs-identifier hs-type">slc</span></a></span><span>
</span><span id="line-522"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679463618"><span class="hs-identifier hs-type">tr'</span></a></span><span>
</span><span id="line-523"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463619"><span class="hs-identifier hs-type">slc</span></a></span><span>
</span><span id="line-524"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GreedyParser.html#ActionSingle"><span class="hs-identifier hs-type">ActionSingle</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463619"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463617"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463622"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463623"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">]</span></span></span></span></span></span></span></span><span>
</span><span id="line-525"></span><span id="collectThawSingle"><span class="annot"><span class="annottext">collectThawSingle :: forall tr tr' slc slc' h s f.
Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; StartStop slc
-&gt; Maybe tr'
-&gt; StartStop slc
-&gt; [ActionSingle slc tr s f]
</span><a href="GreedyParser.html#collectThawSingle"><span class="hs-identifier hs-var hs-var">collectThawSingle</span></a></span></span><span> </span><span id="local-6989586621679464389"><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
</span><a href="#local-6989586621679464389"><span class="hs-identifier hs-var">eval</span></a></span></span><span> </span><span id="local-6989586621679464390"><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679464390"><span class="hs-identifier hs-var">sl</span></a></span></span><span> </span><span id="local-6989586621679464391"><span class="annot"><span class="annottext">Maybe tr'
</span><a href="#local-6989586621679464391"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679464392"><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679464392"><span class="hs-identifier hs-var">sr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-526"></span><span>  </span><span class="annot"><span class="annottext">((tr, Leftmost s f h) -&gt; Maybe (ActionSingle slc tr s f))
-&gt; [(tr, Leftmost s f h)] -&gt; [ActionSingle slc tr s f]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span>
</span><span id="line-527"></span><span>    </span><span class="annot"><span class="annottext">(tr, Leftmost s f h) -&gt; Maybe (ActionSingle slc tr s f)
forall {tr} {s} {f} {h}.
(tr, Leftmost s f h) -&gt; Maybe (ActionSingle slc tr s f)
</span><a href="#local-6989586621679464393"><span class="hs-identifier hs-var">getAction</span></a></span><span>
</span><span id="line-528"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; StartStop slc
-&gt; Maybe tr'
-&gt; StartStop slc
-&gt; Bool
-&gt; [(tr, Leftmost s f h)]
forall tr tr' slc slc' h v.
Eval tr tr' slc slc' h v
-&gt; StartStop slc -&gt; Maybe tr' -&gt; StartStop slc -&gt; Bool -&gt; [(tr, v)]
</span><a href="Common.html#evalUnfreeze"><span class="hs-identifier hs-var">evalUnfreeze</span></a></span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
</span><a href="#local-6989586621679464389"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679464390"><span class="hs-identifier hs-var">sl</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe tr'
</span><a href="#local-6989586621679464391"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679464392"><span class="hs-identifier hs-var">sr</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">)</span><span>
</span><span id="line-529"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-530"></span><span>  </span><span id="local-6989586621679464393"><span class="annot"><span class="annottext">getAction :: (tr, Leftmost s f h) -&gt; Maybe (ActionSingle slc tr s f)
</span><a href="#local-6989586621679464393"><span class="hs-identifier hs-var hs-var">getAction</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679464395"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464395"><span class="hs-identifier hs-var">t'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679464396"><span class="annot"><span class="annottext">Leftmost s f h
</span><a href="#local-6989586621679464396"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Leftmost s f h
</span><a href="#local-6989586621679464396"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-531"></span><span>    </span><span class="annot"><a href="Common.html#LMSingle"><span class="hs-identifier hs-type">LMSingle</span></a></span><span> </span><span id="local-6989586621679464397"><span class="annot"><span class="annottext">LeftmostSingle s f
</span><a href="#local-6989586621679464397"><span class="hs-identifier hs-var">sop</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ActionSingle slc tr s f -&gt; Maybe (ActionSingle slc tr s f)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(ActionSingle slc tr s f -&gt; Maybe (ActionSingle slc tr s f))
-&gt; ActionSingle slc tr s f -&gt; Maybe (ActionSingle slc tr s f)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SingleParent slc tr
-&gt; LeftmostSingle s f -&gt; ActionSingle slc tr s f
forall slc tr s f.
SingleParent slc tr
-&gt; LeftmostSingle s f -&gt; ActionSingle slc tr s f
</span><a href="GreedyParser.html#ActionSingle"><span class="hs-identifier hs-var">ActionSingle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StartStop slc -&gt; tr -&gt; StartStop slc -&gt; SingleParent slc tr
forall slc tr.
StartStop slc -&gt; tr -&gt; StartStop slc -&gt; SingleParent slc tr
</span><a href="GreedyParser.html#SingleParent"><span class="hs-identifier hs-var">SingleParent</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679464390"><span class="hs-identifier hs-var">sl</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464395"><span class="hs-identifier hs-var">t'</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679464392"><span class="hs-identifier hs-var">sr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LeftmostSingle s f
</span><a href="#local-6989586621679464397"><span class="hs-identifier hs-var">sop</span></a></span><span>
</span><span id="line-532"></span><span>    </span><span class="annot"><a href="Common.html#LMDouble"><span class="hs-identifier hs-type">LMDouble</span></a></span><span> </span><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (ActionSingle slc tr s f)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-533"></span><span>
</span><span id="line-534"></span><span id="local-6989586621679463651"><span id="local-6989586621679463652"><span id="local-6989586621679463653"><span id="local-6989586621679463654"><span id="local-6989586621679463655"><span id="local-6989586621679463656"><span id="local-6989586621679463657"><span class="annot"><a href="GreedyParser.html#collectThawLeft"><span class="hs-identifier hs-type">collectThawLeft</span></a></span><span>
</span><span id="line-535"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Common.html#Eval"><span class="hs-identifier hs-type">Eval</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463651"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463652"><span class="hs-identifier hs-type">tr'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463653"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463654"><span class="hs-identifier hs-type">slc'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463655"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Leftmost"><span class="hs-identifier hs-type">Leftmost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463656"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463657"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463655"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-536"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463653"><span class="hs-identifier hs-type">slc</span></a></span><span>
</span><span id="line-537"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679463652"><span class="hs-identifier hs-type">tr'</span></a></span><span>
</span><span id="line-538"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679463653"><span class="hs-identifier hs-type">slc</span></a></span><span>
</span><span id="line-539"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679463651"><span class="hs-identifier hs-type">tr</span></a></span><span>
</span><span id="line-540"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463653"><span class="hs-identifier hs-type">slc</span></a></span><span>
</span><span id="line-541"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GreedyParser.html#ActionDouble"><span class="hs-identifier hs-type">ActionDouble</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463653"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463651"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463656"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463657"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463655"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">]</span></span></span></span></span></span></span></span><span>
</span><span id="line-542"></span><span id="collectThawLeft"><span class="annot"><span class="annottext">collectThawLeft :: forall tr tr' slc slc' h s f.
Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; StartStop slc
-&gt; Maybe tr'
-&gt; slc
-&gt; tr
-&gt; StartStop slc
-&gt; [ActionDouble slc tr s f h]
</span><a href="GreedyParser.html#collectThawLeft"><span class="hs-identifier hs-var hs-var">collectThawLeft</span></a></span></span><span> </span><span id="local-6989586621679464398"><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
</span><a href="#local-6989586621679464398"><span class="hs-identifier hs-var">eval</span></a></span></span><span> </span><span id="local-6989586621679464399"><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679464399"><span class="hs-identifier hs-var">sl</span></a></span></span><span> </span><span id="local-6989586621679464400"><span class="annot"><span class="annottext">Maybe tr'
</span><a href="#local-6989586621679464400"><span class="hs-identifier hs-var">tl</span></a></span></span><span> </span><span id="local-6989586621679464401"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464401"><span class="hs-identifier hs-var">sm</span></a></span></span><span> </span><span id="local-6989586621679464402"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464402"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span id="local-6989586621679464403"><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679464403"><span class="hs-identifier hs-var">sr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-543"></span><span>  </span><span class="annot"><span class="annottext">((tr, Leftmost s f h) -&gt; Maybe (ActionDouble slc tr s f h))
-&gt; [(tr, Leftmost s f h)] -&gt; [ActionDouble slc tr s f h]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span>
</span><span id="line-544"></span><span>    </span><span class="annot"><span class="annottext">(tr, Leftmost s f h) -&gt; Maybe (ActionDouble slc tr s f h)
forall {s} {f} {h}.
(tr, Leftmost s f h) -&gt; Maybe (ActionDouble slc tr s f h)
</span><a href="#local-6989586621679464404"><span class="hs-identifier hs-var">getAction</span></a></span><span>
</span><span id="line-545"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; StartStop slc
-&gt; Maybe tr'
-&gt; StartStop slc
-&gt; Bool
-&gt; [(tr, Leftmost s f h)]
forall tr tr' slc slc' h v.
Eval tr tr' slc slc' h v
-&gt; StartStop slc -&gt; Maybe tr' -&gt; StartStop slc -&gt; Bool -&gt; [(tr, v)]
</span><a href="Common.html#evalUnfreeze"><span class="hs-identifier hs-var">evalUnfreeze</span></a></span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
</span><a href="#local-6989586621679464398"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679464399"><span class="hs-identifier hs-var">sl</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe tr'
</span><a href="#local-6989586621679464400"><span class="hs-identifier hs-var">tl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">slc -&gt; StartStop slc
forall a. a -&gt; StartStop a
</span><a href="Common.html#Inner"><span class="hs-identifier hs-var">Inner</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464401"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">)</span><span>
</span><span id="line-546"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-547"></span><span>  </span><span id="local-6989586621679464404"><span class="annot"><span class="annottext">getAction :: (tr, Leftmost s f h) -&gt; Maybe (ActionDouble slc tr s f h)
</span><a href="#local-6989586621679464404"><span class="hs-identifier hs-var hs-var">getAction</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679464405"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464405"><span class="hs-identifier hs-var">thawed</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679464406"><span class="annot"><span class="annottext">Leftmost s f h
</span><a href="#local-6989586621679464406"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Leftmost s f h
</span><a href="#local-6989586621679464406"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-548"></span><span>    </span><span class="annot"><a href="Common.html#LMDouble"><span class="hs-identifier hs-type">LMDouble</span></a></span><span> </span><span id="local-6989586621679464407"><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><a href="#local-6989586621679464407"><span class="hs-identifier hs-var">dop</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-549"></span><span>      </span><span class="annot"><span class="annottext">ActionDouble slc tr s f h -&gt; Maybe (ActionDouble slc tr s f h)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(ActionDouble slc tr s f h -&gt; Maybe (ActionDouble slc tr s f h))
-&gt; ActionDouble slc tr s f h -&gt; Maybe (ActionDouble slc tr s f h)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DoubleParent slc tr
-&gt; LeftmostDouble s f h -&gt; ActionDouble slc tr s f h
forall slc tr s f h.
DoubleParent slc tr
-&gt; LeftmostDouble s f h -&gt; ActionDouble slc tr s f h
</span><a href="GreedyParser.html#ActionDouble"><span class="hs-identifier hs-var">ActionDouble</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StartStop slc
-&gt; tr -&gt; slc -&gt; tr -&gt; StartStop slc -&gt; DoubleParent slc tr
forall slc tr.
StartStop slc
-&gt; tr -&gt; slc -&gt; tr -&gt; StartStop slc -&gt; DoubleParent slc tr
</span><a href="GreedyParser.html#DoubleParent"><span class="hs-identifier hs-var">DoubleParent</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679464399"><span class="hs-identifier hs-var">sl</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464405"><span class="hs-identifier hs-var">thawed</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464401"><span class="hs-identifier hs-var">sm</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464402"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679464403"><span class="hs-identifier hs-var">sr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><a href="#local-6989586621679464407"><span class="hs-identifier hs-var">dop</span></a></span><span>
</span><span id="line-550"></span><span>    </span><span class="annot"><a href="Common.html#LMSingle"><span class="hs-identifier hs-type">LMSingle</span></a></span><span> </span><span class="annot"><span class="annottext">LeftmostSingle s f
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (ActionDouble slc tr s f h)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-551"></span><span>
</span><span id="line-552"></span><span id="local-6989586621679463632"><span id="local-6989586621679463633"><span id="local-6989586621679463634"><span id="local-6989586621679463635"><span id="local-6989586621679463636"><span id="local-6989586621679463637"><span id="local-6989586621679463638"><span class="annot"><a href="GreedyParser.html#collectUnsplitSingle"><span class="hs-identifier hs-type">collectUnsplitSingle</span></a></span><span>
</span><span id="line-553"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Common.html#Eval"><span class="hs-identifier hs-type">Eval</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463632"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463633"><span class="hs-identifier hs-type">tr'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463634"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463635"><span class="hs-identifier hs-type">slc'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463636"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Leftmost"><span class="hs-identifier hs-type">Leftmost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463637"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463638"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463636"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-554"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463634"><span class="hs-identifier hs-type">slc</span></a></span><span>
</span><span id="line-555"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679463632"><span class="hs-identifier hs-type">tr</span></a></span><span>
</span><span id="line-556"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679463634"><span class="hs-identifier hs-type">slc</span></a></span><span>
</span><span id="line-557"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679463632"><span class="hs-identifier hs-type">tr</span></a></span><span>
</span><span id="line-558"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463634"><span class="hs-identifier hs-type">slc</span></a></span><span>
</span><span id="line-559"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GreedyParser.html#ActionSingle"><span class="hs-identifier hs-type">ActionSingle</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463634"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463632"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463637"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463638"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">]</span></span></span></span></span></span></span></span><span>
</span><span id="line-560"></span><span id="collectUnsplitSingle"><span class="annot"><span class="annottext">collectUnsplitSingle :: forall tr tr' slc slc' h s f.
Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; StartStop slc
-&gt; tr
-&gt; slc
-&gt; tr
-&gt; StartStop slc
-&gt; [ActionSingle slc tr s f]
</span><a href="GreedyParser.html#collectUnsplitSingle"><span class="hs-identifier hs-var hs-var">collectUnsplitSingle</span></a></span></span><span> </span><span id="local-6989586621679464408"><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
</span><a href="#local-6989586621679464408"><span class="hs-identifier hs-var">eval</span></a></span></span><span> </span><span id="local-6989586621679464409"><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679464409"><span class="hs-identifier hs-var">sl</span></a></span></span><span> </span><span id="local-6989586621679464410"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464410"><span class="hs-identifier hs-var">tl</span></a></span></span><span> </span><span id="local-6989586621679464411"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464411"><span class="hs-identifier hs-var">sm</span></a></span></span><span> </span><span id="local-6989586621679464412"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464412"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span id="local-6989586621679464413"><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679464413"><span class="hs-identifier hs-var">sr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-561"></span><span>  </span><span class="annot"><span class="annottext">((tr, Leftmost s f h) -&gt; Maybe (ActionSingle slc tr s f))
-&gt; [(tr, Leftmost s f h)] -&gt; [ActionSingle slc tr s f]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="annot"><span class="annottext">(tr, Leftmost s f h) -&gt; Maybe (ActionSingle slc tr s f)
forall {tr} {s} {f} {h}.
(tr, Leftmost s f h) -&gt; Maybe (ActionSingle slc tr s f)
</span><a href="#local-6989586621679464414"><span class="hs-identifier hs-var">getAction</span></a></span><span> </span><span class="annot"><span class="annottext">([(tr, Leftmost s f h)] -&gt; [ActionSingle slc tr s f])
-&gt; [(tr, Leftmost s f h)] -&gt; [ActionSingle slc tr s f]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; Unsplit tr slc (Leftmost s f h)
forall tr tr' slc slc' h v.
Eval tr tr' slc slc' h v -&gt; Unsplit tr slc v
</span><a href="Common.html#evalUnsplit"><span class="hs-identifier hs-var">evalUnsplit</span></a></span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
</span><a href="#local-6989586621679464408"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679464409"><span class="hs-identifier hs-var">sl</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464410"><span class="hs-identifier hs-var">tl</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464411"><span class="hs-identifier hs-var">sm</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464412"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679464413"><span class="hs-identifier hs-var">sr</span></a></span><span> </span><span class="annot"><span class="annottext">SplitType
</span><a href="Common.html#SingleOfOne"><span class="hs-identifier hs-var">SingleOfOne</span></a></span><span>
</span><span id="line-562"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-563"></span><span>  </span><span id="local-6989586621679464414"><span class="annot"><span class="annottext">getAction :: (tr, Leftmost s f h) -&gt; Maybe (ActionSingle slc tr s f)
</span><a href="#local-6989586621679464414"><span class="hs-identifier hs-var hs-var">getAction</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679464417"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464417"><span class="hs-identifier hs-var">ttop</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679464418"><span class="annot"><span class="annottext">Leftmost s f h
</span><a href="#local-6989586621679464418"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Leftmost s f h
</span><a href="#local-6989586621679464418"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-564"></span><span>    </span><span class="annot"><a href="Common.html#LMSingle"><span class="hs-identifier hs-type">LMSingle</span></a></span><span> </span><span id="local-6989586621679464419"><span class="annot"><span class="annottext">LeftmostSingle s f
</span><a href="#local-6989586621679464419"><span class="hs-identifier hs-var">sop</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ActionSingle slc tr s f -&gt; Maybe (ActionSingle slc tr s f)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(ActionSingle slc tr s f -&gt; Maybe (ActionSingle slc tr s f))
-&gt; ActionSingle slc tr s f -&gt; Maybe (ActionSingle slc tr s f)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">SingleParent slc tr
-&gt; LeftmostSingle s f -&gt; ActionSingle slc tr s f
forall slc tr s f.
SingleParent slc tr
-&gt; LeftmostSingle s f -&gt; ActionSingle slc tr s f
</span><a href="GreedyParser.html#ActionSingle"><span class="hs-identifier hs-var">ActionSingle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StartStop slc -&gt; tr -&gt; StartStop slc -&gt; SingleParent slc tr
forall slc tr.
StartStop slc -&gt; tr -&gt; StartStop slc -&gt; SingleParent slc tr
</span><a href="GreedyParser.html#SingleParent"><span class="hs-identifier hs-var">SingleParent</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679464409"><span class="hs-identifier hs-var">sl</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464417"><span class="hs-identifier hs-var">ttop</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679464413"><span class="hs-identifier hs-var">sr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LeftmostSingle s f
</span><a href="#local-6989586621679464419"><span class="hs-identifier hs-var">sop</span></a></span><span>
</span><span id="line-565"></span><span>    </span><span class="annot"><a href="Common.html#LMDouble"><span class="hs-identifier hs-type">LMDouble</span></a></span><span> </span><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (ActionSingle slc tr s f)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-566"></span><span>
</span><span id="line-567"></span><span id="local-6989586621679463768"><span id="local-6989586621679463769"><span id="local-6989586621679463770"><span id="local-6989586621679463771"><span id="local-6989586621679463772"><span id="local-6989586621679463773"><span id="local-6989586621679463774"><span class="annot"><a href="GreedyParser.html#collectUnsplitLeft"><span class="hs-identifier hs-type">collectUnsplitLeft</span></a></span><span>
</span><span id="line-568"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Common.html#Eval"><span class="hs-identifier hs-type">Eval</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463768"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463769"><span class="hs-identifier hs-type">tr'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463770"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463771"><span class="hs-identifier hs-type">slc'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463772"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Leftmost"><span class="hs-identifier hs-type">Leftmost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463773"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463774"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463772"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-569"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463770"><span class="hs-identifier hs-type">slc</span></a></span><span>
</span><span id="line-570"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679463768"><span class="hs-identifier hs-type">tr</span></a></span><span>
</span><span id="line-571"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679463770"><span class="hs-identifier hs-type">slc</span></a></span><span>
</span><span id="line-572"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679463768"><span class="hs-identifier hs-type">tr</span></a></span><span>
</span><span id="line-573"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679463770"><span class="hs-identifier hs-type">slc</span></a></span><span>
</span><span id="line-574"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679463768"><span class="hs-identifier hs-type">tr</span></a></span><span>
</span><span id="line-575"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463770"><span class="hs-identifier hs-type">slc</span></a></span><span>
</span><span id="line-576"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GreedyParser.html#ActionDouble"><span class="hs-identifier hs-type">ActionDouble</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463770"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463768"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463773"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463774"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463772"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">]</span></span></span></span></span></span></span></span><span>
</span><span id="line-577"></span><span id="collectUnsplitLeft"><span class="annot"><span class="annottext">collectUnsplitLeft :: forall tr tr' slc slc' h s f.
Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; StartStop slc
-&gt; tr
-&gt; slc
-&gt; tr
-&gt; slc
-&gt; tr
-&gt; StartStop slc
-&gt; [ActionDouble slc tr s f h]
</span><a href="GreedyParser.html#collectUnsplitLeft"><span class="hs-identifier hs-var hs-var">collectUnsplitLeft</span></a></span></span><span> </span><span id="local-6989586621679464421"><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
</span><a href="#local-6989586621679464421"><span class="hs-identifier hs-var">eval</span></a></span></span><span> </span><span id="local-6989586621679464422"><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679464422"><span class="hs-identifier hs-var">sstart</span></a></span></span><span> </span><span id="local-6989586621679464423"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464423"><span class="hs-identifier hs-var">tl</span></a></span></span><span> </span><span id="local-6989586621679464424"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464424"><span class="hs-identifier hs-var">sl</span></a></span></span><span> </span><span id="local-6989586621679464425"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464425"><span class="hs-identifier hs-var">tm</span></a></span></span><span> </span><span id="local-6989586621679464426"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464426"><span class="hs-identifier hs-var">sr</span></a></span></span><span> </span><span id="local-6989586621679464427"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464427"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span id="local-6989586621679464428"><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679464428"><span class="hs-identifier hs-var">send</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-578"></span><span>  </span><span class="annot"><span class="annottext">((tr, Leftmost s f h) -&gt; Maybe (ActionDouble slc tr s f h))
-&gt; [(tr, Leftmost s f h)] -&gt; [ActionDouble slc tr s f h]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="annot"><span class="annottext">(tr, Leftmost s f h) -&gt; Maybe (ActionDouble slc tr s f h)
forall {s} {f} {h}.
(tr, Leftmost s f h) -&gt; Maybe (ActionDouble slc tr s f h)
</span><a href="#local-6989586621679464429"><span class="hs-identifier hs-var">getAction</span></a></span><span> </span><span class="annot"><span class="annottext">([(tr, Leftmost s f h)] -&gt; [ActionDouble slc tr s f h])
-&gt; [(tr, Leftmost s f h)] -&gt; [ActionDouble slc tr s f h]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; Unsplit tr slc (Leftmost s f h)
forall tr tr' slc slc' h v.
Eval tr tr' slc slc' h v -&gt; Unsplit tr slc v
</span><a href="Common.html#evalUnsplit"><span class="hs-identifier hs-var">evalUnsplit</span></a></span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
</span><a href="#local-6989586621679464421"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679464422"><span class="hs-identifier hs-var">sstart</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464423"><span class="hs-identifier hs-var">tl</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464424"><span class="hs-identifier hs-var">sl</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464425"><span class="hs-identifier hs-var">tm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">slc -&gt; StartStop slc
forall a. a -&gt; StartStop a
</span><a href="Common.html#Inner"><span class="hs-identifier hs-var">Inner</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464426"><span class="hs-identifier hs-var">sr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SplitType
</span><a href="Common.html#LeftOfTwo"><span class="hs-identifier hs-var">LeftOfTwo</span></a></span><span>
</span><span id="line-579"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-580"></span><span>  </span><span id="local-6989586621679464429"><span class="annot"><span class="annottext">getAction :: (tr, Leftmost s f h) -&gt; Maybe (ActionDouble slc tr s f h)
</span><a href="#local-6989586621679464429"><span class="hs-identifier hs-var hs-var">getAction</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679464431"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464431"><span class="hs-identifier hs-var">ttop</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679464432"><span class="annot"><span class="annottext">Leftmost s f h
</span><a href="#local-6989586621679464432"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Leftmost s f h
</span><a href="#local-6989586621679464432"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-581"></span><span>    </span><span class="annot"><a href="Common.html#LMSingle"><span class="hs-identifier hs-type">LMSingle</span></a></span><span> </span><span class="annot"><span class="annottext">LeftmostSingle s f
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (ActionDouble slc tr s f h)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-582"></span><span>    </span><span class="annot"><a href="Common.html#LMDouble"><span class="hs-identifier hs-type">LMDouble</span></a></span><span> </span><span id="local-6989586621679464433"><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><a href="#local-6989586621679464433"><span class="hs-identifier hs-var">dop</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-583"></span><span>      </span><span class="annot"><span class="annottext">ActionDouble slc tr s f h -&gt; Maybe (ActionDouble slc tr s f h)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(ActionDouble slc tr s f h -&gt; Maybe (ActionDouble slc tr s f h))
-&gt; ActionDouble slc tr s f h -&gt; Maybe (ActionDouble slc tr s f h)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-584"></span><span>        </span><span class="annot"><span class="annottext">DoubleParent slc tr
-&gt; LeftmostDouble s f h -&gt; ActionDouble slc tr s f h
forall slc tr s f h.
DoubleParent slc tr
-&gt; LeftmostDouble s f h -&gt; ActionDouble slc tr s f h
</span><a href="GreedyParser.html#ActionDouble"><span class="hs-identifier hs-var">ActionDouble</span></a></span><span>
</span><span id="line-585"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StartStop slc
-&gt; tr -&gt; slc -&gt; tr -&gt; StartStop slc -&gt; DoubleParent slc tr
forall slc tr.
StartStop slc
-&gt; tr -&gt; slc -&gt; tr -&gt; StartStop slc -&gt; DoubleParent slc tr
</span><a href="GreedyParser.html#DoubleParent"><span class="hs-identifier hs-var">DoubleParent</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679464422"><span class="hs-identifier hs-var">sstart</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464431"><span class="hs-identifier hs-var">ttop</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464426"><span class="hs-identifier hs-var">sr</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464427"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679464428"><span class="hs-identifier hs-var">send</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-586"></span><span>          </span><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><a href="#local-6989586621679464433"><span class="hs-identifier hs-var">dop</span></a></span><span>
</span><span id="line-587"></span><span>
</span><span id="line-588"></span><span id="local-6989586621679463785"><span id="local-6989586621679463786"><span id="local-6989586621679463787"><span id="local-6989586621679463788"><span id="local-6989586621679463789"><span id="local-6989586621679463790"><span id="local-6989586621679463791"><span class="annot"><a href="GreedyParser.html#collectUnsplitRight"><span class="hs-identifier hs-type">collectUnsplitRight</span></a></span><span>
</span><span id="line-589"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Common.html#Eval"><span class="hs-identifier hs-type">Eval</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463785"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463786"><span class="hs-identifier hs-type">tr'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463787"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463788"><span class="hs-identifier hs-type">slc'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463789"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Leftmost"><span class="hs-identifier hs-type">Leftmost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463790"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463791"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463789"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-590"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463787"><span class="hs-identifier hs-type">slc</span></a></span><span>
</span><span id="line-591"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679463785"><span class="hs-identifier hs-type">tr</span></a></span><span>
</span><span id="line-592"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679463787"><span class="hs-identifier hs-type">slc</span></a></span><span>
</span><span id="line-593"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679463785"><span class="hs-identifier hs-type">tr</span></a></span><span>
</span><span id="line-594"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679463787"><span class="hs-identifier hs-type">slc</span></a></span><span>
</span><span id="line-595"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679463785"><span class="hs-identifier hs-type">tr</span></a></span><span>
</span><span id="line-596"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463787"><span class="hs-identifier hs-type">slc</span></a></span><span>
</span><span id="line-597"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-598"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GreedyParser.html#ActionDouble"><span class="hs-identifier hs-type">ActionDouble</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463787"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463785"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463790"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463791"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463789"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">]</span></span></span></span></span></span></span></span><span>
</span><span id="line-599"></span><span id="collectUnsplitRight"><span class="annot"><span class="annottext">collectUnsplitRight :: forall tr tr' slc slc' h s f.
Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; StartStop slc
-&gt; tr
-&gt; slc
-&gt; tr
-&gt; slc
-&gt; tr
-&gt; StartStop slc
-&gt; Bool
-&gt; [ActionDouble slc tr s f h]
</span><a href="GreedyParser.html#collectUnsplitRight"><span class="hs-identifier hs-var hs-var">collectUnsplitRight</span></a></span></span><span> </span><span id="local-6989586621679464435"><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
</span><a href="#local-6989586621679464435"><span class="hs-identifier hs-var">eval</span></a></span></span><span> </span><span id="local-6989586621679464436"><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679464436"><span class="hs-identifier hs-var">sstart</span></a></span></span><span> </span><span id="local-6989586621679464437"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464437"><span class="hs-identifier hs-var">tl</span></a></span></span><span> </span><span id="local-6989586621679464438"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464438"><span class="hs-identifier hs-var">sl</span></a></span></span><span> </span><span id="local-6989586621679464439"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464439"><span class="hs-identifier hs-var">tm</span></a></span></span><span> </span><span id="local-6989586621679464440"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464440"><span class="hs-identifier hs-var">sr</span></a></span></span><span> </span><span id="local-6989586621679464441"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464441"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span id="local-6989586621679464442"><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679464442"><span class="hs-identifier hs-var">send</span></a></span></span><span> </span><span id="local-6989586621679464443"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679464443"><span class="hs-identifier hs-var">afterLeft</span></a></span></span><span>
</span><span id="line-600"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679464443"><span class="hs-identifier hs-var">afterLeft</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-601"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-602"></span><span>      </span><span class="annot"><span class="annottext">((tr, Leftmost s f h) -&gt; Maybe (ActionDouble slc tr s f h))
-&gt; [(tr, Leftmost s f h)] -&gt; [ActionDouble slc tr s f h]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="annot"><span class="annottext">(tr, Leftmost s f h) -&gt; Maybe (ActionDouble slc tr s f h)
forall {s} {f} {h}.
(tr, Leftmost s f h) -&gt; Maybe (ActionDouble slc tr s f h)
</span><a href="#local-6989586621679464444"><span class="hs-identifier hs-var">getAction</span></a></span><span> </span><span class="annot"><span class="annottext">([(tr, Leftmost s f h)] -&gt; [ActionDouble slc tr s f h])
-&gt; [(tr, Leftmost s f h)] -&gt; [ActionDouble slc tr s f h]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-603"></span><span>        </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; Unsplit tr slc (Leftmost s f h)
forall tr tr' slc slc' h v.
Eval tr tr' slc slc' h v -&gt; Unsplit tr slc v
</span><a href="Common.html#evalUnsplit"><span class="hs-identifier hs-var">evalUnsplit</span></a></span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
</span><a href="#local-6989586621679464435"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">slc -&gt; StartStop slc
forall a. a -&gt; StartStop a
</span><a href="Common.html#Inner"><span class="hs-identifier hs-var">Inner</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464438"><span class="hs-identifier hs-var">sl</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464439"><span class="hs-identifier hs-var">tm</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464440"><span class="hs-identifier hs-var">sr</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464441"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679464442"><span class="hs-identifier hs-var">send</span></a></span><span> </span><span class="annot"><span class="annottext">SplitType
</span><a href="Common.html#RightOfTwo"><span class="hs-identifier hs-var">RightOfTwo</span></a></span><span>
</span><span id="line-604"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-605"></span><span>  </span><span id="local-6989586621679464444"><span class="annot"><span class="annottext">getAction :: (tr, Leftmost s f h) -&gt; Maybe (ActionDouble slc tr s f h)
</span><a href="#local-6989586621679464444"><span class="hs-identifier hs-var hs-var">getAction</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679464446"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464446"><span class="hs-identifier hs-var">ttop</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679464447"><span class="annot"><span class="annottext">Leftmost s f h
</span><a href="#local-6989586621679464447"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Leftmost s f h
</span><a href="#local-6989586621679464447"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-606"></span><span>    </span><span class="annot"><a href="Common.html#LMSingle"><span class="hs-identifier hs-type">LMSingle</span></a></span><span> </span><span class="annot"><span class="annottext">LeftmostSingle s f
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (ActionDouble slc tr s f h)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-607"></span><span>    </span><span class="annot"><a href="Common.html#LMDouble"><span class="hs-identifier hs-type">LMDouble</span></a></span><span> </span><span id="local-6989586621679464448"><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><a href="#local-6989586621679464448"><span class="hs-identifier hs-var">dop</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-608"></span><span>      </span><span class="annot"><span class="annottext">ActionDouble slc tr s f h -&gt; Maybe (ActionDouble slc tr s f h)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(ActionDouble slc tr s f h -&gt; Maybe (ActionDouble slc tr s f h))
-&gt; ActionDouble slc tr s f h -&gt; Maybe (ActionDouble slc tr s f h)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DoubleParent slc tr
-&gt; LeftmostDouble s f h -&gt; ActionDouble slc tr s f h
forall slc tr s f h.
DoubleParent slc tr
-&gt; LeftmostDouble s f h -&gt; ActionDouble slc tr s f h
</span><a href="GreedyParser.html#ActionDouble"><span class="hs-identifier hs-var">ActionDouble</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StartStop slc
-&gt; tr -&gt; slc -&gt; tr -&gt; StartStop slc -&gt; DoubleParent slc tr
forall slc tr.
StartStop slc
-&gt; tr -&gt; slc -&gt; tr -&gt; StartStop slc -&gt; DoubleParent slc tr
</span><a href="GreedyParser.html#DoubleParent"><span class="hs-identifier hs-var">DoubleParent</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679464436"><span class="hs-identifier hs-var">sstart</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464437"><span class="hs-identifier hs-var">tl</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464438"><span class="hs-identifier hs-var">sl</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464446"><span class="hs-identifier hs-var">ttop</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679464442"><span class="hs-identifier hs-var">send</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><a href="#local-6989586621679464448"><span class="hs-identifier hs-var">dop</span></a></span><span>
</span><span id="line-609"></span><span>
</span><span id="line-610"></span><span id="local-6989586621679464449"><span id="local-6989586621679464450"><span id="local-6989586621679464451"><span id="local-6989586621679464452"><span id="local-6989586621679464453"><span id="local-6989586621679464454"><span id="local-6989586621679464455"><span class="annot"><a href="GreedyParser.html#collectUnspreads"><span class="hs-identifier hs-type">collectUnspreads</span></a></span><span>
</span><span id="line-611"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Common.html#Eval"><span class="hs-identifier hs-type">Eval</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679464449"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679464450"><span class="hs-identifier hs-type">tr'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679464451"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679464452"><span class="hs-identifier hs-type">slc'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679464453"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Leftmost"><span class="hs-identifier hs-type">Leftmost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679464454"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679464455"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679464453"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-612"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679464451"><span class="hs-identifier hs-type">slc</span></a></span><span>
</span><span id="line-613"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679464449"><span class="hs-identifier hs-type">tr</span></a></span><span>
</span><span id="line-614"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679464451"><span class="hs-identifier hs-type">slc</span></a></span><span>
</span><span id="line-615"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679464449"><span class="hs-identifier hs-type">tr</span></a></span><span>
</span><span id="line-616"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679464451"><span class="hs-identifier hs-type">slc</span></a></span><span>
</span><span id="line-617"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679464449"><span class="hs-identifier hs-type">tr</span></a></span><span>
</span><span id="line-618"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679464451"><span class="hs-identifier hs-type">slc</span></a></span><span>
</span><span id="line-619"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GreedyParser.html#ActionDouble"><span class="hs-identifier hs-type">ActionDouble</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679464451"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679464449"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679464454"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679464455"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679464453"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">]</span></span></span></span></span></span></span></span><span>
</span><span id="line-620"></span><span id="collectUnspreads"><span class="annot"><span class="annottext">collectUnspreads :: forall tr tr' slc slc' h s f.
Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; StartStop slc
-&gt; tr
-&gt; slc
-&gt; tr
-&gt; slc
-&gt; tr
-&gt; StartStop slc
-&gt; [ActionDouble slc tr s f h]
</span><a href="GreedyParser.html#collectUnspreads"><span class="hs-identifier hs-var hs-var">collectUnspreads</span></a></span></span><span> </span><span id="local-6989586621679464463"><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
</span><a href="#local-6989586621679464463"><span class="hs-identifier hs-var">eval</span></a></span></span><span> </span><span id="local-6989586621679464464"><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679464464"><span class="hs-identifier hs-var">sstart</span></a></span></span><span> </span><span id="local-6989586621679464465"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464465"><span class="hs-identifier hs-var">tl</span></a></span></span><span> </span><span id="local-6989586621679464466"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464466"><span class="hs-identifier hs-var">sl</span></a></span></span><span> </span><span id="local-6989586621679464467"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464467"><span class="hs-identifier hs-var">tm</span></a></span></span><span> </span><span id="local-6989586621679464468"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464468"><span class="hs-identifier hs-var">sr</span></a></span></span><span> </span><span id="local-6989586621679464469"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464469"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span id="local-6989586621679464470"><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679464470"><span class="hs-identifier hs-var">send</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-621"></span><span>  </span><span class="annot"><span class="annottext">[Maybe (ActionDouble slc tr s f h)] -&gt; [ActionDouble slc tr s f h]
forall a. [Maybe a] -&gt; [a]
</span><span class="hs-identifier hs-var">catMaybes</span></span><span> </span><span class="annot"><span class="annottext">([Maybe (ActionDouble slc tr s f h)]
 -&gt; [ActionDouble slc tr s f h])
-&gt; [Maybe (ActionDouble slc tr s f h)]
-&gt; [ActionDouble slc tr s f h]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-622"></span><span>    </span><span class="hs-comment">-- List</span><span>
</span><span id="line-623"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679464471"><span class="annot"><a href="#local-6989586621679464471"><span class="hs-identifier hs-var">sTop</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679464472"><span class="annot"><a href="#local-6989586621679464472"><span class="hs-identifier hs-var">us</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679464473"><span class="annot"><a href="#local-6989586621679464473"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; UnspreadMiddle tr slc h (Leftmost s f h)
forall tr tr' slc slc' h v.
Eval tr tr' slc slc' h v -&gt; UnspreadMiddle tr slc h v
</span><a href="Common.html#evalUnspreadMiddle"><span class="hs-identifier hs-var">evalUnspreadMiddle</span></a></span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
</span><a href="#local-6989586621679464463"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464466"><span class="hs-identifier hs-var">sl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464467"><span class="hs-identifier hs-var">tm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464468"><span class="hs-identifier hs-var">sr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-624"></span><span>    </span><span id="local-6989586621679464475"><span class="annot"><a href="#local-6989586621679464475"><span class="hs-identifier hs-var">lTop</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Common.html#evalUnspreadLeft"><span class="hs-identifier hs-var">evalUnspreadLeft</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679464463"><span class="hs-identifier hs-type">eval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679464465"><span class="hs-identifier hs-type">tl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679464466"><span class="hs-identifier hs-type">sl</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679464471"><span class="hs-identifier hs-type">sTop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679464472"><span class="hs-identifier hs-type">us</span></a></span><span>
</span><span id="line-625"></span><span>    </span><span id="local-6989586621679464477"><span class="annot"><a href="#local-6989586621679464477"><span class="hs-identifier hs-var">rTop</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Common.html#evalUnspreadRight"><span class="hs-identifier hs-var">evalUnspreadRight</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679464463"><span class="hs-identifier hs-type">eval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679464468"><span class="hs-identifier hs-type">sr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679464469"><span class="hs-identifier hs-type">tr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679464471"><span class="hs-identifier hs-type">sTop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679464472"><span class="hs-identifier hs-type">us</span></a></span><span>
</span><span id="line-626"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621679464479"><span class="hs-identifier hs-type">getAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679464475"><span class="hs-identifier hs-type">lTop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679464471"><span class="hs-identifier hs-type">sTop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679464477"><span class="hs-identifier hs-type">rTop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679464473"><span class="hs-identifier hs-type">op</span></a></span><span>
</span><span id="line-627"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-628"></span><span>  </span><span id="local-6989586621679464479"><span class="annot"><span class="annottext">getAction :: tr
-&gt; slc -&gt; tr -&gt; Leftmost s f h -&gt; Maybe (ActionDouble slc tr s f h)
</span><a href="#local-6989586621679464479"><span class="hs-identifier hs-var hs-var">getAction</span></a></span></span><span> </span><span id="local-6989586621679464480"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464480"><span class="hs-identifier hs-var">lTop</span></a></span></span><span> </span><span id="local-6989586621679464481"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464481"><span class="hs-identifier hs-var">sTop</span></a></span></span><span> </span><span id="local-6989586621679464482"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464482"><span class="hs-identifier hs-var">rTop</span></a></span></span><span> </span><span id="local-6989586621679464483"><span class="annot"><span class="annottext">Leftmost s f h
</span><a href="#local-6989586621679464483"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Leftmost s f h
</span><a href="#local-6989586621679464483"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-629"></span><span>    </span><span class="annot"><a href="Common.html#LMSingle"><span class="hs-identifier hs-type">LMSingle</span></a></span><span> </span><span class="annot"><span class="annottext">LeftmostSingle s f
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (ActionDouble slc tr s f h)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-630"></span><span>    </span><span class="annot"><a href="Common.html#LMDouble"><span class="hs-identifier hs-type">LMDouble</span></a></span><span> </span><span id="local-6989586621679464484"><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><a href="#local-6989586621679464484"><span class="hs-identifier hs-var">dop</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-631"></span><span>      </span><span class="annot"><span class="annottext">ActionDouble slc tr s f h -&gt; Maybe (ActionDouble slc tr s f h)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(ActionDouble slc tr s f h -&gt; Maybe (ActionDouble slc tr s f h))
-&gt; ActionDouble slc tr s f h -&gt; Maybe (ActionDouble slc tr s f h)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-632"></span><span>        </span><span class="annot"><span class="annottext">DoubleParent slc tr
-&gt; LeftmostDouble s f h -&gt; ActionDouble slc tr s f h
forall slc tr s f h.
DoubleParent slc tr
-&gt; LeftmostDouble s f h -&gt; ActionDouble slc tr s f h
</span><a href="GreedyParser.html#ActionDouble"><span class="hs-identifier hs-var">ActionDouble</span></a></span><span>
</span><span id="line-633"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StartStop slc
-&gt; tr -&gt; slc -&gt; tr -&gt; StartStop slc -&gt; DoubleParent slc tr
forall slc tr.
StartStop slc
-&gt; tr -&gt; slc -&gt; tr -&gt; StartStop slc -&gt; DoubleParent slc tr
</span><a href="GreedyParser.html#DoubleParent"><span class="hs-identifier hs-var">DoubleParent</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679464464"><span class="hs-identifier hs-var">sstart</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464480"><span class="hs-identifier hs-var">lTop</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464481"><span class="hs-identifier hs-var">sTop</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464482"><span class="hs-identifier hs-var">rTop</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679464470"><span class="hs-identifier hs-var">send</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-634"></span><span>          </span><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><a href="#local-6989586621679464484"><span class="hs-identifier hs-var">dop</span></a></span><span>
</span><span id="line-635"></span><span>
</span><span id="line-636"></span><span id="local-6989586621679463639"><span id="local-6989586621679463640"><span id="local-6989586621679463641"><span id="local-6989586621679463642"><span id="local-6989586621679463643"><span id="local-6989586621679463644"><span id="local-6989586621679463645"><span class="annot"><a href="GreedyParser.html#collectDoubles"><span class="hs-identifier hs-type">collectDoubles</span></a></span><span>
</span><span id="line-637"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Common.html#Eval"><span class="hs-identifier hs-type">Eval</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463639"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463640"><span class="hs-identifier hs-type">tr'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463641"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463642"><span class="hs-identifier hs-type">slc'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463643"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Leftmost"><span class="hs-identifier hs-type">Leftmost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463644"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463645"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463643"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-638"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463641"><span class="hs-identifier hs-type">slc</span></a></span><span>
</span><span id="line-639"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679463639"><span class="hs-identifier hs-type">tr</span></a></span><span>
</span><span id="line-640"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679463641"><span class="hs-identifier hs-type">slc</span></a></span><span>
</span><span id="line-641"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679463639"><span class="hs-identifier hs-type">tr</span></a></span><span>
</span><span id="line-642"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679463641"><span class="hs-identifier hs-type">slc</span></a></span><span>
</span><span id="line-643"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463639"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463641"><span class="hs-identifier hs-type">slc</span></a></span><span>
</span><span id="line-644"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-645"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="GreedyParser.html#ActionDouble"><span class="hs-identifier hs-type">ActionDouble</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463641"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463639"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463644"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463645"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463643"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">]</span></span></span></span></span></span></span></span><span>
</span><span id="line-646"></span><span id="collectDoubles"><span class="annot"><span class="annottext">collectDoubles :: forall tr tr' slc slc' h s f.
Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; StartStop slc
-&gt; tr
-&gt; slc
-&gt; tr
-&gt; slc
-&gt; Path tr slc
-&gt; Bool
-&gt; [ActionDouble slc tr s f h]
</span><a href="GreedyParser.html#collectDoubles"><span class="hs-identifier hs-var hs-var">collectDoubles</span></a></span></span><span> </span><span id="local-6989586621679464487"><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
</span><a href="#local-6989586621679464487"><span class="hs-identifier hs-var">eval</span></a></span></span><span> </span><span id="local-6989586621679464488"><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679464488"><span class="hs-identifier hs-var">sstart</span></a></span></span><span> </span><span id="local-6989586621679464489"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464489"><span class="hs-identifier hs-var">tl</span></a></span></span><span> </span><span id="local-6989586621679464490"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464490"><span class="hs-identifier hs-var">sl</span></a></span></span><span> </span><span id="local-6989586621679464491"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464491"><span class="hs-identifier hs-var">tm</span></a></span></span><span> </span><span id="local-6989586621679464492"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464492"><span class="hs-identifier hs-var">sr</span></a></span></span><span> </span><span id="local-6989586621679464493"><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679464493"><span class="hs-identifier hs-var">rst</span></a></span></span><span> </span><span id="local-6989586621679464494"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679464494"><span class="hs-identifier hs-var">afterLeft</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[ActionDouble slc tr s f h]
</span><a href="#local-6989586621679464495"><span class="hs-identifier hs-var">leftUnsplits</span></a></span><span> </span><span class="annot"><span class="annottext">[ActionDouble slc tr s f h]
-&gt; [ActionDouble slc tr s f h] -&gt; [ActionDouble slc tr s f h]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[ActionDouble slc tr s f h]
</span><a href="#local-6989586621679464496"><span class="hs-identifier hs-var">rightUnsplits</span></a></span><span> </span><span class="annot"><span class="annottext">[ActionDouble slc tr s f h]
-&gt; [ActionDouble slc tr s f h] -&gt; [ActionDouble slc tr s f h]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">[ActionDouble slc tr s f h]
</span><a href="#local-6989586621679464497"><span class="hs-identifier hs-var">unspreads</span></a></span><span>
</span><span id="line-647"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-648"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679464498"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464498"><span class="hs-identifier hs-var">tr</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679464499"><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679464499"><span class="hs-identifier hs-var">send</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679464493"><span class="hs-identifier hs-var">rst</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-649"></span><span>    </span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span id="local-6989586621679464500"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464500"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464500"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StartStop slc
forall a. StartStop a
</span><a href="Common.html#Stop"><span class="hs-identifier hs-var">Stop</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-650"></span><span>    </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679464501"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464501"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span id="local-6989586621679464502"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464502"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="annot"><span class="annottext">Path tr slc
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464501"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">slc -&gt; StartStop slc
forall a. a -&gt; StartStop a
</span><a href="Common.html#Inner"><span class="hs-identifier hs-var">Inner</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464502"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-651"></span><span>  </span><span id="local-6989586621679464495"><span class="annot"><span class="annottext">leftUnsplits :: [ActionDouble slc tr s f h]
</span><a href="#local-6989586621679464495"><span class="hs-identifier hs-var hs-var">leftUnsplits</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; StartStop slc
-&gt; tr
-&gt; slc
-&gt; tr
-&gt; slc
-&gt; tr
-&gt; StartStop slc
-&gt; [ActionDouble slc tr s f h]
forall tr tr' slc slc' h s f.
Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; StartStop slc
-&gt; tr
-&gt; slc
-&gt; tr
-&gt; slc
-&gt; tr
-&gt; StartStop slc
-&gt; [ActionDouble slc tr s f h]
</span><a href="GreedyParser.html#collectUnsplitLeft"><span class="hs-identifier hs-var">collectUnsplitLeft</span></a></span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
</span><a href="#local-6989586621679464487"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679464488"><span class="hs-identifier hs-var">sstart</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464489"><span class="hs-identifier hs-var">tl</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464490"><span class="hs-identifier hs-var">sl</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464491"><span class="hs-identifier hs-var">tm</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464492"><span class="hs-identifier hs-var">sr</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464498"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679464499"><span class="hs-identifier hs-var">send</span></a></span><span>
</span><span id="line-652"></span><span>  </span><span id="local-6989586621679464496"><span class="annot"><span class="annottext">rightUnsplits :: [ActionDouble slc tr s f h]
</span><a href="#local-6989586621679464496"><span class="hs-identifier hs-var hs-var">rightUnsplits</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; StartStop slc
-&gt; tr
-&gt; slc
-&gt; tr
-&gt; slc
-&gt; tr
-&gt; StartStop slc
-&gt; Bool
-&gt; [ActionDouble slc tr s f h]
forall tr tr' slc slc' h s f.
Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; StartStop slc
-&gt; tr
-&gt; slc
-&gt; tr
-&gt; slc
-&gt; tr
-&gt; StartStop slc
-&gt; Bool
-&gt; [ActionDouble slc tr s f h]
</span><a href="GreedyParser.html#collectUnsplitRight"><span class="hs-identifier hs-var">collectUnsplitRight</span></a></span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
</span><a href="#local-6989586621679464487"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679464488"><span class="hs-identifier hs-var">sstart</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464489"><span class="hs-identifier hs-var">tl</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464490"><span class="hs-identifier hs-var">sl</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464491"><span class="hs-identifier hs-var">tm</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464492"><span class="hs-identifier hs-var">sr</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464498"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679464499"><span class="hs-identifier hs-var">send</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679464494"><span class="hs-identifier hs-var">afterLeft</span></a></span><span>
</span><span id="line-653"></span><span>  </span><span id="local-6989586621679464497"><span class="annot"><span class="annottext">unspreads :: [ActionDouble slc tr s f h]
</span><a href="#local-6989586621679464497"><span class="hs-identifier hs-var hs-var">unspreads</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; StartStop slc
-&gt; tr
-&gt; slc
-&gt; tr
-&gt; slc
-&gt; tr
-&gt; StartStop slc
-&gt; [ActionDouble slc tr s f h]
forall tr tr' slc slc' h s f.
Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; StartStop slc
-&gt; tr
-&gt; slc
-&gt; tr
-&gt; slc
-&gt; tr
-&gt; StartStop slc
-&gt; [ActionDouble slc tr s f h]
</span><a href="GreedyParser.html#collectUnspreads"><span class="hs-identifier hs-var">collectUnspreads</span></a></span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
</span><a href="#local-6989586621679464487"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679464488"><span class="hs-identifier hs-var">sstart</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464489"><span class="hs-identifier hs-var">tl</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464490"><span class="hs-identifier hs-var">sl</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464491"><span class="hs-identifier hs-var">tm</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464492"><span class="hs-identifier hs-var">sr</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464498"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679464499"><span class="hs-identifier hs-var">send</span></a></span><span>
</span><span id="line-654"></span><span>
</span><span id="line-655"></span><span class="annot"><span class="hs-comment">{- | A policy that picks the next action at random.
 Must be partially applied with a random generator before passing to 'parseGreedy'.
-}</span></span><span>
</span><span id="line-658"></span><span id="local-6989586621679463842"><span id="local-6989586621679463843"><span id="local-6989586621679463845"><span class="annot"><a href="GreedyParser.html#pickRandom"><span class="hs-identifier hs-type">pickRandom</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">StatefulGen</span></span><span> </span><span class="annot"><a href="#local-6989586621679463842"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463843"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679463842"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679463845"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="#local-6989586621679463843"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463845"><span class="hs-identifier hs-type">slc</span></a></span></span></span></span><span>
</span><span id="line-659"></span><span id="pickRandom"><span class="annot"><span class="annottext">pickRandom :: forall g (m :: * -&gt; *) slc.
StatefulGen g m =&gt;
g -&gt; [slc] -&gt; ExceptT String m slc
</span><a href="GreedyParser.html#pickRandom"><span class="hs-identifier hs-var hs-var">pickRandom</span></a></span></span><span> </span><span class="annot"><span class="annottext">g
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; ExceptT String m slc
forall a. String -&gt; ExceptT String m a
forall e (m :: * -&gt; *) a. MonadError e m =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwError</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;No candidates for pickRandom!&quot;</span></span><span>
</span><span id="line-660"></span><span class="annot"><a href="GreedyParser.html#pickRandom"><span class="hs-identifier hs-var">pickRandom</span></a></span><span> </span><span id="local-6989586621679464525"><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679464525"><span class="hs-identifier hs-var">gen</span></a></span></span><span> </span><span id="local-6989586621679464526"><span class="annot"><span class="annottext">[slc]
</span><a href="#local-6989586621679464526"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-661"></span><span>  </span><span id="local-6989586621679464527"><span class="annot"><a href="#local-6989586621679464527"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m Int -&gt; ExceptT String m Int
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ExceptT String m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(m Int -&gt; ExceptT String m Int) -&gt; m Int -&gt; ExceptT String m Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(Int, Int) -&gt; g -&gt; m Int
forall a g (m :: * -&gt; *).
(UniformRange a, StatefulGen g m) =&gt;
(a, a) -&gt; g -&gt; m a
forall g (m :: * -&gt; *). StatefulGen g m =&gt; (Int, Int) -&gt; g -&gt; m Int
</span><span class="hs-identifier hs-var">uniformRM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[slc] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">[slc]
</span><a href="#local-6989586621679464526"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679464525"><span class="hs-identifier hs-var">gen</span></a></span><span>
</span><span id="line-662"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621679464526"><span class="hs-identifier hs-type">xs</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">!!</span></span><span> </span><span class="annot"><a href="#local-6989586621679464527"><span class="hs-identifier hs-type">i</span></a></span><span>
</span><span id="line-663"></span><span>
</span><span id="line-664"></span><span class="annot"><span class="hs-comment">-- * Applying actions</span></span><span>
</span><span id="line-665"></span><span>
</span><span id="line-666"></span><span class="annot"><span class="hs-comment">-- | Apply an action to a parsing state.</span></span><span>
</span><span id="line-667"></span><span class="annot"><a href="GreedyParser.html#applyAction"><span class="hs-identifier hs-type">applyAction</span></a></span><span>
</span><span id="line-668"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679463874"><span class="annot"><a href="#local-6989586621679463874"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679463867"><span class="annot"><a href="#local-6989586621679463867"><span class="hs-identifier hs-type">tr</span></a></span></span><span> </span><span id="local-6989586621679463868"><span class="annot"><a href="#local-6989586621679463868"><span class="hs-identifier hs-type">tr'</span></a></span></span><span> </span><span id="local-6989586621679463869"><span class="annot"><a href="#local-6989586621679463869"><span class="hs-identifier hs-type">slc</span></a></span></span><span> </span><span id="local-6989586621679463873"><span class="annot"><a href="#local-6989586621679463873"><span class="hs-identifier hs-type">slc'</span></a></span></span><span> </span><span id="local-6989586621679463870"><span class="annot"><a href="#local-6989586621679463870"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679463871"><span class="annot"><a href="#local-6989586621679463871"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679463872"><span class="annot"><a href="#local-6989586621679463872"><span class="hs-identifier hs-type">h</span></a></span></span><span>
</span><span id="line-669"></span><span>   </span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="GreedyParser.html#GreedyState"><span class="hs-identifier hs-type">GreedyState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463867"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463868"><span class="hs-identifier hs-type">tr'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463869"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Leftmost"><span class="hs-identifier hs-type">Leftmost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463870"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463871"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463872"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-670"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ the current parsing state</span></span><span>
</span><span id="line-671"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="GreedyParser.html#Action"><span class="hs-identifier hs-type">Action</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463869"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463867"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463870"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463871"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463872"><span class="hs-identifier hs-type">h</span></a></span><span>
</span><span id="line-672"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ the action to be applied</span></span><span>
</span><span id="line-673"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#GreedyState"><span class="hs-identifier hs-type">GreedyState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463867"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463868"><span class="hs-identifier hs-type">tr'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463869"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Leftmost"><span class="hs-identifier hs-type">Leftmost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463870"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463871"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463872"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679463867"><span class="hs-identifier hs-type">tr</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Common.html#Leftmost"><span class="hs-identifier hs-type">Leftmost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463870"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463871"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463872"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-674"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ either the next state or an error message</span></span><span>
</span><span id="line-675"></span><span id="applyAction"><span class="annot"><span class="annottext">applyAction :: forall {k} {k} (m :: k) tr tr' slc (slc' :: k) s f h.
GreedyState tr tr' slc (Leftmost s f h)
-&gt; Action slc tr s f h
-&gt; Either
     String
     (Either
        (GreedyState tr tr' slc (Leftmost s f h)) (tr, [Leftmost s f h]))
</span><a href="GreedyParser.html#applyAction"><span class="hs-identifier hs-var hs-var">applyAction</span></a></span></span><span> </span><span id="local-6989586621679464535"><span class="annot"><span class="annottext">GreedyState tr tr' slc (Leftmost s f h)
</span><a href="#local-6989586621679464535"><span class="hs-identifier hs-var">state</span></a></span></span><span> </span><span id="local-6989586621679464536"><span class="annot"><span class="annottext">Action slc tr s f h
</span><a href="#local-6989586621679464536"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-676"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">GreedyState tr tr' slc (Leftmost s f h)
</span><a href="#local-6989586621679464535"><span class="hs-identifier hs-var">state</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-677"></span><span>    </span><span class="hs-comment">-- case 1: everything frozen</span><span>
</span><span id="line-678"></span><span>    </span><span class="annot"><a href="GreedyParser.html#GSFrozen"><span class="hs-identifier hs-type">GSFrozen</span></a></span><span> </span><span id="local-6989586621679464537"><span class="annot"><span class="annottext">Path (Maybe tr') slc
</span><a href="#local-6989586621679464537"><span class="hs-identifier hs-var">frozen</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-679"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Action slc tr s f h
</span><a href="#local-6989586621679464536"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-680"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#ActionSingle"><span class="hs-identifier hs-type">ActionSingle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#SingleParent"><span class="hs-identifier hs-type">SingleParent</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679464538"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464538"><span class="hs-identifier hs-var">top</span></a></span></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679464539"><span class="annot"><span class="annottext">op :: LeftmostSingle s f
</span><a href="#local-6989586621679464539"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Common.html#LMSingleFreeze"><span class="hs-identifier hs-type">LMSingleFreeze</span></a></span><span> </span><span class="annot"><span class="annottext">f
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-681"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Path (Maybe tr') slc
</span><a href="#local-6989586621679464537"><span class="hs-identifier hs-var">frozen</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-682"></span><span>            </span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe tr'
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">tr
-&gt; [Leftmost s f h]
-&gt; Either
     String
     (Either
        (GreedyState tr tr' slc (Leftmost s f h)) (tr, [Leftmost s f h]))
forall {f :: * -&gt; *} {a} {b} {a}.
Applicative f =&gt;
a -&gt; b -&gt; f (Either a (a, b))
</span><a href="#local-6989586621679464541"><span class="hs-identifier hs-var">finish</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464538"><span class="hs-identifier hs-var">top</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LeftmostSingle s f -&gt; Leftmost s f h
forall s f h. LeftmostSingle s f -&gt; Leftmost s f h
</span><a href="Common.html#LMSingle"><span class="hs-identifier hs-var">LMSingle</span></a></span><span> </span><span class="annot"><span class="annottext">LeftmostSingle s f
</span><a href="#local-6989586621679464539"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-683"></span><span>            </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe tr'
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679464542"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464542"><span class="hs-identifier hs-var">slc</span></a></span></span><span> </span><span id="local-6989586621679464543"><span class="annot"><span class="annottext">Path (Maybe tr') slc
</span><a href="#local-6989586621679464543"><span class="hs-identifier hs-var">rst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GreedyState tr tr' slc (Leftmost s f h)
-&gt; Either
     String
     (Either
        (GreedyState tr tr' slc (Leftmost s f h)) (tr, [Leftmost s f h]))
forall {a} {b}. a -&gt; Either String (Either a b)
</span><a href="#local-6989586621679464544"><span class="hs-identifier hs-var">continue</span></a></span><span> </span><span class="annot"><span class="annottext">(GreedyState tr tr' slc (Leftmost s f h)
 -&gt; Either
      String
      (Either
         (GreedyState tr tr' slc (Leftmost s f h)) (tr, [Leftmost s f h])))
-&gt; GreedyState tr tr' slc (Leftmost s f h)
-&gt; Either
     String
     (Either
        (GreedyState tr tr' slc (Leftmost s f h)) (tr, [Leftmost s f h]))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Path (Maybe tr') slc
-&gt; slc
-&gt; Path tr slc
-&gt; [Leftmost s f h]
-&gt; GreedyState tr tr' slc (Leftmost s f h)
forall tr tr' slc op.
Path (Maybe tr') slc
-&gt; slc -&gt; Path tr slc -&gt; [op] -&gt; GreedyState tr tr' slc op
</span><a href="GreedyParser.html#GSSemiOpen"><span class="hs-identifier hs-var">GSSemiOpen</span></a></span><span> </span><span class="annot"><span class="annottext">Path (Maybe tr') slc
</span><a href="#local-6989586621679464543"><span class="hs-identifier hs-var">rst</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464542"><span class="hs-identifier hs-var">slc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">tr -&gt; Path tr slc
forall around between. around -&gt; Path around between
</span><a href="Common.html#PathEnd"><span class="hs-identifier hs-var">PathEnd</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464538"><span class="hs-identifier hs-var">top</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">LeftmostSingle s f -&gt; Leftmost s f h
forall s f h. LeftmostSingle s f -&gt; Leftmost s f h
</span><a href="Common.html#LMSingle"><span class="hs-identifier hs-var">LMSingle</span></a></span><span> </span><span class="annot"><span class="annottext">LeftmostSingle s f
</span><a href="#local-6989586621679464539"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-684"></span><span>        </span><span class="annot"><span class="annottext">Action slc tr s f h
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
-&gt; Either
     String
     (Either
        (GreedyState tr tr' slc (Leftmost s f h)) (tr, [Leftmost s f h]))
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;cannot apply this operation to frozen state&quot;</span></span><span>
</span><span id="line-685"></span><span>    </span><span class="hs-comment">-- case 2: everything open</span><span>
</span><span id="line-686"></span><span>    </span><span class="annot"><a href="GreedyParser.html#GSOpen"><span class="hs-identifier hs-type">GSOpen</span></a></span><span> </span><span id="local-6989586621679464545"><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679464545"><span class="hs-identifier hs-var">open</span></a></span></span><span> </span><span id="local-6989586621679464546"><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679464546"><span class="hs-identifier hs-var">ops</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679464545"><span class="hs-identifier hs-var">open</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-687"></span><span>      </span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span id="local-6989586621679464547"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464547"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">tr
-&gt; [Leftmost s f h]
-&gt; Either
     String
     (Either
        (GreedyState tr tr' slc (Leftmost s f h)) (tr, [Leftmost s f h]))
forall {f :: * -&gt; *} {a} {b} {a}.
Applicative f =&gt;
a -&gt; b -&gt; f (Either a (a, b))
</span><a href="#local-6989586621679464541"><span class="hs-identifier hs-var">finish</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464547"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679464546"><span class="hs-identifier hs-var">ops</span></a></span><span>
</span><span id="line-688"></span><span>      </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679464548"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464548"><span class="hs-identifier hs-var">tl</span></a></span></span><span> </span><span id="local-6989586621679464549"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464549"><span class="hs-identifier hs-var">slice</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span id="local-6989586621679464550"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464550"><span class="hs-identifier hs-var">tr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-689"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Action slc tr s f h
</span><a href="#local-6989586621679464536"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-690"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#ActionSingle"><span class="hs-identifier hs-type">ActionSingle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#SingleParent"><span class="hs-identifier hs-type">SingleParent</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679464551"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464551"><span class="hs-identifier hs-var">top</span></a></span></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679464552"><span class="annot"><span class="annottext">op :: LeftmostSingle s f
</span><a href="#local-6989586621679464552"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Common.html#LMSingleSplit"><span class="hs-identifier hs-type">LMSingleSplit</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-691"></span><span>            </span><span class="annot"><span class="annottext">tr
-&gt; [Leftmost s f h]
-&gt; Either
     String
     (Either
        (GreedyState tr tr' slc (Leftmost s f h)) (tr, [Leftmost s f h]))
forall {f :: * -&gt; *} {a} {b} {a}.
Applicative f =&gt;
a -&gt; b -&gt; f (Either a (a, b))
</span><a href="#local-6989586621679464541"><span class="hs-identifier hs-var">finish</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464551"><span class="hs-identifier hs-var">top</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LeftmostSingle s f -&gt; Leftmost s f h
forall s f h. LeftmostSingle s f -&gt; Leftmost s f h
</span><a href="Common.html#LMSingle"><span class="hs-identifier hs-var">LMSingle</span></a></span><span> </span><span class="annot"><span class="annottext">LeftmostSingle s f
</span><a href="#local-6989586621679464552"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Leftmost s f h -&gt; [Leftmost s f h] -&gt; [Leftmost s f h]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679464546"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-692"></span><span>          </span><span class="annot"><span class="annottext">Action slc tr s f h
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
-&gt; Either
     String
     (Either
        (GreedyState tr tr' slc (Leftmost s f h)) (tr, [Leftmost s f h]))
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;cannot apply this operation to 2 open transitions&quot;</span></span><span>
</span><span id="line-693"></span><span>      </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679464554"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464554"><span class="hs-identifier hs-var">tl</span></a></span></span><span> </span><span id="local-6989586621679464555"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464555"><span class="hs-identifier hs-var">sl</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679464556"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464556"><span class="hs-identifier hs-var">tm</span></a></span></span><span> </span><span id="local-6989586621679464557"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464557"><span class="hs-identifier hs-var">sm</span></a></span></span><span> </span><span id="local-6989586621679464558"><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679464558"><span class="hs-identifier hs-var">rst</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-694"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Action slc tr s f h
</span><a href="#local-6989586621679464536"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-695"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#ActionDouble"><span class="hs-identifier hs-type">ActionDouble</span></a></span><span> </span><span class="annot"><span class="annottext">DoubleParent slc tr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#LMDoubleFreezeLeft"><span class="hs-identifier hs-type">LMDoubleFreezeLeft</span></a></span><span> </span><span class="annot"><span class="annottext">f
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-696"></span><span>            </span><span class="annot"><span class="annottext">String
-&gt; Either
     String
     (Either
        (GreedyState tr tr' slc (Leftmost s f h)) (tr, [Leftmost s f h]))
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;cannot apply unfreeze in open state&quot;</span></span><span>
</span><span id="line-697"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#ActionDouble"><span class="hs-identifier hs-type">ActionDouble</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#DoubleParent"><span class="hs-identifier hs-type">DoubleParent</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679464559"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464559"><span class="hs-identifier hs-var">topl</span></a></span></span><span> </span><span id="local-6989586621679464560"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464560"><span class="hs-identifier hs-var">tops</span></a></span></span><span> </span><span id="local-6989586621679464561"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464561"><span class="hs-identifier hs-var">topr</span></a></span></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679464562"><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><a href="#local-6989586621679464562"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-698"></span><span>            </span><span class="annot"><span class="annottext">GreedyState tr tr' slc (Leftmost s f h)
-&gt; Either
     String
     (Either
        (GreedyState tr tr' slc (Leftmost s f h)) (tr, [Leftmost s f h]))
forall {a} {b}. a -&gt; Either String (Either a b)
</span><a href="#local-6989586621679464544"><span class="hs-identifier hs-var">continue</span></a></span><span> </span><span class="annot"><span class="annottext">(GreedyState tr tr' slc (Leftmost s f h)
 -&gt; Either
      String
      (Either
         (GreedyState tr tr' slc (Leftmost s f h)) (tr, [Leftmost s f h])))
-&gt; GreedyState tr tr' slc (Leftmost s f h)
-&gt; Either
     String
     (Either
        (GreedyState tr tr' slc (Leftmost s f h)) (tr, [Leftmost s f h]))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Path tr slc
-&gt; [Leftmost s f h] -&gt; GreedyState tr tr' slc (Leftmost s f h)
forall tr tr' slc op.
Path tr slc -&gt; [op] -&gt; GreedyState tr tr' slc op
</span><a href="GreedyParser.html#GSOpen"><span class="hs-identifier hs-var">GSOpen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">tr -&gt; slc -&gt; Path tr slc -&gt; Path tr slc
forall around between.
around -&gt; between -&gt; Path around between -&gt; Path around between
</span><a href="Common.html#Path"><span class="hs-identifier hs-var">Path</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464559"><span class="hs-identifier hs-var">topl</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464560"><span class="hs-identifier hs-var">tops</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Path tr slc -&gt; tr -&gt; Path tr slc
forall a b. Path a b -&gt; a -&gt; Path a b
</span><a href="Common.html#pathSetHead"><span class="hs-identifier hs-var">pathSetHead</span></a></span><span> </span><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679464558"><span class="hs-identifier hs-var">rst</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464561"><span class="hs-identifier hs-var">topr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LeftmostDouble s f h -&gt; Leftmost s f h
forall s f h. LeftmostDouble s f h -&gt; Leftmost s f h
</span><a href="Common.html#LMDouble"><span class="hs-identifier hs-var">LMDouble</span></a></span><span> </span><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><a href="#local-6989586621679464562"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Leftmost s f h -&gt; [Leftmost s f h] -&gt; [Leftmost s f h]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679464546"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-699"></span><span>    </span><span class="hs-comment">-- case 3: some open some closed</span><span>
</span><span id="line-700"></span><span>    </span><span class="annot"><a href="GreedyParser.html#GSSemiOpen"><span class="hs-identifier hs-type">GSSemiOpen</span></a></span><span> </span><span id="local-6989586621679464563"><span class="annot"><span class="annottext">Path (Maybe tr') slc
</span><a href="#local-6989586621679464563"><span class="hs-identifier hs-var">frozen</span></a></span></span><span> </span><span id="local-6989586621679464564"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464564"><span class="hs-identifier hs-var">mid</span></a></span></span><span> </span><span id="local-6989586621679464565"><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679464565"><span class="hs-identifier hs-var">open</span></a></span></span><span> </span><span id="local-6989586621679464566"><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679464566"><span class="hs-identifier hs-var">ops</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Action slc tr s f h
</span><a href="#local-6989586621679464536"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-701"></span><span>      </span><span class="hs-comment">-- single op: unfreeze or unsplit</span><span>
</span><span id="line-702"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Left</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#ActionSingle"><span class="hs-identifier hs-type">ActionSingle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#SingleParent"><span class="hs-identifier hs-type">SingleParent</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679464567"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464567"><span class="hs-identifier hs-var">top</span></a></span></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679464568"><span class="annot"><span class="annottext">LeftmostSingle s f
</span><a href="#local-6989586621679464568"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">LeftmostSingle s f
</span><a href="#local-6989586621679464568"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-703"></span><span>        </span><span class="hs-comment">-- unfreeze single</span><span>
</span><span id="line-704"></span><span>        </span><span class="annot"><a href="Common.html#LMSingleFreeze"><span class="hs-identifier hs-type">LMSingleFreeze</span></a></span><span> </span><span class="annot"><span class="annottext">f
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Path (Maybe tr') slc
</span><a href="#local-6989586621679464563"><span class="hs-identifier hs-var">frozen</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-705"></span><span>          </span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe tr'
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GreedyState tr tr' slc (Leftmost s f h)
-&gt; Either
     String
     (Either
        (GreedyState tr tr' slc (Leftmost s f h)) (tr, [Leftmost s f h]))
forall {a} {b}. a -&gt; Either String (Either a b)
</span><a href="#local-6989586621679464544"><span class="hs-identifier hs-var">continue</span></a></span><span> </span><span class="annot"><span class="annottext">(GreedyState tr tr' slc (Leftmost s f h)
 -&gt; Either
      String
      (Either
         (GreedyState tr tr' slc (Leftmost s f h)) (tr, [Leftmost s f h])))
-&gt; GreedyState tr tr' slc (Leftmost s f h)
-&gt; Either
     String
     (Either
        (GreedyState tr tr' slc (Leftmost s f h)) (tr, [Leftmost s f h]))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Path tr slc
-&gt; [Leftmost s f h] -&gt; GreedyState tr tr' slc (Leftmost s f h)
forall tr tr' slc op.
Path tr slc -&gt; [op] -&gt; GreedyState tr tr' slc op
</span><a href="GreedyParser.html#GSOpen"><span class="hs-identifier hs-var">GSOpen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">tr -&gt; slc -&gt; Path tr slc -&gt; Path tr slc
forall around between.
around -&gt; between -&gt; Path around between -&gt; Path around between
</span><a href="Common.html#Path"><span class="hs-identifier hs-var">Path</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464567"><span class="hs-identifier hs-var">top</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464564"><span class="hs-identifier hs-var">mid</span></a></span><span> </span><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679464565"><span class="hs-identifier hs-var">open</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LeftmostSingle s f -&gt; Leftmost s f h
forall s f h. LeftmostSingle s f -&gt; Leftmost s f h
</span><a href="Common.html#LMSingle"><span class="hs-identifier hs-var">LMSingle</span></a></span><span> </span><span class="annot"><span class="annottext">LeftmostSingle s f
</span><a href="#local-6989586621679464568"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Leftmost s f h -&gt; [Leftmost s f h] -&gt; [Leftmost s f h]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679464566"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-706"></span><span>          </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe tr'
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679464569"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464569"><span class="hs-identifier hs-var">frs</span></a></span></span><span> </span><span id="local-6989586621679464570"><span class="annot"><span class="annottext">Path (Maybe tr') slc
</span><a href="#local-6989586621679464570"><span class="hs-identifier hs-var">frrest</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-707"></span><span>            </span><span class="annot"><span class="annottext">GreedyState tr tr' slc (Leftmost s f h)
-&gt; Either
     String
     (Either
        (GreedyState tr tr' slc (Leftmost s f h)) (tr, [Leftmost s f h]))
forall {a} {b}. a -&gt; Either String (Either a b)
</span><a href="#local-6989586621679464544"><span class="hs-identifier hs-var">continue</span></a></span><span> </span><span class="annot"><span class="annottext">(GreedyState tr tr' slc (Leftmost s f h)
 -&gt; Either
      String
      (Either
         (GreedyState tr tr' slc (Leftmost s f h)) (tr, [Leftmost s f h])))
-&gt; GreedyState tr tr' slc (Leftmost s f h)
-&gt; Either
     String
     (Either
        (GreedyState tr tr' slc (Leftmost s f h)) (tr, [Leftmost s f h]))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Path (Maybe tr') slc
-&gt; slc
-&gt; Path tr slc
-&gt; [Leftmost s f h]
-&gt; GreedyState tr tr' slc (Leftmost s f h)
forall tr tr' slc op.
Path (Maybe tr') slc
-&gt; slc -&gt; Path tr slc -&gt; [op] -&gt; GreedyState tr tr' slc op
</span><a href="GreedyParser.html#GSSemiOpen"><span class="hs-identifier hs-var">GSSemiOpen</span></a></span><span> </span><span class="annot"><span class="annottext">Path (Maybe tr') slc
</span><a href="#local-6989586621679464570"><span class="hs-identifier hs-var">frrest</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464569"><span class="hs-identifier hs-var">frs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">tr -&gt; slc -&gt; Path tr slc -&gt; Path tr slc
forall around between.
around -&gt; between -&gt; Path around between -&gt; Path around between
</span><a href="Common.html#Path"><span class="hs-identifier hs-var">Path</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464567"><span class="hs-identifier hs-var">top</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464564"><span class="hs-identifier hs-var">mid</span></a></span><span> </span><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679464565"><span class="hs-identifier hs-var">open</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LeftmostSingle s f -&gt; Leftmost s f h
forall s f h. LeftmostSingle s f -&gt; Leftmost s f h
</span><a href="Common.html#LMSingle"><span class="hs-identifier hs-var">LMSingle</span></a></span><span> </span><span class="annot"><span class="annottext">LeftmostSingle s f
</span><a href="#local-6989586621679464568"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Leftmost s f h -&gt; [Leftmost s f h] -&gt; [Leftmost s f h]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679464566"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-708"></span><span>        </span><span class="hs-comment">-- unsplit single</span><span>
</span><span id="line-709"></span><span>        </span><span class="annot"><a href="Common.html#LMSingleSplit"><span class="hs-identifier hs-type">LMSingleSplit</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679464565"><span class="hs-identifier hs-var">open</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-710"></span><span>          </span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
-&gt; Either
     String
     (Either
        (GreedyState tr tr' slc (Leftmost s f h)) (tr, [Leftmost s f h]))
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;cannot apply unsplit to single open transition&quot;</span></span><span>
</span><span id="line-711"></span><span>          </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679464571"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464571"><span class="hs-identifier hs-var">topenl</span></a></span></span><span> </span><span id="local-6989586621679464572"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464572"><span class="hs-identifier hs-var">sopen</span></a></span></span><span> </span><span id="local-6989586621679464573"><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679464573"><span class="hs-identifier hs-var">rstopen</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-712"></span><span>            </span><span class="annot"><span class="annottext">GreedyState tr tr' slc (Leftmost s f h)
-&gt; Either
     String
     (Either
        (GreedyState tr tr' slc (Leftmost s f h)) (tr, [Leftmost s f h]))
forall {a} {b}. a -&gt; Either String (Either a b)
</span><a href="#local-6989586621679464544"><span class="hs-identifier hs-var">continue</span></a></span><span> </span><span class="annot"><span class="annottext">(GreedyState tr tr' slc (Leftmost s f h)
 -&gt; Either
      String
      (Either
         (GreedyState tr tr' slc (Leftmost s f h)) (tr, [Leftmost s f h])))
-&gt; GreedyState tr tr' slc (Leftmost s f h)
-&gt; Either
     String
     (Either
        (GreedyState tr tr' slc (Leftmost s f h)) (tr, [Leftmost s f h]))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Path (Maybe tr') slc
-&gt; slc
-&gt; Path tr slc
-&gt; [Leftmost s f h]
-&gt; GreedyState tr tr' slc (Leftmost s f h)
forall tr tr' slc op.
Path (Maybe tr') slc
-&gt; slc -&gt; Path tr slc -&gt; [op] -&gt; GreedyState tr tr' slc op
</span><a href="GreedyParser.html#GSSemiOpen"><span class="hs-identifier hs-var">GSSemiOpen</span></a></span><span> </span><span class="annot"><span class="annottext">Path (Maybe tr') slc
</span><a href="#local-6989586621679464563"><span class="hs-identifier hs-var">frozen</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464564"><span class="hs-identifier hs-var">mid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Path tr slc -&gt; tr -&gt; Path tr slc
forall a b. Path a b -&gt; a -&gt; Path a b
</span><a href="Common.html#pathSetHead"><span class="hs-identifier hs-var">pathSetHead</span></a></span><span> </span><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679464573"><span class="hs-identifier hs-var">rstopen</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464567"><span class="hs-identifier hs-var">top</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LeftmostSingle s f -&gt; Leftmost s f h
forall s f h. LeftmostSingle s f -&gt; Leftmost s f h
</span><a href="Common.html#LMSingle"><span class="hs-identifier hs-var">LMSingle</span></a></span><span> </span><span class="annot"><span class="annottext">LeftmostSingle s f
</span><a href="#local-6989586621679464568"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Leftmost s f h -&gt; [Leftmost s f h] -&gt; [Leftmost s f h]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679464566"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-713"></span><span>      </span><span class="hs-comment">-- double op:</span><span>
</span><span id="line-714"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#ActionDouble"><span class="hs-identifier hs-type">ActionDouble</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#DoubleParent"><span class="hs-identifier hs-type">DoubleParent</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679464574"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464574"><span class="hs-identifier hs-var">topl</span></a></span></span><span> </span><span id="local-6989586621679464575"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464575"><span class="hs-identifier hs-var">tops</span></a></span></span><span> </span><span id="local-6989586621679464576"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464576"><span class="hs-identifier hs-var">topr</span></a></span></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679464577"><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><a href="#local-6989586621679464577"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><a href="#local-6989586621679464577"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-715"></span><span>        </span><span class="hs-comment">-- unfreeze left</span><span>
</span><span id="line-716"></span><span>        </span><span class="annot"><a href="Common.html#LMDoubleFreezeLeft"><span class="hs-identifier hs-type">LMDoubleFreezeLeft</span></a></span><span> </span><span class="annot"><span class="annottext">f
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Path (Maybe tr') slc
</span><a href="#local-6989586621679464563"><span class="hs-identifier hs-var">frozen</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-717"></span><span>          </span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe tr'
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">GreedyState tr tr' slc (Leftmost s f h)
-&gt; Either
     String
     (Either
        (GreedyState tr tr' slc (Leftmost s f h)) (tr, [Leftmost s f h]))
forall {a} {b}. a -&gt; Either String (Either a b)
</span><a href="#local-6989586621679464544"><span class="hs-identifier hs-var">continue</span></a></span><span> </span><span class="annot"><span class="annottext">(GreedyState tr tr' slc (Leftmost s f h)
 -&gt; Either
      String
      (Either
         (GreedyState tr tr' slc (Leftmost s f h)) (tr, [Leftmost s f h])))
-&gt; GreedyState tr tr' slc (Leftmost s f h)
-&gt; Either
     String
     (Either
        (GreedyState tr tr' slc (Leftmost s f h)) (tr, [Leftmost s f h]))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Path tr slc
-&gt; [Leftmost s f h] -&gt; GreedyState tr tr' slc (Leftmost s f h)
forall tr tr' slc op.
Path tr slc -&gt; [op] -&gt; GreedyState tr tr' slc op
</span><a href="GreedyParser.html#GSOpen"><span class="hs-identifier hs-var">GSOpen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">tr -&gt; slc -&gt; Path tr slc -&gt; Path tr slc
forall around between.
around -&gt; between -&gt; Path around between -&gt; Path around between
</span><a href="Common.html#Path"><span class="hs-identifier hs-var">Path</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464574"><span class="hs-identifier hs-var">topl</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464564"><span class="hs-identifier hs-var">mid</span></a></span><span> </span><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679464565"><span class="hs-identifier hs-var">open</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LeftmostDouble s f h -&gt; Leftmost s f h
forall s f h. LeftmostDouble s f h -&gt; Leftmost s f h
</span><a href="Common.html#LMDouble"><span class="hs-identifier hs-var">LMDouble</span></a></span><span> </span><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><a href="#local-6989586621679464577"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Leftmost s f h -&gt; [Leftmost s f h] -&gt; [Leftmost s f h]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679464566"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-718"></span><span>          </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe tr'
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679464578"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464578"><span class="hs-identifier hs-var">mid'</span></a></span></span><span> </span><span id="local-6989586621679464579"><span class="annot"><span class="annottext">Path (Maybe tr') slc
</span><a href="#local-6989586621679464579"><span class="hs-identifier hs-var">frozen'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-719"></span><span>            </span><span class="annot"><span class="annottext">GreedyState tr tr' slc (Leftmost s f h)
-&gt; Either
     String
     (Either
        (GreedyState tr tr' slc (Leftmost s f h)) (tr, [Leftmost s f h]))
forall {a} {b}. a -&gt; Either String (Either a b)
</span><a href="#local-6989586621679464544"><span class="hs-identifier hs-var">continue</span></a></span><span> </span><span class="annot"><span class="annottext">(GreedyState tr tr' slc (Leftmost s f h)
 -&gt; Either
      String
      (Either
         (GreedyState tr tr' slc (Leftmost s f h)) (tr, [Leftmost s f h])))
-&gt; GreedyState tr tr' slc (Leftmost s f h)
-&gt; Either
     String
     (Either
        (GreedyState tr tr' slc (Leftmost s f h)) (tr, [Leftmost s f h]))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Path (Maybe tr') slc
-&gt; slc
-&gt; Path tr slc
-&gt; [Leftmost s f h]
-&gt; GreedyState tr tr' slc (Leftmost s f h)
forall tr tr' slc op.
Path (Maybe tr') slc
-&gt; slc -&gt; Path tr slc -&gt; [op] -&gt; GreedyState tr tr' slc op
</span><a href="GreedyParser.html#GSSemiOpen"><span class="hs-identifier hs-var">GSSemiOpen</span></a></span><span> </span><span class="annot"><span class="annottext">Path (Maybe tr') slc
</span><a href="#local-6989586621679464579"><span class="hs-identifier hs-var">frozen'</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464578"><span class="hs-identifier hs-var">mid'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">tr -&gt; slc -&gt; Path tr slc -&gt; Path tr slc
forall around between.
around -&gt; between -&gt; Path around between -&gt; Path around between
</span><a href="Common.html#Path"><span class="hs-identifier hs-var">Path</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464574"><span class="hs-identifier hs-var">topl</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464564"><span class="hs-identifier hs-var">mid</span></a></span><span> </span><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679464565"><span class="hs-identifier hs-var">open</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LeftmostDouble s f h -&gt; Leftmost s f h
forall s f h. LeftmostDouble s f h -&gt; Leftmost s f h
</span><a href="Common.html#LMDouble"><span class="hs-identifier hs-var">LMDouble</span></a></span><span> </span><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><a href="#local-6989586621679464577"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Leftmost s f h -&gt; [Leftmost s f h] -&gt; [Leftmost s f h]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679464566"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-720"></span><span>        </span><span class="hs-comment">-- unsplit left</span><span>
</span><span id="line-721"></span><span>        </span><span class="annot"><a href="Common.html#LMDoubleSplitLeft"><span class="hs-identifier hs-type">LMDoubleSplitLeft</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679464565"><span class="hs-identifier hs-var">open</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-722"></span><span>          </span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
-&gt; Either
     String
     (Either
        (GreedyState tr tr' slc (Leftmost s f h)) (tr, [Leftmost s f h]))
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;cannot apply unsplit to single open transition&quot;</span></span><span>
</span><span id="line-723"></span><span>          </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679464580"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464580"><span class="hs-identifier hs-var">sopen</span></a></span></span><span> </span><span id="local-6989586621679464581"><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679464581"><span class="hs-identifier hs-var">rst</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-724"></span><span>            </span><span class="annot"><span class="annottext">GreedyState tr tr' slc (Leftmost s f h)
-&gt; Either
     String
     (Either
        (GreedyState tr tr' slc (Leftmost s f h)) (tr, [Leftmost s f h]))
forall {a} {b}. a -&gt; Either String (Either a b)
</span><a href="#local-6989586621679464544"><span class="hs-identifier hs-var">continue</span></a></span><span> </span><span class="annot"><span class="annottext">(GreedyState tr tr' slc (Leftmost s f h)
 -&gt; Either
      String
      (Either
         (GreedyState tr tr' slc (Leftmost s f h)) (tr, [Leftmost s f h])))
-&gt; GreedyState tr tr' slc (Leftmost s f h)
-&gt; Either
     String
     (Either
        (GreedyState tr tr' slc (Leftmost s f h)) (tr, [Leftmost s f h]))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Path (Maybe tr') slc
-&gt; slc
-&gt; Path tr slc
-&gt; [Leftmost s f h]
-&gt; GreedyState tr tr' slc (Leftmost s f h)
forall tr tr' slc op.
Path (Maybe tr') slc
-&gt; slc -&gt; Path tr slc -&gt; [op] -&gt; GreedyState tr tr' slc op
</span><a href="GreedyParser.html#GSSemiOpen"><span class="hs-identifier hs-var">GSSemiOpen</span></a></span><span> </span><span class="annot"><span class="annottext">Path (Maybe tr') slc
</span><a href="#local-6989586621679464563"><span class="hs-identifier hs-var">frozen</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464564"><span class="hs-identifier hs-var">mid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Path tr slc -&gt; tr -&gt; Path tr slc
forall a b. Path a b -&gt; a -&gt; Path a b
</span><a href="Common.html#pathSetHead"><span class="hs-identifier hs-var">pathSetHead</span></a></span><span> </span><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679464581"><span class="hs-identifier hs-var">rst</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464574"><span class="hs-identifier hs-var">topl</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LeftmostDouble s f h -&gt; Leftmost s f h
forall s f h. LeftmostDouble s f h -&gt; Leftmost s f h
</span><a href="Common.html#LMDouble"><span class="hs-identifier hs-var">LMDouble</span></a></span><span> </span><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><a href="#local-6989586621679464577"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Leftmost s f h -&gt; [Leftmost s f h] -&gt; [Leftmost s f h]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679464566"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-725"></span><span>        </span><span class="hs-comment">-- unsplit right or unspread</span><span>
</span><span id="line-726"></span><span>        </span><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679464565"><span class="hs-identifier hs-var">open</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-727"></span><span>          </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679464582"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464582"><span class="hs-identifier hs-var">_tl</span></a></span></span><span> </span><span id="local-6989586621679464583"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464583"><span class="hs-identifier hs-var">_sl</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679464584"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464584"><span class="hs-identifier hs-var">_tm</span></a></span></span><span> </span><span id="local-6989586621679464585"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464585"><span class="hs-identifier hs-var">_sr</span></a></span></span><span> </span><span id="local-6989586621679464586"><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679464586"><span class="hs-identifier hs-var">rst</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-728"></span><span>            </span><span class="annot"><span class="annottext">GreedyState tr tr' slc (Leftmost s f h)
-&gt; Either
     String
     (Either
        (GreedyState tr tr' slc (Leftmost s f h)) (tr, [Leftmost s f h]))
forall {a} {b}. a -&gt; Either String (Either a b)
</span><a href="#local-6989586621679464544"><span class="hs-identifier hs-var">continue</span></a></span><span> </span><span class="annot"><span class="annottext">(GreedyState tr tr' slc (Leftmost s f h)
 -&gt; Either
      String
      (Either
         (GreedyState tr tr' slc (Leftmost s f h)) (tr, [Leftmost s f h])))
-&gt; GreedyState tr tr' slc (Leftmost s f h)
-&gt; Either
     String
     (Either
        (GreedyState tr tr' slc (Leftmost s f h)) (tr, [Leftmost s f h]))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Path (Maybe tr') slc
-&gt; slc
-&gt; Path tr slc
-&gt; [Leftmost s f h]
-&gt; GreedyState tr tr' slc (Leftmost s f h)
forall tr tr' slc op.
Path (Maybe tr') slc
-&gt; slc -&gt; Path tr slc -&gt; [op] -&gt; GreedyState tr tr' slc op
</span><a href="GreedyParser.html#GSSemiOpen"><span class="hs-identifier hs-var">GSSemiOpen</span></a></span><span> </span><span class="annot"><span class="annottext">Path (Maybe tr') slc
</span><a href="#local-6989586621679464563"><span class="hs-identifier hs-var">frozen</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464564"><span class="hs-identifier hs-var">mid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">tr -&gt; slc -&gt; Path tr slc -&gt; Path tr slc
forall around between.
around -&gt; between -&gt; Path around between -&gt; Path around between
</span><a href="Common.html#Path"><span class="hs-identifier hs-var">Path</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464574"><span class="hs-identifier hs-var">topl</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679464575"><span class="hs-identifier hs-var">tops</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Path tr slc -&gt; tr -&gt; Path tr slc
forall a b. Path a b -&gt; a -&gt; Path a b
</span><a href="Common.html#pathSetHead"><span class="hs-identifier hs-var">pathSetHead</span></a></span><span> </span><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679464586"><span class="hs-identifier hs-var">rst</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679464576"><span class="hs-identifier hs-var">topr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">LeftmostDouble s f h -&gt; Leftmost s f h
forall s f h. LeftmostDouble s f h -&gt; Leftmost s f h
</span><a href="Common.html#LMDouble"><span class="hs-identifier hs-var">LMDouble</span></a></span><span> </span><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><a href="#local-6989586621679464577"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Leftmost s f h -&gt; [Leftmost s f h] -&gt; [Leftmost s f h]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679464566"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-729"></span><span>          </span><span class="annot"><span class="annottext">Path tr slc
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
-&gt; Either
     String
     (Either
        (GreedyState tr tr' slc (Leftmost s f h)) (tr, [Leftmost s f h]))
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;cannot apply unsplit right or unspread to less than 3 open transitions&quot;</span></span><span>
</span><span id="line-730"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-731"></span><span>  </span><span id="local-6989586621679464544"><span class="annot"><span class="annottext">continue :: a -&gt; Either String (Either a b)
</span><a href="#local-6989586621679464544"><span class="hs-identifier hs-var hs-var">continue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either a b -&gt; Either String (Either a b)
forall a. a -&gt; Either String a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Either a b -&gt; Either String (Either a b))
-&gt; (a -&gt; Either a b) -&gt; a -&gt; Either String (Either a b)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Either a b
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span>
</span><span id="line-732"></span><span>  </span><span id="local-6989586621679464541"><span class="annot"><span class="annottext">finish :: a -&gt; b -&gt; f (Either a (a, b))
</span><a href="#local-6989586621679464541"><span class="hs-identifier hs-var hs-var">finish</span></a></span></span><span> </span><span id="local-6989586621679464594"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679464594"><span class="hs-identifier hs-var">top</span></a></span></span><span> </span><span id="local-6989586621679464595"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679464595"><span class="hs-identifier hs-var">ops</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either a (a, b) -&gt; f (Either a (a, b))
forall a. a -&gt; f a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Either a (a, b) -&gt; f (Either a (a, b)))
-&gt; Either a (a, b) -&gt; f (Either a (a, b))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(a, b) -&gt; Either a (a, b)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679464594"><span class="hs-identifier hs-var">top</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679464595"><span class="hs-identifier hs-var">ops</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-733"></span><span>
</span><span id="line-734"></span><span class="annot"><span class="hs-comment">-- * Entry Points</span></span><span>
</span><span id="line-735"></span><span>
</span><span id="line-736"></span><span class="annot"><span class="hs-comment">-- | Parse a piece randomly using a fresh random number generator.</span></span><span>
</span><span id="line-737"></span><span id="local-6989586621679463889"><span id="local-6989586621679463890"><span id="local-6989586621679463891"><span id="local-6989586621679463892"><span id="local-6989586621679463893"><span id="local-6989586621679463894"><span id="local-6989586621679463895"><span class="annot"><a href="GreedyParser.html#parseRandom"><span class="hs-identifier hs-type">parseRandom</span></a></span><span>
</span><span id="line-738"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679463889"><span class="hs-identifier hs-type">tr'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679463890"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679463891"><span class="hs-identifier hs-type">tr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679463892"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679463893"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679463894"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-739"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Common.html#Eval"><span class="hs-identifier hs-type">Eval</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463891"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463889"><span class="hs-identifier hs-type">tr'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463890"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463895"><span class="hs-identifier hs-type">slc'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463894"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Leftmost"><span class="hs-identifier hs-type">Leftmost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463892"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463893"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463894"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-740"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ the grammar's evaluator</span></span><span>
</span><span id="line-741"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463895"><span class="hs-identifier hs-type">slc'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463889"><span class="hs-identifier hs-type">tr'</span></a></span><span>
</span><span id="line-742"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ the input piece</span></span><span>
</span><span id="line-743"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Analysis"><span class="hs-identifier hs-type">Analysis</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463892"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463893"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463894"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463891"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463890"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span><span>
</span><span id="line-744"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ a random reduction of the piece (or an error message)</span></span><span>
</span><span id="line-745"></span><span id="parseRandom"><span class="annot"><span class="annottext">parseRandom :: forall tr' slc tr s f h slc'.
(Show tr', Show slc, Show tr, Show s, Show f, Show h) =&gt;
Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; Path slc' tr' -&gt; ExceptT String IO (Analysis s f h tr slc)
</span><a href="GreedyParser.html#parseRandom"><span class="hs-identifier hs-var hs-var">parseRandom</span></a></span></span><span> </span><span id="local-6989586621679464626"><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
</span><a href="#local-6989586621679464626"><span class="hs-identifier hs-var">eval</span></a></span></span><span> </span><span id="local-6989586621679464627"><span class="annot"><span class="annottext">Path slc' tr'
</span><a href="#local-6989586621679464627"><span class="hs-identifier hs-var">input</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-746"></span><span>  </span><span id="local-6989586621679464628"><span class="annot"><a href="#local-6989586621679464628"><span class="hs-identifier hs-var">gen</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO StdGen -&gt; ExceptT String IO StdGen
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ExceptT String m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">IO StdGen
forall (m :: * -&gt; *). MonadIO m =&gt; m StdGen
</span><span class="hs-identifier hs-var">initStdGen</span></span><span>
</span><span id="line-747"></span><span>  </span><span id="local-6989586621679464629"><span class="annot"><a href="#local-6989586621679464629"><span class="hs-identifier hs-var">mgen</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">lift</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">newIOGenM</span></span><span> </span><span class="annot"><a href="#local-6989586621679464628"><span class="hs-identifier hs-type">gen</span></a></span><span>
</span><span id="line-748"></span><span>  </span><span class="annot"><a href="GreedyParser.html#parseGreedy"><span class="hs-identifier hs-type">parseGreedy</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679464626"><span class="hs-identifier hs-type">eval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="GreedyParser.html#pickRandom"><span class="hs-identifier hs-type">pickRandom</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679464629"><span class="hs-identifier hs-type">mgen</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679464627"><span class="hs-identifier hs-type">input</span></a></span><span>
</span><span id="line-749"></span><span>
</span><span id="line-750"></span><span class="annot"><span class="hs-comment">-- | Parse a piece randomly using an existing random number generator.</span></span><span>
</span><span id="line-751"></span><span id="local-6989586621679463911"><span id="local-6989586621679463912"><span id="local-6989586621679463913"><span id="local-6989586621679463914"><span id="local-6989586621679463915"><span id="local-6989586621679463916"><span id="local-6989586621679463917"><span id="local-6989586621679463918"><span class="annot"><a href="GreedyParser.html#parseRandom%27"><span class="hs-identifier hs-type">parseRandom'</span></a></span><span>
</span><span id="line-752"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679463911"><span class="hs-identifier hs-type">tr'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679463912"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679463913"><span class="hs-identifier hs-type">tr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679463914"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679463915"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679463916"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StatefulGen</span></span><span> </span><span class="annot"><a href="#local-6989586621679463917"><span class="hs-identifier hs-type">g</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span class="hs-special">)</span><span>
</span><span id="line-753"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679463917"><span class="hs-identifier hs-type">g</span></a></span><span>
</span><span id="line-754"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ a random number generator</span></span><span>
</span><span id="line-755"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#Eval"><span class="hs-identifier hs-type">Eval</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463913"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463911"><span class="hs-identifier hs-type">tr'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463912"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463918"><span class="hs-identifier hs-type">slc'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463916"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Leftmost"><span class="hs-identifier hs-type">Leftmost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463914"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463915"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463916"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-756"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ the grammar's evaluator</span></span><span>
</span><span id="line-757"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463918"><span class="hs-identifier hs-type">slc'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463911"><span class="hs-identifier hs-type">tr'</span></a></span><span>
</span><span id="line-758"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ the input piece</span></span><span>
</span><span id="line-759"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Analysis"><span class="hs-identifier hs-type">Analysis</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463914"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463915"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463916"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463913"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679463912"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span></span><span>
</span><span id="line-760"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ a random reduction of the piece (or an error message)</span></span><span>
</span><span id="line-761"></span><span id="parseRandom%27"><span class="annot"><span class="annottext">parseRandom' :: forall tr' slc tr s f h g slc'.
(Show tr', Show slc, Show tr, Show s, Show f, Show h,
 StatefulGen g IO) =&gt;
g
-&gt; Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; Path slc' tr'
-&gt; ExceptT String IO (Analysis s f h tr slc)
</span><a href="GreedyParser.html#parseRandom%27"><span class="hs-identifier hs-var hs-var">parseRandom'</span></a></span></span><span> </span><span id="local-6989586621679464648"><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679464648"><span class="hs-identifier hs-var">mgen</span></a></span></span><span> </span><span id="local-6989586621679464649"><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
</span><a href="#local-6989586621679464649"><span class="hs-identifier hs-var">eval</span></a></span></span><span> </span><span id="local-6989586621679464650"><span class="annot"><span class="annottext">Path slc' tr'
</span><a href="#local-6989586621679464650"><span class="hs-identifier hs-var">input</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-762"></span><span>  </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; ([Action slc tr s f h]
    -&gt; ExceptT String IO (Action slc tr s f h))
-&gt; Path slc' tr'
-&gt; ExceptT String IO (Analysis s f h tr slc)
forall (m :: * -&gt; *) tr tr' slc slc' s f h.
(Monad m, MonadIO m, Show tr', Show slc, Show tr, Show s, Show f,
 Show h) =&gt;
Eval tr tr' slc slc' h (Leftmost s f h)
-&gt; ([Action slc tr s f h]
    -&gt; ExceptT String m (Action slc tr s f h))
-&gt; Path slc' tr'
-&gt; ExceptT String m (Analysis s f h tr slc)
</span><a href="GreedyParser.html#parseGreedy"><span class="hs-identifier hs-var">parseGreedy</span></a></span><span> </span><span class="annot"><span class="annottext">Eval tr tr' slc slc' h (Leftmost s f h)
</span><a href="#local-6989586621679464649"><span class="hs-identifier hs-var">eval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">g
-&gt; [Action slc tr s f h] -&gt; ExceptT String IO (Action slc tr s f h)
forall g (m :: * -&gt; *) slc.
StatefulGen g m =&gt;
g -&gt; [slc] -&gt; ExceptT String m slc
</span><a href="GreedyParser.html#pickRandom"><span class="hs-identifier hs-var">pickRandom</span></a></span><span> </span><span class="annot"><span class="annottext">g
</span><a href="#local-6989586621679464648"><span class="hs-identifier hs-var">mgen</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Path slc' tr'
</span><a href="#local-6989586621679464650"><span class="hs-identifier hs-var">input</span></a></span><span>
</span><span id="line-763"></span></pre></body></html>