<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DeriveAnyClass #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE PatternSynonyms #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-partial-type-signatures #-}</span><span>
</span><span id="line-7"></span><span>
</span><span id="line-8"></span><span class="annot"><span class="hs-comment">-- | Common types and functionality that are used throughout the model.</span></span><span>
</span><span id="line-9"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Common.html"><span class="hs-identifier">Common</span></a></span><span>
</span><span id="line-10"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- * Paths #paths#</span></span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span>    </span><span class="hs-comment">-- | Paths encode sequences of alternating objects (such as nodes and edges).</span><span>
</span><span id="line-13"></span><span>    </span><span class="hs-comment">-- They are often used to encode sequences of slices and transitions.</span><span>
</span><span id="line-14"></span><span>    </span><span class="hs-comment">-- Note that dependending on context,</span><span>
</span><span id="line-15"></span><span>    </span><span class="hs-comment">-- both slice-transition-slice and transition-slice-transition orders are used.</span><span>
</span><span id="line-16"></span><span>    </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier">Path</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#pathLen"><span class="hs-identifier">pathLen</span></a></span><span>
</span><span id="line-18"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#pathHead"><span class="hs-identifier">pathHead</span></a></span><span>
</span><span id="line-19"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#pathSetHead"><span class="hs-identifier">pathSetHead</span></a></span><span>
</span><span id="line-20"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#mapArounds"><span class="hs-identifier">mapArounds</span></a></span><span>
</span><span id="line-21"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#mapAroundsWithIndex"><span class="hs-identifier">mapAroundsWithIndex</span></a></span><span>
</span><span id="line-22"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#mapBetweens"><span class="hs-identifier">mapBetweens</span></a></span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#reversePath"><span class="hs-identifier">reversePath</span></a></span><span>
</span><span id="line-24"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#pathArounds"><span class="hs-identifier">pathArounds</span></a></span><span>
</span><span id="line-25"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#pathBetweens"><span class="hs-identifier">pathBetweens</span></a></span><span>
</span><span id="line-26"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#pathTake"><span class="hs-identifier">pathTake</span></a></span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span>    </span><span class="annot"><span class="hs-comment">-- * StartStop #startstop#</span></span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span>    </span><span class="annot"><span class="hs-comment">-- | 'StartStop' is a wrapper that augments a type with special values for beginning and end.</span></span><span>
</span><span id="line-31"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier">StartStop</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#onlyInner"><span class="hs-identifier">onlyInner</span></a></span><span>
</span><span id="line-33"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#getInner"><span class="hs-identifier">getInner</span></a></span><span>
</span><span id="line-34"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#getInnerE"><span class="hs-identifier">getInnerE</span></a></span><span>
</span><span id="line-35"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#isInner"><span class="hs-identifier">isInner</span></a></span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#isStart"><span class="hs-identifier">isStart</span></a></span><span>
</span><span id="line-37"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#isStop"><span class="hs-identifier">isStop</span></a></span><span>
</span><span id="line-38"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#distStartStop"><span class="hs-identifier">distStartStop</span></a></span><span>
</span><span id="line-39"></span><span>
</span><span id="line-40"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Evaluators #evals#</span></span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span>    </span><span class="hs-comment">-- | Evaluators ('Eval') are the main parsing interface for a grammar.</span><span>
</span><span id="line-43"></span><span>    </span><span class="hs-comment">-- They bundle a number of functions that compute local &quot;completions&quot;</span><span>
</span><span id="line-44"></span><span>    </span><span class="hs-comment">-- (i.e., parent objects and generative operations)</span><span>
</span><span id="line-45"></span><span>    </span><span class="hs-comment">-- from child objects.</span><span>
</span><span id="line-46"></span><span>    </span><span class="hs-comment">-- Parsers use these evaluators to generically parse an input sequence</span><span>
</span><span id="line-47"></span><span>    </span><span class="hs-comment">-- since all the grammar-specific parsing code is provided by the evaluator.</span><span>
</span><span id="line-48"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-49"></span><span>    </span><span class="hs-comment">-- Evaluators can be transformed and combined using 'mapEvalScore' and 'productEval' respectively.</span><span>
</span><span id="line-50"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#SplitType"><span class="hs-identifier">SplitType</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#UnspreadMiddle"><span class="hs-identifier">UnspreadMiddle</span></a></span><span>
</span><span id="line-52"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#UnspreadLeft"><span class="hs-identifier">UnspreadLeft</span></a></span><span>
</span><span id="line-53"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#UnspreadRight"><span class="hs-identifier">UnspreadRight</span></a></span><span>
</span><span id="line-54"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#Unsplit"><span class="hs-identifier">Unsplit</span></a></span><span>
</span><span id="line-55"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#Eval"><span class="hs-identifier">Eval</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#IsLast"><span class="hs-identifier">IsLast</span></a></span><span>
</span><span id="line-57"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#mapEvalScore"><span class="hs-identifier">mapEvalScore</span></a></span><span>
</span><span id="line-58"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#productEval"><span class="hs-identifier">productEval</span></a></span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Special Restricting Evaluators #special-evals#</span></span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span>    </span><span class="hs-comment">-- | Some special evaluators that can be combined with grammar-specific evaluators</span><span>
</span><span id="line-63"></span><span>    </span><span class="hs-comment">-- to restrict the possibile derivations.</span><span>
</span><span id="line-64"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#RightBranchSpread"><span class="hs-identifier">RightBranchSpread</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#evalRightBranchSpread"><span class="hs-identifier">evalRightBranchSpread</span></a></span><span>
</span><span id="line-66"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#rightBranchSpread"><span class="hs-identifier">rightBranchSpread</span></a></span><span>
</span><span id="line-67"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#Merged"><span class="hs-identifier">Merged</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#evalSplitBeforeSpread"><span class="hs-identifier">evalSplitBeforeSpread</span></a></span><span>
</span><span id="line-69"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#splitFirst"><span class="hs-identifier">splitFirst</span></a></span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Leftmost Derivations #leftmost#</span></span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span>    </span><span class="hs-comment">-- | Derivations can be represented as lists of operations in leftmost-first order.</span><span>
</span><span id="line-74"></span><span>    </span><span class="hs-comment">-- In this order, each operation (split, spread, or freeze)</span><span>
</span><span id="line-75"></span><span>    </span><span class="hs-comment">-- is applied to the leftmost non-terminal transition(s).</span><span>
</span><span id="line-76"></span><span>    </span><span class="annot"><span class="hs-comment">-- $leftmostdoc</span></span><span>
</span><span id="line-77"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#Leftmost"><span class="hs-identifier">Leftmost</span></a></span><span>
</span><span id="line-78"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Common.html#LMDouble"><span class="hs-identifier">LMDouble</span></a></span><span>
</span><span id="line-79"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#LMFreezeLeft"><span class="hs-identifier">LMFreezeLeft</span></a></span><span>
</span><span id="line-80"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#LMFreezeOnly"><span class="hs-identifier">LMFreezeOnly</span></a></span><span>
</span><span id="line-81"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#LMSingle"><span class="hs-identifier">LMSingle</span></a></span><span>
</span><span id="line-82"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#LMSplitLeft"><span class="hs-identifier">LMSplitLeft</span></a></span><span>
</span><span id="line-83"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#LMSplitOnly"><span class="hs-identifier">LMSplitOnly</span></a></span><span>
</span><span id="line-84"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#LMSplitRight"><span class="hs-identifier">LMSplitRight</span></a></span><span>
</span><span id="line-85"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#LMSpread"><span class="hs-identifier">LMSpread</span></a></span><span>
</span><span id="line-86"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#LeftmostSingle"><span class="hs-identifier">LeftmostSingle</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#LeftmostDouble"><span class="hs-identifier">LeftmostDouble</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#Analysis"><span class="hs-identifier">Analysis</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#debugAnalysis"><span class="hs-identifier">debugAnalysis</span></a></span><span>
</span><span id="line-91"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#mkLeftmostEval"><span class="hs-identifier">mkLeftmostEval</span></a></span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Monadic Interface for Constructing Derivations #monadicDeriv#</span></span><span>
</span><span id="line-94"></span><span>    </span><span class="annot"><span class="hs-comment">-- $monadicdoc</span></span><span>
</span><span id="line-95"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#PartialDerivation"><span class="hs-identifier">PartialDerivation</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#DerivationInfo"><span class="hs-identifier">DerivationInfo</span></a></span><span>
</span><span id="line-97"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#IndexedWriter"><span class="hs-identifier">IndexedWriter</span></a></span><span>
</span><span id="line-98"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#itell"><span class="hs-identifier">itell</span></a></span><span>
</span><span id="line-99"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#DerivationAction"><span class="hs-identifier">DerivationAction</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#buildDerivation"><span class="hs-identifier">buildDerivation</span></a></span><span>
</span><span id="line-101"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#buildPartialDerivation"><span class="hs-identifier">buildPartialDerivation</span></a></span><span>
</span><span id="line-102"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#split"><span class="hs-identifier">split</span></a></span><span>
</span><span id="line-103"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#freeze"><span class="hs-identifier">freeze</span></a></span><span>
</span><span id="line-104"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#splitRight"><span class="hs-identifier">splitRight</span></a></span><span>
</span><span id="line-105"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#spread"><span class="hs-identifier">spread</span></a></span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Derivations Semiring #derivSemiring#</span></span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span>    </span><span class="annot"><span class="hs-comment">-- | A generic semiring that represents a collection of derivations as prefix trees.</span></span><span>
</span><span id="line-110"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#Derivations"><span class="hs-identifier">Derivations</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#mapDerivations"><span class="hs-identifier">mapDerivations</span></a></span><span>
</span><span id="line-112"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#flattenDerivations"><span class="hs-identifier">flattenDerivations</span></a></span><span>
</span><span id="line-113"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#flattenDerivationsRed"><span class="hs-identifier">flattenDerivationsRed</span></a></span><span>
</span><span id="line-114"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#firstDerivation"><span class="hs-identifier">firstDerivation</span></a></span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Utilities #utils#</span></span><span>
</span><span id="line-117"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#cartProd"><span class="hs-identifier">cartProd</span></a></span><span>
</span><span id="line-118"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#traverseSet"><span class="hs-identifier">traverseSet</span></a></span><span>
</span><span id="line-119"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#variantDefaults"><span class="hs-identifier">variantDefaults</span></a></span><span>
</span><span id="line-120"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#firstToLower"><span class="hs-identifier">firstToLower</span></a></span><span>
</span><span id="line-121"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#traceLevel"><span class="hs-identifier">traceLevel</span></a></span><span>
</span><span id="line-122"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#traceIf"><span class="hs-identifier">traceIf</span></a></span><span>
</span><span id="line-123"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#showTex"><span class="hs-identifier">showTex</span></a></span><span>
</span><span id="line-124"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#showTexT"><span class="hs-identifier">showTexT</span></a></span><span>
</span><span id="line-125"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.DeepSeq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NFData</span></span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">when</span></span><span class="hs-special">)</span><span>
</span><span id="line-129"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Except</span></span><span>
</span><span id="line-130"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">ExceptT</span></span><span>
</span><span id="line-131"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">runExceptT</span></span><span>
</span><span id="line-132"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Indexed</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">MI</span></span><span>
</span><span id="line-134"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">lift</span></span><span class="hs-special">)</span><span>
</span><span id="line-135"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Except</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">except</span></span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Writer.Strict</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">MW</span></span><span>
</span><span id="line-137"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson</span></span><span>
</span><span id="line-138"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">FromJSON</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ToJSON</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(.:)</span></span><span>
</span><span id="line-141"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(.=)</span></span><span>
</span><span id="line-142"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-143"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Aeson</span></span><span>
</span><span id="line-144"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson.Types</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">unexpected</span></span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson.Types</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Aeson</span></span><span>
</span><span id="line-146"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Bifunctor</span></span><span>
</span><span id="line-147"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Bifunctor</span></span><span>
</span><span id="line-148"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">bimap</span></span><span>
</span><span id="line-149"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">second</span></span><span>
</span><span id="line-150"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.HashSet</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">HS</span></span><span>
</span><span id="line-152"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Hashable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Hashable</span></span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Kind</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Type</span></span><span class="hs-special">)</span><span>
</span><span id="line-154"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Semigroup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">stimesMonoid</span></span><span class="hs-special">)</span><span>
</span><span id="line-155"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Semiring</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">R</span></span><span>
</span><span id="line-156"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span>
</span><span id="line-157"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.String</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">IsString</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-158"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-159"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Typeable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Proxy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Proxy</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Debug.Trace</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">trace</span></span><span class="hs-special">)</span><span>
</span><span id="line-161"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Generic</span></span><span class="hs-special">)</span><span>
</span><span id="line-162"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.TypeNats</span></span><span>
</span><span id="line-163"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">KnownNat</span></span><span>
</span><span id="line-164"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Nat</span></span><span>
</span><span id="line-165"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">natVal</span></span><span>
</span><span id="line-166"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">type</span><span> </span><span class="annot"><span class="hs-operator">(+)</span></span><span>
</span><span id="line-167"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">type</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">type</span><span> </span><span class="annot"><span class="hs-operator">(&lt;=)</span></span><span>
</span><span id="line-169"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-170"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Unicode</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">toLower</span></span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Musicology.Pitch</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Notation</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-172"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Text.ParserCombinators.ReadP</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">ReadP</span></span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span class="hs-comment">-- Path: sequences of alternating objects</span><span>
</span><span id="line-175"></span><span class="hs-comment">-- ======================================</span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span class="annot"><span class="hs-comment">{- | A Path is a datastructure that represents a sequence of alternating objects,
 /arounds/ and /betweens/,
 starting and ending with the same type.
 An example would be a path in a graph,
 starting and ending with a node with edges in-between.
-}</span></span><span>
</span><span id="line-183"></span><span class="hs-keyword">data</span><span> </span><span id="Path"><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-var">Path</span></a></span></span><span> </span><span id="local-6989586621679458509"><span class="annot"><a href="#local-6989586621679458509"><span class="hs-identifier hs-type">around</span></a></span></span><span> </span><span id="local-6989586621679458510"><span class="annot"><a href="#local-6989586621679458510"><span class="hs-identifier hs-type">between</span></a></span></span><span>
</span><span id="line-184"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="Path"><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-var">Path</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679458509"><span class="hs-identifier hs-type">around</span></a></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679458510"><span class="hs-identifier hs-type">between</span></a></span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458509"><span class="hs-identifier hs-type">around</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458510"><span class="hs-identifier hs-type">between</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="PathEnd"><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-var">PathEnd</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679458509"><span class="hs-identifier hs-type">around</span></a></span><span>
</span><span id="line-186"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679459635"><span id="local-6989586621679459645"><span class="annot"><span class="annottext">Path around between -&gt; Path around between -&gt; Bool
(Path around between -&gt; Path around between -&gt; Bool)
-&gt; (Path around between -&gt; Path around between -&gt; Bool)
-&gt; Eq (Path around between)
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall around between.
(Eq between, Eq around) =&gt;
Path around between -&gt; Path around between -&gt; Bool
$c== :: forall around between.
(Eq between, Eq around) =&gt;
Path around between -&gt; Path around between -&gt; Bool
== :: Path around between -&gt; Path around between -&gt; Bool
$c/= :: forall around between.
(Eq between, Eq around) =&gt;
Path around between -&gt; Path around between -&gt; Bool
/= :: Path around between -&gt; Path around between -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679459655"><span id="local-6989586621679459662"><span id="local-6989586621679459668"><span id="local-6989586621679459671"><span id="local-6989586621679459674"><span id="local-6989586621679459677"><span id="local-6989586621679459680"><span class="annot"><span class="annottext">Eq (Path around between)
Eq (Path around between) =&gt;
(Path around between -&gt; Path around between -&gt; Ordering)
-&gt; (Path around between -&gt; Path around between -&gt; Bool)
-&gt; (Path around between -&gt; Path around between -&gt; Bool)
-&gt; (Path around between -&gt; Path around between -&gt; Bool)
-&gt; (Path around between -&gt; Path around between -&gt; Bool)
-&gt; (Path around between
    -&gt; Path around between -&gt; Path around between)
-&gt; (Path around between
    -&gt; Path around between -&gt; Path around between)
-&gt; Ord (Path around between)
Path around between -&gt; Path around between -&gt; Bool
Path around between -&gt; Path around between -&gt; Ordering
Path around between -&gt; Path around between -&gt; Path around between
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall around between.
(Ord between, Ord around) =&gt;
Eq (Path around between)
forall around between.
(Ord between, Ord around) =&gt;
Path around between -&gt; Path around between -&gt; Bool
forall around between.
(Ord between, Ord around) =&gt;
Path around between -&gt; Path around between -&gt; Ordering
forall around between.
(Ord between, Ord around) =&gt;
Path around between -&gt; Path around between -&gt; Path around between
$ccompare :: forall around between.
(Ord between, Ord around) =&gt;
Path around between -&gt; Path around between -&gt; Ordering
compare :: Path around between -&gt; Path around between -&gt; Ordering
$c&lt; :: forall around between.
(Ord between, Ord around) =&gt;
Path around between -&gt; Path around between -&gt; Bool
&lt; :: Path around between -&gt; Path around between -&gt; Bool
$c&lt;= :: forall around between.
(Ord between, Ord around) =&gt;
Path around between -&gt; Path around between -&gt; Bool
&lt;= :: Path around between -&gt; Path around between -&gt; Bool
$c&gt; :: forall around between.
(Ord between, Ord around) =&gt;
Path around between -&gt; Path around between -&gt; Bool
&gt; :: Path around between -&gt; Path around between -&gt; Bool
$c&gt;= :: forall around between.
(Ord between, Ord around) =&gt;
Path around between -&gt; Path around between -&gt; Bool
&gt;= :: Path around between -&gt; Path around between -&gt; Bool
$cmax :: forall around between.
(Ord between, Ord around) =&gt;
Path around between -&gt; Path around between -&gt; Path around between
max :: Path around between -&gt; Path around between -&gt; Path around between
$cmin :: forall around between.
(Ord between, Ord around) =&gt;
Path around between -&gt; Path around between -&gt; Path around between
min :: Path around between -&gt; Path around between -&gt; Path around between
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679459689"><span id="local-6989586621679459691"><span class="annot"><span class="annottext">(forall x. Path around between -&gt; Rep (Path around between) x)
-&gt; (forall x. Rep (Path around between) x -&gt; Path around between)
-&gt; Generic (Path around between)
forall x. Rep (Path around between) x -&gt; Path around between
forall x. Path around between -&gt; Rep (Path around between) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall around between x.
Rep (Path around between) x -&gt; Path around between
forall around between x.
Path around between -&gt; Rep (Path around between) x
$cfrom :: forall around between x.
Path around between -&gt; Rep (Path around between) x
from :: forall x. Path around between -&gt; Rep (Path around between) x
$cto :: forall around between x.
Rep (Path around between) x -&gt; Path around between
to :: forall x. Rep (Path around between) x -&gt; Path around between
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679459697"><span id="local-6989586621679459701"><span class="annot"><span class="annottext">(forall a b. (a -&gt; b) -&gt; Path around a -&gt; Path around b)
-&gt; (forall a b. a -&gt; Path around b -&gt; Path around a)
-&gt; Functor (Path around)
forall a b. a -&gt; Path around b -&gt; Path around a
forall a b. (a -&gt; b) -&gt; Path around a -&gt; Path around b
forall around a b. a -&gt; Path around b -&gt; Path around a
forall around a b. (a -&gt; b) -&gt; Path around a -&gt; Path around b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
$cfmap :: forall around a b. (a -&gt; b) -&gt; Path around a -&gt; Path around b
fmap :: forall a b. (a -&gt; b) -&gt; Path around a -&gt; Path around b
$c&lt;$ :: forall around a b. a -&gt; Path around b -&gt; Path around a
&lt;$ :: forall a b. a -&gt; Path around b -&gt; Path around a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-187"></span><span>
</span><span id="line-188"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679459709"><span id="local-6989586621679459713"><span class="annot"><span class="hs-identifier hs-type">Bifunctor</span></span><span> </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-189"></span><span>  </span><span id="local-6989586621679459717"><span class="annot"><span class="annottext">bimap :: forall a b c d. (a -&gt; b) -&gt; (c -&gt; d) -&gt; Path a c -&gt; Path b d
</span><span class="hs-identifier hs-var hs-var hs-var">bimap</span></span></span><span> </span><span id="local-6989586621679459718"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679459718"><span class="hs-identifier hs-var">fa</span></a></span></span><span> </span><span class="annot"><span class="annottext">c -&gt; d
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span id="local-6989586621679459719"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679459719"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b -&gt; Path b d
forall around between. around -&gt; Path around between
</span><a href="Common.html#PathEnd"><span class="hs-identifier hs-var">PathEnd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679459718"><span class="hs-identifier hs-var">fa</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679459719"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-190"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">bimap</span></span><span> </span><span id="local-6989586621679459720"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679459720"><span class="hs-identifier hs-var">fa</span></a></span></span><span> </span><span id="local-6989586621679459721"><span class="annot"><span class="annottext">c -&gt; d
</span><a href="#local-6989586621679459721"><span class="hs-identifier hs-var">fb</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679459722"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679459722"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679459723"><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679459723"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679459724"><span class="annot"><span class="annottext">Path a c
</span><a href="#local-6989586621679459724"><span class="hs-identifier hs-var">rst</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b -&gt; d -&gt; Path b d -&gt; Path b d
forall around between.
around -&gt; between -&gt; Path around between -&gt; Path around between
</span><a href="Common.html#Path"><span class="hs-identifier hs-var">Path</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679459720"><span class="hs-identifier hs-var">fa</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679459722"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">c -&gt; d
</span><a href="#local-6989586621679459721"><span class="hs-identifier hs-var">fb</span></a></span><span> </span><span class="annot"><span class="annottext">c
</span><a href="#local-6989586621679459723"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Path b d -&gt; Path b d) -&gt; Path b d -&gt; Path b d
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; (c -&gt; d) -&gt; Path a c -&gt; Path b d
forall a b c d. (a -&gt; b) -&gt; (c -&gt; d) -&gt; Path a c -&gt; Path b d
forall (p :: * -&gt; * -&gt; *) a b c d.
Bifunctor p =&gt;
(a -&gt; b) -&gt; (c -&gt; d) -&gt; p a c -&gt; p b d
</span><span class="hs-identifier hs-var">bimap</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679459720"><span class="hs-identifier hs-var">fa</span></a></span><span> </span><span class="annot"><span class="annottext">c -&gt; d
</span><a href="#local-6989586621679459721"><span class="hs-identifier hs-var">fb</span></a></span><span> </span><span class="annot"><span class="annottext">Path a c
</span><a href="#local-6989586621679459724"><span class="hs-identifier hs-var">rst</span></a></span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679458519"><span id="local-6989586621679458520"><span id="local-6989586621679459728"><span id="local-6989586621679459733"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679458519"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679458520"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458519"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458520"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-193"></span><span>  </span><span id="local-6989586621679459747"><span class="annot"><span class="annottext">show :: Path a b -&gt; String
</span><a href="#local-6989586621679459747"><span class="hs-identifier hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679459749"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679459749"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679459750"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679459750"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679459751"><span class="annot"><span class="annottext">Path a b
</span><a href="#local-6989586621679459751"><span class="hs-identifier hs-var">rst</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679459749"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n+-&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679459750"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Path a b -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Path a b
</span><a href="#local-6989586621679459751"><span class="hs-identifier hs-var">rst</span></a></span><span>
</span><span id="line-194"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span id="local-6989586621679459752"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679459752"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679459752"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-195"></span><span>
</span><span id="line-196"></span><span class="annot"><span class="hs-comment">-- | Returns the number of /arounds/ in the path.</span></span><span>
</span><span id="line-197"></span><span id="local-6989586621679458524"><span id="local-6989586621679458525"><span class="annot"><a href="Common.html#pathLen"><span class="hs-identifier hs-type">pathLen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458524"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458525"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span></span></span><span>
</span><span id="line-198"></span><span id="pathLen"><span class="annot"><span class="annottext">pathLen :: forall a b. Path a b -&gt; Int
</span><a href="Common.html#pathLen"><span class="hs-identifier hs-var hs-var">pathLen</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679459756"><span class="annot"><span class="annottext">Path a b
</span><a href="#local-6989586621679459756"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Path a b -&gt; Int
forall a b. Path a b -&gt; Int
</span><a href="Common.html#pathLen"><span class="hs-identifier hs-var">pathLen</span></a></span><span> </span><span class="annot"><span class="annottext">Path a b
</span><a href="#local-6989586621679459756"><span class="hs-identifier hs-var">rest</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-199"></span><span class="annot"><a href="Common.html#pathLen"><span class="hs-identifier hs-var">pathLen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span class="annot"><span class="hs-comment">-- | Returns the first /around/ in the path.</span></span><span>
</span><span id="line-202"></span><span id="local-6989586621679458529"><span id="local-6989586621679458530"><span class="annot"><a href="Common.html#pathHead"><span class="hs-identifier hs-type">pathHead</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458529"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458530"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679458529"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-203"></span><span id="pathHead"><span class="annot"><span class="annottext">pathHead :: forall a b. Path a b -&gt; a
</span><a href="Common.html#pathHead"><span class="hs-identifier hs-var hs-var">pathHead</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679459758"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679459758"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Path a b
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679459758"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-204"></span><span class="annot"><a href="Common.html#pathHead"><span class="hs-identifier hs-var">pathHead</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span id="local-6989586621679459759"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679459759"><span class="hs-identifier hs-var">l</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679459759"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-205"></span><span>
</span><span id="line-206"></span><span class="annot"><span class="hs-comment">-- | Replaces the first /around/ in the path.</span></span><span>
</span><span id="line-207"></span><span id="local-6989586621679458533"><span id="local-6989586621679458534"><span class="annot"><a href="Common.html#pathSetHead"><span class="hs-identifier hs-type">pathSetHead</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458533"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458534"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679458533"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458533"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458534"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-208"></span><span id="pathSetHead"><span class="annot"><span class="annottext">pathSetHead :: forall a b. Path a b -&gt; a -&gt; Path a b
</span><a href="Common.html#pathSetHead"><span class="hs-identifier hs-var hs-var">pathSetHead</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679459760"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679459760"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679459761"><span class="annot"><span class="annottext">Path a b
</span><a href="#local-6989586621679459761"><span class="hs-identifier hs-var">rst</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679459762"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679459762"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; Path a b -&gt; Path a b
forall around between.
around -&gt; between -&gt; Path around between -&gt; Path around between
</span><a href="Common.html#Path"><span class="hs-identifier hs-var">Path</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679459762"><span class="hs-identifier hs-var">a'</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679459760"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Path a b
</span><a href="#local-6989586621679459761"><span class="hs-identifier hs-var">rst</span></a></span><span>
</span><span id="line-209"></span><span class="annot"><a href="Common.html#pathSetHead"><span class="hs-identifier hs-var">pathSetHead</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679459763"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679459763"><span class="hs-identifier hs-var">a'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Path a b
forall around between. around -&gt; Path around between
</span><a href="Common.html#PathEnd"><span class="hs-identifier hs-var">PathEnd</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679459763"><span class="hs-identifier hs-var">a'</span></a></span><span>
</span><span id="line-210"></span><span>
</span><span id="line-211"></span><span class="annot"><span class="hs-comment">-- | Maps a function over every /around/ in the path.</span></span><span>
</span><span id="line-212"></span><span id="local-6989586621679459764"><span id="local-6989586621679459765"><span id="local-6989586621679459766"><span class="annot"><a href="Common.html#mapArounds"><span class="hs-identifier hs-type">mapArounds</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679459764"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679459765"><span class="hs-identifier hs-type">a'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459764"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459766"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459765"><span class="hs-identifier hs-type">a'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459766"><span class="hs-identifier hs-type">b</span></a></span></span></span></span><span>
</span><span id="line-213"></span><span id="mapArounds"><span class="annot"><span class="annottext">mapArounds :: forall a b c. (a -&gt; b) -&gt; Path a c -&gt; Path b c
</span><a href="Common.html#mapArounds"><span class="hs-identifier hs-var hs-var">mapArounds</span></a></span></span><span> </span><span id="local-6989586621679459767"><span class="annot"><span class="annottext">a -&gt; a'
</span><a href="#local-6989586621679459767"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679459768"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679459768"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679459769"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679459769"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679459770"><span class="annot"><span class="annottext">Path a b
</span><a href="#local-6989586621679459770"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a' -&gt; b -&gt; Path a' b -&gt; Path a' b
forall around between.
around -&gt; between -&gt; Path around between -&gt; Path around between
</span><a href="Common.html#Path"><span class="hs-identifier hs-var">Path</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a'
</span><a href="#local-6989586621679459767"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679459768"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679459769"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">(Path a' b -&gt; Path a' b) -&gt; Path a' b -&gt; Path a' b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; a') -&gt; Path a b -&gt; Path a' b
forall a b c. (a -&gt; b) -&gt; Path a c -&gt; Path b c
</span><a href="Common.html#mapArounds"><span class="hs-identifier hs-var">mapArounds</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a'
</span><a href="#local-6989586621679459767"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Path a b
</span><a href="#local-6989586621679459770"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-214"></span><span class="annot"><a href="Common.html#mapArounds"><span class="hs-identifier hs-var">mapArounds</span></a></span><span> </span><span id="local-6989586621679459771"><span class="annot"><span class="annottext">a -&gt; a'
</span><a href="#local-6989586621679459771"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span id="local-6989586621679459772"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679459772"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a' -&gt; Path a' b
forall around between. around -&gt; Path around between
</span><a href="Common.html#PathEnd"><span class="hs-identifier hs-var">PathEnd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a'
</span><a href="#local-6989586621679459771"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679459772"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-215"></span><span>
</span><span id="line-216"></span><span class="annot"><span class="hs-comment">-- | Maps a function over every /around/ in the path together with its index.</span></span><span>
</span><span id="line-217"></span><span id="local-6989586621679458540"><span id="local-6989586621679458541"><span id="local-6989586621679458542"><span class="annot"><a href="Common.html#mapAroundsWithIndex"><span class="hs-identifier hs-type">mapAroundsWithIndex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679458540"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679458541"><span class="hs-identifier hs-type">a'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458540"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458542"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458541"><span class="hs-identifier hs-type">a'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458542"><span class="hs-identifier hs-type">b</span></a></span></span></span></span><span>
</span><span id="line-218"></span><span id="mapAroundsWithIndex"><span class="annot"><span class="annottext">mapAroundsWithIndex :: forall a a' b. Int -&gt; (Int -&gt; a -&gt; a') -&gt; Path a b -&gt; Path a' b
</span><a href="Common.html#mapAroundsWithIndex"><span class="hs-identifier hs-var hs-var">mapAroundsWithIndex</span></a></span></span><span> </span><span id="local-6989586621679459775"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679459775"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679459776"><span class="annot"><span class="annottext">Int -&gt; a -&gt; a'
</span><a href="#local-6989586621679459776"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679459777"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679459777"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679459778"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679459778"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679459779"><span class="annot"><span class="annottext">Path a b
</span><a href="#local-6989586621679459779"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-219"></span><span>  </span><span class="annot"><span class="annottext">a' -&gt; b -&gt; Path a' b -&gt; Path a' b
forall around between.
around -&gt; between -&gt; Path around between -&gt; Path around between
</span><a href="Common.html#Path"><span class="hs-identifier hs-var">Path</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; a -&gt; a'
</span><a href="#local-6989586621679459776"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679459775"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679459777"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679459778"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; (Int -&gt; a -&gt; a') -&gt; Path a b -&gt; Path a' b
forall a a' b. Int -&gt; (Int -&gt; a -&gt; a') -&gt; Path a b -&gt; Path a' b
</span><a href="Common.html#mapAroundsWithIndex"><span class="hs-identifier hs-var">mapAroundsWithIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679459775"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; a -&gt; a'
</span><a href="#local-6989586621679459776"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Path a b
</span><a href="#local-6989586621679459779"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-220"></span><span class="annot"><a href="Common.html#mapAroundsWithIndex"><span class="hs-identifier hs-var">mapAroundsWithIndex</span></a></span><span> </span><span id="local-6989586621679459780"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679459780"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679459781"><span class="annot"><span class="annottext">Int -&gt; a -&gt; a'
</span><a href="#local-6989586621679459781"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span id="local-6989586621679459782"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679459782"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a' -&gt; Path a' b
forall around between. around -&gt; Path around between
</span><a href="Common.html#PathEnd"><span class="hs-identifier hs-var">PathEnd</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; a -&gt; a'
</span><a href="#local-6989586621679459781"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679459780"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679459782"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-221"></span><span>
</span><span id="line-222"></span><span class="annot"><span class="hs-comment">-- | Maps a function over every /between/ and its adjacent /arounds/ in the path.</span></span><span>
</span><span id="line-223"></span><span id="local-6989586621679458546"><span id="local-6989586621679458547"><span id="local-6989586621679458548"><span class="annot"><a href="Common.html#mapBetweens"><span class="hs-identifier hs-type">mapBetweens</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679458546"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679458547"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679458546"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679458548"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458546"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458547"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679458548"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">]</span></span></span></span><span>
</span><span id="line-224"></span><span id="mapBetweens"><span class="annot"><span class="annottext">mapBetweens :: forall a b c. (a -&gt; b -&gt; a -&gt; c) -&gt; Path a b -&gt; [c]
</span><a href="Common.html#mapBetweens"><span class="hs-identifier hs-var hs-var">mapBetweens</span></a></span></span><span> </span><span id="local-6989586621679459783"><span class="annot"><span class="annottext">a -&gt; b -&gt; a -&gt; c
</span><a href="#local-6989586621679459783"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679459784"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679459784"><span class="hs-identifier hs-var">al</span></a></span></span><span> </span><span id="local-6989586621679459785"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679459785"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679459786"><span class="annot"><span class="annottext">Path a b
</span><a href="#local-6989586621679459786"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; a -&gt; c
</span><a href="#local-6989586621679459783"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679459784"><span class="hs-identifier hs-var">al</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679459785"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679459787"><span class="hs-identifier hs-var">ar</span></a></span><span> </span><span class="annot"><span class="annottext">c -&gt; [c] -&gt; [c]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; b -&gt; a -&gt; c) -&gt; Path a b -&gt; [c]
forall a b c. (a -&gt; b -&gt; a -&gt; c) -&gt; Path a b -&gt; [c]
</span><a href="Common.html#mapBetweens"><span class="hs-identifier hs-var">mapBetweens</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; a -&gt; c
</span><a href="#local-6989586621679459783"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Path a b
</span><a href="#local-6989586621679459786"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-225"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-226"></span><span>  </span><span id="local-6989586621679459787"><span class="annot"><span class="annottext">ar :: a
</span><a href="#local-6989586621679459787"><span class="hs-identifier hs-var hs-var">ar</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Path a b -&gt; a
forall a b. Path a b -&gt; a
</span><a href="Common.html#pathHead"><span class="hs-identifier hs-var">pathHead</span></a></span><span> </span><span class="annot"><span class="annottext">Path a b
</span><a href="#local-6989586621679459786"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-227"></span><span class="annot"><a href="Common.html#mapBetweens"><span class="hs-identifier hs-var">mapBetweens</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-228"></span><span>
</span><span id="line-229"></span><span class="annot"><span class="hs-comment">-- | Reverses the path.</span></span><span>
</span><span id="line-230"></span><span id="local-6989586621679458552"><span id="local-6989586621679458553"><span class="annot"><a href="Common.html#reversePath"><span class="hs-identifier hs-type">reversePath</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458552"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458553"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458552"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458553"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-231"></span><span id="reversePath"><span class="annot"><span class="annottext">reversePath :: forall a b. Path a b -&gt; Path a b
</span><a href="Common.html#reversePath"><span class="hs-identifier hs-var hs-var">reversePath</span></a></span></span><span> </span><span id="local-6989586621679459788"><span class="annot"><span class="annottext">Path a b
</span><a href="#local-6989586621679459788"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Path a b
</span><a href="#local-6989586621679459788"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-232"></span><span>  </span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span id="local-6989586621679459789"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679459789"><span class="hs-identifier hs-var">end</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; Path a b
forall around between. around -&gt; Path around between
</span><a href="Common.html#PathEnd"><span class="hs-identifier hs-var">PathEnd</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679459789"><span class="hs-identifier hs-var">end</span></a></span><span>
</span><span id="line-233"></span><span>  </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679459790"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679459790"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679459791"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679459791"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679459792"><span class="annot"><span class="annottext">Path a b
</span><a href="#local-6989586621679459792"><span class="hs-identifier hs-var">rest</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">b -&gt; Path a b -&gt; Path a b -&gt; Path a b
forall {t} {around}.
t -&gt; Path around t -&gt; Path around t -&gt; Path around t
</span><a href="#local-6989586621679459793"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679459791"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Path a b
</span><a href="#local-6989586621679459792"><span class="hs-identifier hs-var">rest</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Path a b
forall around between. around -&gt; Path around between
</span><a href="Common.html#PathEnd"><span class="hs-identifier hs-var">PathEnd</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679459790"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-234"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-235"></span><span>  </span><span id="local-6989586621679459793"><span class="annot"><span class="annottext">go :: t -&gt; Path around t -&gt; Path around t -&gt; Path around t
</span><a href="#local-6989586621679459793"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679459794"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679459794"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span id="local-6989586621679459795"><span class="annot"><span class="annottext">around
</span><a href="#local-6989586621679459795"><span class="hs-identifier hs-var">aEnd</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679459796"><span class="annot"><span class="annottext">Path around t
</span><a href="#local-6989586621679459796"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">around -&gt; t -&gt; Path around t -&gt; Path around t
forall around between.
around -&gt; between -&gt; Path around between -&gt; Path around between
</span><a href="Common.html#Path"><span class="hs-identifier hs-var">Path</span></a></span><span> </span><span class="annot"><span class="annottext">around
</span><a href="#local-6989586621679459795"><span class="hs-identifier hs-var">aEnd</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679459794"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Path around t
</span><a href="#local-6989586621679459796"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-236"></span><span>  </span><span class="annot"><a href="#local-6989586621679459793"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679459797"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679459797"><span class="hs-identifier hs-var">b1</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679459798"><span class="annot"><span class="annottext">around
</span><a href="#local-6989586621679459798"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679459799"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679459799"><span class="hs-identifier hs-var">b2</span></a></span></span><span> </span><span id="local-6989586621679459800"><span class="annot"><span class="annottext">Path around t
</span><a href="#local-6989586621679459800"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679459801"><span class="annot"><span class="annottext">Path around t
</span><a href="#local-6989586621679459801"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t -&gt; Path around t -&gt; Path around t -&gt; Path around t
</span><a href="#local-6989586621679459793"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679459799"><span class="hs-identifier hs-var">b2</span></a></span><span> </span><span class="annot"><span class="annottext">Path around t
</span><a href="#local-6989586621679459800"><span class="hs-identifier hs-var">rest</span></a></span><span> </span><span class="annot"><span class="annottext">(Path around t -&gt; Path around t) -&gt; Path around t -&gt; Path around t
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">around -&gt; t -&gt; Path around t -&gt; Path around t
forall around between.
around -&gt; between -&gt; Path around between -&gt; Path around between
</span><a href="Common.html#Path"><span class="hs-identifier hs-var">Path</span></a></span><span> </span><span class="annot"><span class="annottext">around
</span><a href="#local-6989586621679459798"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679459797"><span class="hs-identifier hs-var">b1</span></a></span><span> </span><span class="annot"><span class="annottext">Path around t
</span><a href="#local-6989586621679459801"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span class="annot"><span class="hs-comment">-- | Returns the list of /arounds/  in the path.</span></span><span>
</span><span id="line-239"></span><span id="local-6989586621679458558"><span id="local-6989586621679458559"><span class="annot"><a href="Common.html#pathArounds"><span class="hs-identifier hs-type">pathArounds</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458558"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458559"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679458558"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-240"></span><span id="pathArounds"><span class="annot"><span class="annottext">pathArounds :: forall a b. Path a b -&gt; [a]
</span><a href="Common.html#pathArounds"><span class="hs-identifier hs-var hs-var">pathArounds</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679459802"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679459802"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679459803"><span class="annot"><span class="annottext">Path a b
</span><a href="#local-6989586621679459803"><span class="hs-identifier hs-var">rst</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679459802"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Path a b -&gt; [a]
forall a b. Path a b -&gt; [a]
</span><a href="Common.html#pathArounds"><span class="hs-identifier hs-var">pathArounds</span></a></span><span> </span><span class="annot"><span class="annottext">Path a b
</span><a href="#local-6989586621679459803"><span class="hs-identifier hs-var">rst</span></a></span><span>
</span><span id="line-241"></span><span class="annot"><a href="Common.html#pathArounds"><span class="hs-identifier hs-var">pathArounds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span id="local-6989586621679459804"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679459804"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679459804"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-242"></span><span>
</span><span id="line-243"></span><span class="annot"><span class="hs-comment">-- | Returns the list of /betweens/ in the path).</span></span><span>
</span><span id="line-244"></span><span id="local-6989586621679458562"><span id="local-6989586621679458563"><span class="annot"><a href="Common.html#pathBetweens"><span class="hs-identifier hs-type">pathBetweens</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458562"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458563"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679458563"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-245"></span><span id="pathBetweens"><span class="annot"><span class="annottext">pathBetweens :: forall a b. Path a b -&gt; [b]
</span><a href="Common.html#pathBetweens"><span class="hs-identifier hs-var hs-var">pathBetweens</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679459805"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679459805"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679459806"><span class="annot"><span class="annottext">Path a b
</span><a href="#local-6989586621679459806"><span class="hs-identifier hs-var">rst</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679459805"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; [b] -&gt; [b]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">Path a b -&gt; [b]
forall a b. Path a b -&gt; [b]
</span><a href="Common.html#pathBetweens"><span class="hs-identifier hs-var">pathBetweens</span></a></span><span> </span><span class="annot"><span class="annottext">Path a b
</span><a href="#local-6989586621679459806"><span class="hs-identifier hs-var">rst</span></a></span><span>
</span><span id="line-246"></span><span class="annot"><a href="Common.html#pathBetweens"><span class="hs-identifier hs-var">pathBetweens</span></a></span><span> </span><span class="annot"><span class="annottext">Path a b
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-247"></span><span>
</span><span id="line-248"></span><span class="annot"><span class="hs-comment">{- | Takes at most @n@ '(a,b')' pairs from the path and returns it as a list,
applying a function over the /betweens/.
The last 'a' in the path (if taken) is paired with the provided @finalb@.
The function @f@ is used to be able to map /betweens/ to a type with a default value.
-}</span></span><span>
</span><span id="line-253"></span><span id="local-6989586621679458566"><span id="local-6989586621679458567"><span id="local-6989586621679458568"><span class="annot"><a href="Common.html#pathTake"><span class="hs-identifier hs-type">pathTake</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679458566"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679458567"><span class="hs-identifier hs-type">b'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679458567"><span class="hs-identifier hs-type">b'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458568"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458566"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679458568"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679458567"><span class="hs-identifier hs-type">b'</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span></span></span><span>
</span><span id="line-254"></span><span id="pathTake"><span class="annot"><span class="annottext">pathTake :: forall b b' a. Int -&gt; (b -&gt; b') -&gt; b' -&gt; Path a b -&gt; [(a, b')]
</span><a href="Common.html#pathTake"><span class="hs-identifier hs-var hs-var">pathTake</span></a></span></span><span> </span><span id="local-6989586621679459812"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679459812"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679459813"><span class="annot"><span class="annottext">b -&gt; b'
</span><a href="#local-6989586621679459813"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679459814"><span class="annot"><span class="annottext">b'
</span><a href="#local-6989586621679459814"><span class="hs-identifier hs-var">finalb</span></a></span></span><span> </span><span id="local-6989586621679459815"><span class="annot"><span class="annottext">Path a b
</span><a href="#local-6989586621679459815"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(a, b')] -&gt; [(a, b')]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">([(a, b')] -&gt; [(a, b')]) -&gt; [(a, b')] -&gt; [(a, b')]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[(a, b')] -&gt; Int -&gt; Path a b -&gt; [(a, b')]
</span><a href="#local-6989586621679459817"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679459812"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Path a b
</span><a href="#local-6989586621679459815"><span class="hs-identifier hs-var">path</span></a></span><span>
</span><span id="line-255"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-256"></span><span>  </span><span id="local-6989586621679459817"><span class="annot"><span class="annottext">go :: [(a, b')] -&gt; Int -&gt; Path a b -&gt; [(a, b')]
</span><a href="#local-6989586621679459817"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679459818"><span class="annot"><span class="annottext">[(a, b')]
</span><a href="#local-6989586621679459818"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Path a b
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(a, b')]
</span><a href="#local-6989586621679459818"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-257"></span><span>  </span><span class="annot"><a href="#local-6989586621679459817"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679459819"><span class="annot"><span class="annottext">[(a, b')]
</span><a href="#local-6989586621679459819"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span id="local-6989586621679459820"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679459820"><span class="hs-identifier hs-var">_n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span id="local-6989586621679459821"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679459821"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679459821"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b'
</span><a href="#local-6989586621679459814"><span class="hs-identifier hs-var">finalb</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(a, b') -&gt; [(a, b')] -&gt; [(a, b')]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(a, b')]
</span><a href="#local-6989586621679459819"><span class="hs-identifier hs-var">acc</span></a></span><span>
</span><span id="line-258"></span><span>  </span><span class="annot"><a href="#local-6989586621679459817"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679459822"><span class="annot"><span class="annottext">[(a, b')]
</span><a href="#local-6989586621679459822"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span id="local-6989586621679459823"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679459823"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679459824"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679459824"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679459825"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679459825"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span id="local-6989586621679459826"><span class="annot"><span class="annottext">Path a b
</span><a href="#local-6989586621679459826"><span class="hs-identifier hs-var">rst</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(a, b')] -&gt; Int -&gt; Path a b -&gt; [(a, b')]
</span><a href="#local-6989586621679459817"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679459824"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b -&gt; b'
</span><a href="#local-6989586621679459813"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679459825"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(a, b') -&gt; [(a, b')] -&gt; [(a, b')]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[(a, b')]
</span><a href="#local-6989586621679459822"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679459823"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Path a b
</span><a href="#local-6989586621679459826"><span class="hs-identifier hs-var">rst</span></a></span><span>
</span><span id="line-259"></span><span>
</span><span id="line-260"></span><span class="hs-comment">-- StartStop</span><span>
</span><span id="line-261"></span><span class="hs-comment">-- =========</span><span>
</span><span id="line-262"></span><span>
</span><span id="line-263"></span><span class="annot"><span class="hs-comment">{- | A container type that augements the type @a@
 with symbols for beginning ('Start', &#8906;) and end ('Stop', &#8905;).
 Every other value is wrapped in an @Inner@ constructor.
-}</span></span><span>
</span><span id="line-267"></span><span class="hs-keyword">data</span><span> </span><span id="StartStop"><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-var">StartStop</span></a></span></span><span> </span><span id="local-6989586621679458672"><span class="annot"><a href="#local-6989586621679458672"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-268"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="Start"><span class="annot"><a href="Common.html#Start"><span class="hs-identifier hs-var">Start</span></a></span></span><span>
</span><span id="line-269"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Inner"><span class="annot"><a href="Common.html#Inner"><span class="hs-identifier hs-var">Inner</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679458672"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-270"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="Stop"><span class="annot"><a href="Common.html#Stop"><span class="hs-identifier hs-var">Stop</span></a></span></span><span>
</span><span id="line-271"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679459836"><span id="local-6989586621679459839"><span id="local-6989586621679459842"><span id="local-6989586621679459846"><span id="local-6989586621679459849"><span id="local-6989586621679459852"><span id="local-6989586621679459855"><span class="annot"><span class="annottext">Eq (StartStop a)
Eq (StartStop a) =&gt;
(StartStop a -&gt; StartStop a -&gt; Ordering)
-&gt; (StartStop a -&gt; StartStop a -&gt; Bool)
-&gt; (StartStop a -&gt; StartStop a -&gt; Bool)
-&gt; (StartStop a -&gt; StartStop a -&gt; Bool)
-&gt; (StartStop a -&gt; StartStop a -&gt; Bool)
-&gt; (StartStop a -&gt; StartStop a -&gt; StartStop a)
-&gt; (StartStop a -&gt; StartStop a -&gt; StartStop a)
-&gt; Ord (StartStop a)
StartStop a -&gt; StartStop a -&gt; Bool
StartStop a -&gt; StartStop a -&gt; Ordering
StartStop a -&gt; StartStop a -&gt; StartStop a
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall a. Ord a =&gt; Eq (StartStop a)
forall a. Ord a =&gt; StartStop a -&gt; StartStop a -&gt; Bool
forall a. Ord a =&gt; StartStop a -&gt; StartStop a -&gt; Ordering
forall a. Ord a =&gt; StartStop a -&gt; StartStop a -&gt; StartStop a
$ccompare :: forall a. Ord a =&gt; StartStop a -&gt; StartStop a -&gt; Ordering
compare :: StartStop a -&gt; StartStop a -&gt; Ordering
$c&lt; :: forall a. Ord a =&gt; StartStop a -&gt; StartStop a -&gt; Bool
&lt; :: StartStop a -&gt; StartStop a -&gt; Bool
$c&lt;= :: forall a. Ord a =&gt; StartStop a -&gt; StartStop a -&gt; Bool
&lt;= :: StartStop a -&gt; StartStop a -&gt; Bool
$c&gt; :: forall a. Ord a =&gt; StartStop a -&gt; StartStop a -&gt; Bool
&gt; :: StartStop a -&gt; StartStop a -&gt; Bool
$c&gt;= :: forall a. Ord a =&gt; StartStop a -&gt; StartStop a -&gt; Bool
&gt;= :: StartStop a -&gt; StartStop a -&gt; Bool
$cmax :: forall a. Ord a =&gt; StartStop a -&gt; StartStop a -&gt; StartStop a
max :: StartStop a -&gt; StartStop a -&gt; StartStop a
$cmin :: forall a. Ord a =&gt; StartStop a -&gt; StartStop a -&gt; StartStop a
min :: StartStop a -&gt; StartStop a -&gt; StartStop a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679459859"><span id="local-6989586621679459864"><span class="annot"><span class="annottext">StartStop a -&gt; StartStop a -&gt; Bool
(StartStop a -&gt; StartStop a -&gt; Bool)
-&gt; (StartStop a -&gt; StartStop a -&gt; Bool) -&gt; Eq (StartStop a)
forall a. Eq a =&gt; StartStop a -&gt; StartStop a -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: forall a. Eq a =&gt; StartStop a -&gt; StartStop a -&gt; Bool
== :: StartStop a -&gt; StartStop a -&gt; Bool
$c/= :: forall a. Eq a =&gt; StartStop a -&gt; StartStop a -&gt; Bool
/= :: StartStop a -&gt; StartStop a -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679459867"><span id="local-6989586621679459869"><span class="annot"><span class="annottext">(forall x. StartStop a -&gt; Rep (StartStop a) x)
-&gt; (forall x. Rep (StartStop a) x -&gt; StartStop a)
-&gt; Generic (StartStop a)
forall x. Rep (StartStop a) x -&gt; StartStop a
forall x. StartStop a -&gt; Rep (StartStop a) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall a x. Rep (StartStop a) x -&gt; StartStop a
forall a x. StartStop a -&gt; Rep (StartStop a) x
$cfrom :: forall a x. StartStop a -&gt; Rep (StartStop a) x
from :: forall x. StartStop a -&gt; Rep (StartStop a) x
$cto :: forall a x. Rep (StartStop a) x -&gt; StartStop a
to :: forall x. Rep (StartStop a) x -&gt; StartStop a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679459873"><span class="annot"><span class="annottext">StartStop a -&gt; ()
(StartStop a -&gt; ()) -&gt; NFData (StartStop a)
forall a. NFData a =&gt; StartStop a -&gt; ()
forall a. (a -&gt; ()) -&gt; NFData a
$crnf :: forall a. NFData a =&gt; StartStop a -&gt; ()
rnf :: StartStop a -&gt; ()
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679459897"><span id="local-6989586621679459904"><span class="annot"><span class="annottext">Eq (StartStop a)
Eq (StartStop a) =&gt;
(Int -&gt; StartStop a -&gt; Int)
-&gt; (StartStop a -&gt; Int) -&gt; Hashable (StartStop a)
Int -&gt; StartStop a -&gt; Int
StartStop a -&gt; Int
forall a. Eq a =&gt; (Int -&gt; a -&gt; Int) -&gt; (a -&gt; Int) -&gt; Hashable a
forall a. Hashable a =&gt; Eq (StartStop a)
forall a. Hashable a =&gt; Int -&gt; StartStop a -&gt; Int
forall a. Hashable a =&gt; StartStop a -&gt; Int
$chashWithSalt :: forall a. Hashable a =&gt; Int -&gt; StartStop a -&gt; Int
hashWithSalt :: Int -&gt; StartStop a -&gt; Int
$chash :: forall a. Hashable a =&gt; StartStop a -&gt; Int
hash :: StartStop a -&gt; Int
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Hashable</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679459923"><span id="local-6989586621679459925"><span class="annot"><span class="annottext">(forall a b. (a -&gt; b) -&gt; StartStop a -&gt; StartStop b)
-&gt; (forall a b. a -&gt; StartStop b -&gt; StartStop a)
-&gt; Functor StartStop
forall a b. a -&gt; StartStop b -&gt; StartStop a
forall a b. (a -&gt; b) -&gt; StartStop a -&gt; StartStop b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
$cfmap :: forall a b. (a -&gt; b) -&gt; StartStop a -&gt; StartStop b
fmap :: forall a b. (a -&gt; b) -&gt; StartStop a -&gt; StartStop b
$c&lt;$ :: forall a b. a -&gt; StartStop b -&gt; StartStop a
&lt;$ :: forall a b. a -&gt; StartStop b -&gt; StartStop a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679459928"><span id="local-6989586621679459934"><span id="local-6989586621679459939"><span id="local-6989586621679459944"><span id="local-6989586621679459946"><span id="local-6989586621679459949"><span id="local-6989586621679459952"><span id="local-6989586621679459955"><span id="local-6989586621679459958"><span id="local-6989586621679459961"><span id="local-6989586621679459964"><span id="local-6989586621679459966"><span id="local-6989586621679459969"><span id="local-6989586621679459974"><span id="local-6989586621679459979"><span id="local-6989586621679459984"><span id="local-6989586621679459989"><span class="annot"><span class="annottext">(forall m. Monoid m =&gt; StartStop m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; StartStop a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; StartStop a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; StartStop a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; StartStop a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; StartStop a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; StartStop a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; StartStop a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; StartStop a -&gt; a)
-&gt; (forall a. StartStop a -&gt; [a])
-&gt; (forall a. StartStop a -&gt; Bool)
-&gt; (forall a. StartStop a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; StartStop a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; StartStop a -&gt; a)
-&gt; (forall a. Ord a =&gt; StartStop a -&gt; a)
-&gt; (forall a. Num a =&gt; StartStop a -&gt; a)
-&gt; (forall a. Num a =&gt; StartStop a -&gt; a)
-&gt; Foldable StartStop
forall a. Eq a =&gt; a -&gt; StartStop a -&gt; Bool
forall a. Num a =&gt; StartStop a -&gt; a
forall a. Ord a =&gt; StartStop a -&gt; a
forall m. Monoid m =&gt; StartStop m -&gt; m
forall a. StartStop a -&gt; Bool
forall a. StartStop a -&gt; Int
forall a. StartStop a -&gt; [a]
forall a. (a -&gt; a -&gt; a) -&gt; StartStop a -&gt; a
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; StartStop a -&gt; m
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; StartStop a -&gt; b
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; StartStop a -&gt; b
forall (t :: * -&gt; *).
(forall m. Monoid m =&gt; t m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. t a -&gt; [a])
-&gt; (forall a. t a -&gt; Bool)
-&gt; (forall a. t a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; t a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; Foldable t
$cfold :: forall m. Monoid m =&gt; StartStop m -&gt; m
fold :: forall m. Monoid m =&gt; StartStop m -&gt; m
$cfoldMap :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; StartStop a -&gt; m
foldMap :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; StartStop a -&gt; m
$cfoldMap' :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; StartStop a -&gt; m
foldMap' :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; StartStop a -&gt; m
$cfoldr :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; StartStop a -&gt; b
foldr :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; StartStop a -&gt; b
$cfoldr' :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; StartStop a -&gt; b
foldr' :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; StartStop a -&gt; b
$cfoldl :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; StartStop a -&gt; b
foldl :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; StartStop a -&gt; b
$cfoldl' :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; StartStop a -&gt; b
foldl' :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; StartStop a -&gt; b
$cfoldr1 :: forall a. (a -&gt; a -&gt; a) -&gt; StartStop a -&gt; a
foldr1 :: forall a. (a -&gt; a -&gt; a) -&gt; StartStop a -&gt; a
$cfoldl1 :: forall a. (a -&gt; a -&gt; a) -&gt; StartStop a -&gt; a
foldl1 :: forall a. (a -&gt; a -&gt; a) -&gt; StartStop a -&gt; a
$ctoList :: forall a. StartStop a -&gt; [a]
toList :: forall a. StartStop a -&gt; [a]
$cnull :: forall a. StartStop a -&gt; Bool
null :: forall a. StartStop a -&gt; Bool
$clength :: forall a. StartStop a -&gt; Int
length :: forall a. StartStop a -&gt; Int
$celem :: forall a. Eq a =&gt; a -&gt; StartStop a -&gt; Bool
elem :: forall a. Eq a =&gt; a -&gt; StartStop a -&gt; Bool
$cmaximum :: forall a. Ord a =&gt; StartStop a -&gt; a
maximum :: forall a. Ord a =&gt; StartStop a -&gt; a
$cminimum :: forall a. Ord a =&gt; StartStop a -&gt; a
minimum :: forall a. Ord a =&gt; StartStop a -&gt; a
$csum :: forall a. Num a =&gt; StartStop a -&gt; a
sum :: forall a. Num a =&gt; StartStop a -&gt; a
$cproduct :: forall a. Num a =&gt; StartStop a -&gt; a
product :: forall a. Num a =&gt; StartStop a -&gt; a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Foldable</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679460002"><span id="local-6989586621679460009"><span id="local-6989586621679460015"><span id="local-6989586621679460020"><span class="annot"><span class="annottext">Functor StartStop
Foldable StartStop
(Functor StartStop, Foldable StartStop) =&gt;
(forall (f :: * -&gt; *) a b.
 Applicative f =&gt;
 (a -&gt; f b) -&gt; StartStop a -&gt; f (StartStop b))
-&gt; (forall (f :: * -&gt; *) a.
    Applicative f =&gt;
    StartStop (f a) -&gt; f (StartStop a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; StartStop a -&gt; m (StartStop b))
-&gt; (forall (m :: * -&gt; *) a.
    Monad m =&gt;
    StartStop (m a) -&gt; m (StartStop a))
-&gt; Traversable StartStop
forall (t :: * -&gt; *).
(Functor t, Foldable t) =&gt;
(forall (f :: * -&gt; *) a b.
 Applicative f =&gt;
 (a -&gt; f b) -&gt; t a -&gt; f (t b))
-&gt; (forall (f :: * -&gt; *) a. Applicative f =&gt; t (f a) -&gt; f (t a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; t a -&gt; m (t b))
-&gt; (forall (m :: * -&gt; *) a. Monad m =&gt; t (m a) -&gt; m (t a))
-&gt; Traversable t
forall (m :: * -&gt; *) a.
Monad m =&gt;
StartStop (m a) -&gt; m (StartStop a)
forall (f :: * -&gt; *) a.
Applicative f =&gt;
StartStop (f a) -&gt; f (StartStop a)
forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; StartStop a -&gt; m (StartStop b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; StartStop a -&gt; f (StartStop b)
$ctraverse :: forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; StartStop a -&gt; f (StartStop b)
traverse :: forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; StartStop a -&gt; f (StartStop b)
$csequenceA :: forall (f :: * -&gt; *) a.
Applicative f =&gt;
StartStop (f a) -&gt; f (StartStop a)
sequenceA :: forall (f :: * -&gt; *) a.
Applicative f =&gt;
StartStop (f a) -&gt; f (StartStop a)
$cmapM :: forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; StartStop a -&gt; m (StartStop b)
mapM :: forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; StartStop a -&gt; m (StartStop b)
$csequence :: forall (m :: * -&gt; *) a.
Monad m =&gt;
StartStop (m a) -&gt; m (StartStop a)
sequence :: forall (m :: * -&gt; *) a.
Monad m =&gt;
StartStop (m a) -&gt; m (StartStop a)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Traversable</span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-272"></span><span>
</span><span id="line-273"></span><span class="hs-comment">-- some instances for StartStop</span><span>
</span><span id="line-274"></span><span>
</span><span id="line-275"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679458662"><span id="local-6989586621679460029"><span id="local-6989586621679460034"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679458662"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458662"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-276"></span><span>  </span><span id="local-6989586621679460037"><span class="annot"><span class="annottext">show :: StartStop a -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var">show</span></span></span><span> </span><span class="annot"><span class="annottext">StartStop a
</span><a href="Common.html#Start"><span class="hs-identifier hs-var">Start</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&#8906;&quot;</span></span><span>
</span><span id="line-277"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">StartStop a
</span><a href="Common.html#Stop"><span class="hs-identifier hs-var">Stop</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&#8905;&quot;</span></span><span>
</span><span id="line-278"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Inner"><span class="hs-identifier hs-type">Inner</span></a></span><span> </span><span id="local-6989586621679460038"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679460038"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679460038"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-279"></span><span>
</span><span id="line-280"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679458668"><span id="local-6989586621679460042"><span id="local-6989586621679460047"><span id="local-6989586621679460050"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Notation</span></span><span> </span><span class="annot"><a href="#local-6989586621679458668"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Notation</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458668"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-281"></span><span>  </span><span id="local-6989586621679460054"><span class="annot"><span class="annottext">showNotation :: StartStop a -&gt; String
</span><a href="#local-6989586621679460054"><span class="hs-identifier hs-var hs-var hs-var">showNotation</span></a></span></span><span> </span><span class="annot"><span class="annottext">StartStop a
</span><a href="Common.html#Start"><span class="hs-identifier hs-var">Start</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&#8906;&quot;</span></span><span>
</span><span id="line-282"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">showNotation</span></span><span> </span><span class="annot"><span class="annottext">StartStop a
</span><a href="Common.html#Stop"><span class="hs-identifier hs-var">Stop</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&#8905;&quot;</span></span><span>
</span><span id="line-283"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">showNotation</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Inner"><span class="hs-identifier hs-type">Inner</span></a></span><span> </span><span id="local-6989586621679460056"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679460056"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall i. Notation i =&gt; i -&gt; String
</span><span class="hs-identifier hs-var">showNotation</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679460056"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-284"></span><span>  </span><span id="local-6989586621679460057"><span class="annot"><span class="annottext">parseNotation :: ReadP (StartStop a)
</span><a href="#local-6989586621679460057"><span class="hs-identifier hs-var hs-var hs-var">parseNotation</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReadP (StartStop a)
forall a. ReadP a
</span><span class="hs-identifier hs-var">ReadP.pfail</span></span><span>
</span><span id="line-285"></span><span>
</span><span id="line-286"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679458671"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IsString</span></span><span> </span><span class="annot"><a href="#local-6989586621679458671"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IsString</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458671"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-287"></span><span>  </span><span id="local-6989586621679460065"><span class="annot"><span class="annottext">fromString :: String -&gt; StartStop a
</span><span class="hs-identifier hs-var hs-var hs-var">fromString</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; StartStop a
forall a. a -&gt; StartStop a
</span><a href="Common.html#Inner"><span class="hs-identifier hs-var">Inner</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; StartStop a) -&gt; (String -&gt; a) -&gt; String -&gt; StartStop a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; a
forall a. IsString a =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">fromString</span></span><span>
</span><span id="line-288"></span><span>
</span><span id="line-289"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679458681"><span id="local-6989586621679460070"><span id="local-6989586621679460074"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621679458681"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458681"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-290"></span><span>  </span><span id="local-6989586621679460089"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser (StartStop a)
</span><a href="#local-6989586621679460089"><span class="hs-identifier hs-var hs-var hs-var">parseJSON</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Aeson.String</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;start&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StartStop a -&gt; Parser (StartStop a)
forall a. a -&gt; Parser a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">StartStop a
forall a. StartStop a
</span><a href="Common.html#Start"><span class="hs-identifier hs-var">Start</span></a></span><span>
</span><span id="line-291"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">parseJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Aeson.String</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;stop&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StartStop a -&gt; Parser (StartStop a)
forall a. a -&gt; Parser a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">StartStop a
forall a. StartStop a
</span><a href="Common.html#Stop"><span class="hs-identifier hs-var">Stop</span></a></span><span>
</span><span id="line-292"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">parseJSON</span></span><span> </span><span id="local-6989586621679460092"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679460092"><span class="hs-identifier hs-var">other</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; StartStop a
forall a. a -&gt; StartStop a
</span><a href="Common.html#Inner"><span class="hs-identifier hs-var">Inner</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; StartStop a) -&gt; Parser a -&gt; Parser (StartStop a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Parser a
forall a. FromJSON a =&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">parseJSON</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679460092"><span class="hs-identifier hs-var">other</span></a></span><span>
</span><span id="line-293"></span><span>
</span><span id="line-294"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679458690"><span id="local-6989586621679460098"><span id="local-6989586621679460102"><span id="local-6989586621679460105"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621679458690"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458690"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-295"></span><span>  </span><span id="local-6989586621679460111"><span class="annot"><span class="annottext">toJSON :: StartStop a -&gt; Value
</span><a href="#local-6989586621679460111"><span class="hs-identifier hs-var hs-var hs-var">toJSON</span></a></span></span><span> </span><span class="annot"><span class="annottext">StartStop a
</span><a href="Common.html#Start"><span class="hs-identifier hs-var">Start</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Value
</span><span class="hs-identifier hs-var">Aeson.String</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;start&quot;</span></span><span>
</span><span id="line-296"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="annot"><span class="annottext">StartStop a
</span><a href="Common.html#Stop"><span class="hs-identifier hs-var">Stop</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Value
</span><span class="hs-identifier hs-var">Aeson.String</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;stop&quot;</span></span><span>
</span><span id="line-297"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Inner"><span class="hs-identifier hs-type">Inner</span></a></span><span> </span><span id="local-6989586621679460113"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679460113"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Value
forall a. ToJSON a =&gt; a -&gt; Value
</span><span class="hs-identifier hs-var">Aeson.toJSON</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679460113"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-298"></span><span>
</span><span id="line-299"></span><span>  </span><span id="local-6989586621679460118"><span class="annot"><span class="annottext">toEncoding :: StartStop a -&gt; Encoding
</span><a href="#local-6989586621679460118"><span class="hs-identifier hs-var hs-var hs-var">toEncoding</span></a></span></span><span> </span><span class="annot"><span class="annottext">StartStop a
</span><a href="Common.html#Start"><span class="hs-identifier hs-var">Start</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Encoding
</span><span class="hs-string">&quot;start&quot;</span></span><span>
</span><span id="line-300"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toEncoding</span></span><span> </span><span class="annot"><span class="annottext">StartStop a
</span><a href="Common.html#Stop"><span class="hs-identifier hs-var">Stop</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Encoding
</span><span class="hs-string">&quot;stop&quot;</span></span><span>
</span><span id="line-301"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toEncoding</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Inner"><span class="hs-identifier hs-type">Inner</span></a></span><span> </span><span id="local-6989586621679460120"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679460120"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Encoding
forall a. ToJSON a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">Aeson.toEncoding</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679460120"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-302"></span><span>
</span><span id="line-303"></span><span class="hs-comment">-- some helper functions for StartStop</span><span>
</span><span id="line-304"></span><span>
</span><span id="line-305"></span><span class="annot"><span class="hs-comment">{- | From a list of @StartStop@s returns only the elements that are not @:&#8906;@ or @:&#8905;@,
 unwrapped to their original type.
-}</span></span><span>
</span><span id="line-308"></span><span id="local-6989586621679458693"><span class="annot"><a href="Common.html#onlyInner"><span class="hs-identifier hs-type">onlyInner</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458693"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679458693"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-309"></span><span id="onlyInner"><span class="annot"><span class="annottext">onlyInner :: forall a. [StartStop a] -&gt; [a]
</span><a href="Common.html#onlyInner"><span class="hs-identifier hs-var hs-var">onlyInner</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-310"></span><span class="annot"><a href="Common.html#onlyInner"><span class="hs-identifier hs-var">onlyInner</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Inner"><span class="hs-identifier hs-type">Inner</span></a></span><span> </span><span id="local-6989586621679460121"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679460121"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679460122"><span class="annot"><span class="annottext">[StartStop a]
</span><a href="#local-6989586621679460122"><span class="hs-identifier hs-var">rst</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679460121"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[StartStop a] -&gt; [a]
forall a. [StartStop a] -&gt; [a]
</span><a href="Common.html#onlyInner"><span class="hs-identifier hs-var">onlyInner</span></a></span><span> </span><span class="annot"><span class="annottext">[StartStop a]
</span><a href="#local-6989586621679460122"><span class="hs-identifier hs-var">rst</span></a></span><span>
</span><span id="line-311"></span><span class="annot"><a href="Common.html#onlyInner"><span class="hs-identifier hs-var">onlyInner</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StartStop a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679460123"><span class="annot"><span class="annottext">[StartStop a]
</span><a href="#local-6989586621679460123"><span class="hs-identifier hs-var">rst</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[StartStop a] -&gt; [a]
forall a. [StartStop a] -&gt; [a]
</span><a href="Common.html#onlyInner"><span class="hs-identifier hs-var">onlyInner</span></a></span><span> </span><span class="annot"><span class="annottext">[StartStop a]
</span><a href="#local-6989586621679460123"><span class="hs-identifier hs-var">rst</span></a></span><span>
</span><span id="line-312"></span><span>
</span><span id="line-313"></span><span class="annot"><span class="hs-comment">-- | Returns the content of an 'Inner', or 'Nothing'.</span></span><span>
</span><span id="line-314"></span><span id="local-6989586621679458695"><span class="annot"><a href="Common.html#getInner"><span class="hs-identifier hs-type">getInner</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458695"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679458695"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-315"></span><span id="getInner"><span class="annot"><span class="annottext">getInner :: forall a. StartStop a -&gt; Maybe a
</span><a href="Common.html#getInner"><span class="hs-identifier hs-var hs-var">getInner</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Inner"><span class="hs-identifier hs-type">Inner</span></a></span><span> </span><span id="local-6989586621679460124"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679460124"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679460124"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-316"></span><span class="annot"><a href="Common.html#getInner"><span class="hs-identifier hs-var">getInner</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-317"></span><span>
</span><span id="line-318"></span><span class="annot"><span class="hs-comment">-- | Returns the content of an 'Inner', or a 'Left' with an error message.</span></span><span>
</span><span id="line-319"></span><span id="local-6989586621679458697"><span class="annot"><a href="Common.html#getInnerE"><span class="hs-identifier hs-type">getInnerE</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458697"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="#local-6989586621679458697"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-320"></span><span id="getInnerE"><span class="annot"><span class="annottext">getInnerE :: forall a. StartStop a -&gt; Either String a
</span><a href="Common.html#getInnerE"><span class="hs-identifier hs-var hs-var">getInnerE</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Inner"><span class="hs-identifier hs-type">Inner</span></a></span><span> </span><span id="local-6989586621679460127"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679460127"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Either String a
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679460127"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-321"></span><span class="annot"><a href="Common.html#getInnerE"><span class="hs-identifier hs-var">getInnerE</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop a
</span><a href="Common.html#Start"><span class="hs-identifier hs-var">Start</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String a
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;expected inner but found &#8906;&quot;</span></span><span>
</span><span id="line-322"></span><span class="annot"><a href="Common.html#getInnerE"><span class="hs-identifier hs-var">getInnerE</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop a
</span><a href="Common.html#Stop"><span class="hs-identifier hs-var">Stop</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String a
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;expected inner but found &#8905;&quot;</span></span><span>
</span><span id="line-323"></span><span>
</span><span id="line-324"></span><span class="annot"><span class="hs-comment">-- | Returns 'True' iff the argument is an 'Inner'.</span></span><span>
</span><span id="line-325"></span><span id="local-6989586621679460128"><span class="annot"><a href="Common.html#isInner"><span class="hs-identifier hs-type">isInner</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679460128"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-326"></span><span id="isInner"><span class="annot"><span class="annottext">isInner :: forall a. StartStop a -&gt; Bool
</span><a href="Common.html#isInner"><span class="hs-identifier hs-var hs-var">isInner</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Inner"><span class="hs-identifier hs-type">Inner</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-327"></span><span class="annot"><a href="Common.html#isInner"><span class="hs-identifier hs-var">isInner</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-328"></span><span>
</span><span id="line-329"></span><span class="annot"><span class="hs-comment">-- | Returns 'True' iff the argument is 'Start'.</span></span><span>
</span><span id="line-330"></span><span id="local-6989586621679460129"><span class="annot"><a href="Common.html#isStart"><span class="hs-identifier hs-type">isStart</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679460129"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-331"></span><span id="isStart"><span class="annot"><span class="annottext">isStart :: forall a. StartStop a -&gt; Bool
</span><a href="Common.html#isStart"><span class="hs-identifier hs-var hs-var">isStart</span></a></span></span><span> </span><span class="annot"><span class="annottext">StartStop a
</span><a href="Common.html#Start"><span class="hs-identifier hs-var">Start</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-332"></span><span class="annot"><a href="Common.html#isStart"><span class="hs-identifier hs-var">isStart</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-333"></span><span>
</span><span id="line-334"></span><span class="annot"><span class="hs-comment">-- | Returns 'True' iff the argument is 'Stop'.</span></span><span>
</span><span id="line-335"></span><span id="local-6989586621679460130"><span class="annot"><a href="Common.html#isStop"><span class="hs-identifier hs-type">isStop</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679460130"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-336"></span><span id="isStop"><span class="annot"><span class="annottext">isStop :: forall a. StartStop a -&gt; Bool
</span><a href="Common.html#isStop"><span class="hs-identifier hs-var hs-var">isStop</span></a></span></span><span> </span><span class="annot"><span class="annottext">StartStop a
</span><a href="Common.html#Stop"><span class="hs-identifier hs-var">Stop</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-337"></span><span class="annot"><a href="Common.html#isStop"><span class="hs-identifier hs-var">isStop</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-338"></span><span>
</span><span id="line-339"></span><span class="annot"><span class="hs-comment">-- | Turns a pair within a 'StartStop' into a pair of 'StartStop's</span></span><span>
</span><span id="line-340"></span><span id="local-6989586621679458704"><span id="local-6989586621679458705"><span class="annot"><a href="Common.html#distStartStop"><span class="hs-identifier hs-type">distStartStop</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679458704"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679458705"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458704"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458705"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-341"></span><span id="distStartStop"><span class="annot"><span class="annottext">distStartStop :: forall a b. StartStop (a, b) -&gt; (StartStop a, StartStop b)
</span><a href="Common.html#distStartStop"><span class="hs-identifier hs-var hs-var">distStartStop</span></a></span></span><span> </span><span class="annot"><span class="annottext">StartStop (a, b)
</span><a href="Common.html#Start"><span class="hs-identifier hs-var">Start</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StartStop a
forall a. StartStop a
</span><a href="Common.html#Start"><span class="hs-identifier hs-var">Start</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StartStop b
forall a. StartStop a
</span><a href="Common.html#Start"><span class="hs-identifier hs-var">Start</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-342"></span><span class="annot"><a href="Common.html#distStartStop"><span class="hs-identifier hs-var">distStartStop</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop (a, b)
</span><a href="Common.html#Stop"><span class="hs-identifier hs-var">Stop</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StartStop a
forall a. StartStop a
</span><a href="Common.html#Stop"><span class="hs-identifier hs-var">Stop</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StartStop b
forall a. StartStop a
</span><a href="Common.html#Stop"><span class="hs-identifier hs-var">Stop</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-343"></span><span class="annot"><a href="Common.html#distStartStop"><span class="hs-identifier hs-var">distStartStop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Inner"><span class="hs-identifier hs-type">Inner</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679460131"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679460131"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679460132"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679460132"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; StartStop a
forall a. a -&gt; StartStop a
</span><a href="Common.html#Inner"><span class="hs-identifier hs-var">Inner</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679460131"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b -&gt; StartStop b
forall a. a -&gt; StartStop a
</span><a href="Common.html#Inner"><span class="hs-identifier hs-var">Inner</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679460132"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-344"></span><span>
</span><span id="line-345"></span><span class="hs-comment">-- evaluator interface</span><span>
</span><span id="line-346"></span><span class="hs-comment">-- ===================</span><span>
</span><span id="line-347"></span><span>
</span><span id="line-348"></span><span class="annot"><span class="hs-comment">-- | A flag indicating whether an operation is performed on the last transition.</span></span><span>
</span><span id="line-349"></span><span class="hs-keyword">type</span><span> </span><span id="IsLast"><span class="annot"><a href="Common.html#IsLast"><span class="hs-identifier hs-var">IsLast</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-350"></span><span>
</span><span id="line-351"></span><span class="annot"><span class="hs-comment">{- | A flag that indicates where a split has been performed,
 on the left transition, the right transition, or the only transition
-}</span></span><span>
</span><span id="line-354"></span><span class="hs-keyword">data</span><span> </span><span id="SplitType"><span class="annot"><a href="Common.html#SplitType"><span class="hs-identifier hs-var">SplitType</span></a></span></span><span>
</span><span id="line-355"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="LeftOfTwo"><span class="annot"><a href="Common.html#LeftOfTwo"><span class="hs-identifier hs-var">LeftOfTwo</span></a></span></span><span>
</span><span id="line-356"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="RightOfTwo"><span class="annot"><a href="Common.html#RightOfTwo"><span class="hs-identifier hs-var">RightOfTwo</span></a></span></span><span>
</span><span id="line-357"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="SingleOfOne"><span class="annot"><a href="Common.html#SingleOfOne"><span class="hs-identifier hs-var">SingleOfOne</span></a></span></span><span>
</span><span id="line-358"></span><span>
</span><span id="line-359"></span><span class="annot"><span class="hs-comment">{- | An evaluator for unspreads.
 Takes the two child slices and the middle transition.
 Returns the parent slice and the spread operation, if possible.
-}</span></span><span>
</span><span id="line-363"></span><span class="hs-keyword">type</span><span> </span><span id="UnspreadMiddle"><span class="annot"><a href="Common.html#UnspreadMiddle"><span class="hs-identifier hs-var">UnspreadMiddle</span></a></span></span><span> </span><span id="local-6989586621679460136"><span class="annot"><a href="#local-6989586621679460136"><span class="hs-identifier hs-type">tr</span></a></span></span><span> </span><span id="local-6989586621679460137"><span class="annot"><a href="#local-6989586621679460137"><span class="hs-identifier hs-type">slc</span></a></span></span><span> </span><span id="local-6989586621679460138"><span class="annot"><a href="#local-6989586621679460138"><span class="hs-identifier hs-type">h</span></a></span></span><span> </span><span id="local-6989586621679460139"><span class="annot"><a href="#local-6989586621679460139"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679460137"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679460136"><span class="hs-identifier hs-type">tr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679460137"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679460137"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679460138"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679460139"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-364"></span><span>
</span><span id="line-365"></span><span class="annot"><span class="hs-comment">{- | An evaluator returning the possible left parent edges of an unspread.
 The first argument is a pair of left child transition and left child slice.
 The second argument is the parent slice.
-}</span></span><span>
</span><span id="line-369"></span><span class="hs-keyword">type</span><span> </span><span id="UnspreadLeft"><span class="annot"><a href="Common.html#UnspreadLeft"><span class="hs-identifier hs-var">UnspreadLeft</span></a></span></span><span> </span><span id="local-6989586621679460140"><span class="annot"><a href="#local-6989586621679460140"><span class="hs-identifier hs-type">tr</span></a></span></span><span> </span><span id="local-6989586621679460141"><span class="annot"><a href="#local-6989586621679460141"><span class="hs-identifier hs-type">slc</span></a></span></span><span> </span><span id="local-6989586621679460142"><span class="annot"><a href="#local-6989586621679460142"><span class="hs-identifier hs-type">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679460140"><span class="hs-identifier hs-type">tr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679460141"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679460141"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679460142"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679460140"><span class="hs-identifier hs-type">tr</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-370"></span><span>
</span><span id="line-371"></span><span class="annot"><span class="hs-comment">{- | An evaluator returning the possible right parent edges of an unspread.
 The first argument is a pair of right child slice and right child transition.
 The second argument is the parent slice.
-}</span></span><span>
</span><span id="line-375"></span><span class="hs-keyword">type</span><span> </span><span id="UnspreadRight"><span class="annot"><a href="Common.html#UnspreadRight"><span class="hs-identifier hs-var">UnspreadRight</span></a></span></span><span> </span><span id="local-6989586621679460143"><span class="annot"><a href="#local-6989586621679460143"><span class="hs-identifier hs-type">tr</span></a></span></span><span> </span><span id="local-6989586621679460144"><span class="annot"><a href="#local-6989586621679460144"><span class="hs-identifier hs-type">slc</span></a></span></span><span> </span><span id="local-6989586621679460145"><span class="annot"><a href="#local-6989586621679460145"><span class="hs-identifier hs-type">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679460144"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679460143"><span class="hs-identifier hs-type">tr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679460144"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679460145"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679460143"><span class="hs-identifier hs-type">tr</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-376"></span><span>
</span><span id="line-377"></span><span class="annot"><span class="hs-comment">{- | An evaluator for unsplits.
 Returns possible unsplits of a given pair of transitions.
-}</span></span><span>
</span><span id="line-380"></span><span class="hs-keyword">type</span><span> </span><span id="Unsplit"><span class="annot"><a href="Common.html#Unsplit"><span class="hs-identifier hs-var">Unsplit</span></a></span></span><span> </span><span id="local-6989586621679460146"><span class="annot"><a href="#local-6989586621679460146"><span class="hs-identifier hs-type">tr</span></a></span></span><span> </span><span id="local-6989586621679460147"><span class="annot"><a href="#local-6989586621679460147"><span class="hs-identifier hs-type">slc</span></a></span></span><span> </span><span id="local-6989586621679460148"><span class="annot"><a href="#local-6989586621679460148"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-381"></span><span>  </span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679460147"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679460146"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679460147"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679460146"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679460147"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#SplitType"><span class="hs-identifier hs-type">SplitType</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679460146"><span class="hs-identifier hs-type">tr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679460148"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-382"></span><span>
</span><span id="line-383"></span><span class="annot"><span class="hs-comment">{- | A combined evaluator for unsplits, unspreads, and unfreezes.
 Additionally, contains a function for mapping terminal slices to derivation slices.
-}</span></span><span>
</span><span id="line-386"></span><span class="hs-keyword">data</span><span> </span><span id="Eval"><span class="annot"><a href="Common.html#Eval"><span class="hs-identifier hs-var">Eval</span></a></span></span><span> </span><span id="local-6989586621679458708"><span class="annot"><a href="#local-6989586621679458708"><span class="hs-identifier hs-type">tr</span></a></span></span><span> </span><span id="local-6989586621679458709"><span class="annot"><a href="#local-6989586621679458709"><span class="hs-identifier hs-type">tr'</span></a></span></span><span> </span><span id="local-6989586621679458710"><span class="annot"><a href="#local-6989586621679458710"><span class="hs-identifier hs-type">slc</span></a></span></span><span> </span><span id="local-6989586621679458711"><span class="annot"><a href="#local-6989586621679458711"><span class="hs-identifier hs-type">slc'</span></a></span></span><span> </span><span id="local-6989586621679458712"><span class="annot"><a href="#local-6989586621679458712"><span class="hs-identifier hs-type">h</span></a></span></span><span> </span><span id="local-6989586621679458713"><span class="annot"><a href="#local-6989586621679458713"><span class="hs-identifier hs-type">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Eval"><span class="annot"><a href="Common.html#Eval"><span class="hs-identifier hs-var">Eval</span></a></span></span><span>
</span><span id="line-387"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="evalUnspreadMiddle"><span class="annot"><span class="annottext">forall tr tr' slc slc' h v.
Eval tr tr' slc slc' h v -&gt; UnspreadMiddle tr slc h v
</span><a href="Common.html#evalUnspreadMiddle"><span class="hs-identifier hs-var hs-var">evalUnspreadMiddle</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Common.html#UnspreadMiddle"><span class="hs-identifier hs-type">UnspreadMiddle</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458708"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458710"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458712"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458713"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-388"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="evalUnspreadLeft"><span class="annot"><span class="annottext">forall tr tr' slc slc' h v.
Eval tr tr' slc slc' h v -&gt; UnspreadLeft tr slc h
</span><a href="Common.html#evalUnspreadLeft"><span class="hs-identifier hs-var hs-var">evalUnspreadLeft</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Common.html#UnspreadLeft"><span class="hs-identifier hs-type">UnspreadLeft</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458708"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458710"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458712"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-389"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="evalUnspreadRight"><span class="annot"><span class="annottext">forall tr tr' slc slc' h v.
Eval tr tr' slc slc' h v -&gt; UnspreadRight tr slc h
</span><a href="Common.html#evalUnspreadRight"><span class="hs-identifier hs-var hs-var">evalUnspreadRight</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Common.html#UnspreadRight"><span class="hs-identifier hs-type">UnspreadRight</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458708"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458710"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458712"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-390"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="evalUnsplit"><span class="annot"><span class="annottext">forall tr tr' slc slc' h v.
Eval tr tr' slc slc' h v -&gt; Unsplit tr slc v
</span><a href="Common.html#evalUnsplit"><span class="hs-identifier hs-var hs-var">evalUnsplit</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Unsplit"><span class="hs-identifier hs-type">Unsplit</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458708"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458710"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458713"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-391"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="evalUnfreeze"><span class="annot"><span class="annottext">forall tr tr' slc slc' h v.
Eval tr tr' slc slc' h v
-&gt; StartStop slc -&gt; Maybe tr' -&gt; StartStop slc -&gt; Bool -&gt; [(tr, v)]
</span><a href="Common.html#evalUnfreeze"><span class="hs-identifier hs-var hs-var">evalUnfreeze</span></a></span></span><span>
</span><span id="line-392"></span><span>      </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458710"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679458709"><span class="hs-identifier hs-type">tr'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458710"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#IsLast"><span class="hs-identifier hs-type">IsLast</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679458708"><span class="hs-identifier hs-type">tr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679458713"><span class="hs-identifier hs-type">v</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-393"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="evalSlice"><span class="annot"><span class="annottext">forall tr tr' slc slc' h v. Eval tr tr' slc slc' h v -&gt; slc' -&gt; slc
</span><a href="Common.html#evalSlice"><span class="hs-identifier hs-var hs-var">evalSlice</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679458711"><span class="hs-identifier hs-type">slc'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679458710"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-394"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-395"></span><span>
</span><span id="line-396"></span><span class="annot"><span class="hs-comment">-- | Maps a function over all scores produced by the evaluator.</span></span><span>
</span><span id="line-397"></span><span id="local-6989586621679458755"><span id="local-6989586621679458756"><span id="local-6989586621679458757"><span id="local-6989586621679458758"><span id="local-6989586621679458759"><span id="local-6989586621679458760"><span id="local-6989586621679458761"><span class="annot"><a href="Common.html#mapEvalScore"><span class="hs-identifier hs-type">mapEvalScore</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679458755"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679458756"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#Eval"><span class="hs-identifier hs-type">Eval</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458757"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458758"><span class="hs-identifier hs-type">tr'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458759"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458760"><span class="hs-identifier hs-type">slc'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458761"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458755"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#Eval"><span class="hs-identifier hs-type">Eval</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458757"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458758"><span class="hs-identifier hs-type">tr'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458759"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458760"><span class="hs-identifier hs-type">slc'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458761"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458756"><span class="hs-identifier hs-type">w</span></a></span></span></span></span></span></span></span></span><span>
</span><span id="line-398"></span><span id="mapEvalScore"><span class="annot"><span class="annottext">mapEvalScore :: forall v w tr tr' slc slc' h.
(v -&gt; w) -&gt; Eval tr tr' slc slc' h v -&gt; Eval tr tr' slc slc' h w
</span><a href="Common.html#mapEvalScore"><span class="hs-identifier hs-var hs-var">mapEvalScore</span></a></span></span><span> </span><span id="local-6989586621679460164"><span class="annot"><span class="annottext">v -&gt; w
</span><a href="#local-6989586621679460164"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Eval"><span class="hs-identifier hs-type">Eval</span></a></span><span> </span><span id="local-6989586621679460165"><span class="annot"><span class="annottext">UnspreadMiddle tr slc h v
</span><a href="#local-6989586621679460165"><span class="hs-identifier hs-var">unspreadm</span></a></span></span><span> </span><span id="local-6989586621679460166"><span class="annot"><span class="annottext">UnspreadLeft tr slc h
</span><a href="#local-6989586621679460166"><span class="hs-identifier hs-var">unspreadl</span></a></span></span><span> </span><span id="local-6989586621679460167"><span class="annot"><span class="annottext">UnspreadRight tr slc h
</span><a href="#local-6989586621679460167"><span class="hs-identifier hs-var">unspreadr</span></a></span></span><span> </span><span id="local-6989586621679460168"><span class="annot"><span class="annottext">Unsplit tr slc v
</span><a href="#local-6989586621679460168"><span class="hs-identifier hs-var">unsplit</span></a></span></span><span> </span><span id="local-6989586621679460169"><span class="annot"><span class="annottext">StartStop slc -&gt; Maybe tr' -&gt; StartStop slc -&gt; Bool -&gt; [(tr, v)]
</span><a href="#local-6989586621679460169"><span class="hs-identifier hs-var">uf</span></a></span></span><span> </span><span id="local-6989586621679460170"><span class="annot"><span class="annottext">slc' -&gt; slc
</span><a href="#local-6989586621679460170"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-399"></span><span>  </span><span class="annot"><span class="annottext">UnspreadMiddle tr slc h w
-&gt; UnspreadLeft tr slc h
-&gt; UnspreadRight tr slc h
-&gt; Unsplit tr slc w
-&gt; (StartStop slc
    -&gt; Maybe tr' -&gt; StartStop slc -&gt; Bool -&gt; [(tr, w)])
-&gt; (slc' -&gt; slc)
-&gt; Eval tr tr' slc slc' h w
forall tr tr' slc slc' h v.
UnspreadMiddle tr slc h v
-&gt; UnspreadLeft tr slc h
-&gt; UnspreadRight tr slc h
-&gt; Unsplit tr slc v
-&gt; (StartStop slc
    -&gt; Maybe tr' -&gt; StartStop slc -&gt; Bool -&gt; [(tr, v)])
-&gt; (slc' -&gt; slc)
-&gt; Eval tr tr' slc slc' h v
</span><a href="Common.html#Eval"><span class="hs-identifier hs-var">Eval</span></a></span><span>
</span><span id="line-400"></span><span>    </span><span class="annot"><span class="annottext">UnspreadMiddle tr slc h w
</span><a href="#local-6989586621679460171"><span class="hs-identifier hs-var">unspreadm'</span></a></span><span>
</span><span id="line-401"></span><span>    </span><span class="annot"><span class="annottext">UnspreadLeft tr slc h
</span><a href="#local-6989586621679460166"><span class="hs-identifier hs-var">unspreadl</span></a></span><span>
</span><span id="line-402"></span><span>    </span><span class="annot"><span class="annottext">UnspreadRight tr slc h
</span><a href="#local-6989586621679460167"><span class="hs-identifier hs-var">unspreadr</span></a></span><span>
</span><span id="line-403"></span><span>    </span><span class="annot"><span class="annottext">Unsplit tr slc w
</span><a href="#local-6989586621679460172"><span class="hs-identifier hs-var">unsplit'</span></a></span><span>
</span><span id="line-404"></span><span>    </span><span class="annot"><span class="annottext">StartStop slc -&gt; Maybe tr' -&gt; StartStop slc -&gt; Bool -&gt; [(tr, w)]
</span><a href="#local-6989586621679460173"><span class="hs-identifier hs-var">uf'</span></a></span><span>
</span><span id="line-405"></span><span>    </span><span class="annot"><span class="annottext">slc' -&gt; slc
</span><a href="#local-6989586621679460170"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-406"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-407"></span><span>  </span><span id="local-6989586621679460171"><span class="annot"><span class="annottext">unspreadm' :: UnspreadMiddle tr slc h w
</span><a href="#local-6989586621679460171"><span class="hs-identifier hs-var hs-var">unspreadm'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((slc, h, v) -&gt; (slc, h, w)) -&gt; [(slc, h, v)] -&gt; [(slc, h, w)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(v -&gt; w) -&gt; (slc, h, v) -&gt; (slc, h, w)
forall a b. (a -&gt; b) -&gt; (slc, h, a) -&gt; (slc, h, b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">v -&gt; w
</span><a href="#local-6989586621679460164"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(slc, h, v)] -&gt; [(slc, h, w)])
-&gt; UnspreadMiddle tr slc h v -&gt; UnspreadMiddle tr slc h w
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">UnspreadMiddle tr slc h v
</span><a href="#local-6989586621679460165"><span class="hs-identifier hs-var">unspreadm</span></a></span><span>
</span><span id="line-408"></span><span>  </span><span id="local-6989586621679460172"><span class="annot"><span class="annottext">unsplit' :: Unsplit tr slc w
</span><a href="#local-6989586621679460172"><span class="hs-identifier hs-var hs-var">unsplit'</span></a></span></span><span> </span><span id="local-6989586621679460174"><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679460174"><span class="hs-identifier hs-var">sl</span></a></span></span><span> </span><span id="local-6989586621679460175"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679460175"><span class="hs-identifier hs-var">tl</span></a></span></span><span> </span><span id="local-6989586621679460176"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679460176"><span class="hs-identifier hs-var">sm</span></a></span></span><span> </span><span id="local-6989586621679460177"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679460177"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span id="local-6989586621679460178"><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679460178"><span class="hs-identifier hs-var">sr</span></a></span></span><span> </span><span id="local-6989586621679460179"><span class="annot"><span class="annottext">SplitType
</span><a href="#local-6989586621679460179"><span class="hs-identifier hs-var">typ</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(v -&gt; w) -&gt; (tr, v) -&gt; (tr, w)
forall a b. (a -&gt; b) -&gt; (tr, a) -&gt; (tr, b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">v -&gt; w
</span><a href="#local-6989586621679460164"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">((tr, v) -&gt; (tr, w)) -&gt; [(tr, v)] -&gt; [(tr, w)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Unsplit tr slc v
</span><a href="#local-6989586621679460168"><span class="hs-identifier hs-var">unsplit</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679460174"><span class="hs-identifier hs-var">sl</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679460175"><span class="hs-identifier hs-var">tl</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679460176"><span class="hs-identifier hs-var">sm</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679460177"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679460178"><span class="hs-identifier hs-var">sr</span></a></span><span> </span><span class="annot"><span class="annottext">SplitType
</span><a href="#local-6989586621679460179"><span class="hs-identifier hs-var">typ</span></a></span><span>
</span><span id="line-409"></span><span>  </span><span id="local-6989586621679460173"><span class="annot"><span class="annottext">uf' :: StartStop slc -&gt; Maybe tr' -&gt; StartStop slc -&gt; Bool -&gt; [(tr, w)]
</span><a href="#local-6989586621679460173"><span class="hs-identifier hs-var hs-var">uf'</span></a></span></span><span> </span><span id="local-6989586621679460180"><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679460180"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679460181"><span class="annot"><span class="annottext">Maybe tr'
</span><a href="#local-6989586621679460181"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679460182"><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679460182"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679460183"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679460183"><span class="hs-identifier hs-var">isLast</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(v -&gt; w) -&gt; (tr, v) -&gt; (tr, w)
forall a b. (a -&gt; b) -&gt; (tr, a) -&gt; (tr, b)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="annot"><span class="annottext">v -&gt; w
</span><a href="#local-6989586621679460164"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">((tr, v) -&gt; (tr, w)) -&gt; [(tr, v)] -&gt; [(tr, w)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">StartStop slc -&gt; Maybe tr' -&gt; StartStop slc -&gt; Bool -&gt; [(tr, v)]
</span><a href="#local-6989586621679460169"><span class="hs-identifier hs-var">uf</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679460180"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe tr'
</span><a href="#local-6989586621679460181"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679460182"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679460183"><span class="hs-identifier hs-var">isLast</span></a></span><span>
</span><span id="line-410"></span><span>
</span><span id="line-411"></span><span class="hs-comment">-- product evaluators</span><span>
</span><span id="line-412"></span><span class="hs-comment">-- ------------------</span><span>
</span><span id="line-413"></span><span>
</span><span id="line-414"></span><span class="annot"><span class="hs-comment">{- | Combine two evaluators into a product evaluator.
 Each evaluation function returns the product of the two component evaluators' results.
-}</span></span><span>
</span><span id="line-417"></span><span id="local-6989586621679458773"><span id="local-6989586621679458774"><span id="local-6989586621679458775"><span id="local-6989586621679458776"><span id="local-6989586621679458777"><span id="local-6989586621679458778"><span id="local-6989586621679458779"><span id="local-6989586621679458780"><span id="local-6989586621679458781"><span id="local-6989586621679458782"><span class="annot"><a href="Common.html#productEval"><span class="hs-identifier hs-type">productEval</span></a></span><span>
</span><span id="line-418"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Common.html#Eval"><span class="hs-identifier hs-type">Eval</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458773"><span class="hs-identifier hs-type">tr1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458774"><span class="hs-identifier hs-type">tr'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458775"><span class="hs-identifier hs-type">slc1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458776"><span class="hs-identifier hs-type">slc'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458777"><span class="hs-identifier hs-type">h1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458778"><span class="hs-identifier hs-type">v1</span></a></span><span>
</span><span id="line-419"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#Eval"><span class="hs-identifier hs-type">Eval</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458779"><span class="hs-identifier hs-type">tr2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458774"><span class="hs-identifier hs-type">tr'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458780"><span class="hs-identifier hs-type">slc2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458776"><span class="hs-identifier hs-type">slc'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458781"><span class="hs-identifier hs-type">h2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458782"><span class="hs-identifier hs-type">v2</span></a></span><span>
</span><span id="line-420"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#Eval"><span class="hs-identifier hs-type">Eval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679458773"><span class="hs-identifier hs-type">tr1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679458779"><span class="hs-identifier hs-type">tr2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679458774"><span class="hs-identifier hs-type">tr'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679458775"><span class="hs-identifier hs-type">slc1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679458780"><span class="hs-identifier hs-type">slc2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679458776"><span class="hs-identifier hs-type">slc'</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679458777"><span class="hs-identifier hs-type">h1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679458781"><span class="hs-identifier hs-type">h2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679458778"><span class="hs-identifier hs-type">v1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679458782"><span class="hs-identifier hs-type">v2</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span></span></span></span><span>
</span><span id="line-421"></span><span id="productEval"><span class="annot"><span class="annottext">productEval :: forall tr1 tr' slc1 slc' h1 v1 tr2 slc2 h2 v2.
Eval tr1 tr' slc1 slc' h1 v1
-&gt; Eval tr2 tr' slc2 slc' h2 v2
-&gt; Eval (tr1, tr2) tr' (slc1, slc2) slc' (h1, h2) (v1, v2)
</span><a href="Common.html#productEval"><span class="hs-identifier hs-var hs-var">productEval</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Eval"><span class="hs-identifier hs-type">Eval</span></a></span><span> </span><span id="local-6989586621679460201"><span class="annot"><span class="annottext">UnspreadMiddle tr1 slc1 h1 v1
</span><a href="#local-6989586621679460201"><span class="hs-identifier hs-var">unspreadm1</span></a></span></span><span> </span><span id="local-6989586621679460202"><span class="annot"><span class="annottext">UnspreadLeft tr1 slc1 h1
</span><a href="#local-6989586621679460202"><span class="hs-identifier hs-var">unspreadl1</span></a></span></span><span> </span><span id="local-6989586621679460203"><span class="annot"><span class="annottext">UnspreadRight tr1 slc1 h1
</span><a href="#local-6989586621679460203"><span class="hs-identifier hs-var">unspreadr1</span></a></span></span><span> </span><span id="local-6989586621679460204"><span class="annot"><span class="annottext">Unsplit tr1 slc1 v1
</span><a href="#local-6989586621679460204"><span class="hs-identifier hs-var">merge1</span></a></span></span><span> </span><span id="local-6989586621679460205"><span class="annot"><span class="annottext">StartStop slc1
-&gt; Maybe tr' -&gt; StartStop slc1 -&gt; Bool -&gt; [(tr1, v1)]
</span><a href="#local-6989586621679460205"><span class="hs-identifier hs-var">thaw1</span></a></span></span><span> </span><span id="local-6989586621679460206"><span class="annot"><span class="annottext">slc' -&gt; slc1
</span><a href="#local-6989586621679460206"><span class="hs-identifier hs-var">slice1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Eval"><span class="hs-identifier hs-type">Eval</span></a></span><span> </span><span id="local-6989586621679460207"><span class="annot"><span class="annottext">UnspreadMiddle tr2 slc2 h2 v2
</span><a href="#local-6989586621679460207"><span class="hs-identifier hs-var">unspreadm2</span></a></span></span><span> </span><span id="local-6989586621679460208"><span class="annot"><span class="annottext">UnspreadLeft tr2 slc2 h2
</span><a href="#local-6989586621679460208"><span class="hs-identifier hs-var">unspreadl2</span></a></span></span><span> </span><span id="local-6989586621679460209"><span class="annot"><span class="annottext">UnspreadRight tr2 slc2 h2
</span><a href="#local-6989586621679460209"><span class="hs-identifier hs-var">unspreadr2</span></a></span></span><span> </span><span id="local-6989586621679460210"><span class="annot"><span class="annottext">Unsplit tr2 slc2 v2
</span><a href="#local-6989586621679460210"><span class="hs-identifier hs-var">merge2</span></a></span></span><span> </span><span id="local-6989586621679460211"><span class="annot"><span class="annottext">StartStop slc2
-&gt; Maybe tr' -&gt; StartStop slc2 -&gt; Bool -&gt; [(tr2, v2)]
</span><a href="#local-6989586621679460211"><span class="hs-identifier hs-var">thaw2</span></a></span></span><span> </span><span id="local-6989586621679460212"><span class="annot"><span class="annottext">slc' -&gt; slc2
</span><a href="#local-6989586621679460212"><span class="hs-identifier hs-var">slice2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-422"></span><span>  </span><span class="annot"><span class="annottext">UnspreadMiddle (tr1, tr2) (slc1, slc2) (h1, h2) (v1, v2)
-&gt; UnspreadLeft (tr1, tr2) (slc1, slc2) (h1, h2)
-&gt; UnspreadRight (tr1, tr2) (slc1, slc2) (h1, h2)
-&gt; Unsplit (tr1, tr2) (slc1, slc2) (v1, v2)
-&gt; (StartStop (slc1, slc2)
    -&gt; Maybe tr'
    -&gt; StartStop (slc1, slc2)
    -&gt; Bool
    -&gt; [((tr1, tr2), (v1, v2))])
-&gt; (slc' -&gt; (slc1, slc2))
-&gt; Eval (tr1, tr2) tr' (slc1, slc2) slc' (h1, h2) (v1, v2)
forall tr tr' slc slc' h v.
UnspreadMiddle tr slc h v
-&gt; UnspreadLeft tr slc h
-&gt; UnspreadRight tr slc h
-&gt; Unsplit tr slc v
-&gt; (StartStop slc
    -&gt; Maybe tr' -&gt; StartStop slc -&gt; Bool -&gt; [(tr, v)])
-&gt; (slc' -&gt; slc)
-&gt; Eval tr tr' slc slc' h v
</span><a href="Common.html#Eval"><span class="hs-identifier hs-var">Eval</span></a></span><span> </span><span class="annot"><span class="annottext">UnspreadMiddle (tr1, tr2) (slc1, slc2) (h1, h2) (v1, v2)
</span><a href="#local-6989586621679460213"><span class="hs-identifier hs-var">unspreadm</span></a></span><span> </span><span class="annot"><span class="annottext">UnspreadLeft (tr1, tr2) (slc1, slc2) (h1, h2)
</span><a href="#local-6989586621679460214"><span class="hs-identifier hs-var">unspreadl</span></a></span><span> </span><span class="annot"><span class="annottext">UnspreadRight (tr1, tr2) (slc1, slc2) (h1, h2)
</span><a href="#local-6989586621679460215"><span class="hs-identifier hs-var">unspreadr</span></a></span><span> </span><span class="annot"><span class="annottext">Unsplit (tr1, tr2) (slc1, slc2) (v1, v2)
</span><a href="#local-6989586621679460216"><span class="hs-identifier hs-var">merge</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop (slc1, slc2)
-&gt; Maybe tr'
-&gt; StartStop (slc1, slc2)
-&gt; Bool
-&gt; [((tr1, tr2), (v1, v2))]
</span><a href="#local-6989586621679460217"><span class="hs-identifier hs-var">thaw</span></a></span><span> </span><span class="annot"><span class="annottext">slc' -&gt; (slc1, slc2)
</span><a href="#local-6989586621679460218"><span class="hs-identifier hs-var">slice</span></a></span><span>
</span><span id="line-423"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-424"></span><span>  </span><span id="local-6989586621679460213"><span class="annot"><span class="annottext">unspreadm :: UnspreadMiddle (tr1, tr2) (slc1, slc2) (h1, h2) (v1, v2)
</span><a href="#local-6989586621679460213"><span class="hs-identifier hs-var hs-var">unspreadm</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679460219"><span class="annot"><span class="annottext">slc1
</span><a href="#local-6989586621679460219"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679460220"><span class="annot"><span class="annottext">slc2
</span><a href="#local-6989586621679460220"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679460221"><span class="annot"><span class="annottext">tr1
</span><a href="#local-6989586621679460221"><span class="hs-identifier hs-var">m1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679460222"><span class="annot"><span class="annottext">tr2
</span><a href="#local-6989586621679460222"><span class="hs-identifier hs-var">m2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679460223"><span class="annot"><span class="annottext">slc1
</span><a href="#local-6989586621679460223"><span class="hs-identifier hs-var">r1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679460224"><span class="annot"><span class="annottext">slc2
</span><a href="#local-6989586621679460224"><span class="hs-identifier hs-var">r2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-425"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679460225"><span class="annot"><a href="#local-6989586621679460225"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679460226"><span class="annot"><a href="#local-6989586621679460226"><span class="hs-identifier hs-var">ha</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679460227"><span class="annot"><a href="#local-6989586621679460227"><span class="hs-identifier hs-var">va</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UnspreadMiddle tr1 slc1 h1 v1
</span><a href="#local-6989586621679460201"><span class="hs-identifier hs-var">unspreadm1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">slc1
</span><a href="#local-6989586621679460219"><span class="hs-identifier hs-var">l1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tr1
</span><a href="#local-6989586621679460221"><span class="hs-identifier hs-var">m1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">slc1
</span><a href="#local-6989586621679460223"><span class="hs-identifier hs-var">r1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-426"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679460228"><span class="annot"><a href="#local-6989586621679460228"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679460229"><span class="annot"><a href="#local-6989586621679460229"><span class="hs-identifier hs-var">hb</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679460230"><span class="annot"><a href="#local-6989586621679460230"><span class="hs-identifier hs-var">vb</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621679460207"><span class="hs-identifier hs-type">unspreadm2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679460220"><span class="hs-identifier hs-type">l2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679460222"><span class="hs-identifier hs-type">m2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679460224"><span class="hs-identifier hs-type">r2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-427"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679460225"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679460228"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679460226"><span class="hs-identifier hs-type">ha</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679460229"><span class="hs-identifier hs-type">hb</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679460227"><span class="hs-identifier hs-type">va</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679460230"><span class="hs-identifier hs-type">vb</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-428"></span><span>  </span><span id="local-6989586621679460214"><span class="annot"><span class="annottext">unspreadl :: UnspreadLeft (tr1, tr2) (slc1, slc2) (h1, h2)
</span><a href="#local-6989586621679460214"><span class="hs-identifier hs-var hs-var">unspreadl</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679460231"><span class="annot"><span class="annottext">tr1
</span><a href="#local-6989586621679460231"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679460232"><span class="annot"><span class="annottext">tr2
</span><a href="#local-6989586621679460232"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679460233"><span class="annot"><span class="annottext">slc1
</span><a href="#local-6989586621679460233"><span class="hs-identifier hs-var">c1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679460234"><span class="annot"><span class="annottext">slc2
</span><a href="#local-6989586621679460234"><span class="hs-identifier hs-var">c2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679460235"><span class="annot"><span class="annottext">slc1
</span><a href="#local-6989586621679460235"><span class="hs-identifier hs-var">p1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679460236"><span class="annot"><span class="annottext">slc2
</span><a href="#local-6989586621679460236"><span class="hs-identifier hs-var">p2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679460237"><span class="annot"><span class="annottext">h1
</span><a href="#local-6989586621679460237"><span class="hs-identifier hs-var">h1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679460238"><span class="annot"><span class="annottext">h2
</span><a href="#local-6989586621679460238"><span class="hs-identifier hs-var">h2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-429"></span><span>    </span><span id="local-6989586621679460239"><span class="annot"><a href="#local-6989586621679460239"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UnspreadLeft tr1 slc1 h1
</span><a href="#local-6989586621679460202"><span class="hs-identifier hs-var">unspreadl1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">tr1
</span><a href="#local-6989586621679460231"><span class="hs-identifier hs-var">l1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">slc1
</span><a href="#local-6989586621679460233"><span class="hs-identifier hs-var">c1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">slc1
</span><a href="#local-6989586621679460235"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="annot"><span class="annottext">h1
</span><a href="#local-6989586621679460237"><span class="hs-identifier hs-var">h1</span></a></span><span>
</span><span id="line-430"></span><span>    </span><span id="local-6989586621679460240"><span class="annot"><a href="#local-6989586621679460240"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621679460208"><span class="hs-identifier hs-type">unspreadl2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679460232"><span class="hs-identifier hs-type">l2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679460234"><span class="hs-identifier hs-type">c2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679460236"><span class="hs-identifier hs-type">p2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679460238"><span class="hs-identifier hs-type">h2</span></a></span><span>
</span><span id="line-431"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679460239"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679460240"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-432"></span><span>  </span><span id="local-6989586621679460215"><span class="annot"><span class="annottext">unspreadr :: UnspreadRight (tr1, tr2) (slc1, slc2) (h1, h2)
</span><a href="#local-6989586621679460215"><span class="hs-identifier hs-var hs-var">unspreadr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679460241"><span class="annot"><span class="annottext">slc1
</span><a href="#local-6989586621679460241"><span class="hs-identifier hs-var">c1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679460242"><span class="annot"><span class="annottext">slc2
</span><a href="#local-6989586621679460242"><span class="hs-identifier hs-var">c2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679460243"><span class="annot"><span class="annottext">tr1
</span><a href="#local-6989586621679460243"><span class="hs-identifier hs-var">r1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679460244"><span class="annot"><span class="annottext">tr2
</span><a href="#local-6989586621679460244"><span class="hs-identifier hs-var">r2</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679460245"><span class="annot"><span class="annottext">slc1
</span><a href="#local-6989586621679460245"><span class="hs-identifier hs-var">p1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679460246"><span class="annot"><span class="annottext">slc2
</span><a href="#local-6989586621679460246"><span class="hs-identifier hs-var">p2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679460247"><span class="annot"><span class="annottext">h1
</span><a href="#local-6989586621679460247"><span class="hs-identifier hs-var">h1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679460248"><span class="annot"><span class="annottext">h2
</span><a href="#local-6989586621679460248"><span class="hs-identifier hs-var">h2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-433"></span><span>    </span><span id="local-6989586621679460249"><span class="annot"><a href="#local-6989586621679460249"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">UnspreadRight tr1 slc1 h1
</span><a href="#local-6989586621679460203"><span class="hs-identifier hs-var">unspreadr1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">slc1
</span><a href="#local-6989586621679460241"><span class="hs-identifier hs-var">c1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tr1
</span><a href="#local-6989586621679460243"><span class="hs-identifier hs-var">r1</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">slc1
</span><a href="#local-6989586621679460245"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="annot"><span class="annottext">h1
</span><a href="#local-6989586621679460247"><span class="hs-identifier hs-var">h1</span></a></span><span>
</span><span id="line-434"></span><span>    </span><span id="local-6989586621679460250"><span class="annot"><a href="#local-6989586621679460250"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621679460209"><span class="hs-identifier hs-type">unspreadr2</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679460242"><span class="hs-identifier hs-type">c2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679460244"><span class="hs-identifier hs-type">r2</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679460246"><span class="hs-identifier hs-type">p2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679460248"><span class="hs-identifier hs-type">h2</span></a></span><span>
</span><span id="line-435"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679460249"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679460250"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-436"></span><span>  </span><span id="local-6989586621679460216"><span class="annot"><span class="annottext">merge :: Unsplit (tr1, tr2) (slc1, slc2) (v1, v2)
</span><a href="#local-6989586621679460216"><span class="hs-identifier hs-var hs-var">merge</span></a></span></span><span> </span><span id="local-6989586621679460251"><span class="annot"><span class="annottext">StartStop (slc1, slc2)
</span><a href="#local-6989586621679460251"><span class="hs-identifier hs-var">sl</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679460252"><span class="annot"><span class="annottext">tr1
</span><a href="#local-6989586621679460252"><span class="hs-identifier hs-var">tl1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679460253"><span class="annot"><span class="annottext">tr2
</span><a href="#local-6989586621679460253"><span class="hs-identifier hs-var">tl2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679460254"><span class="annot"><span class="annottext">slc1
</span><a href="#local-6989586621679460254"><span class="hs-identifier hs-var">sm1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679460255"><span class="annot"><span class="annottext">slc2
</span><a href="#local-6989586621679460255"><span class="hs-identifier hs-var">sm2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679460256"><span class="annot"><span class="annottext">tr1
</span><a href="#local-6989586621679460256"><span class="hs-identifier hs-var">tr1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679460257"><span class="annot"><span class="annottext">tr2
</span><a href="#local-6989586621679460257"><span class="hs-identifier hs-var">tr2</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679460258"><span class="annot"><span class="annottext">StartStop (slc1, slc2)
</span><a href="#local-6989586621679460258"><span class="hs-identifier hs-var">sr</span></a></span></span><span> </span><span id="local-6989586621679460259"><span class="annot"><span class="annottext">SplitType
</span><a href="#local-6989586621679460259"><span class="hs-identifier hs-var">typ</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-437"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679460260"><span class="annot"><a href="#local-6989586621679460260"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679460261"><span class="annot"><a href="#local-6989586621679460261"><span class="hs-identifier hs-var">va</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Unsplit tr1 slc1 v1
</span><a href="#local-6989586621679460204"><span class="hs-identifier hs-var">merge1</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc1
</span><a href="#local-6989586621679460262"><span class="hs-identifier hs-var">sl1</span></a></span><span> </span><span class="annot"><span class="annottext">tr1
</span><a href="#local-6989586621679460252"><span class="hs-identifier hs-var">tl1</span></a></span><span> </span><span class="annot"><span class="annottext">slc1
</span><a href="#local-6989586621679460254"><span class="hs-identifier hs-var">sm1</span></a></span><span> </span><span class="annot"><span class="annottext">tr1
</span><a href="#local-6989586621679460256"><span class="hs-identifier hs-var">tr1</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc1
</span><a href="#local-6989586621679460263"><span class="hs-identifier hs-var">sr1</span></a></span><span> </span><span class="annot"><span class="annottext">SplitType
</span><a href="#local-6989586621679460259"><span class="hs-identifier hs-var">typ</span></a></span><span>
</span><span id="line-438"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679460264"><span class="annot"><a href="#local-6989586621679460264"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679460265"><span class="annot"><a href="#local-6989586621679460265"><span class="hs-identifier hs-var">vb</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621679460210"><span class="hs-identifier hs-type">merge2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679460266"><span class="hs-identifier hs-type">sl2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679460253"><span class="hs-identifier hs-type">tl2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679460255"><span class="hs-identifier hs-type">sm2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679460257"><span class="hs-identifier hs-type">tr2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679460267"><span class="hs-identifier hs-type">sr2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679460259"><span class="hs-identifier hs-type">typ</span></a></span><span>
</span><span id="line-439"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679460260"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679460264"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679460261"><span class="hs-identifier hs-type">va</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679460265"><span class="hs-identifier hs-type">vb</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-440"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-441"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679460262"><span class="annot"><span class="annottext">StartStop slc1
</span><a href="#local-6989586621679460262"><span class="hs-identifier hs-var">sl1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679460266"><span class="annot"><span class="annottext">StartStop slc2
</span><a href="#local-6989586621679460266"><span class="hs-identifier hs-var">sl2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StartStop (slc1, slc2) -&gt; (StartStop slc1, StartStop slc2)
forall a b. StartStop (a, b) -&gt; (StartStop a, StartStop b)
</span><a href="Common.html#distStartStop"><span class="hs-identifier hs-var">distStartStop</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop (slc1, slc2)
</span><a href="#local-6989586621679460251"><span class="hs-identifier hs-var">sl</span></a></span><span>
</span><span id="line-442"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679460263"><span class="annot"><span class="annottext">StartStop slc1
</span><a href="#local-6989586621679460263"><span class="hs-identifier hs-var">sr1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679460267"><span class="annot"><span class="annottext">StartStop slc2
</span><a href="#local-6989586621679460267"><span class="hs-identifier hs-var">sr2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StartStop (slc1, slc2) -&gt; (StartStop slc1, StartStop slc2)
forall a b. StartStop (a, b) -&gt; (StartStop a, StartStop b)
</span><a href="Common.html#distStartStop"><span class="hs-identifier hs-var">distStartStop</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop (slc1, slc2)
</span><a href="#local-6989586621679460258"><span class="hs-identifier hs-var">sr</span></a></span><span>
</span><span id="line-443"></span><span>  </span><span id="local-6989586621679460217"><span class="annot"><span class="annottext">thaw :: StartStop (slc1, slc2)
-&gt; Maybe tr'
-&gt; StartStop (slc1, slc2)
-&gt; Bool
-&gt; [((tr1, tr2), (v1, v2))]
</span><a href="#local-6989586621679460217"><span class="hs-identifier hs-var hs-var">thaw</span></a></span></span><span> </span><span id="local-6989586621679460268"><span class="annot"><span class="annottext">StartStop (slc1, slc2)
</span><a href="#local-6989586621679460268"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679460269"><span class="annot"><span class="annottext">Maybe tr'
</span><a href="#local-6989586621679460269"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679460270"><span class="annot"><span class="annottext">StartStop (slc1, slc2)
</span><a href="#local-6989586621679460270"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621679460271"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679460271"><span class="hs-identifier hs-var">isLast</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-444"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679460272"><span class="annot"><a href="#local-6989586621679460272"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679460273"><span class="annot"><a href="#local-6989586621679460273"><span class="hs-identifier hs-var">va</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StartStop slc1
-&gt; Maybe tr' -&gt; StartStop slc1 -&gt; Bool -&gt; [(tr1, v1)]
</span><a href="#local-6989586621679460205"><span class="hs-identifier hs-var">thaw1</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc1
</span><a href="#local-6989586621679460274"><span class="hs-identifier hs-var">l1</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe tr'
</span><a href="#local-6989586621679460269"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc1
</span><a href="#local-6989586621679460275"><span class="hs-identifier hs-var">r1</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679460271"><span class="hs-identifier hs-var">isLast</span></a></span><span>
</span><span id="line-445"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679460276"><span class="annot"><a href="#local-6989586621679460276"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679460277"><span class="annot"><a href="#local-6989586621679460277"><span class="hs-identifier hs-var">vb</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621679460211"><span class="hs-identifier hs-type">thaw2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679460278"><span class="hs-identifier hs-type">l2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679460269"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679460279"><span class="hs-identifier hs-type">r2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679460271"><span class="hs-identifier hs-type">isLast</span></a></span><span>
</span><span id="line-446"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679460272"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679460276"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679460273"><span class="hs-identifier hs-type">va</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679460277"><span class="hs-identifier hs-type">vb</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-447"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-448"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679460274"><span class="annot"><span class="annottext">StartStop slc1
</span><a href="#local-6989586621679460274"><span class="hs-identifier hs-var">l1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679460278"><span class="annot"><span class="annottext">StartStop slc2
</span><a href="#local-6989586621679460278"><span class="hs-identifier hs-var">l2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StartStop (slc1, slc2) -&gt; (StartStop slc1, StartStop slc2)
forall a b. StartStop (a, b) -&gt; (StartStop a, StartStop b)
</span><a href="Common.html#distStartStop"><span class="hs-identifier hs-var">distStartStop</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop (slc1, slc2)
</span><a href="#local-6989586621679460268"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-449"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679460275"><span class="annot"><span class="annottext">StartStop slc1
</span><a href="#local-6989586621679460275"><span class="hs-identifier hs-var">r1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679460279"><span class="annot"><span class="annottext">StartStop slc2
</span><a href="#local-6989586621679460279"><span class="hs-identifier hs-var">r2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StartStop (slc1, slc2) -&gt; (StartStop slc1, StartStop slc2)
forall a b. StartStop (a, b) -&gt; (StartStop a, StartStop b)
</span><a href="Common.html#distStartStop"><span class="hs-identifier hs-var">distStartStop</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop (slc1, slc2)
</span><a href="#local-6989586621679460270"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-450"></span><span>  </span><span id="local-6989586621679460218"><span class="annot"><span class="annottext">slice :: slc' -&gt; (slc1, slc2)
</span><a href="#local-6989586621679460218"><span class="hs-identifier hs-var hs-var">slice</span></a></span></span><span> </span><span id="local-6989586621679460280"><span class="annot"><span class="annottext">slc'
</span><a href="#local-6989586621679460280"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">slc' -&gt; slc1
</span><a href="#local-6989586621679460206"><span class="hs-identifier hs-var">slice1</span></a></span><span> </span><span class="annot"><span class="annottext">slc'
</span><a href="#local-6989586621679460280"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">slc' -&gt; slc2
</span><a href="#local-6989586621679460212"><span class="hs-identifier hs-var">slice2</span></a></span><span> </span><span class="annot"><span class="annottext">slc'
</span><a href="#local-6989586621679460280"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-451"></span><span>
</span><span id="line-452"></span><span class="hs-comment">-- restricting branching</span><span>
</span><span id="line-453"></span><span class="hs-comment">-- ---------------------</span><span>
</span><span id="line-454"></span><span>
</span><span id="line-455"></span><span class="annot"><span class="hs-comment">-- | A flag that is used to restrict spread operations to right branching.</span></span><span>
</span><span id="line-456"></span><span class="hs-keyword">data</span><span> </span><span id="RightBranchSpread"><span class="annot"><a href="Common.html#RightBranchSpread"><span class="hs-identifier hs-var">RightBranchSpread</span></a></span></span><span>
</span><span id="line-457"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="RBBranches"><span class="annot"><a href="Common.html#RBBranches"><span class="hs-identifier hs-var">RBBranches</span></a></span></span><span>
</span><span id="line-458"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="RBClear"><span class="annot"><a href="Common.html#RBClear"><span class="hs-identifier hs-var">RBClear</span></a></span></span><span>
</span><span id="line-459"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679460284"><span id="local-6989586621679460288"><span class="annot"><span class="annottext">RightBranchSpread -&gt; RightBranchSpread -&gt; Bool
(RightBranchSpread -&gt; RightBranchSpread -&gt; Bool)
-&gt; (RightBranchSpread -&gt; RightBranchSpread -&gt; Bool)
-&gt; Eq RightBranchSpread
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: RightBranchSpread -&gt; RightBranchSpread -&gt; Bool
== :: RightBranchSpread -&gt; RightBranchSpread -&gt; Bool
$c/= :: RightBranchSpread -&gt; RightBranchSpread -&gt; Bool
/= :: RightBranchSpread -&gt; RightBranchSpread -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679460294"><span id="local-6989586621679460296"><span id="local-6989586621679460298"><span id="local-6989586621679460302"><span id="local-6989586621679460305"><span id="local-6989586621679460308"><span id="local-6989586621679460311"><span class="annot"><span class="annottext">Eq RightBranchSpread
Eq RightBranchSpread =&gt;
(RightBranchSpread -&gt; RightBranchSpread -&gt; Ordering)
-&gt; (RightBranchSpread -&gt; RightBranchSpread -&gt; Bool)
-&gt; (RightBranchSpread -&gt; RightBranchSpread -&gt; Bool)
-&gt; (RightBranchSpread -&gt; RightBranchSpread -&gt; Bool)
-&gt; (RightBranchSpread -&gt; RightBranchSpread -&gt; Bool)
-&gt; (RightBranchSpread -&gt; RightBranchSpread -&gt; RightBranchSpread)
-&gt; (RightBranchSpread -&gt; RightBranchSpread -&gt; RightBranchSpread)
-&gt; Ord RightBranchSpread
RightBranchSpread -&gt; RightBranchSpread -&gt; Bool
RightBranchSpread -&gt; RightBranchSpread -&gt; Ordering
RightBranchSpread -&gt; RightBranchSpread -&gt; RightBranchSpread
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
$ccompare :: RightBranchSpread -&gt; RightBranchSpread -&gt; Ordering
compare :: RightBranchSpread -&gt; RightBranchSpread -&gt; Ordering
$c&lt; :: RightBranchSpread -&gt; RightBranchSpread -&gt; Bool
&lt; :: RightBranchSpread -&gt; RightBranchSpread -&gt; Bool
$c&lt;= :: RightBranchSpread -&gt; RightBranchSpread -&gt; Bool
&lt;= :: RightBranchSpread -&gt; RightBranchSpread -&gt; Bool
$c&gt; :: RightBranchSpread -&gt; RightBranchSpread -&gt; Bool
&gt; :: RightBranchSpread -&gt; RightBranchSpread -&gt; Bool
$c&gt;= :: RightBranchSpread -&gt; RightBranchSpread -&gt; Bool
&gt;= :: RightBranchSpread -&gt; RightBranchSpread -&gt; Bool
$cmax :: RightBranchSpread -&gt; RightBranchSpread -&gt; RightBranchSpread
max :: RightBranchSpread -&gt; RightBranchSpread -&gt; RightBranchSpread
$cmin :: RightBranchSpread -&gt; RightBranchSpread -&gt; RightBranchSpread
min :: RightBranchSpread -&gt; RightBranchSpread -&gt; RightBranchSpread
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679460314"><span id="local-6989586621679460316"><span id="local-6989586621679460320"><span class="annot"><span class="annottext">Int -&gt; RightBranchSpread -&gt; ShowS
[RightBranchSpread] -&gt; ShowS
RightBranchSpread -&gt; String
(Int -&gt; RightBranchSpread -&gt; ShowS)
-&gt; (RightBranchSpread -&gt; String)
-&gt; ([RightBranchSpread] -&gt; ShowS)
-&gt; Show RightBranchSpread
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; RightBranchSpread -&gt; ShowS
showsPrec :: Int -&gt; RightBranchSpread -&gt; ShowS
$cshow :: RightBranchSpread -&gt; String
show :: RightBranchSpread -&gt; String
$cshowList :: [RightBranchSpread] -&gt; ShowS
showList :: [RightBranchSpread] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679460324"><span id="local-6989586621679460326"><span class="annot"><span class="annottext">(forall x. RightBranchSpread -&gt; Rep RightBranchSpread x)
-&gt; (forall x. Rep RightBranchSpread x -&gt; RightBranchSpread)
-&gt; Generic RightBranchSpread
forall x. Rep RightBranchSpread x -&gt; RightBranchSpread
forall x. RightBranchSpread -&gt; Rep RightBranchSpread x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x. RightBranchSpread -&gt; Rep RightBranchSpread x
from :: forall x. RightBranchSpread -&gt; Rep RightBranchSpread x
$cto :: forall x. Rep RightBranchSpread x -&gt; RightBranchSpread
to :: forall x. Rep RightBranchSpread x -&gt; RightBranchSpread
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679460329"><span class="annot"><span class="annottext">RightBranchSpread -&gt; ()
(RightBranchSpread -&gt; ()) -&gt; NFData RightBranchSpread
forall a. (a -&gt; ()) -&gt; NFData a
$crnf :: RightBranchSpread -&gt; ()
rnf :: RightBranchSpread -&gt; ()
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679460342"><span id="local-6989586621679460349"><span class="annot"><span class="annottext">Eq RightBranchSpread
Eq RightBranchSpread =&gt;
(Int -&gt; RightBranchSpread -&gt; Int)
-&gt; (RightBranchSpread -&gt; Int) -&gt; Hashable RightBranchSpread
Int -&gt; RightBranchSpread -&gt; Int
RightBranchSpread -&gt; Int
forall a. Eq a =&gt; (Int -&gt; a -&gt; Int) -&gt; (a -&gt; Int) -&gt; Hashable a
$chashWithSalt :: Int -&gt; RightBranchSpread -&gt; Int
hashWithSalt :: Int -&gt; RightBranchSpread -&gt; Int
$chash :: RightBranchSpread -&gt; Int
hash :: RightBranchSpread -&gt; Int
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Hashable</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-460"></span><span>
</span><span id="line-461"></span><span class="annot"><span class="hs-comment">{- | An evaluator that doesn't parse the input but restricts spread operations to right branching.
 Legal combinations will just return a singleton @()@ while illegal combinations return nothing.
 Combine this with any evaluator as a product (using 'productEval' or 'rightBranchSpread')
 to make the evaluator right-branching.
-}</span></span><span>
</span><span id="line-466"></span><span id="local-6989586621679458794"><span id="local-6989586621679458795"><span class="annot"><a href="Common.html#evalRightBranchSpread"><span class="hs-identifier hs-type">evalRightBranchSpread</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Common.html#Eval"><span class="hs-identifier hs-type">Eval</span></a></span><span> </span><span class="annot"><a href="Common.html#RightBranchSpread"><span class="hs-identifier hs-type">RightBranchSpread</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458794"><span class="hs-identifier hs-type">tr'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679458795"><span class="hs-identifier hs-type">slc'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-467"></span><span id="evalRightBranchSpread"><span class="annot"><span class="annottext">evalRightBranchSpread :: forall tr' slc'. Eval RightBranchSpread tr' () slc' () ()
</span><a href="Common.html#evalRightBranchSpread"><span class="hs-identifier hs-var hs-var">evalRightBranchSpread</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UnspreadMiddle RightBranchSpread () () ()
-&gt; UnspreadLeft RightBranchSpread () ()
-&gt; UnspreadRight RightBranchSpread () ()
-&gt; Unsplit RightBranchSpread () ()
-&gt; (StartStop ()
    -&gt; Maybe tr' -&gt; StartStop () -&gt; Bool -&gt; [(RightBranchSpread, ())])
-&gt; (slc' -&gt; ())
-&gt; Eval RightBranchSpread tr' () slc' () ()
forall tr tr' slc slc' h v.
UnspreadMiddle tr slc h v
-&gt; UnspreadLeft tr slc h
-&gt; UnspreadRight tr slc h
-&gt; Unsplit tr slc v
-&gt; (StartStop slc
    -&gt; Maybe tr' -&gt; StartStop slc -&gt; Bool -&gt; [(tr, v)])
-&gt; (slc' -&gt; slc)
-&gt; Eval tr tr' slc slc' h v
</span><a href="Common.html#Eval"><span class="hs-identifier hs-var">Eval</span></a></span><span> </span><span class="annot"><span class="annottext">UnspreadMiddle RightBranchSpread () () ()
forall {a} {c}. (a, RightBranchSpread, c) -&gt; [((), (), ())]
</span><a href="#local-6989586621679460355"><span class="hs-identifier hs-var">unspreadm</span></a></span><span> </span><span class="annot"><span class="annottext">UnspreadLeft RightBranchSpread () ()
forall {p} {p} {p}. p -&gt; p -&gt; p -&gt; [RightBranchSpread]
</span><a href="#local-6989586621679460356"><span class="hs-identifier hs-var">unspreadl</span></a></span><span> </span><span class="annot"><span class="annottext">UnspreadRight RightBranchSpread () ()
forall {p} {p} {p}. p -&gt; p -&gt; p -&gt; [RightBranchSpread]
</span><a href="#local-6989586621679460357"><span class="hs-identifier hs-var">unspreadr</span></a></span><span> </span><span class="annot"><span class="annottext">Unsplit RightBranchSpread () ()
forall {p} {p} {p} {p} {p} {p}.
p -&gt; p -&gt; p -&gt; p -&gt; p -&gt; p -&gt; [(RightBranchSpread, ())]
</span><a href="#local-6989586621679460358"><span class="hs-identifier hs-var">merge</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop ()
-&gt; Maybe tr' -&gt; StartStop () -&gt; Bool -&gt; [(RightBranchSpread, ())]
forall {p} {p} {p} {p}.
p -&gt; p -&gt; p -&gt; p -&gt; [(RightBranchSpread, ())]
</span><a href="#local-6989586621679460359"><span class="hs-identifier hs-var">thaw</span></a></span><span> </span><span class="annot"><span class="annottext">slc' -&gt; ()
forall {p}. p -&gt; ()
</span><a href="#local-6989586621679460360"><span class="hs-identifier hs-var">slice</span></a></span><span>
</span><span id="line-468"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-469"></span><span>  </span><span id="local-6989586621679460355"><span class="annot"><span class="annottext">unspreadm :: (a, RightBranchSpread, c) -&gt; [((), (), ())]
</span><a href="#local-6989586621679460355"><span class="hs-identifier hs-var hs-var">unspreadm</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RightBranchSpread
</span><a href="Common.html#RBBranches"><span class="hs-identifier hs-var">RBBranches</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">c
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-470"></span><span>  </span><span class="annot"><a href="#local-6989586621679460355"><span class="hs-identifier hs-var">unspreadm</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">RightBranchSpread
</span><a href="Common.html#RBClear"><span class="hs-identifier hs-var">RBClear</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">c
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-471"></span><span>  </span><span id="local-6989586621679460356"><span class="annot"><span class="annottext">unspreadl :: p -&gt; p -&gt; p -&gt; [RightBranchSpread]
</span><a href="#local-6989586621679460356"><span class="hs-identifier hs-var hs-var">unspreadl</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">RightBranchSpread
</span><a href="Common.html#RBClear"><span class="hs-identifier hs-var">RBClear</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-472"></span><span>  </span><span id="local-6989586621679460357"><span class="annot"><span class="annottext">unspreadr :: p -&gt; p -&gt; p -&gt; [RightBranchSpread]
</span><a href="#local-6989586621679460357"><span class="hs-identifier hs-var hs-var">unspreadr</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">RightBranchSpread
</span><a href="Common.html#RBBranches"><span class="hs-identifier hs-var">RBBranches</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-473"></span><span>  </span><span id="local-6989586621679460358"><span class="annot"><span class="annottext">merge :: p -&gt; p -&gt; p -&gt; p -&gt; p -&gt; p -&gt; [(RightBranchSpread, ())]
</span><a href="#local-6989586621679460358"><span class="hs-identifier hs-var hs-var">merge</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">RightBranchSpread
</span><a href="Common.html#RBClear"><span class="hs-identifier hs-var">RBClear</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-474"></span><span>  </span><span id="local-6989586621679460359"><span class="annot"><span class="annottext">thaw :: p -&gt; p -&gt; p -&gt; p -&gt; [(RightBranchSpread, ())]
</span><a href="#local-6989586621679460359"><span class="hs-identifier hs-var hs-var">thaw</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">RightBranchSpread
</span><a href="Common.html#RBClear"><span class="hs-identifier hs-var">RBClear</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-475"></span><span>  </span><span id="local-6989586621679460360"><span class="annot"><span class="annottext">slice :: p -&gt; ()
</span><a href="#local-6989586621679460360"><span class="hs-identifier hs-var hs-var">slice</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-476"></span><span>
</span><span id="line-477"></span><span class="annot"><span class="hs-comment">-- | Restrict any evaluator to right-branching spreads.</span></span><span>
</span><span id="line-478"></span><span id="local-6989586621679458817"><span id="local-6989586621679458818"><span id="local-6989586621679458819"><span id="local-6989586621679458820"><span id="local-6989586621679458821"><span id="local-6989586621679458822"><span class="annot"><a href="Common.html#rightBranchSpread"><span class="hs-identifier hs-type">rightBranchSpread</span></a></span><span>
</span><span id="line-479"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Common.html#Eval"><span class="hs-identifier hs-type">Eval</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458817"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458818"><span class="hs-identifier hs-type">tr'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458819"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458820"><span class="hs-identifier hs-type">slc'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458821"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458822"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#Eval"><span class="hs-identifier hs-type">Eval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#RightBranchSpread"><span class="hs-identifier hs-type">RightBranchSpread</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679458817"><span class="hs-identifier hs-type">tr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679458818"><span class="hs-identifier hs-type">tr'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679458819"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679458820"><span class="hs-identifier hs-type">slc'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679458821"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679458822"><span class="hs-identifier hs-type">w</span></a></span></span></span></span></span></span></span><span>
</span><span id="line-480"></span><span id="rightBranchSpread"><span class="annot"><span class="annottext">rightBranchSpread :: forall tr tr' slc slc' h w.
Eval tr tr' slc slc' h w
-&gt; Eval (RightBranchSpread, tr) tr' ((), slc) slc' ((), h) w
</span><a href="Common.html#rightBranchSpread"><span class="hs-identifier hs-var hs-var">rightBranchSpread</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(((), w) -&gt; w)
-&gt; Eval (RightBranchSpread, tr) tr' ((), slc) slc' ((), h) ((), w)
-&gt; Eval (RightBranchSpread, tr) tr' ((), slc) slc' ((), h) w
forall v w tr tr' slc slc' h.
(v -&gt; w) -&gt; Eval tr tr' slc slc' h v -&gt; Eval tr tr' slc slc' h w
</span><a href="Common.html#mapEvalScore"><span class="hs-identifier hs-var">mapEvalScore</span></a></span><span> </span><span class="annot"><span class="annottext">((), w) -&gt; w
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">(Eval (RightBranchSpread, tr) tr' ((), slc) slc' ((), h) ((), w)
 -&gt; Eval (RightBranchSpread, tr) tr' ((), slc) slc' ((), h) w)
-&gt; (Eval tr tr' slc slc' h w
    -&gt; Eval (RightBranchSpread, tr) tr' ((), slc) slc' ((), h) ((), w))
-&gt; Eval tr tr' slc slc' h w
-&gt; Eval (RightBranchSpread, tr) tr' ((), slc) slc' ((), h) w
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Eval RightBranchSpread tr' () slc' () ()
-&gt; Eval tr tr' slc slc' h w
-&gt; Eval (RightBranchSpread, tr) tr' ((), slc) slc' ((), h) ((), w)
forall tr1 tr' slc1 slc' h1 v1 tr2 slc2 h2 v2.
Eval tr1 tr' slc1 slc' h1 v1
-&gt; Eval tr2 tr' slc2 slc' h2 v2
-&gt; Eval (tr1, tr2) tr' (slc1, slc2) slc' (h1, h2) (v1, v2)
</span><a href="Common.html#productEval"><span class="hs-identifier hs-var">productEval</span></a></span><span> </span><span class="annot"><span class="annottext">Eval RightBranchSpread tr' () slc' () ()
forall tr' slc'. Eval RightBranchSpread tr' () slc' () ()
</span><a href="Common.html#evalRightBranchSpread"><span class="hs-identifier hs-var">evalRightBranchSpread</span></a></span><span>
</span><span id="line-481"></span><span>
</span><span id="line-482"></span><span class="hs-comment">-- restricting derivation order</span><span>
</span><span id="line-483"></span><span class="hs-comment">-- ----------------------------</span><span>
</span><span id="line-484"></span><span>
</span><span id="line-485"></span><span class="annot"><span class="hs-comment">{- | A flag for indicating whether a transition is the result of a split or not.
 This is used for restricting the order of splits and spreads.
-}</span></span><span>
</span><span id="line-488"></span><span class="hs-keyword">data</span><span> </span><span id="Merged"><span class="annot"><a href="Common.html#Merged"><span class="hs-identifier hs-var">Merged</span></a></span></span><span>
</span><span id="line-489"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="Merged"><span class="annot"><a href="Common.html#Merged"><span class="hs-identifier hs-var">Merged</span></a></span></span><span>
</span><span id="line-490"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="NotMerged"><span class="annot"><a href="Common.html#NotMerged"><span class="hs-identifier hs-var">NotMerged</span></a></span></span><span>
</span><span id="line-491"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679460365"><span id="local-6989586621679460369"><span class="annot"><span class="annottext">Merged -&gt; Merged -&gt; Bool
(Merged -&gt; Merged -&gt; Bool)
-&gt; (Merged -&gt; Merged -&gt; Bool) -&gt; Eq Merged
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: Merged -&gt; Merged -&gt; Bool
== :: Merged -&gt; Merged -&gt; Bool
$c/= :: Merged -&gt; Merged -&gt; Bool
/= :: Merged -&gt; Merged -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679460375"><span id="local-6989586621679460377"><span id="local-6989586621679460379"><span id="local-6989586621679460383"><span id="local-6989586621679460386"><span id="local-6989586621679460389"><span id="local-6989586621679460392"><span class="annot"><span class="annottext">Eq Merged
Eq Merged =&gt;
(Merged -&gt; Merged -&gt; Ordering)
-&gt; (Merged -&gt; Merged -&gt; Bool)
-&gt; (Merged -&gt; Merged -&gt; Bool)
-&gt; (Merged -&gt; Merged -&gt; Bool)
-&gt; (Merged -&gt; Merged -&gt; Bool)
-&gt; (Merged -&gt; Merged -&gt; Merged)
-&gt; (Merged -&gt; Merged -&gt; Merged)
-&gt; Ord Merged
Merged -&gt; Merged -&gt; Bool
Merged -&gt; Merged -&gt; Ordering
Merged -&gt; Merged -&gt; Merged
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
$ccompare :: Merged -&gt; Merged -&gt; Ordering
compare :: Merged -&gt; Merged -&gt; Ordering
$c&lt; :: Merged -&gt; Merged -&gt; Bool
&lt; :: Merged -&gt; Merged -&gt; Bool
$c&lt;= :: Merged -&gt; Merged -&gt; Bool
&lt;= :: Merged -&gt; Merged -&gt; Bool
$c&gt; :: Merged -&gt; Merged -&gt; Bool
&gt; :: Merged -&gt; Merged -&gt; Bool
$c&gt;= :: Merged -&gt; Merged -&gt; Bool
&gt;= :: Merged -&gt; Merged -&gt; Bool
$cmax :: Merged -&gt; Merged -&gt; Merged
max :: Merged -&gt; Merged -&gt; Merged
$cmin :: Merged -&gt; Merged -&gt; Merged
min :: Merged -&gt; Merged -&gt; Merged
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679460395"><span id="local-6989586621679460397"><span id="local-6989586621679460401"><span class="annot"><span class="annottext">Int -&gt; Merged -&gt; ShowS
[Merged] -&gt; ShowS
Merged -&gt; String
(Int -&gt; Merged -&gt; ShowS)
-&gt; (Merged -&gt; String) -&gt; ([Merged] -&gt; ShowS) -&gt; Show Merged
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; Merged -&gt; ShowS
showsPrec :: Int -&gt; Merged -&gt; ShowS
$cshow :: Merged -&gt; String
show :: Merged -&gt; String
$cshowList :: [Merged] -&gt; ShowS
showList :: [Merged] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679460404"><span id="local-6989586621679460406"><span class="annot"><span class="annottext">(forall x. Merged -&gt; Rep Merged x)
-&gt; (forall x. Rep Merged x -&gt; Merged) -&gt; Generic Merged
forall x. Rep Merged x -&gt; Merged
forall x. Merged -&gt; Rep Merged x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x. Merged -&gt; Rep Merged x
from :: forall x. Merged -&gt; Rep Merged x
$cto :: forall x. Rep Merged x -&gt; Merged
to :: forall x. Rep Merged x -&gt; Merged
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679460409"><span class="annot"><span class="annottext">Merged -&gt; ()
(Merged -&gt; ()) -&gt; NFData Merged
forall a. (a -&gt; ()) -&gt; NFData a
$crnf :: Merged -&gt; ()
rnf :: Merged -&gt; ()
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679460422"><span id="local-6989586621679460429"><span class="annot"><span class="annottext">Eq Merged
Eq Merged =&gt;
(Int -&gt; Merged -&gt; Int) -&gt; (Merged -&gt; Int) -&gt; Hashable Merged
Int -&gt; Merged -&gt; Int
Merged -&gt; Int
forall a. Eq a =&gt; (Int -&gt; a -&gt; Int) -&gt; (a -&gt; Int) -&gt; Hashable a
$chashWithSalt :: Int -&gt; Merged -&gt; Int
hashWithSalt :: Int -&gt; Merged -&gt; Int
$chash :: Merged -&gt; Int
hash :: Merged -&gt; Int
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Hashable</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-492"></span><span>
</span><span id="line-493"></span><span class="annot"><span class="hs-comment">{- | An evaluator that doesn't parse the input but restricts the order of operations
 to always have splits before spreads on the left and right transitions at a spread.
 Legal combinations will just return a singleton @()@ while illegal combinations return nothing.
 Combine this with any evaluator as a product (using 'productEval' or 'splitFirst')
 to make the evaluator order-restricted.
-}</span></span><span>
</span><span id="line-499"></span><span id="local-6989586621679458832"><span id="local-6989586621679458833"><span class="annot"><a href="Common.html#evalSplitBeforeSpread"><span class="hs-identifier hs-type">evalSplitBeforeSpread</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Eval"><span class="hs-identifier hs-type">Eval</span></a></span><span> </span><span class="annot"><a href="Common.html#Merged"><span class="hs-identifier hs-type">Merged</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458832"><span class="hs-identifier hs-type">tr'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679458833"><span class="hs-identifier hs-type">slc'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-500"></span><span id="evalSplitBeforeSpread"><span class="annot"><span class="annottext">evalSplitBeforeSpread :: forall tr' slc'. Eval Merged tr' () slc' () ()
</span><a href="Common.html#evalSplitBeforeSpread"><span class="hs-identifier hs-var hs-var">evalSplitBeforeSpread</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UnspreadMiddle Merged () () ()
-&gt; UnspreadLeft Merged () ()
-&gt; UnspreadRight Merged () ()
-&gt; Unsplit Merged () ()
-&gt; (StartStop ()
    -&gt; Maybe tr' -&gt; StartStop () -&gt; Bool -&gt; [(Merged, ())])
-&gt; (slc' -&gt; ())
-&gt; Eval Merged tr' () slc' () ()
forall tr tr' slc slc' h v.
UnspreadMiddle tr slc h v
-&gt; UnspreadLeft tr slc h
-&gt; UnspreadRight tr slc h
-&gt; Unsplit tr slc v
-&gt; (StartStop slc
    -&gt; Maybe tr' -&gt; StartStop slc -&gt; Bool -&gt; [(tr, v)])
-&gt; (slc' -&gt; slc)
-&gt; Eval tr tr' slc slc' h v
</span><a href="Common.html#Eval"><span class="hs-identifier hs-var">Eval</span></a></span><span> </span><span class="annot"><span class="annottext">UnspreadMiddle Merged () () ()
forall {p}. p -&gt; [((), (), ())]
</span><a href="#local-6989586621679460435"><span class="hs-identifier hs-var">unspreadm</span></a></span><span> </span><span class="annot"><span class="annottext">UnspreadLeft Merged () ()
forall {b} {p} {p}. (Merged, b) -&gt; p -&gt; p -&gt; [Merged]
</span><a href="#local-6989586621679460436"><span class="hs-identifier hs-var">unspreadl</span></a></span><span> </span><span class="annot"><span class="annottext">UnspreadRight Merged () ()
forall {a} {p} {p}. (a, Merged) -&gt; p -&gt; p -&gt; [Merged]
</span><a href="#local-6989586621679460437"><span class="hs-identifier hs-var">unspreadr</span></a></span><span> </span><span class="annot"><span class="annottext">Unsplit Merged () ()
forall {p} {p} {p} {p} {p} {p}.
p -&gt; p -&gt; p -&gt; p -&gt; p -&gt; p -&gt; [(Merged, ())]
</span><a href="#local-6989586621679460438"><span class="hs-identifier hs-var">merge</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop () -&gt; Maybe tr' -&gt; StartStop () -&gt; Bool -&gt; [(Merged, ())]
forall {p} {p} {p} {p}. p -&gt; p -&gt; p -&gt; p -&gt; [(Merged, ())]
</span><a href="#local-6989586621679460439"><span class="hs-identifier hs-var">thaw</span></a></span><span> </span><span class="annot"><span class="annottext">slc' -&gt; ()
forall {p}. p -&gt; ()
</span><a href="#local-6989586621679460440"><span class="hs-identifier hs-var">slice</span></a></span><span>
</span><span id="line-501"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-502"></span><span>  </span><span id="local-6989586621679460435"><span class="annot"><span class="annottext">unspreadm :: p -&gt; [((), (), ())]
</span><a href="#local-6989586621679460435"><span class="hs-identifier hs-var hs-var">unspreadm</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-503"></span><span>  </span><span id="local-6989586621679460436"><span class="annot"><span class="annottext">unspreadl :: (Merged, b) -&gt; p -&gt; p -&gt; [Merged]
</span><a href="#local-6989586621679460436"><span class="hs-identifier hs-var hs-var">unspreadl</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Merged
</span><a href="Common.html#Merged"><span class="hs-identifier hs-var">Merged</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-504"></span><span>  </span><span class="annot"><a href="#local-6989586621679460436"><span class="hs-identifier hs-var">unspreadl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Merged
</span><a href="Common.html#NotMerged"><span class="hs-identifier hs-var">NotMerged</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Merged
</span><a href="Common.html#NotMerged"><span class="hs-identifier hs-var">NotMerged</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-505"></span><span>  </span><span id="local-6989586621679460437"><span class="annot"><span class="annottext">unspreadr :: (a, Merged) -&gt; p -&gt; p -&gt; [Merged]
</span><a href="#local-6989586621679460437"><span class="hs-identifier hs-var hs-var">unspreadr</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Merged
</span><a href="Common.html#Merged"><span class="hs-identifier hs-var">Merged</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-506"></span><span>  </span><span class="annot"><a href="#local-6989586621679460437"><span class="hs-identifier hs-var">unspreadr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Merged
</span><a href="Common.html#NotMerged"><span class="hs-identifier hs-var">NotMerged</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Merged
</span><a href="Common.html#NotMerged"><span class="hs-identifier hs-var">NotMerged</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-507"></span><span>  </span><span id="local-6989586621679460438"><span class="annot"><span class="annottext">merge :: p -&gt; p -&gt; p -&gt; p -&gt; p -&gt; p -&gt; [(Merged, ())]
</span><a href="#local-6989586621679460438"><span class="hs-identifier hs-var hs-var">merge</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Merged
</span><a href="Common.html#Merged"><span class="hs-identifier hs-var">Merged</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-508"></span><span>  </span><span id="local-6989586621679460439"><span class="annot"><span class="annottext">thaw :: p -&gt; p -&gt; p -&gt; p -&gt; [(Merged, ())]
</span><a href="#local-6989586621679460439"><span class="hs-identifier hs-var hs-var">thaw</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Merged
</span><a href="Common.html#NotMerged"><span class="hs-identifier hs-var">NotMerged</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-509"></span><span>  </span><span id="local-6989586621679460440"><span class="annot"><span class="annottext">slice :: p -&gt; ()
</span><a href="#local-6989586621679460440"><span class="hs-identifier hs-var hs-var">slice</span></a></span></span><span> </span><span class="annot"><span class="annottext">p
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-510"></span><span>
</span><span id="line-511"></span><span class="annot"><span class="hs-comment">-- | Restrict any evaluator to split-before-spread order.</span></span><span>
</span><span id="line-512"></span><span id="local-6989586621679458854"><span id="local-6989586621679458855"><span id="local-6989586621679458856"><span id="local-6989586621679458857"><span id="local-6989586621679458858"><span id="local-6989586621679458859"><span class="annot"><a href="Common.html#splitFirst"><span class="hs-identifier hs-type">splitFirst</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Common.html#Eval"><span class="hs-identifier hs-type">Eval</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458854"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458855"><span class="hs-identifier hs-type">tr'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458856"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458857"><span class="hs-identifier hs-type">slc'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458858"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458859"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#Eval"><span class="hs-identifier hs-type">Eval</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Merged"><span class="hs-identifier hs-type">Merged</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679458854"><span class="hs-identifier hs-type">tr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679458855"><span class="hs-identifier hs-type">tr'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679458856"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679458857"><span class="hs-identifier hs-type">slc'</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679458858"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679458859"><span class="hs-identifier hs-type">w</span></a></span></span></span></span></span></span></span><span>
</span><span id="line-513"></span><span id="splitFirst"><span class="annot"><span class="annottext">splitFirst :: forall tr tr' slc slc' h w.
Eval tr tr' slc slc' h w
-&gt; Eval (Merged, tr) tr' ((), slc) slc' ((), h) w
</span><a href="Common.html#splitFirst"><span class="hs-identifier hs-var hs-var">splitFirst</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(((), w) -&gt; w)
-&gt; Eval (Merged, tr) tr' ((), slc) slc' ((), h) ((), w)
-&gt; Eval (Merged, tr) tr' ((), slc) slc' ((), h) w
forall v w tr tr' slc slc' h.
(v -&gt; w) -&gt; Eval tr tr' slc slc' h v -&gt; Eval tr tr' slc slc' h w
</span><a href="Common.html#mapEvalScore"><span class="hs-identifier hs-var">mapEvalScore</span></a></span><span> </span><span class="annot"><span class="annottext">((), w) -&gt; w
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">(Eval (Merged, tr) tr' ((), slc) slc' ((), h) ((), w)
 -&gt; Eval (Merged, tr) tr' ((), slc) slc' ((), h) w)
-&gt; (Eval tr tr' slc slc' h w
    -&gt; Eval (Merged, tr) tr' ((), slc) slc' ((), h) ((), w))
-&gt; Eval tr tr' slc slc' h w
-&gt; Eval (Merged, tr) tr' ((), slc) slc' ((), h) w
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Eval Merged tr' () slc' () ()
-&gt; Eval tr tr' slc slc' h w
-&gt; Eval (Merged, tr) tr' ((), slc) slc' ((), h) ((), w)
forall tr1 tr' slc1 slc' h1 v1 tr2 slc2 h2 v2.
Eval tr1 tr' slc1 slc' h1 v1
-&gt; Eval tr2 tr' slc2 slc' h2 v2
-&gt; Eval (tr1, tr2) tr' (slc1, slc2) slc' (h1, h2) (v1, v2)
</span><a href="Common.html#productEval"><span class="hs-identifier hs-var">productEval</span></a></span><span> </span><span class="annot"><span class="annottext">Eval Merged tr' () slc' () ()
forall tr' slc'. Eval Merged tr' () slc' () ()
</span><a href="Common.html#evalSplitBeforeSpread"><span class="hs-identifier hs-var">evalSplitBeforeSpread</span></a></span><span>
</span><span id="line-514"></span><span>
</span><span id="line-515"></span><span class="hs-comment">-- left-most derivation outer operations</span><span>
</span><span id="line-516"></span><span class="hs-comment">-- =====================================</span><span>
</span><span id="line-517"></span><span>
</span><span id="line-518"></span><span class="annot"><span class="hs-comment">{- $leftmostdoc

 More specifically, if there is only one open transition left, only two actions are possible,
 freezing or splitting that transition:

 &gt; freeze only:   split only:
 &gt; ...=[]&#8212;&#8212;&#8905;      ==[]&#8212;&#8212;&#8905;
 &gt; ...=[]==&#8905;         \  /
 &gt;                     []

 These options are encoded in 'LeftmostSingle'.

 If two or more transitions are still open, four actions are possible:

 &gt; freeze left:         split left:          split right:         spread:
 &gt; ...=[]&#8212;&#8212;[]&#8212;&#8212;[]&#8212;...   ...=[]&#8212;&#8212;[]&#8212;&#8212;[]&#8212;...   ...=[]&#8212;&#8212;[]&#8212;&#8212;[]&#8212;...   ...=[]&#8212;&#8212;[]&#8212;&#8212;[]&#8212;...
 &gt; ...=[]==[]&#8212;&#8212;[]&#8212;...        \  /                     \  /             \  /\  /
 &gt;                            []                       []               []&#8212;&#8212;[]

 These options are encoded in 'LeftmostDouble'.
 Note that the order of operations is restricted so that after a right split only
 only another right split or a spread are allowed.
 See [below](#monadicDeriv) for a way to construct leftmost derivations in a type-safe way,
 checking operation order and open transitions at compile time.

 Both single and double operations are combined in 'Leftmost'.
 All three operation containers are parameterized over the specific operations types for
 splits (@s@), spreads (@h@ for &quot;horizontalization&quot;), freezes (@f@).
-}</span></span><span>
</span><span id="line-547"></span><span>
</span><span id="line-548"></span><span class="annot"><span class="hs-comment">-- | Generative operations on a single transition (split or freeze).</span></span><span>
</span><span id="line-549"></span><span class="hs-keyword">data</span><span> </span><span id="LeftmostSingle"><span class="annot"><a href="Common.html#LeftmostSingle"><span class="hs-identifier hs-var">LeftmostSingle</span></a></span></span><span> </span><span id="local-6989586621679459149"><span class="annot"><a href="#local-6989586621679459149"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679459150"><span class="annot"><a href="#local-6989586621679459150"><span class="hs-identifier hs-type">f</span></a></span></span><span>
</span><span id="line-550"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="LMSingleSplit"><span class="annot"><a href="Common.html#LMSingleSplit"><span class="hs-identifier hs-var">LMSingleSplit</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679459149"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-551"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="LMSingleFreeze"><span class="annot"><a href="Common.html#LMSingleFreeze"><span class="hs-identifier hs-var">LMSingleFreeze</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679459150"><span class="hs-identifier hs-type">f</span></a></span><span>
</span><span id="line-552"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679460446"><span id="local-6989586621679460452"><span class="annot"><span class="annottext">LeftmostSingle s f -&gt; LeftmostSingle s f -&gt; Bool
(LeftmostSingle s f -&gt; LeftmostSingle s f -&gt; Bool)
-&gt; (LeftmostSingle s f -&gt; LeftmostSingle s f -&gt; Bool)
-&gt; Eq (LeftmostSingle s f)
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall s f.
(Eq s, Eq f) =&gt;
LeftmostSingle s f -&gt; LeftmostSingle s f -&gt; Bool
$c== :: forall s f.
(Eq s, Eq f) =&gt;
LeftmostSingle s f -&gt; LeftmostSingle s f -&gt; Bool
== :: LeftmostSingle s f -&gt; LeftmostSingle s f -&gt; Bool
$c/= :: forall s f.
(Eq s, Eq f) =&gt;
LeftmostSingle s f -&gt; LeftmostSingle s f -&gt; Bool
/= :: LeftmostSingle s f -&gt; LeftmostSingle s f -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679460462"><span id="local-6989586621679460466"><span id="local-6989586621679460470"><span id="local-6989586621679460474"><span id="local-6989586621679460477"><span id="local-6989586621679460480"><span id="local-6989586621679460483"><span class="annot"><span class="annottext">Eq (LeftmostSingle s f)
Eq (LeftmostSingle s f) =&gt;
(LeftmostSingle s f -&gt; LeftmostSingle s f -&gt; Ordering)
-&gt; (LeftmostSingle s f -&gt; LeftmostSingle s f -&gt; Bool)
-&gt; (LeftmostSingle s f -&gt; LeftmostSingle s f -&gt; Bool)
-&gt; (LeftmostSingle s f -&gt; LeftmostSingle s f -&gt; Bool)
-&gt; (LeftmostSingle s f -&gt; LeftmostSingle s f -&gt; Bool)
-&gt; (LeftmostSingle s f -&gt; LeftmostSingle s f -&gt; LeftmostSingle s f)
-&gt; (LeftmostSingle s f -&gt; LeftmostSingle s f -&gt; LeftmostSingle s f)
-&gt; Ord (LeftmostSingle s f)
LeftmostSingle s f -&gt; LeftmostSingle s f -&gt; Bool
LeftmostSingle s f -&gt; LeftmostSingle s f -&gt; Ordering
LeftmostSingle s f -&gt; LeftmostSingle s f -&gt; LeftmostSingle s f
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall s f. (Ord s, Ord f) =&gt; Eq (LeftmostSingle s f)
forall s f.
(Ord s, Ord f) =&gt;
LeftmostSingle s f -&gt; LeftmostSingle s f -&gt; Bool
forall s f.
(Ord s, Ord f) =&gt;
LeftmostSingle s f -&gt; LeftmostSingle s f -&gt; Ordering
forall s f.
(Ord s, Ord f) =&gt;
LeftmostSingle s f -&gt; LeftmostSingle s f -&gt; LeftmostSingle s f
$ccompare :: forall s f.
(Ord s, Ord f) =&gt;
LeftmostSingle s f -&gt; LeftmostSingle s f -&gt; Ordering
compare :: LeftmostSingle s f -&gt; LeftmostSingle s f -&gt; Ordering
$c&lt; :: forall s f.
(Ord s, Ord f) =&gt;
LeftmostSingle s f -&gt; LeftmostSingle s f -&gt; Bool
&lt; :: LeftmostSingle s f -&gt; LeftmostSingle s f -&gt; Bool
$c&lt;= :: forall s f.
(Ord s, Ord f) =&gt;
LeftmostSingle s f -&gt; LeftmostSingle s f -&gt; Bool
&lt;= :: LeftmostSingle s f -&gt; LeftmostSingle s f -&gt; Bool
$c&gt; :: forall s f.
(Ord s, Ord f) =&gt;
LeftmostSingle s f -&gt; LeftmostSingle s f -&gt; Bool
&gt; :: LeftmostSingle s f -&gt; LeftmostSingle s f -&gt; Bool
$c&gt;= :: forall s f.
(Ord s, Ord f) =&gt;
LeftmostSingle s f -&gt; LeftmostSingle s f -&gt; Bool
&gt;= :: LeftmostSingle s f -&gt; LeftmostSingle s f -&gt; Bool
$cmax :: forall s f.
(Ord s, Ord f) =&gt;
LeftmostSingle s f -&gt; LeftmostSingle s f -&gt; LeftmostSingle s f
max :: LeftmostSingle s f -&gt; LeftmostSingle s f -&gt; LeftmostSingle s f
$cmin :: forall s f.
(Ord s, Ord f) =&gt;
LeftmostSingle s f -&gt; LeftmostSingle s f -&gt; LeftmostSingle s f
min :: LeftmostSingle s f -&gt; LeftmostSingle s f -&gt; LeftmostSingle s f
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679460488"><span id="local-6989586621679460494"><span id="local-6989586621679460498"><span class="annot"><span class="annottext">Int -&gt; LeftmostSingle s f -&gt; ShowS
[LeftmostSingle s f] -&gt; ShowS
LeftmostSingle s f -&gt; String
(Int -&gt; LeftmostSingle s f -&gt; ShowS)
-&gt; (LeftmostSingle s f -&gt; String)
-&gt; ([LeftmostSingle s f] -&gt; ShowS)
-&gt; Show (LeftmostSingle s f)
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall s f. (Show s, Show f) =&gt; Int -&gt; LeftmostSingle s f -&gt; ShowS
forall s f. (Show s, Show f) =&gt; [LeftmostSingle s f] -&gt; ShowS
forall s f. (Show s, Show f) =&gt; LeftmostSingle s f -&gt; String
$cshowsPrec :: forall s f. (Show s, Show f) =&gt; Int -&gt; LeftmostSingle s f -&gt; ShowS
showsPrec :: Int -&gt; LeftmostSingle s f -&gt; ShowS
$cshow :: forall s f. (Show s, Show f) =&gt; LeftmostSingle s f -&gt; String
show :: LeftmostSingle s f -&gt; String
$cshowList :: forall s f. (Show s, Show f) =&gt; [LeftmostSingle s f] -&gt; ShowS
showList :: [LeftmostSingle s f] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679460501"><span id="local-6989586621679460503"><span class="annot"><span class="annottext">(forall x. LeftmostSingle s f -&gt; Rep (LeftmostSingle s f) x)
-&gt; (forall x. Rep (LeftmostSingle s f) x -&gt; LeftmostSingle s f)
-&gt; Generic (LeftmostSingle s f)
forall x. Rep (LeftmostSingle s f) x -&gt; LeftmostSingle s f
forall x. LeftmostSingle s f -&gt; Rep (LeftmostSingle s f) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall s f x. Rep (LeftmostSingle s f) x -&gt; LeftmostSingle s f
forall s f x. LeftmostSingle s f -&gt; Rep (LeftmostSingle s f) x
$cfrom :: forall s f x. LeftmostSingle s f -&gt; Rep (LeftmostSingle s f) x
from :: forall x. LeftmostSingle s f -&gt; Rep (LeftmostSingle s f) x
$cto :: forall s f x. Rep (LeftmostSingle s f) x -&gt; LeftmostSingle s f
to :: forall x. Rep (LeftmostSingle s f) x -&gt; LeftmostSingle s f
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679460508"><span class="annot"><span class="annottext">LeftmostSingle s f -&gt; ()
(LeftmostSingle s f -&gt; ()) -&gt; NFData (LeftmostSingle s f)
forall a. (a -&gt; ()) -&gt; NFData a
forall s f. (NFData s, NFData f) =&gt; LeftmostSingle s f -&gt; ()
$crnf :: forall s f. (NFData s, NFData f) =&gt; LeftmostSingle s f -&gt; ()
rnf :: LeftmostSingle s f -&gt; ()
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679460522"><span id="local-6989586621679460524"><span class="annot"><span class="annottext">(forall a b. (a -&gt; b) -&gt; LeftmostSingle s a -&gt; LeftmostSingle s b)
-&gt; (forall a b. a -&gt; LeftmostSingle s b -&gt; LeftmostSingle s a)
-&gt; Functor (LeftmostSingle s)
forall a b. a -&gt; LeftmostSingle s b -&gt; LeftmostSingle s a
forall a b. (a -&gt; b) -&gt; LeftmostSingle s a -&gt; LeftmostSingle s b
forall s a b. a -&gt; LeftmostSingle s b -&gt; LeftmostSingle s a
forall s a b. (a -&gt; b) -&gt; LeftmostSingle s a -&gt; LeftmostSingle s b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
$cfmap :: forall s a b. (a -&gt; b) -&gt; LeftmostSingle s a -&gt; LeftmostSingle s b
fmap :: forall a b. (a -&gt; b) -&gt; LeftmostSingle s a -&gt; LeftmostSingle s b
$c&lt;$ :: forall s a b. a -&gt; LeftmostSingle s b -&gt; LeftmostSingle s a
&lt;$ :: forall a b. a -&gt; LeftmostSingle s b -&gt; LeftmostSingle s a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679460527"><span id="local-6989586621679460533"><span id="local-6989586621679460537"><span id="local-6989586621679460542"><span id="local-6989586621679460544"><span id="local-6989586621679460547"><span id="local-6989586621679460550"><span id="local-6989586621679460553"><span id="local-6989586621679460556"><span id="local-6989586621679460559"><span id="local-6989586621679460562"><span id="local-6989586621679460564"><span id="local-6989586621679460567"><span id="local-6989586621679460572"><span id="local-6989586621679460577"><span id="local-6989586621679460582"><span id="local-6989586621679460587"><span class="annot"><span class="annottext">(forall m. Monoid m =&gt; LeftmostSingle s m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; LeftmostSingle s a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; LeftmostSingle s a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; LeftmostSingle s a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; LeftmostSingle s a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; LeftmostSingle s a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; LeftmostSingle s a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; LeftmostSingle s a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; LeftmostSingle s a -&gt; a)
-&gt; (forall a. LeftmostSingle s a -&gt; [a])
-&gt; (forall a. LeftmostSingle s a -&gt; Bool)
-&gt; (forall a. LeftmostSingle s a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; LeftmostSingle s a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; LeftmostSingle s a -&gt; a)
-&gt; (forall a. Ord a =&gt; LeftmostSingle s a -&gt; a)
-&gt; (forall a. Num a =&gt; LeftmostSingle s a -&gt; a)
-&gt; (forall a. Num a =&gt; LeftmostSingle s a -&gt; a)
-&gt; Foldable (LeftmostSingle s)
forall a. Eq a =&gt; a -&gt; LeftmostSingle s a -&gt; Bool
forall a. Num a =&gt; LeftmostSingle s a -&gt; a
forall a. Ord a =&gt; LeftmostSingle s a -&gt; a
forall m. Monoid m =&gt; LeftmostSingle s m -&gt; m
forall a. LeftmostSingle s a -&gt; Bool
forall a. LeftmostSingle s a -&gt; Int
forall a. LeftmostSingle s a -&gt; [a]
forall a. (a -&gt; a -&gt; a) -&gt; LeftmostSingle s a -&gt; a
forall s a. Eq a =&gt; a -&gt; LeftmostSingle s a -&gt; Bool
forall s a. Num a =&gt; LeftmostSingle s a -&gt; a
forall s a. Ord a =&gt; LeftmostSingle s a -&gt; a
forall s m. Monoid m =&gt; LeftmostSingle s m -&gt; m
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; LeftmostSingle s a -&gt; m
forall s a. LeftmostSingle s a -&gt; Bool
forall s a. LeftmostSingle s a -&gt; Int
forall s a. LeftmostSingle s a -&gt; [a]
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; LeftmostSingle s a -&gt; b
forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; LeftmostSingle s a -&gt; b
forall s a. (a -&gt; a -&gt; a) -&gt; LeftmostSingle s a -&gt; a
forall s m a. Monoid m =&gt; (a -&gt; m) -&gt; LeftmostSingle s a -&gt; m
forall s b a. (b -&gt; a -&gt; b) -&gt; b -&gt; LeftmostSingle s a -&gt; b
forall s a b. (a -&gt; b -&gt; b) -&gt; b -&gt; LeftmostSingle s a -&gt; b
forall (t :: * -&gt; *).
(forall m. Monoid m =&gt; t m -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall m a. Monoid m =&gt; (a -&gt; m) -&gt; t a -&gt; m)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. (a -&gt; a -&gt; a) -&gt; t a -&gt; a)
-&gt; (forall a. t a -&gt; [a])
-&gt; (forall a. t a -&gt; Bool)
-&gt; (forall a. t a -&gt; Int)
-&gt; (forall a. Eq a =&gt; a -&gt; t a -&gt; Bool)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Ord a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; (forall a. Num a =&gt; t a -&gt; a)
-&gt; Foldable t
$cfold :: forall s m. Monoid m =&gt; LeftmostSingle s m -&gt; m
fold :: forall m. Monoid m =&gt; LeftmostSingle s m -&gt; m
$cfoldMap :: forall s m a. Monoid m =&gt; (a -&gt; m) -&gt; LeftmostSingle s a -&gt; m
foldMap :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; LeftmostSingle s a -&gt; m
$cfoldMap' :: forall s m a. Monoid m =&gt; (a -&gt; m) -&gt; LeftmostSingle s a -&gt; m
foldMap' :: forall m a. Monoid m =&gt; (a -&gt; m) -&gt; LeftmostSingle s a -&gt; m
$cfoldr :: forall s a b. (a -&gt; b -&gt; b) -&gt; b -&gt; LeftmostSingle s a -&gt; b
foldr :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; LeftmostSingle s a -&gt; b
$cfoldr' :: forall s a b. (a -&gt; b -&gt; b) -&gt; b -&gt; LeftmostSingle s a -&gt; b
foldr' :: forall a b. (a -&gt; b -&gt; b) -&gt; b -&gt; LeftmostSingle s a -&gt; b
$cfoldl :: forall s b a. (b -&gt; a -&gt; b) -&gt; b -&gt; LeftmostSingle s a -&gt; b
foldl :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; LeftmostSingle s a -&gt; b
$cfoldl' :: forall s b a. (b -&gt; a -&gt; b) -&gt; b -&gt; LeftmostSingle s a -&gt; b
foldl' :: forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; LeftmostSingle s a -&gt; b
$cfoldr1 :: forall s a. (a -&gt; a -&gt; a) -&gt; LeftmostSingle s a -&gt; a
foldr1 :: forall a. (a -&gt; a -&gt; a) -&gt; LeftmostSingle s a -&gt; a
$cfoldl1 :: forall s a. (a -&gt; a -&gt; a) -&gt; LeftmostSingle s a -&gt; a
foldl1 :: forall a. (a -&gt; a -&gt; a) -&gt; LeftmostSingle s a -&gt; a
$ctoList :: forall s a. LeftmostSingle s a -&gt; [a]
toList :: forall a. LeftmostSingle s a -&gt; [a]
$cnull :: forall s a. LeftmostSingle s a -&gt; Bool
null :: forall a. LeftmostSingle s a -&gt; Bool
$clength :: forall s a. LeftmostSingle s a -&gt; Int
length :: forall a. LeftmostSingle s a -&gt; Int
$celem :: forall s a. Eq a =&gt; a -&gt; LeftmostSingle s a -&gt; Bool
elem :: forall a. Eq a =&gt; a -&gt; LeftmostSingle s a -&gt; Bool
$cmaximum :: forall s a. Ord a =&gt; LeftmostSingle s a -&gt; a
maximum :: forall a. Ord a =&gt; LeftmostSingle s a -&gt; a
$cminimum :: forall s a. Ord a =&gt; LeftmostSingle s a -&gt; a
minimum :: forall a. Ord a =&gt; LeftmostSingle s a -&gt; a
$csum :: forall s a. Num a =&gt; LeftmostSingle s a -&gt; a
sum :: forall a. Num a =&gt; LeftmostSingle s a -&gt; a
$cproduct :: forall s a. Num a =&gt; LeftmostSingle s a -&gt; a
product :: forall a. Num a =&gt; LeftmostSingle s a -&gt; a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Foldable</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679460596"><span id="local-6989586621679460602"><span id="local-6989586621679460608"><span id="local-6989586621679460613"><span class="annot"><span class="annottext">Functor (LeftmostSingle s)
Foldable (LeftmostSingle s)
(Functor (LeftmostSingle s), Foldable (LeftmostSingle s)) =&gt;
(forall (f :: * -&gt; *) a b.
 Applicative f =&gt;
 (a -&gt; f b) -&gt; LeftmostSingle s a -&gt; f (LeftmostSingle s b))
-&gt; (forall (f :: * -&gt; *) a.
    Applicative f =&gt;
    LeftmostSingle s (f a) -&gt; f (LeftmostSingle s a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; LeftmostSingle s a -&gt; m (LeftmostSingle s b))
-&gt; (forall (m :: * -&gt; *) a.
    Monad m =&gt;
    LeftmostSingle s (m a) -&gt; m (LeftmostSingle s a))
-&gt; Traversable (LeftmostSingle s)
forall s. Functor (LeftmostSingle s)
forall s. Foldable (LeftmostSingle s)
forall s (m :: * -&gt; *) a.
Monad m =&gt;
LeftmostSingle s (m a) -&gt; m (LeftmostSingle s a)
forall s (f :: * -&gt; *) a.
Applicative f =&gt;
LeftmostSingle s (f a) -&gt; f (LeftmostSingle s a)
forall s (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; LeftmostSingle s a -&gt; m (LeftmostSingle s b)
forall s (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; LeftmostSingle s a -&gt; f (LeftmostSingle s b)
forall (t :: * -&gt; *).
(Functor t, Foldable t) =&gt;
(forall (f :: * -&gt; *) a b.
 Applicative f =&gt;
 (a -&gt; f b) -&gt; t a -&gt; f (t b))
-&gt; (forall (f :: * -&gt; *) a. Applicative f =&gt; t (f a) -&gt; f (t a))
-&gt; (forall (m :: * -&gt; *) a b.
    Monad m =&gt;
    (a -&gt; m b) -&gt; t a -&gt; m (t b))
-&gt; (forall (m :: * -&gt; *) a. Monad m =&gt; t (m a) -&gt; m (t a))
-&gt; Traversable t
forall (m :: * -&gt; *) a.
Monad m =&gt;
LeftmostSingle s (m a) -&gt; m (LeftmostSingle s a)
forall (f :: * -&gt; *) a.
Applicative f =&gt;
LeftmostSingle s (f a) -&gt; f (LeftmostSingle s a)
forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; LeftmostSingle s a -&gt; m (LeftmostSingle s b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; LeftmostSingle s a -&gt; f (LeftmostSingle s b)
$ctraverse :: forall s (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; LeftmostSingle s a -&gt; f (LeftmostSingle s b)
traverse :: forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; LeftmostSingle s a -&gt; f (LeftmostSingle s b)
$csequenceA :: forall s (f :: * -&gt; *) a.
Applicative f =&gt;
LeftmostSingle s (f a) -&gt; f (LeftmostSingle s a)
sequenceA :: forall (f :: * -&gt; *) a.
Applicative f =&gt;
LeftmostSingle s (f a) -&gt; f (LeftmostSingle s a)
$cmapM :: forall s (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; LeftmostSingle s a -&gt; m (LeftmostSingle s b)
mapM :: forall (m :: * -&gt; *) a b.
Monad m =&gt;
(a -&gt; m b) -&gt; LeftmostSingle s a -&gt; m (LeftmostSingle s b)
$csequence :: forall s (m :: * -&gt; *) a.
Monad m =&gt;
LeftmostSingle s (m a) -&gt; m (LeftmostSingle s a)
sequence :: forall (m :: * -&gt; *) a.
Monad m =&gt;
LeftmostSingle s (m a) -&gt; m (LeftmostSingle s a)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Traversable</span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-553"></span><span>
</span><span id="line-554"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679458907"><span id="local-6989586621679458908"><span id="local-6989586621679460622"><span id="local-6989586621679460626"><span id="local-6989586621679460629"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621679458907"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621679458908"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#LeftmostSingle"><span class="hs-identifier hs-type">LeftmostSingle</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458907"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679458908"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-555"></span><span>  </span><span id="local-6989586621679460714"><span class="annot"><span class="annottext">toJSON :: LeftmostSingle s f -&gt; Value
</span><span class="hs-identifier hs-var hs-var hs-var">toJSON</span></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-556"></span><span>    </span><span class="annot"><span class="annottext">Options -&gt; LeftmostSingle s f -&gt; Value
forall a.
(Generic a, GToJSON' Value Zero (Rep a)) =&gt;
Options -&gt; a -&gt; Value
</span><span class="hs-identifier hs-var">Aeson.genericToJSON</span></span><span> </span><span class="annot"><span class="annottext">(Options -&gt; LeftmostSingle s f -&gt; Value)
-&gt; Options -&gt; LeftmostSingle s f -&gt; Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; Options
</span><a href="Common.html#variantDefaults"><span class="hs-identifier hs-var">variantDefaults</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Only&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ShowS
</span><a href="Common.html#firstToLower"><span class="hs-identifier hs-var">firstToLower</span></a></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; ShowS
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span>
</span><span id="line-557"></span><span>  </span><span id="local-6989586621679460781"><span class="annot"><span class="annottext">toEncoding :: LeftmostSingle s f -&gt; Encoding
</span><span class="hs-identifier hs-var hs-var hs-var">toEncoding</span></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-558"></span><span>    </span><span class="annot"><span class="annottext">Options -&gt; LeftmostSingle s f -&gt; Encoding
forall a.
(Generic a, GToJSON' Encoding Zero (Rep a)) =&gt;
Options -&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">Aeson.genericToEncoding</span></span><span> </span><span class="annot"><span class="annottext">(Options -&gt; LeftmostSingle s f -&gt; Encoding)
-&gt; Options -&gt; LeftmostSingle s f -&gt; Encoding
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-559"></span><span>      </span><span class="annot"><span class="annottext">ShowS -&gt; Options
</span><a href="Common.html#variantDefaults"><span class="hs-identifier hs-var">variantDefaults</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Only&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ShowS
</span><a href="Common.html#firstToLower"><span class="hs-identifier hs-var">firstToLower</span></a></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS -&gt; ShowS
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; ShowS
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span>
</span><span id="line-560"></span><span>
</span><span id="line-561"></span><span class="annot"><span class="hs-comment">-- | Generative operations on two transitions (split left, freeze left, split right, or spread)</span></span><span>
</span><span id="line-562"></span><span class="hs-keyword">data</span><span> </span><span id="LeftmostDouble"><span class="annot"><a href="Common.html#LeftmostDouble"><span class="hs-identifier hs-var">LeftmostDouble</span></a></span></span><span> </span><span id="local-6989586621679459122"><span class="annot"><a href="#local-6989586621679459122"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679459123"><span class="annot"><a href="#local-6989586621679459123"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679459124"><span class="annot"><a href="#local-6989586621679459124"><span class="hs-identifier hs-type">h</span></a></span></span><span>
</span><span id="line-563"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="LMDoubleSplitLeft"><span class="annot"><a href="Common.html#LMDoubleSplitLeft"><span class="hs-identifier hs-var">LMDoubleSplitLeft</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679459122"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-564"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="LMDoubleFreezeLeft"><span class="annot"><a href="Common.html#LMDoubleFreezeLeft"><span class="hs-identifier hs-var">LMDoubleFreezeLeft</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679459123"><span class="hs-identifier hs-type">f</span></a></span><span>
</span><span id="line-565"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="LMDoubleSplitRight"><span class="annot"><a href="Common.html#LMDoubleSplitRight"><span class="hs-identifier hs-var">LMDoubleSplitRight</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679459122"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-566"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="LMDoubleSpread"><span class="annot"><a href="Common.html#LMDoubleSpread"><span class="hs-identifier hs-var">LMDoubleSpread</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679459124"><span class="hs-identifier hs-type">h</span></a></span><span>
</span><span id="line-567"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679460791"><span id="local-6989586621679460799"><span class="annot"><span class="annottext">LeftmostDouble s f h -&gt; LeftmostDouble s f h -&gt; Bool
(LeftmostDouble s f h -&gt; LeftmostDouble s f h -&gt; Bool)
-&gt; (LeftmostDouble s f h -&gt; LeftmostDouble s f h -&gt; Bool)
-&gt; Eq (LeftmostDouble s f h)
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall s f h.
(Eq f, Eq s, Eq h) =&gt;
LeftmostDouble s f h -&gt; LeftmostDouble s f h -&gt; Bool
$c== :: forall s f h.
(Eq f, Eq s, Eq h) =&gt;
LeftmostDouble s f h -&gt; LeftmostDouble s f h -&gt; Bool
== :: LeftmostDouble s f h -&gt; LeftmostDouble s f h -&gt; Bool
$c/= :: forall s f h.
(Eq f, Eq s, Eq h) =&gt;
LeftmostDouble s f h -&gt; LeftmostDouble s f h -&gt; Bool
/= :: LeftmostDouble s f h -&gt; LeftmostDouble s f h -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679460811"><span id="local-6989586621679460817"><span id="local-6989586621679460821"><span id="local-6989586621679460824"><span id="local-6989586621679460827"><span id="local-6989586621679460830"><span id="local-6989586621679460833"><span class="annot"><span class="annottext">Eq (LeftmostDouble s f h)
Eq (LeftmostDouble s f h) =&gt;
(LeftmostDouble s f h -&gt; LeftmostDouble s f h -&gt; Ordering)
-&gt; (LeftmostDouble s f h -&gt; LeftmostDouble s f h -&gt; Bool)
-&gt; (LeftmostDouble s f h -&gt; LeftmostDouble s f h -&gt; Bool)
-&gt; (LeftmostDouble s f h -&gt; LeftmostDouble s f h -&gt; Bool)
-&gt; (LeftmostDouble s f h -&gt; LeftmostDouble s f h -&gt; Bool)
-&gt; (LeftmostDouble s f h
    -&gt; LeftmostDouble s f h -&gt; LeftmostDouble s f h)
-&gt; (LeftmostDouble s f h
    -&gt; LeftmostDouble s f h -&gt; LeftmostDouble s f h)
-&gt; Ord (LeftmostDouble s f h)
LeftmostDouble s f h -&gt; LeftmostDouble s f h -&gt; Bool
LeftmostDouble s f h -&gt; LeftmostDouble s f h -&gt; Ordering
LeftmostDouble s f h
-&gt; LeftmostDouble s f h -&gt; LeftmostDouble s f h
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall s f h. (Ord f, Ord s, Ord h) =&gt; Eq (LeftmostDouble s f h)
forall s f h.
(Ord f, Ord s, Ord h) =&gt;
LeftmostDouble s f h -&gt; LeftmostDouble s f h -&gt; Bool
forall s f h.
(Ord f, Ord s, Ord h) =&gt;
LeftmostDouble s f h -&gt; LeftmostDouble s f h -&gt; Ordering
forall s f h.
(Ord f, Ord s, Ord h) =&gt;
LeftmostDouble s f h
-&gt; LeftmostDouble s f h -&gt; LeftmostDouble s f h
$ccompare :: forall s f h.
(Ord f, Ord s, Ord h) =&gt;
LeftmostDouble s f h -&gt; LeftmostDouble s f h -&gt; Ordering
compare :: LeftmostDouble s f h -&gt; LeftmostDouble s f h -&gt; Ordering
$c&lt; :: forall s f h.
(Ord f, Ord s, Ord h) =&gt;
LeftmostDouble s f h -&gt; LeftmostDouble s f h -&gt; Bool
&lt; :: LeftmostDouble s f h -&gt; LeftmostDouble s f h -&gt; Bool
$c&lt;= :: forall s f h.
(Ord f, Ord s, Ord h) =&gt;
LeftmostDouble s f h -&gt; LeftmostDouble s f h -&gt; Bool
&lt;= :: LeftmostDouble s f h -&gt; LeftmostDouble s f h -&gt; Bool
$c&gt; :: forall s f h.
(Ord f, Ord s, Ord h) =&gt;
LeftmostDouble s f h -&gt; LeftmostDouble s f h -&gt; Bool
&gt; :: LeftmostDouble s f h -&gt; LeftmostDouble s f h -&gt; Bool
$c&gt;= :: forall s f h.
(Ord f, Ord s, Ord h) =&gt;
LeftmostDouble s f h -&gt; LeftmostDouble s f h -&gt; Bool
&gt;= :: LeftmostDouble s f h -&gt; LeftmostDouble s f h -&gt; Bool
$cmax :: forall s f h.
(Ord f, Ord s, Ord h) =&gt;
LeftmostDouble s f h
-&gt; LeftmostDouble s f h -&gt; LeftmostDouble s f h
max :: LeftmostDouble s f h
-&gt; LeftmostDouble s f h -&gt; LeftmostDouble s f h
$cmin :: forall s f h.
(Ord f, Ord s, Ord h) =&gt;
LeftmostDouble s f h
-&gt; LeftmostDouble s f h -&gt; LeftmostDouble s f h
min :: LeftmostDouble s f h
-&gt; LeftmostDouble s f h -&gt; LeftmostDouble s f h
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679460839"><span id="local-6989586621679460849"><span id="local-6989586621679460853"><span class="annot"><span class="annottext">Int -&gt; LeftmostDouble s f h -&gt; ShowS
[LeftmostDouble s f h] -&gt; ShowS
LeftmostDouble s f h -&gt; String
(Int -&gt; LeftmostDouble s f h -&gt; ShowS)
-&gt; (LeftmostDouble s f h -&gt; String)
-&gt; ([LeftmostDouble s f h] -&gt; ShowS)
-&gt; Show (LeftmostDouble s f h)
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall s f h.
(Show f, Show s, Show h) =&gt;
Int -&gt; LeftmostDouble s f h -&gt; ShowS
forall s f h.
(Show f, Show s, Show h) =&gt;
[LeftmostDouble s f h] -&gt; ShowS
forall s f h.
(Show f, Show s, Show h) =&gt;
LeftmostDouble s f h -&gt; String
$cshowsPrec :: forall s f h.
(Show f, Show s, Show h) =&gt;
Int -&gt; LeftmostDouble s f h -&gt; ShowS
showsPrec :: Int -&gt; LeftmostDouble s f h -&gt; ShowS
$cshow :: forall s f h.
(Show f, Show s, Show h) =&gt;
LeftmostDouble s f h -&gt; String
show :: LeftmostDouble s f h -&gt; String
$cshowList :: forall s f h.
(Show f, Show s, Show h) =&gt;
[LeftmostDouble s f h] -&gt; ShowS
showList :: [LeftmostDouble s f h] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679460856"><span id="local-6989586621679460858"><span class="annot"><span class="annottext">(forall x. LeftmostDouble s f h -&gt; Rep (LeftmostDouble s f h) x)
-&gt; (forall x. Rep (LeftmostDouble s f h) x -&gt; LeftmostDouble s f h)
-&gt; Generic (LeftmostDouble s f h)
forall x. Rep (LeftmostDouble s f h) x -&gt; LeftmostDouble s f h
forall x. LeftmostDouble s f h -&gt; Rep (LeftmostDouble s f h) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall s f h x.
Rep (LeftmostDouble s f h) x -&gt; LeftmostDouble s f h
forall s f h x.
LeftmostDouble s f h -&gt; Rep (LeftmostDouble s f h) x
$cfrom :: forall s f h x.
LeftmostDouble s f h -&gt; Rep (LeftmostDouble s f h) x
from :: forall x. LeftmostDouble s f h -&gt; Rep (LeftmostDouble s f h) x
$cto :: forall s f h x.
Rep (LeftmostDouble s f h) x -&gt; LeftmostDouble s f h
to :: forall x. Rep (LeftmostDouble s f h) x -&gt; LeftmostDouble s f h
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679460864"><span class="annot"><span class="annottext">LeftmostDouble s f h -&gt; ()
(LeftmostDouble s f h -&gt; ()) -&gt; NFData (LeftmostDouble s f h)
forall a. (a -&gt; ()) -&gt; NFData a
forall s f h.
(NFData s, NFData f, NFData h) =&gt;
LeftmostDouble s f h -&gt; ()
$crnf :: forall s f h.
(NFData s, NFData f, NFData h) =&gt;
LeftmostDouble s f h -&gt; ()
rnf :: LeftmostDouble s f h -&gt; ()
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></span></span><span class="hs-special">)</span><span>
</span><span id="line-568"></span><span>
</span><span id="line-569"></span><span class="annot"><span class="hs-comment">-- | Helper function for `LeftmostDouble`'s 'ToJSON' instance.</span></span><span>
</span><span id="line-570"></span><span id="lmDoubleToJSONName"><span class="annot"><span class="annottext">lmDoubleToJSONName :: ShowS
</span><a href="Common.html#lmDoubleToJSONName"><span class="hs-identifier hs-var hs-var">lmDoubleToJSONName</span></a></span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;LMDoubleSpread&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;hori&quot;</span></span><span>
</span><span id="line-571"></span><span class="annot"><a href="Common.html#lmDoubleToJSONName"><span class="hs-identifier hs-var">lmDoubleToJSONName</span></a></span><span> </span><span id="local-6989586621679460889"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679460889"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ShowS
</span><a href="Common.html#firstToLower"><span class="hs-identifier hs-var">firstToLower</span></a></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; ShowS
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679460889"><span class="hs-identifier hs-var">str</span></a></span><span>
</span><span id="line-572"></span><span>
</span><span id="line-573"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679459054"><span id="local-6989586621679459055"><span id="local-6989586621679459056"><span id="local-6989586621679460896"><span id="local-6989586621679460900"><span id="local-6989586621679460903"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621679459054"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621679459055"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621679459056"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#LeftmostDouble"><span class="hs-identifier hs-type">LeftmostDouble</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459054"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459055"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459056"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-574"></span><span>  </span><span id="local-6989586621679461011"><span class="annot"><span class="annottext">toJSON :: LeftmostDouble s f h -&gt; Value
</span><span class="hs-identifier hs-var hs-var hs-var">toJSON</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Options -&gt; LeftmostDouble s f h -&gt; Value
forall a.
(Generic a, GToJSON' Value Zero (Rep a)) =&gt;
Options -&gt; a -&gt; Value
</span><span class="hs-identifier hs-var">Aeson.genericToJSON</span></span><span> </span><span class="annot"><span class="annottext">(Options -&gt; LeftmostDouble s f h -&gt; Value)
-&gt; Options -&gt; LeftmostDouble s f h -&gt; Value
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; Options
</span><a href="Common.html#variantDefaults"><span class="hs-identifier hs-var">variantDefaults</span></a></span><span> </span><span class="annot"><span class="annottext">ShowS
</span><a href="Common.html#lmDoubleToJSONName"><span class="hs-identifier hs-var">lmDoubleToJSONName</span></a></span><span>
</span><span id="line-575"></span><span>  </span><span id="local-6989586621679461119"><span class="annot"><span class="annottext">toEncoding :: LeftmostDouble s f h -&gt; Encoding
</span><span class="hs-identifier hs-var hs-var hs-var">toEncoding</span></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-576"></span><span>    </span><span class="annot"><span class="annottext">Options -&gt; LeftmostDouble s f h -&gt; Encoding
forall a.
(Generic a, GToJSON' Encoding Zero (Rep a)) =&gt;
Options -&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">Aeson.genericToEncoding</span></span><span> </span><span class="annot"><span class="annottext">(Options -&gt; LeftmostDouble s f h -&gt; Encoding)
-&gt; Options -&gt; LeftmostDouble s f h -&gt; Encoding
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; Options
</span><a href="Common.html#variantDefaults"><span class="hs-identifier hs-var">variantDefaults</span></a></span><span> </span><span class="annot"><span class="annottext">ShowS
</span><a href="Common.html#lmDoubleToJSONName"><span class="hs-identifier hs-var">lmDoubleToJSONName</span></a></span><span>
</span><span id="line-577"></span><span>
</span><span id="line-578"></span><span class="annot"><span class="hs-comment">-- | A combined datatype for all leftmost-derivation operations.</span></span><span>
</span><span id="line-579"></span><span class="hs-keyword">data</span><span> </span><span id="Leftmost"><span class="annot"><a href="Common.html#Leftmost"><span class="hs-identifier hs-var">Leftmost</span></a></span></span><span> </span><span id="local-6989586621679459119"><span class="annot"><a href="#local-6989586621679459119"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679459120"><span class="annot"><a href="#local-6989586621679459120"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679459121"><span class="annot"><a href="#local-6989586621679459121"><span class="hs-identifier hs-type">h</span></a></span></span><span>
</span><span id="line-580"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="LMSingle"><span class="annot"><a href="Common.html#LMSingle"><span class="hs-identifier hs-var">LMSingle</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Common.html#LeftmostSingle"><span class="hs-identifier hs-type">LeftmostSingle</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459119"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459120"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-581"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="LMDouble"><span class="annot"><a href="Common.html#LMDouble"><span class="hs-identifier hs-var">LMDouble</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Common.html#LeftmostDouble"><span class="hs-identifier hs-type">LeftmostDouble</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459119"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459120"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459121"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-582"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679461124"><span id="local-6989586621679461130"><span class="annot"><span class="annottext">Leftmost s f h -&gt; Leftmost s f h -&gt; Bool
(Leftmost s f h -&gt; Leftmost s f h -&gt; Bool)
-&gt; (Leftmost s f h -&gt; Leftmost s f h -&gt; Bool)
-&gt; Eq (Leftmost s f h)
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall s f h.
(Eq s, Eq f, Eq h) =&gt;
Leftmost s f h -&gt; Leftmost s f h -&gt; Bool
$c== :: forall s f h.
(Eq s, Eq f, Eq h) =&gt;
Leftmost s f h -&gt; Leftmost s f h -&gt; Bool
== :: Leftmost s f h -&gt; Leftmost s f h -&gt; Bool
$c/= :: forall s f h.
(Eq s, Eq f, Eq h) =&gt;
Leftmost s f h -&gt; Leftmost s f h -&gt; Bool
/= :: Leftmost s f h -&gt; Leftmost s f h -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679461142"><span id="local-6989586621679461146"><span id="local-6989586621679461150"><span id="local-6989586621679461154"><span id="local-6989586621679461157"><span id="local-6989586621679461160"><span id="local-6989586621679461163"><span class="annot"><span class="annottext">Eq (Leftmost s f h)
Eq (Leftmost s f h) =&gt;
(Leftmost s f h -&gt; Leftmost s f h -&gt; Ordering)
-&gt; (Leftmost s f h -&gt; Leftmost s f h -&gt; Bool)
-&gt; (Leftmost s f h -&gt; Leftmost s f h -&gt; Bool)
-&gt; (Leftmost s f h -&gt; Leftmost s f h -&gt; Bool)
-&gt; (Leftmost s f h -&gt; Leftmost s f h -&gt; Bool)
-&gt; (Leftmost s f h -&gt; Leftmost s f h -&gt; Leftmost s f h)
-&gt; (Leftmost s f h -&gt; Leftmost s f h -&gt; Leftmost s f h)
-&gt; Ord (Leftmost s f h)
Leftmost s f h -&gt; Leftmost s f h -&gt; Bool
Leftmost s f h -&gt; Leftmost s f h -&gt; Ordering
Leftmost s f h -&gt; Leftmost s f h -&gt; Leftmost s f h
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall s f h. (Ord s, Ord f, Ord h) =&gt; Eq (Leftmost s f h)
forall s f h.
(Ord s, Ord f, Ord h) =&gt;
Leftmost s f h -&gt; Leftmost s f h -&gt; Bool
forall s f h.
(Ord s, Ord f, Ord h) =&gt;
Leftmost s f h -&gt; Leftmost s f h -&gt; Ordering
forall s f h.
(Ord s, Ord f, Ord h) =&gt;
Leftmost s f h -&gt; Leftmost s f h -&gt; Leftmost s f h
$ccompare :: forall s f h.
(Ord s, Ord f, Ord h) =&gt;
Leftmost s f h -&gt; Leftmost s f h -&gt; Ordering
compare :: Leftmost s f h -&gt; Leftmost s f h -&gt; Ordering
$c&lt; :: forall s f h.
(Ord s, Ord f, Ord h) =&gt;
Leftmost s f h -&gt; Leftmost s f h -&gt; Bool
&lt; :: Leftmost s f h -&gt; Leftmost s f h -&gt; Bool
$c&lt;= :: forall s f h.
(Ord s, Ord f, Ord h) =&gt;
Leftmost s f h -&gt; Leftmost s f h -&gt; Bool
&lt;= :: Leftmost s f h -&gt; Leftmost s f h -&gt; Bool
$c&gt; :: forall s f h.
(Ord s, Ord f, Ord h) =&gt;
Leftmost s f h -&gt; Leftmost s f h -&gt; Bool
&gt; :: Leftmost s f h -&gt; Leftmost s f h -&gt; Bool
$c&gt;= :: forall s f h.
(Ord s, Ord f, Ord h) =&gt;
Leftmost s f h -&gt; Leftmost s f h -&gt; Bool
&gt;= :: Leftmost s f h -&gt; Leftmost s f h -&gt; Bool
$cmax :: forall s f h.
(Ord s, Ord f, Ord h) =&gt;
Leftmost s f h -&gt; Leftmost s f h -&gt; Leftmost s f h
max :: Leftmost s f h -&gt; Leftmost s f h -&gt; Leftmost s f h
$cmin :: forall s f h.
(Ord s, Ord f, Ord h) =&gt;
Leftmost s f h -&gt; Leftmost s f h -&gt; Leftmost s f h
min :: Leftmost s f h -&gt; Leftmost s f h -&gt; Leftmost s f h
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679461169"><span id="local-6989586621679461175"><span id="local-6989586621679461179"><span class="annot"><span class="annottext">Int -&gt; Leftmost s f h -&gt; ShowS
[Leftmost s f h] -&gt; ShowS
Leftmost s f h -&gt; String
(Int -&gt; Leftmost s f h -&gt; ShowS)
-&gt; (Leftmost s f h -&gt; String)
-&gt; ([Leftmost s f h] -&gt; ShowS)
-&gt; Show (Leftmost s f h)
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall s f h.
(Show s, Show f, Show h) =&gt;
Int -&gt; Leftmost s f h -&gt; ShowS
forall s f h. (Show s, Show f, Show h) =&gt; [Leftmost s f h] -&gt; ShowS
forall s f h. (Show s, Show f, Show h) =&gt; Leftmost s f h -&gt; String
$cshowsPrec :: forall s f h.
(Show s, Show f, Show h) =&gt;
Int -&gt; Leftmost s f h -&gt; ShowS
showsPrec :: Int -&gt; Leftmost s f h -&gt; ShowS
$cshow :: forall s f h. (Show s, Show f, Show h) =&gt; Leftmost s f h -&gt; String
show :: Leftmost s f h -&gt; String
$cshowList :: forall s f h. (Show s, Show f, Show h) =&gt; [Leftmost s f h] -&gt; ShowS
showList :: [Leftmost s f h] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679461182"><span id="local-6989586621679461184"><span class="annot"><span class="annottext">(forall x. Leftmost s f h -&gt; Rep (Leftmost s f h) x)
-&gt; (forall x. Rep (Leftmost s f h) x -&gt; Leftmost s f h)
-&gt; Generic (Leftmost s f h)
forall x. Rep (Leftmost s f h) x -&gt; Leftmost s f h
forall x. Leftmost s f h -&gt; Rep (Leftmost s f h) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall s f h x. Rep (Leftmost s f h) x -&gt; Leftmost s f h
forall s f h x. Leftmost s f h -&gt; Rep (Leftmost s f h) x
$cfrom :: forall s f h x. Leftmost s f h -&gt; Rep (Leftmost s f h) x
from :: forall x. Leftmost s f h -&gt; Rep (Leftmost s f h) x
$cto :: forall s f h x. Rep (Leftmost s f h) x -&gt; Leftmost s f h
to :: forall x. Rep (Leftmost s f h) x -&gt; Leftmost s f h
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679461190"><span class="annot"><span class="annottext">Leftmost s f h -&gt; ()
(Leftmost s f h -&gt; ()) -&gt; NFData (Leftmost s f h)
forall a. (a -&gt; ()) -&gt; NFData a
forall s f h.
(NFData s, NFData f, NFData h) =&gt;
Leftmost s f h -&gt; ()
$crnf :: forall s f h.
(NFData s, NFData f, NFData h) =&gt;
Leftmost s f h -&gt; ()
rnf :: Leftmost s f h -&gt; ()
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></span></span><span class="hs-special">)</span><span>
</span><span id="line-583"></span><span>
</span><span id="line-584"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679459091"><span id="local-6989586621679459092"><span id="local-6989586621679459093"><span id="local-6989586621679461210"><span id="local-6989586621679461214"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621679459091"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621679459092"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621679459093"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Leftmost"><span class="hs-identifier hs-type">Leftmost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459091"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459092"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459093"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-585"></span><span>  </span><span id="local-6989586621679461250"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser (Leftmost s f h)
</span><span class="hs-identifier hs-var hs-var hs-var">parseJSON</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Object -&gt; Parser (Leftmost s f h))
-&gt; Value
-&gt; Parser (Leftmost s f h)
forall a. String -&gt; (Object -&gt; Parser a) -&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">Aeson.withObject</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Leftmost&quot;</span></span><span> </span><span class="annot"><span class="annottext">((Object -&gt; Parser (Leftmost s f h))
 -&gt; Value -&gt; Parser (Leftmost s f h))
-&gt; (Object -&gt; Parser (Leftmost s f h))
-&gt; Value
-&gt; Parser (Leftmost s f h)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679461252"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679461252"><span class="hs-identifier hs-var">obj</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-586"></span><span>    </span><span id="local-6989586621679461253"><span class="annot"><a href="#local-6989586621679461253"><span class="hs-identifier hs-var">typ</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679461252"><span class="hs-identifier hs-var">obj</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Key -&gt; Parser Value
forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;type&quot;</span></span><span>
</span><span id="line-587"></span><span>    </span><span id="local-6989586621679461254"><span class="annot"><a href="#local-6989586621679461254"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621679461252"><span class="hs-identifier hs-type">obj</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">.:</span></span><span> </span><span class="annot"><span class="hs-string">&quot;value&quot;</span></span><span>
</span><span id="line-588"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621679461253"><span class="hs-identifier hs-type">typ</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-589"></span><span>      </span><span class="annot"><span class="annottext">Value
</span><span class="hs-string">&quot;freezeLeft&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">f -&gt; Leftmost s f h
forall f s h. f -&gt; Leftmost s f h
</span><a href="Common.html#LMFreezeLeft"><span class="hs-identifier hs-var">LMFreezeLeft</span></a></span><span> </span><span class="annot"><span class="annottext">(f -&gt; Leftmost s f h) -&gt; Parser f -&gt; Parser (Leftmost s f h)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Parser f
forall a. FromJSON a =&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">parseJSON</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679461254"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-590"></span><span>      </span><span class="annot"><span class="annottext">Value
</span><span class="hs-string">&quot;freezeOnly&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">f -&gt; Leftmost s f h
forall f s h. f -&gt; Leftmost s f h
</span><a href="Common.html#LMFreezeOnly"><span class="hs-identifier hs-var">LMFreezeOnly</span></a></span><span> </span><span class="annot"><span class="annottext">(f -&gt; Leftmost s f h) -&gt; Parser f -&gt; Parser (Leftmost s f h)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Parser f
forall a. FromJSON a =&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">parseJSON</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679461254"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-591"></span><span>      </span><span class="annot"><span class="annottext">Value
</span><span class="hs-string">&quot;splitLeft&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">s -&gt; Leftmost s f h
forall s f h. s -&gt; Leftmost s f h
</span><a href="Common.html#LMSplitLeft"><span class="hs-identifier hs-var">LMSplitLeft</span></a></span><span> </span><span class="annot"><span class="annottext">(s -&gt; Leftmost s f h) -&gt; Parser s -&gt; Parser (Leftmost s f h)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Parser s
forall a. FromJSON a =&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">parseJSON</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679461254"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-592"></span><span>      </span><span class="annot"><span class="annottext">Value
</span><span class="hs-string">&quot;splitRight&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">s -&gt; Leftmost s f h
forall s f h. s -&gt; Leftmost s f h
</span><a href="Common.html#LMSplitRight"><span class="hs-identifier hs-var">LMSplitRight</span></a></span><span> </span><span class="annot"><span class="annottext">(s -&gt; Leftmost s f h) -&gt; Parser s -&gt; Parser (Leftmost s f h)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Parser s
forall a. FromJSON a =&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">parseJSON</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679461254"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-593"></span><span>      </span><span class="annot"><span class="annottext">Value
</span><span class="hs-string">&quot;splitOnly&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">s -&gt; Leftmost s f h
forall s f h. s -&gt; Leftmost s f h
</span><a href="Common.html#LMSplitOnly"><span class="hs-identifier hs-var">LMSplitOnly</span></a></span><span> </span><span class="annot"><span class="annottext">(s -&gt; Leftmost s f h) -&gt; Parser s -&gt; Parser (Leftmost s f h)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Parser s
forall a. FromJSON a =&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">parseJSON</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679461254"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-594"></span><span>      </span><span class="annot"><span class="annottext">Value
</span><span class="hs-string">&quot;hori&quot;</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">h -&gt; Leftmost s f h
forall h s f. h -&gt; Leftmost s f h
</span><a href="Common.html#LMSpread"><span class="hs-identifier hs-var">LMSpread</span></a></span><span> </span><span class="annot"><span class="annottext">(h -&gt; Leftmost s f h) -&gt; Parser h -&gt; Parser (Leftmost s f h)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Parser h
forall a. FromJSON a =&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">parseJSON</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679461254"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="hs-comment">-- the JSON encoding uses &quot;hori&quot; instead of &quot;spread&quot;</span><span>
</span><span id="line-595"></span><span>      </span><span id="local-6989586621679461255"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679461255"><span class="hs-identifier hs-var">other</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Parser (Leftmost s f h)
forall a. Value -&gt; Parser a
</span><span class="hs-identifier hs-var">unexpected</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679461255"><span class="hs-identifier hs-var">other</span></a></span><span>
</span><span id="line-596"></span><span>
</span><span id="line-597"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679459111"><span id="local-6989586621679459112"><span id="local-6989586621679459113"><span id="local-6989586621679461262"><span id="local-6989586621679461266"><span id="local-6989586621679461269"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621679459111"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621679459112"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621679459113"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Leftmost"><span class="hs-identifier hs-type">Leftmost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459111"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459112"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459113"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-598"></span><span>  </span><span id="local-6989586621679461273"><span class="annot"><span class="annottext">toJSON :: Leftmost s f h -&gt; Value
</span><span class="hs-identifier hs-var hs-var hs-var">toJSON</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#LMSingle"><span class="hs-identifier hs-type">LMSingle</span></a></span><span> </span><span id="local-6989586621679461274"><span class="annot"><span class="annottext">LeftmostSingle s f
</span><a href="#local-6989586621679461274"><span class="hs-identifier hs-var">sg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LeftmostSingle s f -&gt; Value
forall a. ToJSON a =&gt; a -&gt; Value
</span><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="annot"><span class="annottext">LeftmostSingle s f
</span><a href="#local-6989586621679461274"><span class="hs-identifier hs-var">sg</span></a></span><span>
</span><span id="line-599"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#LMDouble"><span class="hs-identifier hs-type">LMDouble</span></a></span><span> </span><span id="local-6989586621679461275"><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><a href="#local-6989586621679461275"><span class="hs-identifier hs-var">db</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LeftmostDouble s f h -&gt; Value
forall a. ToJSON a =&gt; a -&gt; Value
</span><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><a href="#local-6989586621679461275"><span class="hs-identifier hs-var">db</span></a></span><span>
</span><span id="line-600"></span><span>  </span><span id="local-6989586621679461278"><span class="annot"><span class="annottext">toEncoding :: Leftmost s f h -&gt; Encoding
</span><span class="hs-identifier hs-var hs-var hs-var">toEncoding</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#LMSingle"><span class="hs-identifier hs-type">LMSingle</span></a></span><span> </span><span id="local-6989586621679461279"><span class="annot"><span class="annottext">LeftmostSingle s f
</span><a href="#local-6989586621679461279"><span class="hs-identifier hs-var">sg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LeftmostSingle s f -&gt; Encoding
forall a. ToJSON a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">toEncoding</span></span><span> </span><span class="annot"><span class="annottext">LeftmostSingle s f
</span><a href="#local-6989586621679461279"><span class="hs-identifier hs-var">sg</span></a></span><span>
</span><span id="line-601"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">toEncoding</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#LMDouble"><span class="hs-identifier hs-type">LMDouble</span></a></span><span> </span><span id="local-6989586621679461280"><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><a href="#local-6989586621679461280"><span class="hs-identifier hs-var">db</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LeftmostDouble s f h -&gt; Encoding
forall a. ToJSON a =&gt; a -&gt; Encoding
</span><span class="hs-identifier hs-var">toEncoding</span></span><span> </span><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><a href="#local-6989586621679461280"><span class="hs-identifier hs-var">db</span></a></span><span>
</span><span id="line-602"></span><span>
</span><span id="line-603"></span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Common.html#LMSplitLeft"><span class="hs-identifier hs-type">LMSplitLeft</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679459101"><span id="local-6989586621679459102"><span id="local-6989586621679459103"><span class="annot"><a href="#local-6989586621679459101"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#Leftmost"><span class="hs-identifier hs-type">Leftmost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459101"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459102"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459103"><span class="hs-identifier hs-type">h</span></a></span></span></span></span><span>
</span><span id="line-604"></span><span class="hs-keyword">pattern</span><span> </span><span id="LMSplitLeft"><span id="%24mLMSplitLeft"><span id="%24bLMSplitLeft"><span class="annot"><span class="annottext">$mLMSplitLeft :: forall {r} {s} {f} {h}.
Leftmost s f h -&gt; (s -&gt; r) -&gt; ((# #) -&gt; r) -&gt; r
$bLMSplitLeft :: forall s f h. s -&gt; Leftmost s f h
</span><a href="Common.html#LMSplitLeft"><span class="hs-identifier hs-var hs-var hs-var">LMSplitLeft</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679461283"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Common.html#LMDouble"><span class="hs-identifier hs-type">LMDouble</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#LMDoubleSplitLeft"><span class="hs-identifier hs-type">LMDoubleSplitLeft</span></a></span><span> </span><span id="local-6989586621679461283"><span class="annot"><a href="#local-6989586621679461283"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-605"></span><span>
</span><span id="line-606"></span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Common.html#LMFreezeLeft"><span class="hs-identifier hs-type">LMFreezeLeft</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679459098"><span id="local-6989586621679459099"><span id="local-6989586621679459100"><span class="annot"><a href="#local-6989586621679459098"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#Leftmost"><span class="hs-identifier hs-type">Leftmost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459099"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459098"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459100"><span class="hs-identifier hs-type">h</span></a></span></span></span></span><span>
</span><span id="line-607"></span><span class="hs-keyword">pattern</span><span> </span><span id="LMFreezeLeft"><span id="%24mLMFreezeLeft"><span id="%24bLMFreezeLeft"><span class="annot"><span class="annottext">$mLMFreezeLeft :: forall {r} {f} {s} {h}.
Leftmost s f h -&gt; (f -&gt; r) -&gt; ((# #) -&gt; r) -&gt; r
$bLMFreezeLeft :: forall f s h. f -&gt; Leftmost s f h
</span><a href="Common.html#LMFreezeLeft"><span class="hs-identifier hs-var hs-var hs-var">LMFreezeLeft</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679461286"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Common.html#LMDouble"><span class="hs-identifier hs-type">LMDouble</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#LMDoubleFreezeLeft"><span class="hs-identifier hs-type">LMDoubleFreezeLeft</span></a></span><span> </span><span id="local-6989586621679461286"><span class="annot"><a href="#local-6989586621679461286"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-608"></span><span>
</span><span id="line-609"></span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Common.html#LMSplitRight"><span class="hs-identifier hs-type">LMSplitRight</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679459132"><span id="local-6989586621679459133"><span id="local-6989586621679459134"><span class="annot"><a href="#local-6989586621679459132"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#Leftmost"><span class="hs-identifier hs-type">Leftmost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459132"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459133"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459134"><span class="hs-identifier hs-type">h</span></a></span></span></span></span><span>
</span><span id="line-610"></span><span class="hs-keyword">pattern</span><span> </span><span id="LMSplitRight"><span id="%24mLMSplitRight"><span id="%24bLMSplitRight"><span class="annot"><span class="annottext">$mLMSplitRight :: forall {r} {s} {f} {h}.
Leftmost s f h -&gt; (s -&gt; r) -&gt; ((# #) -&gt; r) -&gt; r
$bLMSplitRight :: forall s f h. s -&gt; Leftmost s f h
</span><a href="Common.html#LMSplitRight"><span class="hs-identifier hs-var hs-var hs-var">LMSplitRight</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679461289"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Common.html#LMDouble"><span class="hs-identifier hs-type">LMDouble</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#LMDoubleSplitRight"><span class="hs-identifier hs-type">LMDoubleSplitRight</span></a></span><span> </span><span id="local-6989586621679461289"><span class="annot"><a href="#local-6989586621679461289"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-611"></span><span>
</span><span id="line-612"></span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Common.html#LMSpread"><span class="hs-identifier hs-type">LMSpread</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679459104"><span id="local-6989586621679459105"><span id="local-6989586621679459106"><span class="annot"><a href="#local-6989586621679459104"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#Leftmost"><span class="hs-identifier hs-type">Leftmost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459105"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459106"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459104"><span class="hs-identifier hs-type">h</span></a></span></span></span></span><span>
</span><span id="line-613"></span><span class="hs-keyword">pattern</span><span> </span><span id="LMSpread"><span id="%24mLMSpread"><span id="%24bLMSpread"><span class="annot"><span class="annottext">$mLMSpread :: forall {r} {h} {s} {f}.
Leftmost s f h -&gt; (h -&gt; r) -&gt; ((# #) -&gt; r) -&gt; r
$bLMSpread :: forall h s f. h -&gt; Leftmost s f h
</span><a href="Common.html#LMSpread"><span class="hs-identifier hs-var hs-var hs-var">LMSpread</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679461292"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Common.html#LMDouble"><span class="hs-identifier hs-type">LMDouble</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#LMDoubleSpread"><span class="hs-identifier hs-type">LMDoubleSpread</span></a></span><span> </span><span id="local-6989586621679461292"><span class="annot"><a href="#local-6989586621679461292"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-614"></span><span>
</span><span id="line-615"></span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Common.html#LMSplitOnly"><span class="hs-identifier hs-type">LMSplitOnly</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679459144"><span id="local-6989586621679459145"><span id="local-6989586621679459146"><span class="annot"><a href="#local-6989586621679459144"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#Leftmost"><span class="hs-identifier hs-type">Leftmost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459144"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459145"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459146"><span class="hs-identifier hs-type">h</span></a></span></span></span></span><span>
</span><span id="line-616"></span><span class="hs-keyword">pattern</span><span> </span><span id="LMSplitOnly"><span id="%24mLMSplitOnly"><span id="%24bLMSplitOnly"><span class="annot"><span class="annottext">$mLMSplitOnly :: forall {r} {s} {f} {h}.
Leftmost s f h -&gt; (s -&gt; r) -&gt; ((# #) -&gt; r) -&gt; r
$bLMSplitOnly :: forall s f h. s -&gt; Leftmost s f h
</span><a href="Common.html#LMSplitOnly"><span class="hs-identifier hs-var hs-var hs-var">LMSplitOnly</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679461295"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Common.html#LMSingle"><span class="hs-identifier hs-type">LMSingle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#LMSingleSplit"><span class="hs-identifier hs-type">LMSingleSplit</span></a></span><span> </span><span id="local-6989586621679461295"><span class="annot"><a href="#local-6989586621679461295"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-617"></span><span>
</span><span id="line-618"></span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Common.html#LMFreezeOnly"><span class="hs-identifier hs-type">LMFreezeOnly</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679459153"><span id="local-6989586621679459154"><span id="local-6989586621679459155"><span class="annot"><a href="#local-6989586621679459154"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#Leftmost"><span class="hs-identifier hs-type">Leftmost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459153"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459154"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459155"><span class="hs-identifier hs-type">h</span></a></span></span></span></span><span>
</span><span id="line-619"></span><span class="hs-keyword">pattern</span><span> </span><span id="LMFreezeOnly"><span id="%24mLMFreezeOnly"><span id="%24bLMFreezeOnly"><span class="annot"><span class="annottext">$mLMFreezeOnly :: forall {r} {f} {s} {h}.
Leftmost s f h -&gt; (f -&gt; r) -&gt; ((# #) -&gt; r) -&gt; r
$bLMFreezeOnly :: forall f s h. f -&gt; Leftmost s f h
</span><a href="Common.html#LMFreezeOnly"><span class="hs-identifier hs-var hs-var hs-var">LMFreezeOnly</span></a></span></span></span></span><span> </span><span class="annot"><a href="#local-6989586621679461298"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Common.html#LMSingle"><span class="hs-identifier hs-type">LMSingle</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#LMSingleFreeze"><span class="hs-identifier hs-type">LMSingleFreeze</span></a></span><span> </span><span id="local-6989586621679461298"><span class="annot"><a href="#local-6989586621679461298"><span class="hs-identifier hs-var">f</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-620"></span><span>
</span><span id="line-621"></span><span class="hs-pragma">{-# COMPLETE</span><span> </span><span class="annot"><a href="Common.html#LMSplitLeft"><span class="hs-pragma hs-type">LMSplitLeft</span></a></span><span class="hs-pragma">,</span><span> </span><span class="annot"><a href="Common.html#LMFreezeLeft"><span class="hs-pragma hs-type">LMFreezeLeft</span></a></span><span class="hs-pragma">,</span><span> </span><span class="annot"><a href="Common.html#LMSplitRight"><span class="hs-pragma hs-type">LMSplitRight</span></a></span><span class="hs-pragma">,</span><span> </span><span class="annot"><a href="Common.html#LMSpread"><span class="hs-pragma hs-type">LMSpread</span></a></span><span class="hs-pragma">,</span><span> </span><span class="annot"><a href="Common.html#LMSplitOnly"><span class="hs-pragma hs-type">LMSplitOnly</span></a></span><span class="hs-pragma">,</span><span> </span><span class="annot"><a href="Common.html#LMFreezeOnly"><span class="hs-pragma hs-type">LMFreezeOnly</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-622"></span><span>
</span><span id="line-623"></span><span class="hs-comment">-- representing full analyses</span><span>
</span><span id="line-624"></span><span class="hs-comment">-- ==========================</span><span>
</span><span id="line-625"></span><span>
</span><span id="line-626"></span><span class="annot"><span class="hs-comment">{- | Encodes an analysis of a piece,
 consisting of a &quot;top&quot; (the starting point of the derivation,
 i.e., the smallest reduction in the analysis)
 and a derivation of the piece's surface from the top.

 Use this type's 'FromJSON' instance to load an analysis exported by the protovoice annotation tool.
-}</span></span><span>
</span><span id="line-633"></span><span class="hs-keyword">data</span><span> </span><span id="Analysis"><span class="annot"><a href="Common.html#Analysis"><span class="hs-identifier hs-var">Analysis</span></a></span></span><span> </span><span id="local-6989586621679459158"><span class="annot"><a href="#local-6989586621679459158"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679459159"><span class="annot"><a href="#local-6989586621679459159"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679459160"><span class="annot"><a href="#local-6989586621679459160"><span class="hs-identifier hs-type">h</span></a></span></span><span> </span><span id="local-6989586621679459161"><span class="annot"><a href="#local-6989586621679459161"><span class="hs-identifier hs-type">tr</span></a></span></span><span> </span><span id="local-6989586621679459162"><span class="annot"><a href="#local-6989586621679459162"><span class="hs-identifier hs-type">slc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Analysis"><span class="annot"><a href="Common.html#Analysis"><span class="hs-identifier hs-var">Analysis</span></a></span></span><span>
</span><span id="line-634"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="anaDerivation"><span class="annot"><span class="annottext">forall s f h tr slc. Analysis s f h tr slc -&gt; [Leftmost s f h]
</span><a href="Common.html#anaDerivation"><span class="hs-identifier hs-var hs-var">anaDerivation</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Common.html#Leftmost"><span class="hs-identifier hs-type">Leftmost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459158"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459159"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459160"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-635"></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ The derivation steps.</span></span><span>
</span><span id="line-636"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="anaTop"><span class="annot"><span class="annottext">forall s f h tr slc. Analysis s f h tr slc -&gt; Path tr slc
</span><a href="Common.html#anaTop"><span class="hs-identifier hs-var hs-var">anaTop</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459161"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459162"><span class="hs-identifier hs-type">slc</span></a></span><span>
</span><span id="line-637"></span><span>  </span><span class="hs-comment">-- ^ The starting configuration of the derivation.</span><span>
</span><span id="line-638"></span><span>  </span><span class="hs-comment">-- Starts with the first transition, 'Start' and 'Stop' are implied.</span><span>
</span><span id="line-639"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-640"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679461308"><span id="local-6989586621679461313"><span class="annot"><span class="annottext">Analysis s f h tr slc -&gt; Analysis s f h tr slc -&gt; Bool
(Analysis s f h tr slc -&gt; Analysis s f h tr slc -&gt; Bool)
-&gt; (Analysis s f h tr slc -&gt; Analysis s f h tr slc -&gt; Bool)
-&gt; Eq (Analysis s f h tr slc)
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
forall s f h tr slc.
(Eq s, Eq f, Eq h, Eq slc, Eq tr) =&gt;
Analysis s f h tr slc -&gt; Analysis s f h tr slc -&gt; Bool
$c== :: forall s f h tr slc.
(Eq s, Eq f, Eq h, Eq slc, Eq tr) =&gt;
Analysis s f h tr slc -&gt; Analysis s f h tr slc -&gt; Bool
== :: Analysis s f h tr slc -&gt; Analysis s f h tr slc -&gt; Bool
$c/= :: forall s f h tr slc.
(Eq s, Eq f, Eq h, Eq slc, Eq tr) =&gt;
Analysis s f h tr slc -&gt; Analysis s f h tr slc -&gt; Bool
/= :: Analysis s f h tr slc -&gt; Analysis s f h tr slc -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679461329"><span id="local-6989586621679461335"><span id="local-6989586621679461340"><span id="local-6989586621679461344"><span id="local-6989586621679461347"><span id="local-6989586621679461350"><span id="local-6989586621679461353"><span class="annot"><span class="annottext">Eq (Analysis s f h tr slc)
Eq (Analysis s f h tr slc) =&gt;
(Analysis s f h tr slc -&gt; Analysis s f h tr slc -&gt; Ordering)
-&gt; (Analysis s f h tr slc -&gt; Analysis s f h tr slc -&gt; Bool)
-&gt; (Analysis s f h tr slc -&gt; Analysis s f h tr slc -&gt; Bool)
-&gt; (Analysis s f h tr slc -&gt; Analysis s f h tr slc -&gt; Bool)
-&gt; (Analysis s f h tr slc -&gt; Analysis s f h tr slc -&gt; Bool)
-&gt; (Analysis s f h tr slc
    -&gt; Analysis s f h tr slc -&gt; Analysis s f h tr slc)
-&gt; (Analysis s f h tr slc
    -&gt; Analysis s f h tr slc -&gt; Analysis s f h tr slc)
-&gt; Ord (Analysis s f h tr slc)
Analysis s f h tr slc -&gt; Analysis s f h tr slc -&gt; Bool
Analysis s f h tr slc -&gt; Analysis s f h tr slc -&gt; Ordering
Analysis s f h tr slc
-&gt; Analysis s f h tr slc -&gt; Analysis s f h tr slc
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall s f h tr slc.
(Ord s, Ord f, Ord h, Ord slc, Ord tr) =&gt;
Eq (Analysis s f h tr slc)
forall s f h tr slc.
(Ord s, Ord f, Ord h, Ord slc, Ord tr) =&gt;
Analysis s f h tr slc -&gt; Analysis s f h tr slc -&gt; Bool
forall s f h tr slc.
(Ord s, Ord f, Ord h, Ord slc, Ord tr) =&gt;
Analysis s f h tr slc -&gt; Analysis s f h tr slc -&gt; Ordering
forall s f h tr slc.
(Ord s, Ord f, Ord h, Ord slc, Ord tr) =&gt;
Analysis s f h tr slc
-&gt; Analysis s f h tr slc -&gt; Analysis s f h tr slc
$ccompare :: forall s f h tr slc.
(Ord s, Ord f, Ord h, Ord slc, Ord tr) =&gt;
Analysis s f h tr slc -&gt; Analysis s f h tr slc -&gt; Ordering
compare :: Analysis s f h tr slc -&gt; Analysis s f h tr slc -&gt; Ordering
$c&lt; :: forall s f h tr slc.
(Ord s, Ord f, Ord h, Ord slc, Ord tr) =&gt;
Analysis s f h tr slc -&gt; Analysis s f h tr slc -&gt; Bool
&lt; :: Analysis s f h tr slc -&gt; Analysis s f h tr slc -&gt; Bool
$c&lt;= :: forall s f h tr slc.
(Ord s, Ord f, Ord h, Ord slc, Ord tr) =&gt;
Analysis s f h tr slc -&gt; Analysis s f h tr slc -&gt; Bool
&lt;= :: Analysis s f h tr slc -&gt; Analysis s f h tr slc -&gt; Bool
$c&gt; :: forall s f h tr slc.
(Ord s, Ord f, Ord h, Ord slc, Ord tr) =&gt;
Analysis s f h tr slc -&gt; Analysis s f h tr slc -&gt; Bool
&gt; :: Analysis s f h tr slc -&gt; Analysis s f h tr slc -&gt; Bool
$c&gt;= :: forall s f h tr slc.
(Ord s, Ord f, Ord h, Ord slc, Ord tr) =&gt;
Analysis s f h tr slc -&gt; Analysis s f h tr slc -&gt; Bool
&gt;= :: Analysis s f h tr slc -&gt; Analysis s f h tr slc -&gt; Bool
$cmax :: forall s f h tr slc.
(Ord s, Ord f, Ord h, Ord slc, Ord tr) =&gt;
Analysis s f h tr slc
-&gt; Analysis s f h tr slc -&gt; Analysis s f h tr slc
max :: Analysis s f h tr slc
-&gt; Analysis s f h tr slc -&gt; Analysis s f h tr slc
$cmin :: forall s f h tr slc.
(Ord s, Ord f, Ord h, Ord slc, Ord tr) =&gt;
Analysis s f h tr slc
-&gt; Analysis s f h tr slc -&gt; Analysis s f h tr slc
min :: Analysis s f h tr slc
-&gt; Analysis s f h tr slc -&gt; Analysis s f h tr slc
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679461361"><span id="local-6989586621679461368"><span id="local-6989586621679461372"><span class="annot"><span class="annottext">Int -&gt; Analysis s f h tr slc -&gt; ShowS
[Analysis s f h tr slc] -&gt; ShowS
Analysis s f h tr slc -&gt; String
(Int -&gt; Analysis s f h tr slc -&gt; ShowS)
-&gt; (Analysis s f h tr slc -&gt; String)
-&gt; ([Analysis s f h tr slc] -&gt; ShowS)
-&gt; Show (Analysis s f h tr slc)
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall s f h tr slc.
(Show s, Show f, Show h, Show tr, Show slc) =&gt;
Int -&gt; Analysis s f h tr slc -&gt; ShowS
forall s f h tr slc.
(Show s, Show f, Show h, Show tr, Show slc) =&gt;
[Analysis s f h tr slc] -&gt; ShowS
forall s f h tr slc.
(Show s, Show f, Show h, Show tr, Show slc) =&gt;
Analysis s f h tr slc -&gt; String
$cshowsPrec :: forall s f h tr slc.
(Show s, Show f, Show h, Show tr, Show slc) =&gt;
Int -&gt; Analysis s f h tr slc -&gt; ShowS
showsPrec :: Int -&gt; Analysis s f h tr slc -&gt; ShowS
$cshow :: forall s f h tr slc.
(Show s, Show f, Show h, Show tr, Show slc) =&gt;
Analysis s f h tr slc -&gt; String
show :: Analysis s f h tr slc -&gt; String
$cshowList :: forall s f h tr slc.
(Show s, Show f, Show h, Show tr, Show slc) =&gt;
[Analysis s f h tr slc] -&gt; ShowS
showList :: [Analysis s f h tr slc] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679461375"><span id="local-6989586621679461377"><span class="annot"><span class="annottext">(forall x. Analysis s f h tr slc -&gt; Rep (Analysis s f h tr slc) x)
-&gt; (forall x.
    Rep (Analysis s f h tr slc) x -&gt; Analysis s f h tr slc)
-&gt; Generic (Analysis s f h tr slc)
forall x. Rep (Analysis s f h tr slc) x -&gt; Analysis s f h tr slc
forall x. Analysis s f h tr slc -&gt; Rep (Analysis s f h tr slc) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall s f h tr slc x.
Rep (Analysis s f h tr slc) x -&gt; Analysis s f h tr slc
forall s f h tr slc x.
Analysis s f h tr slc -&gt; Rep (Analysis s f h tr slc) x
$cfrom :: forall s f h tr slc x.
Analysis s f h tr slc -&gt; Rep (Analysis s f h tr slc) x
from :: forall x. Analysis s f h tr slc -&gt; Rep (Analysis s f h tr slc) x
$cto :: forall s f h tr slc x.
Rep (Analysis s f h tr slc) x -&gt; Analysis s f h tr slc
to :: forall x. Rep (Analysis s f h tr slc) x -&gt; Analysis s f h tr slc
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-641"></span><span>
</span><span id="line-642"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679459221"><span id="local-6989586621679459222"><span id="local-6989586621679459223"><span id="local-6989586621679459224"><span id="local-6989586621679459225"><span id="local-6989586621679461386"><span id="local-6989586621679461390"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621679459221"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621679459222"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621679459223"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621679459224"><span class="hs-identifier hs-type">tr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621679459225"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Analysis"><span class="hs-identifier hs-type">Analysis</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459221"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459222"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459223"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459224"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459225"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-643"></span><span>  </span><span id="local-6989586621679461423"><span class="annot"><span class="annottext">parseJSON :: Value -&gt; Parser (Analysis s f h tr slc)
</span><span class="hs-identifier hs-var hs-var hs-var">parseJSON</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Object -&gt; Parser (Analysis s f h tr slc))
-&gt; Value
-&gt; Parser (Analysis s f h tr slc)
forall a. String -&gt; (Object -&gt; Parser a) -&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">Aeson.withObject</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Analysis&quot;</span></span><span> </span><span class="annot"><span class="annottext">((Object -&gt; Parser (Analysis s f h tr slc))
 -&gt; Value -&gt; Parser (Analysis s f h tr slc))
-&gt; (Object -&gt; Parser (Analysis s f h tr slc))
-&gt; Value
-&gt; Parser (Analysis s f h tr slc)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679461424"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679461424"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-644"></span><span>    </span><span id="local-6989586621679461425"><span class="annot"><a href="#local-6989586621679461425"><span class="hs-identifier hs-var">deriv</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679461424"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Key -&gt; Parser [Leftmost s f h]
forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;derivation&quot;</span></span><span>
</span><span id="line-645"></span><span>    </span><span id="local-6989586621679461426"><span class="annot"><a href="#local-6989586621679461426"><span class="hs-identifier hs-var">start</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621679461424"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">.:</span></span><span> </span><span class="annot"><span class="hs-string">&quot;start&quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&gt;&gt;=</span></span><span> </span><span class="annot"><a href="#local-6989586621679461427"><span class="hs-identifier hs-type">parseSlice</span></a></span><span>
</span><span id="line-646"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621679461426"><span class="hs-identifier hs-type">start</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-647"></span><span>      </span><span class="annot"><span class="annottext">StartStop slc
</span><a href="Common.html#Start"><span class="hs-identifier hs-var">Start</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; Parser ()
forall a. a -&gt; Parser a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-648"></span><span>      </span><span class="annot"><span class="annottext">StartStop slc
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Parser ()
forall a. String -&gt; Parser a
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Start slice is not &#8906;.&quot;</span></span><span>
</span><span id="line-649"></span><span>    </span><span id="local-6989586621679461428"><span class="annot"><a href="#local-6989586621679461428"><span class="hs-identifier hs-var">segments</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621679461424"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">.:</span></span><span> </span><span class="annot"><span class="hs-string">&quot;topSegments&quot;</span></span><span>
</span><span id="line-650"></span><span>    </span><span id="local-6989586621679461429"><span class="annot"><a href="#local-6989586621679461429"><span class="hs-identifier hs-var">top</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621679461430"><span class="hs-identifier hs-type">parseTop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679461428"><span class="hs-identifier hs-type">segments</span></a></span><span>
</span><span id="line-651"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Common.html#Analysis"><span class="hs-identifier hs-type">Analysis</span></a></span><span class="hs-special">{</span><span class="annot"><a href="Common.html#anaDerivation"><span class="hs-identifier hs-var">anaDerivation</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679461425"><span class="hs-identifier hs-type">deriv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#anaTop"><span class="hs-identifier hs-var">anaTop</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679461429"><span class="hs-identifier hs-type">top</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-652"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-653"></span><span>    </span><span class="annot"><a href="#local-6989586621679461430"><span class="hs-identifier hs-type">parseTop</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Aeson.Value</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Aeson.Parser</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459224"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459225"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-654"></span><span>    </span><span id="local-6989586621679461430"><span class="annot"><span class="annottext">parseTop :: [Value] -&gt; Parser (Path tr slc)
</span><a href="#local-6989586621679461430"><span class="hs-identifier hs-var hs-var">parseTop</span></a></span></span><span> </span><span id="local-6989586621679461431"><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621679461431"><span class="hs-identifier hs-var">segs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-655"></span><span>      </span><span id="local-6989586621679461432"><span class="annot"><a href="#local-6989586621679461432"><span class="hs-identifier hs-var">segments</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Value -&gt; Parser (tr, StartStop slc))
-&gt; [Value] -&gt; Parser [(tr, StartStop slc)]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]
</span><span class="hs-identifier hs-var">mapM</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Parser (tr, StartStop slc)
</span><a href="#local-6989586621679461434"><span class="hs-identifier hs-var">parseSegment</span></a></span><span> </span><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621679461431"><span class="hs-identifier hs-var">segs</span></a></span><span>
</span><span id="line-656"></span><span>      </span><span class="annot"><a href="#local-6989586621679461435"><span class="hs-identifier hs-type">mkPath</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679461432"><span class="hs-identifier hs-type">segments</span></a></span><span>
</span><span id="line-657"></span><span>     </span><span class="hs-keyword">where</span><span>
</span><span id="line-658"></span><span>      </span><span id="local-6989586621679459232"><span id="local-6989586621679459233"><span class="annot"><a href="#local-6989586621679461435"><span class="hs-identifier hs-type">mkPath</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679459232"><span class="hs-identifier hs-type">e</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459233"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Aeson.Parser</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459232"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459233"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-659"></span><span>      </span><span id="local-6989586621679461435"><span class="annot"><span class="annottext">mkPath :: forall e a. [(e, StartStop a)] -&gt; Parser (Path e a)
</span><a href="#local-6989586621679461435"><span class="hs-identifier hs-var hs-var">mkPath</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span id="local-6989586621679461439"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679461439"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StartStop a
</span><a href="Common.html#Stop"><span class="hs-identifier hs-var">Stop</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Path e a -&gt; Parser (Path e a)
forall a. a -&gt; Parser a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">(Path e a -&gt; Parser (Path e a)) -&gt; Path e a -&gt; Parser (Path e a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">e -&gt; Path e a
forall around between. around -&gt; Path around between
</span><a href="Common.html#PathEnd"><span class="hs-identifier hs-var">PathEnd</span></a></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679461439"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-660"></span><span>      </span><span class="annot"><a href="#local-6989586621679461435"><span class="hs-identifier hs-var">mkPath</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679461440"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679461440"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Common.html#Inner"><span class="hs-identifier hs-type">Inner</span></a></span><span> </span><span id="local-6989586621679461441"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679461441"><span class="hs-identifier hs-var">s</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679461442"><span class="annot"><span class="annottext">[(e, StartStop a)]
</span><a href="#local-6989586621679461442"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">e -&gt; a -&gt; Path e a -&gt; Path e a
forall around between.
around -&gt; between -&gt; Path around between -&gt; Path around between
</span><a href="Common.html#Path"><span class="hs-identifier hs-var">Path</span></a></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679461440"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679461441"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">(Path e a -&gt; Path e a) -&gt; Parser (Path e a) -&gt; Parser (Path e a)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[(e, StartStop a)] -&gt; Parser (Path e a)
forall e a. [(e, StartStop a)] -&gt; Parser (Path e a)
</span><a href="#local-6989586621679461435"><span class="hs-identifier hs-var">mkPath</span></a></span><span> </span><span class="annot"><span class="annottext">[(e, StartStop a)]
</span><a href="#local-6989586621679461442"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-661"></span><span>      </span><span class="annot"><a href="#local-6989586621679461435"><span class="hs-identifier hs-var">mkPath</span></a></span><span> </span><span class="annot"><span class="annottext">[(e, StartStop a)]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Parser (Path e a)
forall a. String -&gt; Parser a
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><span class="hs-identifier hs-var">fail</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Invalid top path.&quot;</span></span><span>
</span><span id="line-662"></span><span>    </span><span id="local-6989586621679461427"><span class="annot"><span class="annottext">parseSlice :: Value -&gt; Parser (StartStop slc)
</span><a href="#local-6989586621679461427"><span class="hs-identifier hs-var hs-var">parseSlice</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Object -&gt; Parser (StartStop slc))
-&gt; Value
-&gt; Parser (StartStop slc)
forall a. String -&gt; (Object -&gt; Parser a) -&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">Aeson.withObject</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Slice&quot;</span></span><span> </span><span class="annot"><span class="annottext">((Object -&gt; Parser (StartStop slc))
 -&gt; Value -&gt; Parser (StartStop slc))
-&gt; (Object -&gt; Parser (StartStop slc))
-&gt; Value
-&gt; Parser (StartStop slc)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679461445"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679461445"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679461445"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Key -&gt; Parser (StartStop slc)
forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;notes&quot;</span></span><span>
</span><span id="line-663"></span><span>    </span><span id="local-6989586621679461448"><span class="annot"><span class="annottext">parseTrans :: Value -&gt; Parser tr
</span><a href="#local-6989586621679461448"><span class="hs-identifier hs-var hs-var">parseTrans</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; (Object -&gt; Parser tr) -&gt; Value -&gt; Parser tr
forall a. String -&gt; (Object -&gt; Parser a) -&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">Aeson.withObject</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Transition&quot;</span></span><span> </span><span class="annot"><span class="annottext">((Object -&gt; Parser tr) -&gt; Value -&gt; Parser tr)
-&gt; (Object -&gt; Parser tr) -&gt; Value -&gt; Parser tr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679461449"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679461449"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679461449"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Key -&gt; Parser tr
forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;edges&quot;</span></span><span>
</span><span id="line-664"></span><span>    </span><span id="local-6989586621679461434"><span class="annot"><span class="annottext">parseSegment :: Value -&gt; Parser (tr, StartStop slc)
</span><a href="#local-6989586621679461434"><span class="hs-identifier hs-var hs-var">parseSegment</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
-&gt; (Object -&gt; Parser (tr, StartStop slc))
-&gt; Value
-&gt; Parser (tr, StartStop slc)
forall a. String -&gt; (Object -&gt; Parser a) -&gt; Value -&gt; Parser a
</span><span class="hs-identifier hs-var">Aeson.withObject</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Segment&quot;</span></span><span> </span><span class="annot"><span class="annottext">((Object -&gt; Parser (tr, StartStop slc))
 -&gt; Value -&gt; Parser (tr, StartStop slc))
-&gt; (Object -&gt; Parser (tr, StartStop slc))
-&gt; Value
-&gt; Parser (tr, StartStop slc)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679461450"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679461450"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-665"></span><span>      </span><span id="local-6989586621679461451"><span class="annot"><a href="#local-6989586621679461451"><span class="hs-identifier hs-var">trans</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679461450"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Object -&gt; Key -&gt; Parser Value
forall a. FromJSON a =&gt; Object -&gt; Key -&gt; Parser a
</span><span class="hs-operator hs-var">.:</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;trans&quot;</span></span><span> </span><span class="annot"><span class="annottext">Parser Value -&gt; (Value -&gt; Parser tr) -&gt; Parser tr
forall a b. Parser a -&gt; (a -&gt; Parser b) -&gt; Parser b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Parser tr
</span><a href="#local-6989586621679461448"><span class="hs-identifier hs-var">parseTrans</span></a></span><span>
</span><span id="line-666"></span><span>      </span><span id="local-6989586621679461452"><span class="annot"><a href="#local-6989586621679461452"><span class="hs-identifier hs-var">rslice</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="#local-6989586621679461450"><span class="hs-identifier hs-type">v</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">.:</span></span><span> </span><span class="annot"><span class="hs-string">&quot;rslice&quot;</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&gt;&gt;=</span></span><span> </span><span class="annot"><a href="#local-6989586621679461427"><span class="hs-identifier hs-type">parseSlice</span></a></span><span>
</span><span id="line-667"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679461451"><span class="hs-identifier hs-type">trans</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679461452"><span class="hs-identifier hs-type">rslice</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-668"></span><span>
</span><span id="line-669"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679461461"><span id="local-6989586621679461465"><span id="local-6989586621679461468"><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679459241"><span class="annot"><a href="#local-6989586621679459241"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679459242"><span class="annot"><a href="#local-6989586621679459242"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679459243"><span class="annot"><a href="#local-6989586621679459243"><span class="hs-identifier hs-type">h</span></a></span></span><span> </span><span id="local-6989586621679459244"><span class="annot"><a href="#local-6989586621679459244"><span class="hs-identifier hs-type">tr</span></a></span></span><span> </span><span id="local-6989586621679459245"><span class="annot"><a href="#local-6989586621679459245"><span class="hs-identifier hs-type">slc</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621679459241"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621679459242"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621679459243"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621679459244"><span class="hs-identifier hs-type">tr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621679459245"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Analysis"><span class="hs-identifier hs-type">Analysis</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459241"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459242"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459243"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459244"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459245"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-670"></span><span>  </span><span id="local-6989586621679461495"><span class="annot"><span class="annottext">toJSON :: Analysis s f h tr slc -&gt; Value
</span><span class="hs-identifier hs-var hs-var hs-var">toJSON</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Analysis"><span class="hs-identifier hs-type">Analysis</span></a></span><span> </span><span id="local-6989586621679461496"><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679461496"><span class="hs-identifier hs-var">deriv</span></a></span></span><span> </span><span id="local-6989586621679461497"><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679461497"><span class="hs-identifier hs-var">top</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-671"></span><span>    </span><span class="annot"><span class="annottext">[Pair] -&gt; Value
</span><span class="hs-identifier hs-var">Aeson.object</span></span><span>
</span><span id="line-672"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;derivation&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; [Leftmost s f h] -&gt; Pair
forall v. ToJSON v =&gt; Key -&gt; v -&gt; Pair
forall e kv v. (KeyValue e kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679461496"><span class="hs-identifier hs-var">deriv</span></a></span><span>
</span><span id="line-673"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;start&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; Value -&gt; Pair
forall v. ToJSON v =&gt; Key -&gt; v -&gt; Pair
forall e kv v. (KeyValue e kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">[Pair] -&gt; Value
</span><span class="hs-identifier hs-var">Aeson.object</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;notes&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; StartStop slc -&gt; Pair
forall v. ToJSON v =&gt; Key -&gt; v -&gt; Pair
forall e kv v. (KeyValue e kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StartStop slc
forall a. StartStop a
</span><a href="Common.html#Start"><span class="hs-identifier hs-var">Start</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459245"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-674"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;topSegments&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; [Value] -&gt; Pair
forall v. ToJSON v =&gt; Key -&gt; v -&gt; Pair
forall e kv v. (KeyValue e kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621679461499"><span class="hs-identifier hs-var">segments</span></a></span><span>
</span><span id="line-675"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;styles&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; Value -&gt; Pair
forall v. ToJSON v =&gt; Key -&gt; v -&gt; Pair
forall e kv v. (KeyValue e kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><span class="hs-identifier hs-var">Aeson.Null</span></span><span>
</span><span id="line-676"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-677"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-678"></span><span>    </span><span id="local-6989586621679461517"><span class="annot"><span class="annottext">toSegment :: v -&gt; v -&gt; Value
</span><a href="#local-6989586621679461517"><span class="hs-identifier hs-var hs-var">toSegment</span></a></span></span><span> </span><span id="local-6989586621679461518"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679461518"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span id="local-6989586621679461519"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679461519"><span class="hs-identifier hs-var">slc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-679"></span><span>      </span><span class="annot"><span class="annottext">[Pair] -&gt; Value
</span><span class="hs-identifier hs-var">Aeson.object</span></span><span>
</span><span id="line-680"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;trans&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; Value -&gt; Pair
forall v. ToJSON v =&gt; Key -&gt; v -&gt; Pair
forall e kv v. (KeyValue e kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">[Pair] -&gt; Value
</span><span class="hs-identifier hs-var">Aeson.object</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;edges&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; v -&gt; Pair
forall v. ToJSON v =&gt; Key -&gt; v -&gt; Pair
forall e kv v. (KeyValue e kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679461518"><span class="hs-identifier hs-var">tr</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-681"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;rslice&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; Value -&gt; Pair
forall v. ToJSON v =&gt; Key -&gt; v -&gt; Pair
forall e kv v. (KeyValue e kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">[Pair] -&gt; Value
</span><span class="hs-identifier hs-var">Aeson.object</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;notes&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; v -&gt; Pair
forall v. ToJSON v =&gt; Key -&gt; v -&gt; Pair
forall e kv v. (KeyValue e kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679461519"><span class="hs-identifier hs-var">slc</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-682"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-683"></span><span>    </span><span id="local-6989586621679461520"><span class="annot"><span class="annottext">trs :: [tr]
</span><a href="#local-6989586621679461520"><span class="hs-identifier hs-var hs-var">trs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Path tr slc -&gt; [tr]
forall a b. Path a b -&gt; [a]
</span><a href="Common.html#pathArounds"><span class="hs-identifier hs-var">pathArounds</span></a></span><span> </span><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679461497"><span class="hs-identifier hs-var">top</span></a></span><span>
</span><span id="line-684"></span><span>    </span><span id="local-6989586621679461521"><span class="annot"><span class="annottext">slcs :: [StartStop slc]
</span><a href="#local-6989586621679461521"><span class="hs-identifier hs-var hs-var">slcs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">slc -&gt; StartStop slc
forall a. a -&gt; StartStop a
</span><a href="Common.html#Inner"><span class="hs-identifier hs-var">Inner</span></a></span><span> </span><span class="annot"><span class="annottext">(slc -&gt; StartStop slc) -&gt; [slc] -&gt; [StartStop slc]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Path tr slc -&gt; [slc]
forall a b. Path a b -&gt; [b]
</span><a href="Common.html#pathBetweens"><span class="hs-identifier hs-var">pathBetweens</span></a></span><span> </span><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679461497"><span class="hs-identifier hs-var">top</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[StartStop slc] -&gt; [StartStop slc] -&gt; [StartStop slc]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">StartStop slc
forall a. StartStop a
</span><a href="Common.html#Stop"><span class="hs-identifier hs-var">Stop</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-685"></span><span>    </span><span id="local-6989586621679461499"><span class="annot"><span class="annottext">segments :: [Value]
</span><a href="#local-6989586621679461499"><span class="hs-identifier hs-var hs-var">segments</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(tr -&gt; StartStop slc -&gt; Value)
-&gt; [tr] -&gt; [StartStop slc] -&gt; [Value]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="annot"><span class="annottext">tr -&gt; StartStop slc -&gt; Value
forall {v} {v}. (ToJSON v, ToJSON v) =&gt; v -&gt; v -&gt; Value
</span><a href="#local-6989586621679461517"><span class="hs-identifier hs-var">toSegment</span></a></span><span> </span><span class="annot"><span class="annottext">[tr]
</span><a href="#local-6989586621679461520"><span class="hs-identifier hs-var">trs</span></a></span><span> </span><span class="annot"><span class="annottext">[StartStop slc]
</span><a href="#local-6989586621679461521"><span class="hs-identifier hs-var">slcs</span></a></span><span>
</span><span id="line-686"></span><span>
</span><span id="line-687"></span><span>  </span><span id="local-6989586621679461550"><span class="annot"><span class="annottext">toEncoding :: Analysis s f h tr slc -&gt; Encoding
</span><span class="hs-identifier hs-var hs-var hs-var">toEncoding</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Analysis"><span class="hs-identifier hs-type">Analysis</span></a></span><span> </span><span id="local-6989586621679461551"><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679461551"><span class="hs-identifier hs-var">deriv</span></a></span></span><span> </span><span id="local-6989586621679461552"><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679461552"><span class="hs-identifier hs-var">top</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-688"></span><span>    </span><span class="annot"><span class="annottext">Series -&gt; Encoding
</span><span class="hs-identifier hs-var">Aeson.pairs</span></span><span>
</span><span id="line-689"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;derivation&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; [Leftmost s f h] -&gt; Series
forall v. ToJSON v =&gt; Key -&gt; v -&gt; Series
forall e kv v. (KeyValue e kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679461551"><span class="hs-identifier hs-var">deriv</span></a></span><span>
</span><span id="line-690"></span><span>          </span><span class="annot"><span class="annottext">Series -&gt; Series -&gt; Series
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;start&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; Value -&gt; Series
forall v. ToJSON v =&gt; Key -&gt; v -&gt; Series
forall e kv v. (KeyValue e kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">[Pair] -&gt; Value
</span><span class="hs-identifier hs-var">Aeson.object</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;notes&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; StartStop slc -&gt; Pair
forall v. ToJSON v =&gt; Key -&gt; v -&gt; Pair
forall e kv v. (KeyValue e kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StartStop slc
forall a. StartStop a
</span><a href="Common.html#Start"><span class="hs-identifier hs-var">Start</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459245"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-691"></span><span>          </span><span class="annot"><span class="annottext">Series -&gt; Series -&gt; Series
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;topSegments&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; [Value] -&gt; Series
forall v. ToJSON v =&gt; Key -&gt; v -&gt; Series
forall e kv v. (KeyValue e kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">[Value]
</span><a href="#local-6989586621679461554"><span class="hs-identifier hs-var">segments</span></a></span><span>
</span><span id="line-692"></span><span>          </span><span class="annot"><span class="annottext">Series -&gt; Series -&gt; Series
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;styles&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; Value -&gt; Series
forall v. ToJSON v =&gt; Key -&gt; v -&gt; Series
forall e kv v. (KeyValue e kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><span class="hs-identifier hs-var">Aeson.Null</span></span><span>
</span><span id="line-693"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-694"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-695"></span><span>    </span><span id="local-6989586621679461571"><span class="annot"><span class="annottext">toSegment :: v -&gt; v -&gt; Value
</span><a href="#local-6989586621679461571"><span class="hs-identifier hs-var hs-var">toSegment</span></a></span></span><span> </span><span id="local-6989586621679461572"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679461572"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span id="local-6989586621679461573"><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679461573"><span class="hs-identifier hs-var">slc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-696"></span><span>      </span><span class="annot"><span class="annottext">[Pair] -&gt; Value
</span><span class="hs-identifier hs-var">Aeson.object</span></span><span>
</span><span id="line-697"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;trans&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; Value -&gt; Pair
forall v. ToJSON v =&gt; Key -&gt; v -&gt; Pair
forall e kv v. (KeyValue e kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">[Pair] -&gt; Value
</span><span class="hs-identifier hs-var">Aeson.object</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;edges&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; v -&gt; Pair
forall v. ToJSON v =&gt; Key -&gt; v -&gt; Pair
forall e kv v. (KeyValue e kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679461572"><span class="hs-identifier hs-var">tr</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-698"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;rslice&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; Value -&gt; Pair
forall v. ToJSON v =&gt; Key -&gt; v -&gt; Pair
forall e kv v. (KeyValue e kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">[Pair] -&gt; Value
</span><span class="hs-identifier hs-var">Aeson.object</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;notes&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; v -&gt; Pair
forall v. ToJSON v =&gt; Key -&gt; v -&gt; Pair
forall e kv v. (KeyValue e kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">v
</span><a href="#local-6989586621679461573"><span class="hs-identifier hs-var">slc</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-699"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-700"></span><span>    </span><span id="local-6989586621679461574"><span class="annot"><span class="annottext">trs :: [tr]
</span><a href="#local-6989586621679461574"><span class="hs-identifier hs-var hs-var">trs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Path tr slc -&gt; [tr]
forall a b. Path a b -&gt; [a]
</span><a href="Common.html#pathArounds"><span class="hs-identifier hs-var">pathArounds</span></a></span><span> </span><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679461552"><span class="hs-identifier hs-var">top</span></a></span><span>
</span><span id="line-701"></span><span>    </span><span id="local-6989586621679461575"><span class="annot"><span class="annottext">slcs :: [StartStop slc]
</span><a href="#local-6989586621679461575"><span class="hs-identifier hs-var hs-var">slcs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">slc -&gt; StartStop slc
forall a. a -&gt; StartStop a
</span><a href="Common.html#Inner"><span class="hs-identifier hs-var">Inner</span></a></span><span> </span><span class="annot"><span class="annottext">(slc -&gt; StartStop slc) -&gt; [slc] -&gt; [StartStop slc]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Path tr slc -&gt; [slc]
forall a b. Path a b -&gt; [b]
</span><a href="Common.html#pathBetweens"><span class="hs-identifier hs-var">pathBetweens</span></a></span><span> </span><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679461552"><span class="hs-identifier hs-var">top</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[StartStop slc] -&gt; [StartStop slc] -&gt; [StartStop slc]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">StartStop slc
forall a. StartStop a
</span><a href="Common.html#Stop"><span class="hs-identifier hs-var">Stop</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-702"></span><span>    </span><span id="local-6989586621679461554"><span class="annot"><span class="annottext">segments :: [Value]
</span><a href="#local-6989586621679461554"><span class="hs-identifier hs-var hs-var">segments</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(tr -&gt; StartStop slc -&gt; Value)
-&gt; [tr] -&gt; [StartStop slc] -&gt; [Value]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><span class="hs-identifier hs-var">zipWith</span></span><span> </span><span class="annot"><span class="annottext">tr -&gt; StartStop slc -&gt; Value
forall {v} {v}. (ToJSON v, ToJSON v) =&gt; v -&gt; v -&gt; Value
</span><a href="#local-6989586621679461571"><span class="hs-identifier hs-var">toSegment</span></a></span><span> </span><span class="annot"><span class="annottext">[tr]
</span><a href="#local-6989586621679461574"><span class="hs-identifier hs-var">trs</span></a></span><span> </span><span class="annot"><span class="annottext">[StartStop slc]
</span><a href="#local-6989586621679461575"><span class="hs-identifier hs-var">slcs</span></a></span><span>
</span><span id="line-703"></span><span>
</span><span id="line-704"></span><span class="annot"><span class="hs-comment">-- | Prints the steps and intermediate configurations of a derivation.</span></span><span>
</span><span id="line-705"></span><span class="annot"><a href="Common.html#debugAnalysis"><span class="hs-identifier hs-type">debugAnalysis</span></a></span><span>
</span><span id="line-706"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679459260"><span class="annot"><a href="#local-6989586621679459260"><span class="hs-identifier hs-type">tr</span></a></span></span><span> </span><span id="local-6989586621679459261"><span class="annot"><a href="#local-6989586621679459261"><span class="hs-identifier hs-type">slc</span></a></span></span><span> </span><span id="local-6989586621679459262"><span class="annot"><a href="#local-6989586621679459262"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679459264"><span class="annot"><a href="#local-6989586621679459264"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679459263"><span class="annot"><a href="#local-6989586621679459263"><span class="hs-identifier hs-type">h</span></a></span></span><span>
</span><span id="line-707"></span><span>   </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679459260"><span class="hs-identifier hs-type">tr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679459261"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679459262"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679459263"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-708"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679459262"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679459260"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679459260"><span class="hs-identifier hs-type">tr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679459261"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679459260"><span class="hs-identifier hs-type">tr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-709"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679459264"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679459260"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><a href="#local-6989586621679459260"><span class="hs-identifier hs-type">tr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-710"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679459263"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679459260"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679459261"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679459260"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679459260"><span class="hs-identifier hs-type">tr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679459261"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679459260"><span class="hs-identifier hs-type">tr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679459261"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679459260"><span class="hs-identifier hs-type">tr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-711"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#Analysis"><span class="hs-identifier hs-type">Analysis</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459262"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459264"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459263"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459260"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459261"><span class="hs-identifier hs-type">slc</span></a></span><span>
</span><span id="line-712"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-713"></span><span id="debugAnalysis"><span class="annot"><span class="annottext">debugAnalysis :: forall tr slc s f h.
(Show tr, Show slc, Show s, Show h) =&gt;
(s -&gt; tr -&gt; Either String (tr, slc, tr))
-&gt; (f -&gt; tr -&gt; Either String tr)
-&gt; (h -&gt; tr -&gt; slc -&gt; tr -&gt; Either String (tr, slc, tr, slc, tr))
-&gt; Analysis s f h tr slc
-&gt; IO (Either String ())
</span><a href="Common.html#debugAnalysis"><span class="hs-identifier hs-var hs-var">debugAnalysis</span></a></span></span><span> </span><span id="local-6989586621679461661"><span class="annot"><span class="annottext">s -&gt; tr -&gt; Either String (tr, slc, tr)
</span><a href="#local-6989586621679461661"><span class="hs-identifier hs-var">doSplit</span></a></span></span><span> </span><span id="local-6989586621679461662"><span class="annot"><span class="annottext">f -&gt; tr -&gt; Either String tr
</span><a href="#local-6989586621679461662"><span class="hs-identifier hs-var">doFreeze</span></a></span></span><span> </span><span id="local-6989586621679461663"><span class="annot"><span class="annottext">h -&gt; tr -&gt; slc -&gt; tr -&gt; Either String (tr, slc, tr, slc, tr)
</span><a href="#local-6989586621679461663"><span class="hs-identifier hs-var">doSpread</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Analysis"><span class="hs-identifier hs-type">Analysis</span></a></span><span> </span><span id="local-6989586621679461664"><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679461664"><span class="hs-identifier hs-var">deriv</span></a></span></span><span> </span><span id="local-6989586621679461665"><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679461665"><span class="hs-identifier hs-var">top</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-714"></span><span>  </span><span class="annot"><span class="annottext">ExceptT String IO () -&gt; IO (Either String ())
forall e (m :: * -&gt; *) a. ExceptT e m a -&gt; m (Either e a)
</span><span class="hs-identifier hs-var">runExceptT</span></span><span> </span><span class="annot"><span class="annottext">(ExceptT String IO () -&gt; IO (Either String ()))
-&gt; ExceptT String IO () -&gt; IO (Either String ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-715"></span><span>    </span><span class="annot"><span class="annottext">StartStop slc
-&gt; Path tr slc -&gt; Bool -&gt; [Leftmost s f h] -&gt; ExceptT String IO ()
</span><a href="#local-6989586621679461666"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
forall a. StartStop a
</span><a href="Common.html#Start"><span class="hs-identifier hs-var">Start</span></a></span><span> </span><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679461665"><span class="hs-identifier hs-var">top</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679461664"><span class="hs-identifier hs-var">deriv</span></a></span><span>
</span><span id="line-716"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-717"></span><span>  </span><span class="annot"><a href="#local-6989586621679461666"><span class="hs-identifier hs-type">go</span></a></span><span>
</span><span id="line-718"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459261"><span class="hs-identifier hs-type">slc</span></a></span><span>
</span><span id="line-719"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459260"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459261"><span class="hs-identifier hs-type">slc</span></a></span><span>
</span><span id="line-720"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-721"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Common.html#Leftmost"><span class="hs-identifier hs-type">Leftmost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459262"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459264"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459263"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-722"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExceptT</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-723"></span><span>  </span><span id="local-6989586621679461666"><span class="annot"><span class="annottext">go :: StartStop slc
-&gt; Path tr slc -&gt; Bool -&gt; [Leftmost s f h] -&gt; ExceptT String IO ()
</span><a href="#local-6989586621679461666"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679461667"><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679461667"><span class="hs-identifier hs-var">_sl</span></a></span></span><span> </span><span id="local-6989586621679461668"><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679461668"><span class="hs-identifier hs-var">_surface</span></a></span></span><span> </span><span id="local-6989586621679461669"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679461669"><span class="hs-identifier hs-var">_ars</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either String () -&gt; ExceptT String IO ()
forall (m :: * -&gt; *) e a. Monad m =&gt; Either e a -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">except</span></span><span> </span><span class="annot"><span class="annottext">(Either String () -&gt; ExceptT String IO ())
-&gt; Either String () -&gt; ExceptT String IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String ()
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Derivation incomplete.&quot;</span></span><span>
</span><span id="line-724"></span><span>  </span><span class="annot"><a href="#local-6989586621679461666"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679461670"><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679461670"><span class="hs-identifier hs-var">sl</span></a></span></span><span> </span><span id="local-6989586621679461671"><span class="annot"><span class="annottext">surface :: Path tr slc
</span><a href="#local-6989586621679461671"><span class="hs-identifier hs-var">surface</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span id="local-6989586621679461672"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679461672"><span class="hs-identifier hs-var">trans</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679461673"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679461673"><span class="hs-identifier hs-var">_ars</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679461674"><span class="annot"><span class="annottext">Leftmost s f h
</span><a href="#local-6989586621679461674"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679461675"><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679461675"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-725"></span><span>    </span><span class="annot"><span class="annottext">IO () -&gt; ExceptT String IO ()
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ExceptT String m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; ExceptT String IO ()) -&gt; IO () -&gt; ExceptT String IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\nCurrent surface: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Path tr slc -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679461671"><span class="hs-identifier hs-var">surface</span></a></span><span>
</span><span id="line-726"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Leftmost s f h
</span><a href="#local-6989586621679461674"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-727"></span><span>      </span><span class="annot"><a href="Common.html#LMSingle"><span class="hs-identifier hs-type">LMSingle</span></a></span><span> </span><span id="local-6989586621679461677"><span class="annot"><span class="annottext">LeftmostSingle s f
</span><a href="#local-6989586621679461677"><span class="hs-identifier hs-var">single</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-728"></span><span>        </span><span class="hs-comment">-- debugSingleStep (sl, trans, Stop) single</span><span>
</span><span id="line-729"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">LeftmostSingle s f
</span><a href="#local-6989586621679461677"><span class="hs-identifier hs-var">single</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-730"></span><span>          </span><span class="annot"><a href="Common.html#LMSingleFreeze"><span class="hs-identifier hs-type">LMSingleFreeze</span></a></span><span> </span><span id="local-6989586621679461678"><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621679461678"><span class="hs-identifier hs-var">freezeOp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-731"></span><span>            </span><span class="annot"><span class="annottext">IO () -&gt; ExceptT String IO ()
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ExceptT String m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; ExceptT String IO ()) -&gt; IO () -&gt; ExceptT String IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;freezing only (terminating)&quot;</span></span><span>
</span><span id="line-732"></span><span>            </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Either String tr -&gt; ExceptT String IO tr
forall (m :: * -&gt; *) e a. Monad m =&gt; Either e a -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">except</span></span><span> </span><span class="annot"><span class="annottext">(Either String tr -&gt; ExceptT String IO tr)
-&gt; Either String tr -&gt; ExceptT String IO tr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">f -&gt; tr -&gt; Either String tr
</span><a href="#local-6989586621679461662"><span class="hs-identifier hs-var">doFreeze</span></a></span><span> </span><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621679461678"><span class="hs-identifier hs-var">freezeOp</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679461672"><span class="hs-identifier hs-var">trans</span></a></span><span>
</span><span id="line-733"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-734"></span><span>          </span><span class="annot"><a href="Common.html#LMSingleSplit"><span class="hs-identifier hs-type">LMSingleSplit</span></a></span><span> </span><span id="local-6989586621679461679"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679461679"><span class="hs-identifier hs-var">splitOp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-735"></span><span>            </span><span class="annot"><span class="annottext">IO () -&gt; ExceptT String IO ()
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ExceptT String m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; ExceptT String IO ()) -&gt; IO () -&gt; ExceptT String IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;splitting only: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">s -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679461679"><span class="hs-identifier hs-var">splitOp</span></a></span><span>
</span><span id="line-736"></span><span>            </span><span class="hs-special">(</span><span id="local-6989586621679461680"><span class="annot"><a href="#local-6989586621679461680"><span class="hs-identifier hs-var">ctl</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679461681"><span class="annot"><a href="#local-6989586621679461681"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679461682"><span class="annot"><a href="#local-6989586621679461682"><span class="hs-identifier hs-var">ctr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Either String (tr, slc, tr) -&gt; ExceptT String IO (tr, slc, tr)
forall (m :: * -&gt; *) e a. Monad m =&gt; Either e a -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">except</span></span><span> </span><span class="annot"><span class="annottext">(Either String (tr, slc, tr) -&gt; ExceptT String IO (tr, slc, tr))
-&gt; Either String (tr, slc, tr) -&gt; ExceptT String IO (tr, slc, tr)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">s -&gt; tr -&gt; Either String (tr, slc, tr)
</span><a href="#local-6989586621679461661"><span class="hs-identifier hs-var">doSplit</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679461679"><span class="hs-identifier hs-var">splitOp</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679461672"><span class="hs-identifier hs-var">trans</span></a></span><span>
</span><span id="line-737"></span><span>            </span><span class="annot"><a href="#local-6989586621679461666"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679461670"><span class="hs-identifier hs-type">sl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679461680"><span class="hs-identifier hs-type">ctl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679461681"><span class="hs-identifier hs-type">cs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679461682"><span class="hs-identifier hs-type">ctr</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span> </span><span class="annot"><a href="#local-6989586621679461675"><span class="hs-identifier hs-type">rest</span></a></span><span>
</span><span id="line-738"></span><span>      </span><span class="annot"><a href="Common.html#LMDouble"><span class="hs-identifier hs-type">LMDouble</span></a></span><span> </span><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Either String () -&gt; ExceptT String IO ()
forall (m :: * -&gt; *) e a. Monad m =&gt; Either e a -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">except</span></span><span> </span><span class="annot"><span class="annottext">(Either String () -&gt; ExceptT String IO ())
-&gt; Either String () -&gt; ExceptT String IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String ()
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Double operation on single transition.&quot;</span></span><span>
</span><span id="line-739"></span><span>  </span><span class="annot"><a href="#local-6989586621679461666"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679461683"><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679461683"><span class="hs-identifier hs-var">sl</span></a></span></span><span> </span><span id="local-6989586621679461684"><span class="annot"><span class="annottext">surface :: Path tr slc
</span><a href="#local-6989586621679461684"><span class="hs-identifier hs-var">surface</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679461685"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679461685"><span class="hs-identifier hs-var">tl</span></a></span></span><span> </span><span id="local-6989586621679461686"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679461686"><span class="hs-identifier hs-var">sm</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#PathEnd"><span class="hs-identifier hs-type">PathEnd</span></a></span><span> </span><span id="local-6989586621679461687"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679461687"><span class="hs-identifier hs-var">tr</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679461688"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679461688"><span class="hs-identifier hs-var">ars</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679461689"><span class="annot"><span class="annottext">Leftmost s f h
</span><a href="#local-6989586621679461689"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679461690"><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679461690"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-740"></span><span>    </span><span class="annot"><span class="annottext">IO () -&gt; ExceptT String IO ()
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ExceptT String m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; ExceptT String IO ()) -&gt; IO () -&gt; ExceptT String IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\nCurrent surface: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Path tr slc -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679461684"><span class="hs-identifier hs-var">surface</span></a></span><span>
</span><span id="line-741"></span><span>    </span><span class="annot"><span class="annottext">Leftmost s f h
-&gt; [Leftmost s f h]
-&gt; Bool
-&gt; (StartStop slc, tr, slc, tr, StartStop slc)
-&gt; (tr -&gt; Path tr slc)
-&gt; ExceptT String IO ()
</span><a href="#local-6989586621679461691"><span class="hs-identifier hs-var">goDouble</span></a></span><span> </span><span class="annot"><span class="annottext">Leftmost s f h
</span><a href="#local-6989586621679461689"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679461690"><span class="hs-identifier hs-var">rest</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679461688"><span class="hs-identifier hs-var">ars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679461683"><span class="hs-identifier hs-var">sl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679461685"><span class="hs-identifier hs-var">tl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679461686"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679461687"><span class="hs-identifier hs-var">tr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">StartStop slc
forall a. StartStop a
</span><a href="Common.html#Stop"><span class="hs-identifier hs-var">Stop</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">tr -&gt; Path tr slc
forall around between. around -&gt; Path around between
</span><a href="Common.html#PathEnd"><span class="hs-identifier hs-var">PathEnd</span></a></span><span>
</span><span id="line-742"></span><span>  </span><span class="annot"><a href="#local-6989586621679461666"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679461692"><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679461692"><span class="hs-identifier hs-var">sl</span></a></span></span><span> </span><span id="local-6989586621679461693"><span class="annot"><span class="annottext">surface :: Path tr slc
</span><a href="#local-6989586621679461693"><span class="hs-identifier hs-var">surface</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679461694"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679461694"><span class="hs-identifier hs-var">tl</span></a></span></span><span> </span><span id="local-6989586621679461695"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679461695"><span class="hs-identifier hs-var">sm</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span id="local-6989586621679461696"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679461696"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span id="local-6989586621679461697"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679461697"><span class="hs-identifier hs-var">sr</span></a></span></span><span> </span><span id="local-6989586621679461698"><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679461698"><span class="hs-identifier hs-var">pathRest</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679461699"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679461699"><span class="hs-identifier hs-var">ars</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679461700"><span class="annot"><span class="annottext">Leftmost s f h
</span><a href="#local-6989586621679461700"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679461701"><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679461701"><span class="hs-identifier hs-var">derivRest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-743"></span><span>    </span><span class="annot"><span class="annottext">IO () -&gt; ExceptT String IO ()
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ExceptT String m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; ExceptT String IO ()) -&gt; IO () -&gt; ExceptT String IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\nCurrent surface: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Path tr slc -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679461693"><span class="hs-identifier hs-var">surface</span></a></span><span>
</span><span id="line-744"></span><span>    </span><span class="annot"><span class="annottext">Leftmost s f h
-&gt; [Leftmost s f h]
-&gt; Bool
-&gt; (StartStop slc, tr, slc, tr, StartStop slc)
-&gt; (tr -&gt; Path tr slc)
-&gt; ExceptT String IO ()
</span><a href="#local-6989586621679461691"><span class="hs-identifier hs-var">goDouble</span></a></span><span> </span><span class="annot"><span class="annottext">Leftmost s f h
</span><a href="#local-6989586621679461700"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679461701"><span class="hs-identifier hs-var">derivRest</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679461699"><span class="hs-identifier hs-var">ars</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679461692"><span class="hs-identifier hs-var">sl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679461694"><span class="hs-identifier hs-var">tl</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679461695"><span class="hs-identifier hs-var">sm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679461696"><span class="hs-identifier hs-var">tr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">slc -&gt; StartStop slc
forall a. a -&gt; StartStop a
</span><a href="Common.html#Inner"><span class="hs-identifier hs-var">Inner</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679461697"><span class="hs-identifier hs-var">sr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((tr -&gt; Path tr slc) -&gt; ExceptT String IO ())
-&gt; (tr -&gt; Path tr slc) -&gt; ExceptT String IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-745"></span><span>      </span><span class="hs-glyph">\</span><span id="local-6989586621679461702"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679461702"><span class="hs-identifier hs-var">tr'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">tr -&gt; slc -&gt; Path tr slc -&gt; Path tr slc
forall around between.
around -&gt; between -&gt; Path around between -&gt; Path around between
</span><a href="Common.html#Path"><span class="hs-identifier hs-var">Path</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679461702"><span class="hs-identifier hs-var">tr'</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679461697"><span class="hs-identifier hs-var">sr</span></a></span><span> </span><span class="annot"><span class="annottext">Path tr slc
</span><a href="#local-6989586621679461698"><span class="hs-identifier hs-var">pathRest</span></a></span><span>
</span><span id="line-746"></span><span>
</span><span id="line-747"></span><span>  </span><span id="local-6989586621679461691"><span class="annot"><span class="annottext">goDouble :: Leftmost s f h
-&gt; [Leftmost s f h]
-&gt; Bool
-&gt; (StartStop slc, tr, slc, tr, StartStop slc)
-&gt; (tr -&gt; Path tr slc)
-&gt; ExceptT String IO ()
</span><a href="#local-6989586621679461691"><span class="hs-identifier hs-var hs-var">goDouble</span></a></span></span><span> </span><span id="local-6989586621679461703"><span class="annot"><span class="annottext">Leftmost s f h
</span><a href="#local-6989586621679461703"><span class="hs-identifier hs-var">op</span></a></span></span><span> </span><span id="local-6989586621679461704"><span class="annot"><span class="annottext">[Leftmost s f h]
</span><a href="#local-6989586621679461704"><span class="hs-identifier hs-var">rest</span></a></span></span><span> </span><span id="local-6989586621679461705"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679461705"><span class="hs-identifier hs-var">ars</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679461706"><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679461706"><span class="hs-identifier hs-var">sl</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679461707"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679461707"><span class="hs-identifier hs-var">tl</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679461708"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679461708"><span class="hs-identifier hs-var">sm</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679461709"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679461709"><span class="hs-identifier hs-var">tr</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679461710"><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679461710"><span class="hs-identifier hs-var">_sr</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679461711"><span class="annot"><span class="annottext">tr -&gt; Path tr slc
</span><a href="#local-6989586621679461711"><span class="hs-identifier hs-var">mkRest</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Leftmost s f h
</span><a href="#local-6989586621679461703"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-748"></span><span>    </span><span class="annot"><a href="Common.html#LMSingle"><span class="hs-identifier hs-type">LMSingle</span></a></span><span> </span><span class="annot"><span class="annottext">LeftmostSingle s f
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-749"></span><span>      </span><span class="annot"><span class="annottext">Either String () -&gt; ExceptT String IO ()
forall (m :: * -&gt; *) e a. Monad m =&gt; Either e a -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">except</span></span><span> </span><span class="annot"><span class="annottext">(Either String () -&gt; ExceptT String IO ())
-&gt; Either String () -&gt; ExceptT String IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String ()
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Single operation with several transitions left.&quot;</span></span><span>
</span><span id="line-750"></span><span>    </span><span class="annot"><a href="Common.html#LMDouble"><span class="hs-identifier hs-type">LMDouble</span></a></span><span> </span><span id="local-6989586621679461712"><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><a href="#local-6989586621679461712"><span class="hs-identifier hs-var">double</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-751"></span><span>      </span><span class="hs-comment">-- observeDoubleStep (sl, tl, sm, tr, sr) ars double</span><span>
</span><span id="line-752"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">LeftmostDouble s f h
</span><a href="#local-6989586621679461712"><span class="hs-identifier hs-var">double</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-753"></span><span>        </span><span class="annot"><a href="Common.html#LMDoubleFreezeLeft"><span class="hs-identifier hs-type">LMDoubleFreezeLeft</span></a></span><span> </span><span id="local-6989586621679461713"><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621679461713"><span class="hs-identifier hs-var">freezeOp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-754"></span><span>          </span><span class="annot"><span class="annottext">Bool -&gt; ExceptT String IO () -&gt; ExceptT String IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679461705"><span class="hs-identifier hs-var">ars</span></a></span><span> </span><span class="annot"><span class="annottext">(ExceptT String IO () -&gt; ExceptT String IO ())
-&gt; ExceptT String IO () -&gt; ExceptT String IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Either String () -&gt; ExceptT String IO ()
forall (m :: * -&gt; *) e a. Monad m =&gt; Either e a -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">except</span></span><span> </span><span class="annot"><span class="annottext">(Either String () -&gt; ExceptT String IO ())
-&gt; Either String () -&gt; ExceptT String IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String ()
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;FreezeLeft after SplitRight.&quot;</span></span><span>
</span><span id="line-755"></span><span>          </span><span class="annot"><span class="annottext">IO () -&gt; ExceptT String IO ()
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ExceptT String m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; ExceptT String IO ()) -&gt; IO () -&gt; ExceptT String IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;freezing left&quot;</span></span><span>
</span><span id="line-756"></span><span>          </span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Either String tr -&gt; ExceptT String IO tr
forall (m :: * -&gt; *) e a. Monad m =&gt; Either e a -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">except</span></span><span> </span><span class="annot"><span class="annottext">(Either String tr -&gt; ExceptT String IO tr)
-&gt; Either String tr -&gt; ExceptT String IO tr
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">f -&gt; tr -&gt; Either String tr
</span><a href="#local-6989586621679461662"><span class="hs-identifier hs-var">doFreeze</span></a></span><span> </span><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621679461713"><span class="hs-identifier hs-var">freezeOp</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679461707"><span class="hs-identifier hs-var">tl</span></a></span><span>
</span><span id="line-757"></span><span>          </span><span class="annot"><a href="#local-6989586621679461666"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Inner"><span class="hs-identifier hs-type">Inner</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679461708"><span class="hs-identifier hs-type">sm</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679461711"><span class="hs-identifier hs-type">mkRest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679461709"><span class="hs-identifier hs-type">tr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span> </span><span class="annot"><a href="#local-6989586621679461704"><span class="hs-identifier hs-type">rest</span></a></span><span>
</span><span id="line-758"></span><span>        </span><span class="annot"><a href="Common.html#LMDoubleSplitLeft"><span class="hs-identifier hs-type">LMDoubleSplitLeft</span></a></span><span> </span><span id="local-6989586621679461714"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679461714"><span class="hs-identifier hs-var">splitOp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-759"></span><span>          </span><span class="annot"><span class="annottext">Bool -&gt; ExceptT String IO () -&gt; ExceptT String IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679461705"><span class="hs-identifier hs-var">ars</span></a></span><span> </span><span class="annot"><span class="annottext">(ExceptT String IO () -&gt; ExceptT String IO ())
-&gt; ExceptT String IO () -&gt; ExceptT String IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Either String () -&gt; ExceptT String IO ()
forall (m :: * -&gt; *) e a. Monad m =&gt; Either e a -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">except</span></span><span> </span><span class="annot"><span class="annottext">(Either String () -&gt; ExceptT String IO ())
-&gt; Either String () -&gt; ExceptT String IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Either String ()
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;SplitLeft after SplitRight.&quot;</span></span><span>
</span><span id="line-760"></span><span>          </span><span class="annot"><span class="annottext">IO () -&gt; ExceptT String IO ()
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ExceptT String m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; ExceptT String IO ()) -&gt; IO () -&gt; ExceptT String IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;splitting left: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">s -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679461714"><span class="hs-identifier hs-var">splitOp</span></a></span><span>
</span><span id="line-761"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621679461715"><span class="annot"><a href="#local-6989586621679461715"><span class="hs-identifier hs-var">ctl</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679461716"><span class="annot"><a href="#local-6989586621679461716"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679461717"><span class="annot"><a href="#local-6989586621679461717"><span class="hs-identifier hs-var">ctr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Either String (tr, slc, tr) -&gt; ExceptT String IO (tr, slc, tr)
forall (m :: * -&gt; *) e a. Monad m =&gt; Either e a -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">except</span></span><span> </span><span class="annot"><span class="annottext">(Either String (tr, slc, tr) -&gt; ExceptT String IO (tr, slc, tr))
-&gt; Either String (tr, slc, tr) -&gt; ExceptT String IO (tr, slc, tr)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">s -&gt; tr -&gt; Either String (tr, slc, tr)
</span><a href="#local-6989586621679461661"><span class="hs-identifier hs-var">doSplit</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679461714"><span class="hs-identifier hs-var">splitOp</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679461707"><span class="hs-identifier hs-var">tl</span></a></span><span>
</span><span id="line-762"></span><span>          </span><span class="annot"><a href="#local-6989586621679461666"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679461706"><span class="hs-identifier hs-type">sl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679461715"><span class="hs-identifier hs-type">ctl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679461716"><span class="hs-identifier hs-type">cs</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679461717"><span class="hs-identifier hs-type">ctr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679461708"><span class="hs-identifier hs-type">sm</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621679461711"><span class="hs-identifier hs-type">mkRest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679461709"><span class="hs-identifier hs-type">tr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span> </span><span class="annot"><a href="#local-6989586621679461704"><span class="hs-identifier hs-type">rest</span></a></span><span>
</span><span id="line-763"></span><span>        </span><span class="annot"><a href="Common.html#LMDoubleSplitRight"><span class="hs-identifier hs-type">LMDoubleSplitRight</span></a></span><span> </span><span id="local-6989586621679461718"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679461718"><span class="hs-identifier hs-var">splitOp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-764"></span><span>          </span><span class="annot"><span class="annottext">IO () -&gt; ExceptT String IO ()
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ExceptT String m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; ExceptT String IO ()) -&gt; IO () -&gt; ExceptT String IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;splitting right: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">s -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679461718"><span class="hs-identifier hs-var">splitOp</span></a></span><span>
</span><span id="line-765"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621679461719"><span class="annot"><a href="#local-6989586621679461719"><span class="hs-identifier hs-var">ctl</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679461720"><span class="annot"><a href="#local-6989586621679461720"><span class="hs-identifier hs-var">cs</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679461721"><span class="annot"><a href="#local-6989586621679461721"><span class="hs-identifier hs-var">ctr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Either String (tr, slc, tr) -&gt; ExceptT String IO (tr, slc, tr)
forall (m :: * -&gt; *) e a. Monad m =&gt; Either e a -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">except</span></span><span> </span><span class="annot"><span class="annottext">(Either String (tr, slc, tr) -&gt; ExceptT String IO (tr, slc, tr))
-&gt; Either String (tr, slc, tr) -&gt; ExceptT String IO (tr, slc, tr)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">s -&gt; tr -&gt; Either String (tr, slc, tr)
</span><a href="#local-6989586621679461661"><span class="hs-identifier hs-var">doSplit</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679461718"><span class="hs-identifier hs-var">splitOp</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679461709"><span class="hs-identifier hs-var">tr</span></a></span><span>
</span><span id="line-766"></span><span>          </span><span class="annot"><a href="#local-6989586621679461666"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679461706"><span class="hs-identifier hs-type">sl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679461707"><span class="hs-identifier hs-type">tl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679461708"><span class="hs-identifier hs-type">sm</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679461719"><span class="hs-identifier hs-type">ctl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679461720"><span class="hs-identifier hs-type">cs</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621679461711"><span class="hs-identifier hs-type">mkRest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679461721"><span class="hs-identifier hs-type">ctr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">True</span></span><span> </span><span class="annot"><a href="#local-6989586621679461704"><span class="hs-identifier hs-type">rest</span></a></span><span>
</span><span id="line-767"></span><span>        </span><span class="annot"><a href="Common.html#LMDoubleSpread"><span class="hs-identifier hs-type">LMDoubleSpread</span></a></span><span> </span><span id="local-6989586621679461722"><span class="annot"><span class="annottext">h
</span><a href="#local-6989586621679461722"><span class="hs-identifier hs-var">spreadOp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-768"></span><span>          </span><span class="annot"><span class="annottext">IO () -&gt; ExceptT String IO ()
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ExceptT String m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; ExceptT String IO ()) -&gt; IO () -&gt; ExceptT String IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;spreading: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">h -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">h
</span><a href="#local-6989586621679461722"><span class="hs-identifier hs-var">spreadOp</span></a></span><span>
</span><span id="line-769"></span><span>          </span><span class="hs-special">(</span><span id="local-6989586621679461723"><span class="annot"><a href="#local-6989586621679461723"><span class="hs-identifier hs-var">ctl</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679461724"><span class="annot"><a href="#local-6989586621679461724"><span class="hs-identifier hs-var">csl</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679461725"><span class="annot"><a href="#local-6989586621679461725"><span class="hs-identifier hs-var">ctm</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679461726"><span class="annot"><a href="#local-6989586621679461726"><span class="hs-identifier hs-var">csr</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679461727"><span class="annot"><a href="#local-6989586621679461727"><span class="hs-identifier hs-var">ctr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Either String (tr, slc, tr, slc, tr)
-&gt; ExceptT String IO (tr, slc, tr, slc, tr)
forall (m :: * -&gt; *) e a. Monad m =&gt; Either e a -&gt; ExceptT e m a
</span><span class="hs-identifier hs-var">except</span></span><span> </span><span class="annot"><span class="annottext">(Either String (tr, slc, tr, slc, tr)
 -&gt; ExceptT String IO (tr, slc, tr, slc, tr))
-&gt; Either String (tr, slc, tr, slc, tr)
-&gt; ExceptT String IO (tr, slc, tr, slc, tr)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">h -&gt; tr -&gt; slc -&gt; tr -&gt; Either String (tr, slc, tr, slc, tr)
</span><a href="#local-6989586621679461663"><span class="hs-identifier hs-var">doSpread</span></a></span><span> </span><span class="annot"><span class="annottext">h
</span><a href="#local-6989586621679461722"><span class="hs-identifier hs-var">spreadOp</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679461707"><span class="hs-identifier hs-var">tl</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679461708"><span class="hs-identifier hs-var">sm</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679461709"><span class="hs-identifier hs-var">tr</span></a></span><span>
</span><span id="line-770"></span><span>          </span><span class="annot"><a href="#local-6989586621679461666"><span class="hs-identifier hs-type">go</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679461706"><span class="hs-identifier hs-type">sl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679461723"><span class="hs-identifier hs-type">ctl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679461724"><span class="hs-identifier hs-type">csl</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Common.html#Path"><span class="hs-identifier hs-type">Path</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679461725"><span class="hs-identifier hs-type">ctm</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679461726"><span class="hs-identifier hs-type">csr</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621679461711"><span class="hs-identifier hs-type">mkRest</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679461727"><span class="hs-identifier hs-type">ctr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span> </span><span class="annot"><a href="#local-6989586621679461704"><span class="hs-identifier hs-type">rest</span></a></span><span>
</span><span id="line-771"></span><span>
</span><span id="line-772"></span><span class="hs-comment">-- evaluators</span><span>
</span><span id="line-773"></span><span class="hs-comment">-- ==========</span><span>
</span><span id="line-774"></span><span>
</span><span id="line-775"></span><span class="annot"><span class="hs-comment">{- | Create a leftmost evaluator from position-independent evaluation functions
 that just return spread, split, and freeze operations
 by wrapping those into the appropriate 'Leftmost' constructors.
-}</span></span><span>
</span><span id="line-779"></span><span class="annot"><a href="Common.html#mkLeftmostEval"><span class="hs-identifier hs-type">mkLeftmostEval</span></a></span><span>
</span><span id="line-780"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679459287"><span class="annot"><a href="#local-6989586621679459287"><span class="hs-identifier hs-type">tr</span></a></span></span><span> </span><span id="local-6989586621679459291"><span class="annot"><a href="#local-6989586621679459291"><span class="hs-identifier hs-type">tr'</span></a></span></span><span> </span><span id="local-6989586621679459288"><span class="annot"><a href="#local-6989586621679459288"><span class="hs-identifier hs-type">slc</span></a></span></span><span> </span><span id="local-6989586621679459293"><span class="annot"><a href="#local-6989586621679459293"><span class="hs-identifier hs-type">slc'</span></a></span></span><span> </span><span id="local-6989586621679459290"><span class="annot"><a href="#local-6989586621679459290"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679459292"><span class="annot"><a href="#local-6989586621679459292"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679459289"><span class="annot"><a href="#local-6989586621679459289"><span class="hs-identifier hs-type">h</span></a></span></span><span>
</span><span id="line-781"></span><span>   </span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Common.html#UnspreadMiddle"><span class="hs-identifier hs-type">UnspreadMiddle</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459287"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459288"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459289"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459289"><span class="hs-identifier hs-type">h</span></a></span><span>
</span><span id="line-782"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#UnspreadLeft"><span class="hs-identifier hs-type">UnspreadLeft</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459287"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459288"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459289"><span class="hs-identifier hs-type">h</span></a></span><span>
</span><span id="line-783"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#UnspreadRight"><span class="hs-identifier hs-type">UnspreadRight</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459287"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459288"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459289"><span class="hs-identifier hs-type">h</span></a></span><span>
</span><span id="line-784"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459288"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679459287"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679459288"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679459287"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459288"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679459287"><span class="hs-identifier hs-type">tr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679459290"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-785"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459288"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679459291"><span class="hs-identifier hs-type">tr'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#StartStop"><span class="hs-identifier hs-type">StartStop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459288"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679459287"><span class="hs-identifier hs-type">tr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679459292"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-786"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679459293"><span class="hs-identifier hs-type">slc'</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679459288"><span class="hs-identifier hs-type">slc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-787"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#Eval"><span class="hs-identifier hs-type">Eval</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459287"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459291"><span class="hs-identifier hs-type">tr'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459288"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459293"><span class="hs-identifier hs-type">slc'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459289"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Leftmost"><span class="hs-identifier hs-type">Leftmost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459290"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459292"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459289"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-788"></span><span id="mkLeftmostEval"><span class="annot"><span class="annottext">mkLeftmostEval :: forall tr tr' slc slc' s f h.
UnspreadMiddle tr slc h h
-&gt; UnspreadLeft tr slc h
-&gt; UnspreadRight tr slc h
-&gt; (StartStop slc -&gt; tr -&gt; slc -&gt; tr -&gt; StartStop slc -&gt; [(tr, s)])
-&gt; (StartStop slc -&gt; Maybe tr' -&gt; StartStop slc -&gt; [(tr, f)])
-&gt; (slc' -&gt; slc)
-&gt; Eval tr tr' slc slc' h (Leftmost s f h)
</span><a href="Common.html#mkLeftmostEval"><span class="hs-identifier hs-var hs-var">mkLeftmostEval</span></a></span></span><span> </span><span id="local-6989586621679461735"><span class="annot"><span class="annottext">UnspreadMiddle tr slc h h
</span><a href="#local-6989586621679461735"><span class="hs-identifier hs-var">unspreadm</span></a></span></span><span> </span><span id="local-6989586621679461736"><span class="annot"><span class="annottext">UnspreadLeft tr slc h
</span><a href="#local-6989586621679461736"><span class="hs-identifier hs-var">unspreadl</span></a></span></span><span> </span><span id="local-6989586621679461737"><span class="annot"><span class="annottext">UnspreadRight tr slc h
</span><a href="#local-6989586621679461737"><span class="hs-identifier hs-var">unspreadr</span></a></span></span><span> </span><span id="local-6989586621679461738"><span class="annot"><span class="annottext">StartStop slc -&gt; tr -&gt; slc -&gt; tr -&gt; StartStop slc -&gt; [(tr, s)]
</span><a href="#local-6989586621679461738"><span class="hs-identifier hs-var">unsplit</span></a></span></span><span> </span><span id="local-6989586621679461739"><span class="annot"><span class="annottext">StartStop slc -&gt; Maybe tr' -&gt; StartStop slc -&gt; [(tr, f)]
</span><a href="#local-6989586621679461739"><span class="hs-identifier hs-var">uf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-789"></span><span>  </span><span class="annot"><span class="annottext">UnspreadMiddle tr slc h (Leftmost s f h)
-&gt; UnspreadLeft tr slc h
-&gt; UnspreadRight tr slc h
-&gt; Unsplit tr slc (Leftmost s f h)
-&gt; (StartStop slc
    -&gt; Maybe tr' -&gt; StartStop slc -&gt; Bool -&gt; [(tr, Leftmost s f h)])
-&gt; (slc' -&gt; slc)
-&gt; Eval tr tr' slc slc' h (Leftmost s f h)
forall tr tr' slc slc' h v.
UnspreadMiddle tr slc h v
-&gt; UnspreadLeft tr slc h
-&gt; UnspreadRight tr slc h
-&gt; Unsplit tr slc v
-&gt; (StartStop slc
    -&gt; Maybe tr' -&gt; StartStop slc -&gt; Bool -&gt; [(tr, v)])
-&gt; (slc' -&gt; slc)
-&gt; Eval tr tr' slc slc' h v
</span><a href="Common.html#Eval"><span class="hs-identifier hs-var">Eval</span></a></span><span>
</span><span id="line-790"></span><span>    </span><span class="annot"><span class="annottext">UnspreadMiddle tr slc h (Leftmost s f h)
</span><a href="#local-6989586621679461740"><span class="hs-identifier hs-var">unspreadm'</span></a></span><span>
</span><span id="line-791"></span><span>    </span><span class="annot"><span class="annottext">UnspreadLeft tr slc h
</span><a href="#local-6989586621679461736"><span class="hs-identifier hs-var">unspreadl</span></a></span><span>
</span><span id="line-792"></span><span>    </span><span class="annot"><span class="annottext">UnspreadRight tr slc h
</span><a href="#local-6989586621679461737"><span class="hs-identifier hs-var">unspreadr</span></a></span><span>
</span><span id="line-793"></span><span>    </span><span class="annot"><span class="annottext">Unsplit tr slc (Leftmost s f h)
</span><a href="#local-6989586621679461741"><span class="hs-identifier hs-var">unsplit'</span></a></span><span>
</span><span id="line-794"></span><span>    </span><span class="annot"><span class="annottext">StartStop slc
-&gt; Maybe tr' -&gt; StartStop slc -&gt; Bool -&gt; [(tr, Leftmost s f h)]
</span><a href="#local-6989586621679461742"><span class="hs-identifier hs-var">uf'</span></a></span><span>
</span><span id="line-795"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-796"></span><span>  </span><span id="local-6989586621679461750"><span class="annot"><span class="annottext">smap :: (b -&gt; c) -&gt; f (p a b) -&gt; f (p a c)
</span><a href="#local-6989586621679461750"><span class="hs-identifier hs-var hs-var">smap</span></a></span></span><span> </span><span id="local-6989586621679461751"><span class="annot"><span class="annottext">b -&gt; c
</span><a href="#local-6989586621679461751"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(p a b -&gt; p a c) -&gt; f (p a b) -&gt; f (p a c)
forall a b. (a -&gt; b) -&gt; f a -&gt; f b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(b -&gt; c) -&gt; p a b -&gt; p a c
forall b c a. (b -&gt; c) -&gt; p a b -&gt; p a c
forall (p :: * -&gt; * -&gt; *) b c a.
Bifunctor p =&gt;
(b -&gt; c) -&gt; p a b -&gt; p a c
</span><span class="hs-identifier hs-var">second</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; c
</span><a href="#local-6989586621679461751"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-797"></span><span>  </span><span class="hs-comment">-- vm' :: UnspreadMiddle e a (Leftmost s f h)</span><span>
</span><span id="line-798"></span><span>  </span><span class="annot"><a href="#local-6989586621679461740"><span class="hs-identifier hs-type">unspreadm'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Common.html#UnspreadMiddle"><span class="hs-identifier hs-type">UnspreadMiddle</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459287"><span class="hs-identifier hs-type">tr</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459288"><span class="hs-identifier hs-type">slc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459289"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Leftmost"><span class="hs-identifier hs-type">Leftmost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459290"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459292"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459289"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-799"></span><span>  </span><span id="local-6989586621679461740"><span class="annot"><span class="annottext">unspreadm' :: UnspreadMiddle tr slc h (Leftmost s f h)
</span><a href="#local-6989586621679461740"><span class="hs-identifier hs-var hs-var">unspreadm'</span></a></span></span><span> </span><span id="local-6989586621679461752"><span class="annot"><span class="annottext">(slc, tr, slc)
</span><a href="#local-6989586621679461752"><span class="hs-identifier hs-var">vert</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((slc, h, h) -&gt; (slc, h, Leftmost s f h))
-&gt; [(slc, h, h)] -&gt; [(slc, h, Leftmost s f h)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679461753"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679461753"><span class="hs-identifier hs-var">top</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679461754"><span class="annot"><span class="annottext">h
</span><a href="#local-6989586621679461754"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679461755"><span class="annot"><span class="annottext">h
</span><a href="#local-6989586621679461755"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679461753"><span class="hs-identifier hs-var">top</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">h
</span><a href="#local-6989586621679461754"><span class="hs-identifier hs-var">op</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">h -&gt; Leftmost s f h
forall h s f. h -&gt; Leftmost s f h
</span><a href="Common.html#LMSpread"><span class="hs-identifier hs-var">LMSpread</span></a></span><span> </span><span class="annot"><span class="annottext">h
</span><a href="#local-6989586621679461755"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(slc, h, h)] -&gt; [(slc, h, Leftmost s f h)])
-&gt; [(slc, h, h)] -&gt; [(slc, h, Leftmost s f h)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UnspreadMiddle tr slc h h
</span><a href="#local-6989586621679461735"><span class="hs-identifier hs-var">unspreadm</span></a></span><span> </span><span class="annot"><span class="annottext">(slc, tr, slc)
</span><a href="#local-6989586621679461752"><span class="hs-identifier hs-var">vert</span></a></span><span>
</span><span id="line-800"></span><span>  </span><span id="local-6989586621679461741"><span class="annot"><span class="annottext">unsplit' :: Unsplit tr slc (Leftmost s f h)
</span><a href="#local-6989586621679461741"><span class="hs-identifier hs-var hs-var">unsplit'</span></a></span></span><span> </span><span id="local-6989586621679461756"><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679461756"><span class="hs-identifier hs-var">sl</span></a></span></span><span> </span><span id="local-6989586621679461757"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679461757"><span class="hs-identifier hs-var">tl</span></a></span></span><span> </span><span id="local-6989586621679461758"><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679461758"><span class="hs-identifier hs-var">sm</span></a></span></span><span> </span><span id="local-6989586621679461759"><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679461759"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span id="local-6989586621679461760"><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679461760"><span class="hs-identifier hs-var">sr</span></a></span></span><span> </span><span id="local-6989586621679461761"><span class="annot"><span class="annottext">SplitType
</span><a href="#local-6989586621679461761"><span class="hs-identifier hs-var">typ</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(s -&gt; Leftmost s f h) -&gt; [(tr, s)] -&gt; [(tr, Leftmost s f h)]
forall {f :: * -&gt; *} {p :: * -&gt; * -&gt; *} {b} {c} {a}.
(Functor f, Bifunctor p) =&gt;
(b -&gt; c) -&gt; f (p a b) -&gt; f (p a c)
</span><a href="#local-6989586621679461750"><span class="hs-identifier hs-var">smap</span></a></span><span> </span><span class="annot"><span class="annottext">s -&gt; Leftmost s f h
</span><a href="#local-6989586621679461762"><span class="hs-identifier hs-var">splitop</span></a></span><span> </span><span class="annot"><span class="annottext">[(tr, s)]
</span><a href="#local-6989586621679461763"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-801"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-802"></span><span>    </span><span id="local-6989586621679461763"><span class="annot"><span class="annottext">res :: [(tr, s)]
</span><a href="#local-6989586621679461763"><span class="hs-identifier hs-var hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StartStop slc -&gt; tr -&gt; slc -&gt; tr -&gt; StartStop slc -&gt; [(tr, s)]
</span><a href="#local-6989586621679461738"><span class="hs-identifier hs-var">unsplit</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679461756"><span class="hs-identifier hs-var">sl</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679461757"><span class="hs-identifier hs-var">tl</span></a></span><span> </span><span class="annot"><span class="annottext">slc
</span><a href="#local-6989586621679461758"><span class="hs-identifier hs-var">sm</span></a></span><span> </span><span class="annot"><span class="annottext">tr
</span><a href="#local-6989586621679461759"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679461760"><span class="hs-identifier hs-var">sr</span></a></span><span>
</span><span id="line-803"></span><span>    </span><span id="local-6989586621679461762"><span class="annot"><span class="annottext">splitop :: s -&gt; Leftmost s f h
</span><a href="#local-6989586621679461762"><span class="hs-identifier hs-var hs-var">splitop</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SplitType
</span><a href="#local-6989586621679461761"><span class="hs-identifier hs-var">typ</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-804"></span><span>      </span><span class="annot"><span class="annottext">SplitType
</span><a href="Common.html#LeftOfTwo"><span class="hs-identifier hs-var">LeftOfTwo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">s -&gt; Leftmost s f h
forall s f h. s -&gt; Leftmost s f h
</span><a href="Common.html#LMSplitLeft"><span class="hs-identifier hs-var">LMSplitLeft</span></a></span><span>
</span><span id="line-805"></span><span>      </span><span class="annot"><span class="annottext">SplitType
</span><a href="Common.html#SingleOfOne"><span class="hs-identifier hs-var">SingleOfOne</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">s -&gt; Leftmost s f h
forall s f h. s -&gt; Leftmost s f h
</span><a href="Common.html#LMSplitOnly"><span class="hs-identifier hs-var">LMSplitOnly</span></a></span><span>
</span><span id="line-806"></span><span>      </span><span class="annot"><span class="annottext">SplitType
</span><a href="Common.html#RightOfTwo"><span class="hs-identifier hs-var">RightOfTwo</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">s -&gt; Leftmost s f h
forall s f h. s -&gt; Leftmost s f h
</span><a href="Common.html#LMSplitRight"><span class="hs-identifier hs-var">LMSplitRight</span></a></span><span>
</span><span id="line-807"></span><span>  </span><span id="local-6989586621679461742"><span class="annot"><span class="annottext">uf' :: StartStop slc
-&gt; Maybe tr' -&gt; StartStop slc -&gt; Bool -&gt; [(tr, Leftmost s f h)]
</span><a href="#local-6989586621679461742"><span class="hs-identifier hs-var hs-var">uf'</span></a></span></span><span> </span><span id="local-6989586621679461764"><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679461764"><span class="hs-identifier hs-var">sl</span></a></span></span><span> </span><span id="local-6989586621679461765"><span class="annot"><span class="annottext">Maybe tr'
</span><a href="#local-6989586621679461765"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span id="local-6989586621679461766"><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679461766"><span class="hs-identifier hs-var">sr</span></a></span></span><span> </span><span id="local-6989586621679461767"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679461767"><span class="hs-identifier hs-var">isLast</span></a></span></span><span>
</span><span id="line-808"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679461767"><span class="hs-identifier hs-var">isLast</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(f -&gt; Leftmost s f h) -&gt; [(tr, f)] -&gt; [(tr, Leftmost s f h)]
forall {f :: * -&gt; *} {p :: * -&gt; * -&gt; *} {b} {c} {a}.
(Functor f, Bifunctor p) =&gt;
(b -&gt; c) -&gt; f (p a b) -&gt; f (p a c)
</span><a href="#local-6989586621679461750"><span class="hs-identifier hs-var">smap</span></a></span><span> </span><span class="annot"><span class="annottext">f -&gt; Leftmost s f h
forall f s h. f -&gt; Leftmost s f h
</span><a href="Common.html#LMFreezeOnly"><span class="hs-identifier hs-var">LMFreezeOnly</span></a></span><span> </span><span class="annot"><span class="annottext">[(tr, f)]
</span><a href="#local-6989586621679461768"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-809"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(f -&gt; Leftmost s f h) -&gt; [(tr, f)] -&gt; [(tr, Leftmost s f h)]
forall {f :: * -&gt; *} {p :: * -&gt; * -&gt; *} {b} {c} {a}.
(Functor f, Bifunctor p) =&gt;
(b -&gt; c) -&gt; f (p a b) -&gt; f (p a c)
</span><a href="#local-6989586621679461750"><span class="hs-identifier hs-var">smap</span></a></span><span> </span><span class="annot"><span class="annottext">f -&gt; Leftmost s f h
forall f s h. f -&gt; Leftmost s f h
</span><a href="Common.html#LMFreezeLeft"><span class="hs-identifier hs-var">LMFreezeLeft</span></a></span><span> </span><span class="annot"><span class="annottext">[(tr, f)]
</span><a href="#local-6989586621679461768"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-810"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-811"></span><span>    </span><span id="local-6989586621679461768"><span class="annot"><span class="annottext">res :: [(tr, f)]
</span><a href="#local-6989586621679461768"><span class="hs-identifier hs-var hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StartStop slc -&gt; Maybe tr' -&gt; StartStop slc -&gt; [(tr, f)]
</span><a href="#local-6989586621679461739"><span class="hs-identifier hs-var">uf</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679461764"><span class="hs-identifier hs-var">sl</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe tr'
</span><a href="#local-6989586621679461765"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">StartStop slc
</span><a href="#local-6989586621679461766"><span class="hs-identifier hs-var">sr</span></a></span><span>
</span><span id="line-812"></span><span>
</span><span id="line-813"></span><span class="hs-comment">-- manually constructing derivations</span><span>
</span><span id="line-814"></span><span class="hs-comment">-- =================================</span><span>
</span><span id="line-815"></span><span>
</span><span id="line-816"></span><span class="annot"><span class="hs-comment">{- $monadicdoc

 Use these functions to manually build a derivation,
 checking leftmost-correctness in the type.
 A good way to do this is to start a derivation using `buildDerivation` or `buildPartialDerivation`
 and follow up with a @do@ block that contains a sequence of `split`,
 `freeze`, `splitRight` and `spread` actions..

 &gt; deriv :: [Leftmost () () ()] -- using unit for each operation type
 &gt; deriv = buildDerivation $ do -- start with 1 transition
 &gt;   split ()      -- (2 open transitions)
 &gt;   splitRight () -- (3 open)
 &gt;   spread ()     -- (4 open)
 &gt;   freeze ()     -- (3 open)
 &gt;   split ()      -- (4 open)
 &gt;   freeze ()     -- (3 open)
 &gt;   freeze ()     -- (2 open)
 &gt;   freeze ()     -- (1 open)
 &gt;   freeze ()     -- (0 open, end of derivation)

 The above example results in the following derivation graph:

 ![derivation of the above example](doc-images/monadic-deriv.svg)

 Since 'PartialDerivation' is an indexed monad
 (it's exact type changes between actions),
 using do-notation requires you to rebind its syntax to use indexed versions of '&gt;&gt;=' and '&gt;&gt;'
 using the @QualifiedDo@ extension.
 The easiest way to do use the generic operators from &quot;Language.Haskell.DoNotation&quot;
 by using this module as the @do@ qualifier:

 &gt; import qualified Language.Haskell.DoNotation as Do
 &gt;
 &gt; deriv = buildDerivation $ Do.do -- requires -XQualifiedDo
 &gt;   split ()
 &gt;   ...
-}</span></span><span>
</span><span id="line-853"></span><span>
</span><span id="line-854"></span><span class="annot"><span class="hs-comment">{- | A wrapper around leftmost derivations
 that tracks information about the derivation state in the type.
 Number of open transitions: @openTrans@.
 Whether a right split has been performed at the current point: @afterRightSplit@.
-}</span></span><span>
</span><span id="line-859"></span><span class="hs-keyword">newtype</span><span> </span><span id="PartialDerivation"><span class="annot"><a href="Common.html#PartialDerivation"><span class="hs-identifier hs-var">PartialDerivation</span></a></span></span><span> </span><span id="local-6989586621679459307"><span class="annot"><a href="#local-6989586621679459307"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679459308"><span class="annot"><a href="#local-6989586621679459308"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679459309"><span class="annot"><a href="#local-6989586621679459309"><span class="hs-identifier hs-type">h</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679459310"><span class="annot"><a href="#local-6989586621679459310"><span class="hs-identifier hs-type">openTrans</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679459311"><span class="annot"><a href="#local-6989586621679459311"><span class="hs-identifier hs-type">afterRightSplit</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PD"><span class="annot"><a href="Common.html#PD"><span class="hs-identifier hs-var">PD</span></a></span></span><span> </span><span class="hs-special">{</span><span id="runPD"><span class="annot"><span class="annottext">forall s f h (openTrans :: Nat) (afterRightSplit :: Bool).
PartialDerivation s f h openTrans afterRightSplit
-&gt; [Leftmost s f h]
</span><a href="Common.html#runPD"><span class="hs-identifier hs-var hs-var">runPD</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Common.html#Leftmost"><span class="hs-identifier hs-type">Leftmost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459307"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459308"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459309"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">]</span><span class="hs-special">}</span><span>
</span><span id="line-860"></span><span>
</span><span id="line-861"></span><span class="annot"><span class="hs-comment">{- | An &quot;indexed&quot; version of a writer monad, i.e. one where the monad type between two steps can change.
 This can be used for tracking the number of open transitions in a derivation on the type level
 while still providing an monadic interface for constructing a derivation.
-}</span></span><span>
</span><span id="line-865"></span><span class="hs-keyword">newtype</span><span> </span><span id="IndexedWriter"><span class="annot"><a href="Common.html#IndexedWriter"><span class="hs-identifier hs-var">IndexedWriter</span></a></span></span><span> </span><span id="local-6989586621679459320"><span class="annot"><a href="#local-6989586621679459320"><span class="hs-identifier hs-type">w</span></a></span></span><span> </span><span id="local-6989586621679459321"><span class="annot"><a href="#local-6989586621679459321"><span class="hs-identifier hs-type">i</span></a></span></span><span> </span><span id="local-6989586621679459322"><span class="annot"><a href="#local-6989586621679459322"><span class="hs-identifier hs-type">j</span></a></span></span><span> </span><span id="local-6989586621679459323"><span class="annot"><a href="#local-6989586621679459323"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="IW"><span class="annot"><a href="Common.html#IW"><span class="hs-identifier hs-var">IW</span></a></span></span><span> </span><span class="hs-special">{</span><span id="runIW"><span class="annot"><span class="annottext">forall {k} {k} w (i :: k) (j :: k) a.
IndexedWriter w i j a -&gt; Writer w a
</span><a href="Common.html#runIW"><span class="hs-identifier hs-var hs-var">runIW</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MW.Writer</span></span><span> </span><span class="annot"><a href="#local-6989586621679459320"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459323"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-866"></span><span>
</span><span id="line-867"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679459345"><span class="annot"><span class="hs-identifier hs-type">MI.IxFunctor</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#IndexedWriter"><span class="hs-identifier hs-type">IndexedWriter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459345"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-868"></span><span>  </span><span id="local-6989586621679461780"><span class="annot"><span class="annottext">imap :: forall a b (j :: k) (k2 :: k1).
(a -&gt; b) -&gt; IndexedWriter w j k2 a -&gt; IndexedWriter w j k2 b
</span><a href="#local-6989586621679461780"><span class="hs-identifier hs-var hs-var hs-var">imap</span></a></span></span><span> </span><span id="local-6989586621679461782"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679461782"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#IW"><span class="hs-identifier hs-type">IW</span></a></span><span> </span><span id="local-6989586621679461783"><span class="annot"><span class="annottext">Writer w a
</span><a href="#local-6989586621679461783"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Writer w b -&gt; IndexedWriter w j k2 b
forall {k} {k} w (i :: k) (j :: k) a.
Writer w a -&gt; IndexedWriter w i j a
</span><a href="Common.html#IW"><span class="hs-identifier hs-var">IW</span></a></span><span> </span><span class="annot"><span class="annottext">(Writer w b -&gt; IndexedWriter w j k2 b)
-&gt; Writer w b -&gt; IndexedWriter w j k2 b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679461782"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; Writer w a -&gt; Writer w b
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Writer w a
</span><a href="#local-6989586621679461783"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-869"></span><span>
</span><span id="line-870"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679459361"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679459361"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MI.IxPointed</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#IndexedWriter"><span class="hs-identifier hs-type">IndexedWriter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459361"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-871"></span><span>  </span><span id="local-6989586621679461794"><span class="annot"><span class="annottext">ireturn :: forall a (i :: k). a -&gt; IndexedWriter w i i a
</span><a href="#local-6989586621679461794"><span class="hs-identifier hs-var hs-var hs-var">ireturn</span></a></span></span><span> </span><span id="local-6989586621679461796"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679461796"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Writer w a -&gt; IndexedWriter w i i a
forall {k} {k} w (i :: k) (j :: k) a.
Writer w a -&gt; IndexedWriter w i j a
</span><a href="Common.html#IW"><span class="hs-identifier hs-var">IW</span></a></span><span> </span><span class="annot"><span class="annottext">(Writer w a -&gt; IndexedWriter w i i a)
-&gt; Writer w a -&gt; IndexedWriter w i i a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Writer w a
forall a. a -&gt; WriterT w Identity a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679461796"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-872"></span><span>
</span><span id="line-873"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679459378"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679459378"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MI.IxApplicative</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#IndexedWriter"><span class="hs-identifier hs-type">IndexedWriter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459378"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-874"></span><span>  </span><span id="local-6989586621679461807"><span class="annot"><span class="annottext">iap :: forall (i :: k) (j :: k) a b (k1 :: k).
IndexedWriter w i j (a -&gt; b)
-&gt; IndexedWriter w j k1 a -&gt; IndexedWriter w i k1 b
</span><a href="#local-6989586621679461807"><span class="hs-identifier hs-var hs-var hs-var">iap</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#IW"><span class="hs-identifier hs-type">IW</span></a></span><span> </span><span id="local-6989586621679461809"><span class="annot"><span class="annottext">Writer w (a -&gt; b)
</span><a href="#local-6989586621679461809"><span class="hs-identifier hs-var">wf</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#IW"><span class="hs-identifier hs-type">IW</span></a></span><span> </span><span id="local-6989586621679461810"><span class="annot"><span class="annottext">Writer w a
</span><a href="#local-6989586621679461810"><span class="hs-identifier hs-var">wa</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Writer w b -&gt; IndexedWriter w i k1 b
forall {k} {k} w (i :: k) (j :: k) a.
Writer w a -&gt; IndexedWriter w i j a
</span><a href="Common.html#IW"><span class="hs-identifier hs-var">IW</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Writer w (a -&gt; b)
</span><a href="#local-6989586621679461809"><span class="hs-identifier hs-var">wf</span></a></span><span> </span><span class="annot"><span class="annottext">Writer w (a -&gt; b) -&gt; Writer w a -&gt; Writer w b
forall a b.
WriterT w Identity (a -&gt; b)
-&gt; WriterT w Identity a -&gt; WriterT w Identity b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Writer w a
</span><a href="#local-6989586621679461810"><span class="hs-identifier hs-var">wa</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-875"></span><span>
</span><span id="line-876"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679459399"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679459399"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MI.IxMonad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#IndexedWriter"><span class="hs-identifier hs-type">IndexedWriter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459399"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-877"></span><span>  </span><span id="local-6989586621679461819"><span class="annot"><span class="annottext">ibind :: forall a (j :: k) (k1 :: k) b (i :: k).
(a -&gt; IndexedWriter w j k1 b)
-&gt; IndexedWriter w i j a -&gt; IndexedWriter w i k1 b
</span><a href="#local-6989586621679461819"><span class="hs-identifier hs-var hs-var hs-var">ibind</span></a></span></span><span> </span><span id="local-6989586621679461821"><span class="annot"><span class="annottext">a -&gt; IndexedWriter w j k1 b
</span><a href="#local-6989586621679461821"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#IW"><span class="hs-identifier hs-type">IW</span></a></span><span> </span><span id="local-6989586621679461822"><span class="annot"><span class="annottext">Writer w a
</span><a href="#local-6989586621679461822"><span class="hs-identifier hs-var">wa</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Writer w b -&gt; IndexedWriter w i k1 b
forall {k} {k} w (i :: k) (j :: k) a.
Writer w a -&gt; IndexedWriter w i j a
</span><a href="Common.html#IW"><span class="hs-identifier hs-var">IW</span></a></span><span> </span><span class="annot"><span class="annottext">(Writer w b -&gt; IndexedWriter w i k1 b)
-&gt; Writer w b -&gt; IndexedWriter w i k1 b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">IndexedWriter w j k1 b -&gt; Writer w b
forall {k} {k} w (i :: k) (j :: k) a.
IndexedWriter w i j a -&gt; Writer w a
</span><a href="Common.html#runIW"><span class="hs-identifier hs-var">runIW</span></a></span><span> </span><span class="annot"><span class="annottext">(IndexedWriter w j k1 b -&gt; Writer w b)
-&gt; (a -&gt; IndexedWriter w j k1 b) -&gt; a -&gt; Writer w b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; IndexedWriter w j k1 b
</span><a href="#local-6989586621679461821"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Writer w b) -&gt; Writer w a -&gt; Writer w b
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><span class="hs-operator hs-var">=&lt;&lt;</span></span><span> </span><span class="annot"><span class="annottext">Writer w a
</span><a href="#local-6989586621679461822"><span class="hs-identifier hs-var">wa</span></a></span><span>
</span><span id="line-878"></span><span>
</span><span id="line-879"></span><span class="annot"><span class="hs-comment">-- | 'MW.tell' for 'IndexedWriter'.</span></span><span>
</span><span id="line-880"></span><span id="local-6989586621679459411"><span id="local-6989586621679459412"><span id="local-6989586621679459413"><span class="annot"><a href="Common.html#itell"><span class="hs-identifier hs-type">itell</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679459411"><span class="hs-identifier hs-type">w</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679459411"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#IndexedWriter"><span class="hs-identifier hs-type">IndexedWriter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459411"><span class="hs-identifier hs-type">w</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459412"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459413"><span class="hs-identifier hs-type">j</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-881"></span><span id="itell"><span class="annot"><span class="annottext">itell :: forall {k} {k} w (i :: k) (j :: k).
Monoid w =&gt;
w -&gt; IndexedWriter w i j ()
</span><a href="Common.html#itell"><span class="hs-identifier hs-var hs-var">itell</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Writer w () -&gt; IndexedWriter w i j ()
forall {k} {k} w (i :: k) (j :: k) a.
Writer w a -&gt; IndexedWriter w i j a
</span><a href="Common.html#IW"><span class="hs-identifier hs-var">IW</span></a></span><span> </span><span class="annot"><span class="annottext">(Writer w () -&gt; IndexedWriter w i j ())
-&gt; (w -&gt; Writer w ()) -&gt; w -&gt; IndexedWriter w i j ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">w -&gt; Writer w ()
forall w (m :: * -&gt; *). MonadWriter w m =&gt; w -&gt; m ()
</span><span class="hs-identifier hs-var">MW.tell</span></span><span>
</span><span id="line-882"></span><span>
</span><span id="line-883"></span><span class="annot"><span class="hs-comment">{- | A type-level wrapper for partial derivation info.
 Encodes the number of open transitions
 and whether the last operation was a right split.
-}</span></span><span>
</span><span id="line-887"></span><span class="hs-keyword">type</span><span> </span><span class="annot"><a href="Common.html#DerivationInfo"><span class="hs-identifier hs-type">DerivationInfo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-888"></span><span class="hs-keyword">data</span><span> </span><span id="DerivationInfo"><span class="annot"><a href="Common.html#DerivationInfo"><span class="hs-identifier hs-var">DerivationInfo</span></a></span></span><span> </span><span id="local-6989586621679461829"><span class="annot"><a href="#local-6989586621679461829"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679461830"><span class="annot"><a href="#local-6989586621679461830"><span class="hs-identifier hs-type">b</span></a></span></span><span>
</span><span id="line-889"></span><span>
</span><span id="line-890"></span><span class="annot"><span class="hs-comment">{- | The type of a monadic derivation action that modifies the derivation state
 (number of open transitions, after right split).
-}</span></span><span>
</span><span id="line-893"></span><span class="hs-keyword">type</span><span> </span><span id="DerivationAction"><span class="annot"><a href="Common.html#DerivationAction"><span class="hs-identifier hs-var">DerivationAction</span></a></span></span><span> </span><span id="local-6989586621679461831"><span class="annot"><a href="#local-6989586621679461831"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679461832"><span class="annot"><a href="#local-6989586621679461832"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679461833"><span class="annot"><a href="#local-6989586621679461833"><span class="hs-identifier hs-type">h</span></a></span></span><span> </span><span id="local-6989586621679461834"><span class="annot"><a href="#local-6989586621679461834"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span id="local-6989586621679461835"><span class="annot"><a href="#local-6989586621679461835"><span class="hs-identifier hs-type">n'</span></a></span></span><span> </span><span id="local-6989586621679461836"><span class="annot"><a href="#local-6989586621679461836"><span class="hs-identifier hs-type">afterRight</span></a></span></span><span> </span><span id="local-6989586621679461837"><span class="annot"><a href="#local-6989586621679461837"><span class="hs-identifier hs-type">afterRight'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-894"></span><span>  </span><span class="annot"><a href="Common.html#IndexedWriter"><span class="hs-identifier hs-type">IndexedWriter</span></a></span><span>
</span><span id="line-895"></span><span>    </span><span class="hs-special">[</span><span class="annot"><a href="Common.html#Leftmost"><span class="hs-identifier hs-type">Leftmost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679461831"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679461832"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679461833"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-896"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#DerivationInfo"><span class="hs-identifier hs-type">DerivationInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679461834"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679461836"><span class="hs-identifier hs-type">afterRight</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-897"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#DerivationInfo"><span class="hs-identifier hs-type">DerivationInfo</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679461835"><span class="hs-identifier hs-type">n'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679461837"><span class="hs-identifier hs-type">afterRight'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-898"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-899"></span><span>
</span><span id="line-900"></span><span class="annot"><span class="hs-comment">{- | Turn a monadically constructed derivation into a proper left-most derivation.
 This function assumes the derivation to start with a single transition.
-}</span></span><span>
</span><span id="line-903"></span><span id="local-6989586621679459424"><span id="local-6989586621679459425"><span id="local-6989586621679459426"><span id="local-6989586621679459427"><span id="local-6989586621679459428"><span class="annot"><a href="Common.html#buildDerivation"><span class="hs-identifier hs-type">buildDerivation</span></a></span><span>
</span><span id="line-904"></span><span>  </span><span class="hs-comment">-- :: (PartialDeriv s f h 1 False -&gt; PartialDeriv s f h n snd)</span><span>
</span><span id="line-905"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Common.html#DerivationAction"><span class="hs-identifier hs-type">DerivationAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459424"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459425"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459426"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><a href="#local-6989586621679459427"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span> </span><span class="annot"><a href="#local-6989586621679459428"><span class="hs-identifier hs-type">snd</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Common.html#Leftmost"><span class="hs-identifier hs-type">Leftmost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459424"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459425"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459426"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">]</span></span></span></span></span></span><span>
</span><span id="line-906"></span><span id="buildDerivation"><span class="annot"><span class="annottext">buildDerivation :: forall s f h (n :: Nat) (snd :: Bool).
DerivationAction s f h 1 n 'False snd -&gt; [Leftmost s f h]
</span><a href="Common.html#buildDerivation"><span class="hs-identifier hs-var hs-var">buildDerivation</span></a></span></span><span> </span><span id="local-6989586621679461838"><span class="annot"><span class="annottext">DerivationAction s f h 1 n 'False snd
</span><a href="#local-6989586621679461838"><span class="hs-identifier hs-var">build</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Writer [Leftmost s f h] () -&gt; [Leftmost s f h]
forall w a. Writer w a -&gt; w
</span><span class="hs-identifier hs-var">MW.execWriter</span></span><span> </span><span class="annot"><span class="annottext">(Writer [Leftmost s f h] () -&gt; [Leftmost s f h])
-&gt; Writer [Leftmost s f h] () -&gt; [Leftmost s f h]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DerivationAction s f h 1 n 'False snd -&gt; Writer [Leftmost s f h] ()
forall {k} {k} w (i :: k) (j :: k) a.
IndexedWriter w i j a -&gt; Writer w a
</span><a href="Common.html#runIW"><span class="hs-identifier hs-var">runIW</span></a></span><span> </span><span class="annot"><span class="annottext">DerivationAction s f h 1 n 'False snd
</span><a href="#local-6989586621679461838"><span class="hs-identifier hs-var">build</span></a></span><span>
</span><span id="line-907"></span><span>
</span><span id="line-908"></span><span class="annot"><span class="hs-comment">{- | Turn a monadically constructed partial derivation into a left-most derivation.
 This function does not restrict the number of transitions in the starting configuration.
-}</span></span><span>
</span><span id="line-911"></span><span class="annot"><a href="Common.html#buildPartialDerivation"><span class="hs-identifier hs-type">buildPartialDerivation</span></a></span><span>
</span><span id="line-912"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679459440"><span class="annot"><a href="#local-6989586621679459440"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span id="local-6989586621679459441"><span class="annot"><a href="#local-6989586621679459441"><span class="hs-identifier hs-type">n'</span></a></span></span><span> </span><span id="local-6989586621679459442"><span class="annot"><a href="#local-6989586621679459442"><span class="hs-identifier hs-type">snd</span></a></span></span><span> </span><span id="local-6989586621679459437"><span class="annot"><a href="#local-6989586621679459437"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679459438"><span class="annot"><a href="#local-6989586621679459438"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679459439"><span class="annot"><a href="#local-6989586621679459439"><span class="hs-identifier hs-type">h</span></a></span></span><span>
</span><span id="line-913"></span><span>   </span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="Common.html#DerivationAction"><span class="hs-identifier hs-type">DerivationAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459437"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459438"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459439"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459440"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459441"><span class="hs-identifier hs-type">n'</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span> </span><span class="annot"><a href="#local-6989586621679459442"><span class="hs-identifier hs-type">snd</span></a></span><span>
</span><span id="line-914"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Common.html#Leftmost"><span class="hs-identifier hs-type">Leftmost</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459437"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459438"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459439"><span class="hs-identifier hs-type">h</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-915"></span><span id="buildPartialDerivation"><span class="annot"><span class="annottext">buildPartialDerivation :: forall (n :: Nat) (n' :: Nat) (snd :: Bool) s f h.
DerivationAction s f h n n' 'False snd -&gt; [Leftmost s f h]
</span><a href="Common.html#buildPartialDerivation"><span class="hs-identifier hs-var hs-var">buildPartialDerivation</span></a></span></span><span> </span><span id="local-6989586621679461840"><span class="annot"><span class="annottext">DerivationAction s f h n n' 'False snd
</span><a href="#local-6989586621679461840"><span class="hs-identifier hs-var">build</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Writer [Leftmost s f h] () -&gt; [Leftmost s f h]
forall w a. Writer w a -&gt; w
</span><span class="hs-identifier hs-var">MW.execWriter</span></span><span> </span><span class="annot"><span class="annottext">(Writer [Leftmost s f h] () -&gt; [Leftmost s f h])
-&gt; Writer [Leftmost s f h] () -&gt; [Leftmost s f h]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">DerivationAction s f h n n' 'False snd
-&gt; Writer [Leftmost s f h] ()
forall {k} {k} w (i :: k) (j :: k) a.
IndexedWriter w i j a -&gt; Writer w a
</span><a href="Common.html#runIW"><span class="hs-identifier hs-var">runIW</span></a></span><span> </span><span class="annot"><span class="annottext">DerivationAction s f h n n' 'False snd
</span><a href="#local-6989586621679461840"><span class="hs-identifier hs-var">build</span></a></span><span>
</span><span id="line-916"></span><span>
</span><span id="line-917"></span><span class="annot"><span class="hs-comment">-- | Turn a split operation into a monadic (left or single) split action.</span></span><span>
</span><span id="line-918"></span><span class="annot"><a href="Common.html#split"><span class="hs-identifier hs-type">split</span></a></span><span>
</span><span id="line-919"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679459449"><span class="annot"><a href="#local-6989586621679459449"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span id="local-6989586621679459451"><span class="annot"><a href="#local-6989586621679459451"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679459452"><span class="annot"><a href="#local-6989586621679459452"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679459453"><span class="annot"><a href="#local-6989586621679459453"><span class="hs-identifier hs-type">h</span></a></span></span><span>
</span><span id="line-920"></span><span>   </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679459449"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;=</span></span><span> </span><span class="annot"><a href="#local-6989586621679459449"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-921"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679459451"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-922"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#DerivationAction"><span class="hs-identifier hs-type">DerivationAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459451"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459452"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459453"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459449"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679459449"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span>
</span><span id="line-923"></span><span id="split"><span class="annot"><span class="annottext">split :: forall (n :: Nat) s f h.
(KnownNat n, 1 &lt;= n) =&gt;
s -&gt; DerivationAction s f h n (n + 1) 'False 'False
</span><a href="Common.html#split"><span class="hs-identifier hs-var hs-var">split</span></a></span></span><span> </span><span id="local-6989586621679461851"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679461851"><span class="hs-identifier hs-var">s</span></a></span></span><span>
</span><span id="line-924"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Proxy n -&gt; Nat
forall (n :: Nat) (proxy :: Nat -&gt; *). KnownNat n =&gt; proxy n -&gt; Nat
</span><span class="hs-identifier hs-var">natVal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy n
forall {k} (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679459449"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Nat -&gt; Nat -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Leftmost s f h]
-&gt; IndexedWriter
     [Leftmost s f h]
     (DerivationInfo n 'False)
     (DerivationInfo (n + 1) 'False)
     ()
forall {k} {k} w (i :: k) (j :: k).
Monoid w =&gt;
w -&gt; IndexedWriter w i j ()
</span><a href="Common.html#itell"><span class="hs-identifier hs-var">itell</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">s -&gt; Leftmost s f h
forall s f h. s -&gt; Leftmost s f h
</span><a href="Common.html#LMSplitOnly"><span class="hs-identifier hs-var">LMSplitOnly</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679461851"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-925"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Leftmost s f h]
-&gt; IndexedWriter
     [Leftmost s f h]
     (DerivationInfo n 'False)
     (DerivationInfo (n + 1) 'False)
     ()
forall {k} {k} w (i :: k) (j :: k).
Monoid w =&gt;
w -&gt; IndexedWriter w i j ()
</span><a href="Common.html#itell"><span class="hs-identifier hs-var">itell</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">s -&gt; Leftmost s f h
forall s f h. s -&gt; Leftmost s f h
</span><a href="Common.html#LMSplitLeft"><span class="hs-identifier hs-var">LMSplitLeft</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679461851"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-926"></span><span>
</span><span id="line-927"></span><span class="annot"><span class="hs-comment">-- | Turn a freeze operation into a monadic (left or single) freeze action.</span></span><span>
</span><span id="line-928"></span><span class="annot"><a href="Common.html#freeze"><span class="hs-identifier hs-type">freeze</span></a></span><span>
</span><span id="line-929"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679459465"><span class="annot"><a href="#local-6989586621679459465"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span id="local-6989586621679459467"><span class="annot"><a href="#local-6989586621679459467"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679459468"><span class="annot"><a href="#local-6989586621679459468"><span class="hs-identifier hs-type">h</span></a></span></span><span> </span><span id="local-6989586621679459466"><span class="annot"><a href="#local-6989586621679459466"><span class="hs-identifier hs-type">f</span></a></span></span><span>
</span><span id="line-930"></span><span>   </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679459465"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;=</span></span><span> </span><span class="annot"><a href="#local-6989586621679459465"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-931"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679459466"><span class="hs-identifier hs-type">f</span></a></span><span>
</span><span id="line-932"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#DerivationAction"><span class="hs-identifier hs-type">DerivationAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459467"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459466"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459468"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459465"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679459465"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">False</span></span><span>
</span><span id="line-933"></span><span id="freeze"><span class="annot"><span class="annottext">freeze :: forall (n :: Nat) s h f.
(KnownNat n, 1 &lt;= n) =&gt;
f -&gt; DerivationAction s f h n (n - 1) 'False 'False
</span><a href="Common.html#freeze"><span class="hs-identifier hs-var hs-var">freeze</span></a></span></span><span> </span><span id="local-6989586621679461859"><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621679461859"><span class="hs-identifier hs-var">f</span></a></span></span><span>
</span><span id="line-934"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Proxy n -&gt; Nat
forall (n :: Nat) (proxy :: Nat -&gt; *). KnownNat n =&gt; proxy n -&gt; Nat
</span><span class="hs-identifier hs-var">natVal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy n
forall {k} (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679459465"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Nat -&gt; Nat -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Nat
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Leftmost s f h]
-&gt; IndexedWriter
     [Leftmost s f h]
     (DerivationInfo n 'False)
     (DerivationInfo (n - 1) 'False)
     ()
forall {k} {k} w (i :: k) (j :: k).
Monoid w =&gt;
w -&gt; IndexedWriter w i j ()
</span><a href="Common.html#itell"><span class="hs-identifier hs-var">itell</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">f -&gt; Leftmost s f h
forall f s h. f -&gt; Leftmost s f h
</span><a href="Common.html#LMFreezeOnly"><span class="hs-identifier hs-var">LMFreezeOnly</span></a></span><span> </span><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621679461859"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-935"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Leftmost s f h]
-&gt; IndexedWriter
     [Leftmost s f h]
     (DerivationInfo n 'False)
     (DerivationInfo (n - 1) 'False)
     ()
forall {k} {k} w (i :: k) (j :: k).
Monoid w =&gt;
w -&gt; IndexedWriter w i j ()
</span><a href="Common.html#itell"><span class="hs-identifier hs-var">itell</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">f -&gt; Leftmost s f h
forall f s h. f -&gt; Leftmost s f h
</span><a href="Common.html#LMFreezeLeft"><span class="hs-identifier hs-var">LMFreezeLeft</span></a></span><span> </span><span class="annot"><span class="annottext">f
</span><a href="#local-6989586621679461859"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-936"></span><span>
</span><span id="line-937"></span><span class="annot"><span class="hs-comment">-- | Turn a split operation into a monadic right-split action.</span></span><span>
</span><span id="line-938"></span><span id="local-6989586621679459473"><span id="local-6989586621679459474"><span id="local-6989586621679459475"><span id="local-6989586621679459476"><span id="local-6989586621679459477"><span class="annot"><a href="Common.html#splitRight"><span class="hs-identifier hs-type">splitRight</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;=</span></span><span> </span><span class="annot"><a href="#local-6989586621679459473"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679459474"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#DerivationAction"><span class="hs-identifier hs-type">DerivationAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459474"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459475"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459476"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459473"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679459473"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679459477"><span class="hs-identifier hs-type">snd</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">True</span></span></span></span></span></span></span><span>
</span><span id="line-939"></span><span id="splitRight"><span class="annot"><span class="annottext">splitRight :: forall (n :: Nat) s f h (snd :: Bool).
(2 &lt;= n) =&gt;
s -&gt; DerivationAction s f h n (n + 1) snd 'True
</span><a href="Common.html#splitRight"><span class="hs-identifier hs-var hs-var">splitRight</span></a></span></span><span> </span><span id="local-6989586621679461862"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679461862"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Leftmost s f h]
-&gt; IndexedWriter
     [Leftmost s f h]
     (DerivationInfo n snd)
     (DerivationInfo (n + 1) 'True)
     ()
forall {k} {k} w (i :: k) (j :: k).
Monoid w =&gt;
w -&gt; IndexedWriter w i j ()
</span><a href="Common.html#itell"><span class="hs-identifier hs-var">itell</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">s -&gt; Leftmost s f h
forall s f h. s -&gt; Leftmost s f h
</span><a href="Common.html#LMSplitRight"><span class="hs-identifier hs-var">LMSplitRight</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679461862"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-940"></span><span>
</span><span id="line-941"></span><span class="annot"><span class="hs-comment">-- | Turn a spread operation into a monadic spread action.</span></span><span>
</span><span id="line-942"></span><span id="local-6989586621679459483"><span id="local-6989586621679459484"><span id="local-6989586621679459485"><span id="local-6989586621679459486"><span id="local-6989586621679459487"><span class="annot"><a href="Common.html#spread"><span class="hs-identifier hs-type">spread</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;=</span></span><span> </span><span class="annot"><a href="#local-6989586621679459483"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679459484"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#DerivationAction"><span class="hs-identifier hs-type">DerivationAction</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459485"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459486"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459484"><span class="hs-identifier hs-type">h</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459483"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679459483"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679459487"><span class="hs-identifier hs-type">snd</span></a></span><span> </span><span class="hs-special">'</span><span class="annot"><span class="hs-identifier hs-type">False</span></span></span></span></span></span></span><span>
</span><span id="line-943"></span><span id="spread"><span class="annot"><span class="annottext">spread :: forall (n :: Nat) h s f (snd :: Bool).
(2 &lt;= n) =&gt;
h -&gt; DerivationAction s f h n (n + 1) snd 'False
</span><a href="Common.html#spread"><span class="hs-identifier hs-var hs-var">spread</span></a></span></span><span> </span><span id="local-6989586621679461865"><span class="annot"><span class="annottext">h
</span><a href="#local-6989586621679461865"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Leftmost s f h]
-&gt; IndexedWriter
     [Leftmost s f h]
     (DerivationInfo n snd)
     (DerivationInfo (n + 1) 'False)
     ()
forall {k} {k} w (i :: k) (j :: k).
Monoid w =&gt;
w -&gt; IndexedWriter w i j ()
</span><a href="Common.html#itell"><span class="hs-identifier hs-var">itell</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">h -&gt; Leftmost s f h
forall h s f. h -&gt; Leftmost s f h
</span><a href="Common.html#LMSpread"><span class="hs-identifier hs-var">LMSpread</span></a></span><span> </span><span class="annot"><span class="annottext">h
</span><a href="#local-6989586621679461865"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-944"></span><span>
</span><span id="line-945"></span><span class="hs-comment">-- useful semirings</span><span>
</span><span id="line-946"></span><span class="hs-comment">-- ================</span><span>
</span><span id="line-947"></span><span>
</span><span id="line-948"></span><span class="annot"><span class="hs-comment">{- | The derivations semiring.
 Similar to a free semiring, encodes sequences, alternatives, and neutral values directly.
 However, semiring equivalences are not idendified by default.
-}</span></span><span>
</span><span id="line-952"></span><span class="hs-keyword">data</span><span> </span><span id="Derivations"><span class="annot"><a href="Common.html#Derivations"><span class="hs-identifier hs-var">Derivations</span></a></span></span><span> </span><span id="local-6989586621679461866"><span class="annot"><a href="#local-6989586621679461866"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-953"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-comment">-- | a single operation</span></span><span>
</span><span id="line-954"></span><span>    </span><span id="Do"><span class="annot"><a href="Common.html#Do"><span class="hs-identifier hs-var">Do</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679461866"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-955"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-comment">-- | combines alternative derivations</span></span><span>
</span><span id="line-956"></span><span>    </span><span id="Or"><span class="annot"><a href="Common.html#Or"><span class="hs-identifier hs-var">Or</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Derivations"><span class="hs-identifier hs-type">Derivations</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679461866"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Derivations"><span class="hs-identifier hs-type">Derivations</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679461866"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-957"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-comment">-- | combines sequential derivations</span></span><span>
</span><span id="line-958"></span><span>    </span><span id="Then"><span class="annot"><a href="Common.html#Then"><span class="hs-identifier hs-var">Then</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Derivations"><span class="hs-identifier hs-type">Derivations</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679461866"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Derivations"><span class="hs-identifier hs-type">Derivations</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679461866"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-959"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-comment">-- | the neutral element to 'Then'</span></span><span>
</span><span id="line-960"></span><span>    </span><span id="NoOp"><span class="annot"><a href="Common.html#NoOp"><span class="hs-identifier hs-var">NoOp</span></a></span></span><span>
</span><span id="line-961"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-comment">-- | the neutral element to 'Or'</span></span><span>
</span><span id="line-962"></span><span>    </span><span id="Cannot"><span class="annot"><a href="Common.html#Cannot"><span class="hs-identifier hs-var">Cannot</span></a></span></span><span>
</span><span id="line-963"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679461874"><span id="local-6989586621679461884"><span class="annot"><span class="annottext">Derivations a -&gt; Derivations a -&gt; Bool
(Derivations a -&gt; Derivations a -&gt; Bool)
-&gt; (Derivations a -&gt; Derivations a -&gt; Bool) -&gt; Eq (Derivations a)
forall a. Eq a =&gt; Derivations a -&gt; Derivations a -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: forall a. Eq a =&gt; Derivations a -&gt; Derivations a -&gt; Bool
== :: Derivations a -&gt; Derivations a -&gt; Bool
$c/= :: forall a. Eq a =&gt; Derivations a -&gt; Derivations a -&gt; Bool
/= :: Derivations a -&gt; Derivations a -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679461891"><span id="local-6989586621679461900"><span id="local-6989586621679461903"><span id="local-6989586621679461906"><span id="local-6989586621679461909"><span id="local-6989586621679461912"><span id="local-6989586621679461915"><span class="annot"><span class="annottext">Eq (Derivations a)
Eq (Derivations a) =&gt;
(Derivations a -&gt; Derivations a -&gt; Ordering)
-&gt; (Derivations a -&gt; Derivations a -&gt; Bool)
-&gt; (Derivations a -&gt; Derivations a -&gt; Bool)
-&gt; (Derivations a -&gt; Derivations a -&gt; Bool)
-&gt; (Derivations a -&gt; Derivations a -&gt; Bool)
-&gt; (Derivations a -&gt; Derivations a -&gt; Derivations a)
-&gt; (Derivations a -&gt; Derivations a -&gt; Derivations a)
-&gt; Ord (Derivations a)
Derivations a -&gt; Derivations a -&gt; Bool
Derivations a -&gt; Derivations a -&gt; Ordering
Derivations a -&gt; Derivations a -&gt; Derivations a
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
forall a. Ord a =&gt; Eq (Derivations a)
forall a. Ord a =&gt; Derivations a -&gt; Derivations a -&gt; Bool
forall a. Ord a =&gt; Derivations a -&gt; Derivations a -&gt; Ordering
forall a. Ord a =&gt; Derivations a -&gt; Derivations a -&gt; Derivations a
$ccompare :: forall a. Ord a =&gt; Derivations a -&gt; Derivations a -&gt; Ordering
compare :: Derivations a -&gt; Derivations a -&gt; Ordering
$c&lt; :: forall a. Ord a =&gt; Derivations a -&gt; Derivations a -&gt; Bool
&lt; :: Derivations a -&gt; Derivations a -&gt; Bool
$c&lt;= :: forall a. Ord a =&gt; Derivations a -&gt; Derivations a -&gt; Bool
&lt;= :: Derivations a -&gt; Derivations a -&gt; Bool
$c&gt; :: forall a. Ord a =&gt; Derivations a -&gt; Derivations a -&gt; Bool
&gt; :: Derivations a -&gt; Derivations a -&gt; Bool
$c&gt;= :: forall a. Ord a =&gt; Derivations a -&gt; Derivations a -&gt; Bool
&gt;= :: Derivations a -&gt; Derivations a -&gt; Bool
$cmax :: forall a. Ord a =&gt; Derivations a -&gt; Derivations a -&gt; Derivations a
max :: Derivations a -&gt; Derivations a -&gt; Derivations a
$cmin :: forall a. Ord a =&gt; Derivations a -&gt; Derivations a -&gt; Derivations a
min :: Derivations a -&gt; Derivations a -&gt; Derivations a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679461918"><span id="local-6989586621679461920"><span class="annot"><span class="annottext">(forall x. Derivations a -&gt; Rep (Derivations a) x)
-&gt; (forall x. Rep (Derivations a) x -&gt; Derivations a)
-&gt; Generic (Derivations a)
forall x. Rep (Derivations a) x -&gt; Derivations a
forall x. Derivations a -&gt; Rep (Derivations a) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall a x. Rep (Derivations a) x -&gt; Derivations a
forall a x. Derivations a -&gt; Rep (Derivations a) x
$cfrom :: forall a x. Derivations a -&gt; Rep (Derivations a) x
from :: forall x. Derivations a -&gt; Rep (Derivations a) x
$cto :: forall a x. Rep (Derivations a) x -&gt; Derivations a
to :: forall x. Rep (Derivations a) x -&gt; Derivations a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-964"></span><span>
</span><span id="line-965"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679459504"><span id="local-6989586621679461924"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="#local-6989586621679459504"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Derivations"><span class="hs-identifier hs-type">Derivations</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459504"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-966"></span><span>
</span><span id="line-967"></span><span class="annot"><span class="hs-comment">-- | A helper tag for pretty-printing derivations.</span></span><span>
</span><span id="line-968"></span><span class="hs-keyword">data</span><span> </span><span id="DerivOp"><span class="annot"><a href="Common.html#DerivOp"><span class="hs-identifier hs-var">DerivOp</span></a></span></span><span>
</span><span id="line-969"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="OpNone"><span class="annot"><a href="Common.html#OpNone"><span class="hs-identifier hs-var">OpNone</span></a></span></span><span>
</span><span id="line-970"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="OpOr"><span class="annot"><a href="Common.html#OpOr"><span class="hs-identifier hs-var">OpOr</span></a></span></span><span>
</span><span id="line-971"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="OpThen"><span class="annot"><a href="Common.html#OpThen"><span class="hs-identifier hs-var">OpThen</span></a></span></span><span>
</span><span id="line-972"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679461951"><span id="local-6989586621679461955"><span class="annot"><span class="annottext">DerivOp -&gt; DerivOp -&gt; Bool
(DerivOp -&gt; DerivOp -&gt; Bool)
-&gt; (DerivOp -&gt; DerivOp -&gt; Bool) -&gt; Eq DerivOp
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: DerivOp -&gt; DerivOp -&gt; Bool
== :: DerivOp -&gt; DerivOp -&gt; Bool
$c/= :: DerivOp -&gt; DerivOp -&gt; Bool
/= :: DerivOp -&gt; DerivOp -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-973"></span><span>
</span><span id="line-974"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679459507"><span id="local-6989586621679461960"><span id="local-6989586621679461965"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679459507"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Derivations"><span class="hs-identifier hs-type">Derivations</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459507"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-975"></span><span>  </span><span id="local-6989586621679461970"><span class="annot"><span class="annottext">show :: Derivations a -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var">show</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; DerivOp -&gt; Derivations a -&gt; String
forall {b} {a}.
(Integral b, Show a) =&gt;
b -&gt; DerivOp -&gt; Derivations a -&gt; String
</span><a href="#local-6989586621679461971"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DerivOp
</span><a href="Common.html#OpNone"><span class="hs-identifier hs-var">OpNone</span></a></span><span>
</span><span id="line-976"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-977"></span><span>    </span><span id="local-6989586621679461995"><span class="annot"><span class="annottext">indent :: b -&gt; a
</span><a href="#local-6989586621679461995"><span class="hs-identifier hs-var hs-var">indent</span></a></span></span><span> </span><span id="local-6989586621679461996"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679461996"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b -&gt; a -&gt; a
forall b a. (Integral b, Monoid a) =&gt; b -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">stimesMonoid</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679461996"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-string">&quot;  &quot;</span></span><span>
</span><span id="line-978"></span><span>    </span><span id="local-6989586621679461971"><span class="annot"><span class="annottext">go :: b -&gt; DerivOp -&gt; Derivations a -&gt; String
</span><a href="#local-6989586621679461971"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679462057"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679462057"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">DerivOp
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Do"><span class="hs-identifier hs-type">Do</span></a></span><span> </span><span id="local-6989586621679462058"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679462058"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b -&gt; String
forall {b} {a}. (Integral b, Monoid a, IsString a) =&gt; b -&gt; a
</span><a href="#local-6989586621679461995"><span class="hs-identifier hs-var">indent</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679462057"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679462058"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-979"></span><span>    </span><span class="annot"><a href="#local-6989586621679461971"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679462059"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679462059"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">DerivOp
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="Common.html#NoOp"><span class="hs-identifier hs-var">NoOp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b -&gt; String
forall {b} {a}. (Integral b, Monoid a, IsString a) =&gt; b -&gt; a
</span><a href="#local-6989586621679461995"><span class="hs-identifier hs-var">indent</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679462059"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;NoOp&quot;</span></span><span>
</span><span id="line-980"></span><span>    </span><span class="annot"><a href="#local-6989586621679461971"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679462060"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679462060"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">DerivOp
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="Common.html#Cannot"><span class="hs-identifier hs-var">Cannot</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b -&gt; String
forall {b} {a}. (Integral b, Monoid a, IsString a) =&gt; b -&gt; a
</span><a href="#local-6989586621679461995"><span class="hs-identifier hs-var">indent</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679462060"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Cannot&quot;</span></span><span>
</span><span id="line-981"></span><span>    </span><span class="annot"><a href="#local-6989586621679461971"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679462061"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679462061"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">DerivOp
</span><a href="Common.html#OpOr"><span class="hs-identifier hs-var">OpOr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Or"><span class="hs-identifier hs-type">Or</span></a></span><span> </span><span id="local-6989586621679462062"><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679462062"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679462063"><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679462063"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b -&gt; DerivOp -&gt; Derivations a -&gt; String
</span><a href="#local-6989586621679461971"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679462061"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">DerivOp
</span><a href="Common.html#OpOr"><span class="hs-identifier hs-var">OpOr</span></a></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679462062"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; DerivOp -&gt; Derivations a -&gt; String
</span><a href="#local-6989586621679461971"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679462061"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">DerivOp
</span><a href="Common.html#OpOr"><span class="hs-identifier hs-var">OpOr</span></a></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679462063"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-982"></span><span>    </span><span class="annot"><a href="#local-6989586621679461971"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679462064"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679462064"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">DerivOp
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Or"><span class="hs-identifier hs-type">Or</span></a></span><span> </span><span id="local-6989586621679462065"><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679462065"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679462066"><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679462066"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-983"></span><span>      </span><span class="annot"><span class="annottext">b -&gt; String
forall {b} {a}. (Integral b, Monoid a, IsString a) =&gt; b -&gt; a
</span><a href="#local-6989586621679461995"><span class="hs-identifier hs-var">indent</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679462064"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Or\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; DerivOp -&gt; Derivations a -&gt; String
</span><a href="#local-6989586621679461971"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679462064"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; b -&gt; b
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DerivOp
</span><a href="Common.html#OpOr"><span class="hs-identifier hs-var">OpOr</span></a></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679462065"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; DerivOp -&gt; Derivations a -&gt; String
</span><a href="#local-6989586621679461971"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679462064"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; b -&gt; b
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DerivOp
</span><a href="Common.html#OpOr"><span class="hs-identifier hs-var">OpOr</span></a></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679462066"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-984"></span><span>    </span><span class="annot"><a href="#local-6989586621679461971"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679462067"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679462067"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">DerivOp
</span><a href="Common.html#OpThen"><span class="hs-identifier hs-var">OpThen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Then"><span class="hs-identifier hs-type">Then</span></a></span><span> </span><span id="local-6989586621679462068"><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679462068"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679462069"><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679462069"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">b -&gt; DerivOp -&gt; Derivations a -&gt; String
</span><a href="#local-6989586621679461971"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679462067"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">DerivOp
</span><a href="Common.html#OpThen"><span class="hs-identifier hs-var">OpThen</span></a></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679462068"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; DerivOp -&gt; Derivations a -&gt; String
</span><a href="#local-6989586621679461971"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679462067"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">DerivOp
</span><a href="Common.html#OpThen"><span class="hs-identifier hs-var">OpThen</span></a></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679462069"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-985"></span><span>    </span><span class="annot"><a href="#local-6989586621679461971"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679462070"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679462070"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="annot"><span class="annottext">DerivOp
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Then"><span class="hs-identifier hs-type">Then</span></a></span><span> </span><span id="local-6989586621679462071"><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679462071"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679462072"><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679462072"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-986"></span><span>      </span><span class="annot"><span class="annottext">b -&gt; String
forall {b} {a}. (Integral b, Monoid a, IsString a) =&gt; b -&gt; a
</span><a href="#local-6989586621679461995"><span class="hs-identifier hs-var">indent</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679462070"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Then\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; DerivOp -&gt; Derivations a -&gt; String
</span><a href="#local-6989586621679461971"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679462070"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; b -&gt; b
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DerivOp
</span><a href="Common.html#OpThen"><span class="hs-identifier hs-var">OpThen</span></a></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679462071"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; DerivOp -&gt; Derivations a -&gt; String
</span><a href="#local-6989586621679461971"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679462070"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; b -&gt; b
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">b
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DerivOp
</span><a href="Common.html#OpThen"><span class="hs-identifier hs-var">OpThen</span></a></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679462072"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-987"></span><span>
</span><span id="line-988"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679459520"><span id="local-6989586621679462078"><span class="annot"><span class="hs-identifier hs-type">R.Semiring</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Derivations"><span class="hs-identifier hs-type">Derivations</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459520"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-989"></span><span>  </span><span id="local-6989586621679462082"><span class="annot"><span class="annottext">zero :: Derivations a
</span><a href="#local-6989586621679462082"><span class="hs-identifier hs-var hs-var hs-var">zero</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Derivations a
forall a. Derivations a
</span><a href="Common.html#Cannot"><span class="hs-identifier hs-var">Cannot</span></a></span><span>
</span><span id="line-990"></span><span>  </span><span id="local-6989586621679462084"><span class="annot"><span class="annottext">one :: Derivations a
</span><a href="#local-6989586621679462084"><span class="hs-identifier hs-var hs-var hs-var">one</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Derivations a
forall a. Derivations a
</span><a href="Common.html#NoOp"><span class="hs-identifier hs-var">NoOp</span></a></span><span>
</span><span id="line-991"></span><span>  </span><span id="local-6989586621679462086"><span class="annot"><span class="annottext">plus :: Derivations a -&gt; Derivations a -&gt; Derivations a
</span><a href="#local-6989586621679462086"><span class="hs-identifier hs-var hs-var hs-var">plus</span></a></span></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="Common.html#Cannot"><span class="hs-identifier hs-var">Cannot</span></a></span><span> </span><span id="local-6989586621679462088"><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679462088"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679462088"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-992"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">plus</span></span><span> </span><span id="local-6989586621679462089"><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679462089"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="Common.html#Cannot"><span class="hs-identifier hs-var">Cannot</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679462089"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-993"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">plus</span></span><span> </span><span id="local-6989586621679462090"><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679462090"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679462091"><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679462091"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Derivations a -&gt; Derivations a -&gt; Derivations a
forall a. Derivations a -&gt; Derivations a -&gt; Derivations a
</span><a href="Common.html#Or"><span class="hs-identifier hs-var">Or</span></a></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679462090"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679462091"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-994"></span><span>  </span><span id="local-6989586621679462092"><span class="annot"><span class="annottext">times :: Derivations a -&gt; Derivations a -&gt; Derivations a
</span><a href="#local-6989586621679462092"><span class="hs-identifier hs-var hs-var hs-var">times</span></a></span></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="Common.html#Cannot"><span class="hs-identifier hs-var">Cannot</span></a></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Derivations a
forall a. Derivations a
</span><a href="Common.html#Cannot"><span class="hs-identifier hs-var">Cannot</span></a></span><span>
</span><span id="line-995"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">times</span></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="Common.html#Cannot"><span class="hs-identifier hs-var">Cannot</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Derivations a
forall a. Derivations a
</span><a href="Common.html#Cannot"><span class="hs-identifier hs-var">Cannot</span></a></span><span>
</span><span id="line-996"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">times</span></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="Common.html#NoOp"><span class="hs-identifier hs-var">NoOp</span></a></span><span> </span><span id="local-6989586621679462094"><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679462094"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679462094"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-997"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">times</span></span><span> </span><span id="local-6989586621679462095"><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679462095"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="Common.html#NoOp"><span class="hs-identifier hs-var">NoOp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679462095"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-998"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">times</span></span><span> </span><span id="local-6989586621679462096"><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679462096"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679462097"><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679462097"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Derivations a -&gt; Derivations a -&gt; Derivations a
forall a. Derivations a -&gt; Derivations a -&gt; Derivations a
</span><a href="Common.html#Then"><span class="hs-identifier hs-var">Then</span></a></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679462096"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679462097"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-999"></span><span>
</span><span id="line-1000"></span><span class="annot"><span class="hs-comment">-- | Map the 'Derivations' semiring to another semiring.</span></span><span>
</span><span id="line-1001"></span><span id="local-6989586621679459521"><span id="local-6989586621679459522"><span class="annot"><a href="Common.html#mapDerivations"><span class="hs-identifier hs-type">mapDerivations</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">R.Semiring</span></span><span> </span><span class="annot"><a href="#local-6989586621679459521"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679459522"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679459521"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Common.html#Derivations"><span class="hs-identifier hs-type">Derivations</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459522"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679459521"><span class="hs-identifier hs-type">r</span></a></span></span></span><span>
</span><span id="line-1002"></span><span id="mapDerivations"><span class="annot"><span class="annottext">mapDerivations :: forall r a. Semiring r =&gt; (a -&gt; r) -&gt; Derivations a -&gt; r
</span><a href="Common.html#mapDerivations"><span class="hs-identifier hs-var hs-var">mapDerivations</span></a></span></span><span> </span><span id="local-6989586621679462107"><span class="annot"><span class="annottext">a -&gt; r
</span><a href="#local-6989586621679462107"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Do"><span class="hs-identifier hs-type">Do</span></a></span><span> </span><span id="local-6989586621679462108"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679462108"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; r
</span><a href="#local-6989586621679462107"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679462108"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-1003"></span><span class="annot"><a href="Common.html#mapDerivations"><span class="hs-identifier hs-var">mapDerivations</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; r
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="Common.html#NoOp"><span class="hs-identifier hs-var">NoOp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r
forall a. Semiring a =&gt; a
</span><span class="hs-identifier hs-var">R.one</span></span><span>
</span><span id="line-1004"></span><span class="annot"><a href="Common.html#mapDerivations"><span class="hs-identifier hs-var">mapDerivations</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; r
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="Common.html#Cannot"><span class="hs-identifier hs-var">Cannot</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">r
forall a. Semiring a =&gt; a
</span><span class="hs-identifier hs-var">R.zero</span></span><span>
</span><span id="line-1005"></span><span class="annot"><a href="Common.html#mapDerivations"><span class="hs-identifier hs-var">mapDerivations</span></a></span><span> </span><span id="local-6989586621679462109"><span class="annot"><span class="annottext">a -&gt; r
</span><a href="#local-6989586621679462109"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Or"><span class="hs-identifier hs-type">Or</span></a></span><span> </span><span id="local-6989586621679462110"><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679462110"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679462111"><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679462111"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; r) -&gt; Derivations a -&gt; r
forall r a. Semiring r =&gt; (a -&gt; r) -&gt; Derivations a -&gt; r
</span><a href="Common.html#mapDerivations"><span class="hs-identifier hs-var">mapDerivations</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; r
</span><a href="#local-6989586621679462109"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679462110"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Semiring a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">R.+</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; r) -&gt; Derivations a -&gt; r
forall r a. Semiring r =&gt; (a -&gt; r) -&gt; Derivations a -&gt; r
</span><a href="Common.html#mapDerivations"><span class="hs-identifier hs-var">mapDerivations</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; r
</span><a href="#local-6989586621679462109"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679462111"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-1006"></span><span class="annot"><a href="Common.html#mapDerivations"><span class="hs-identifier hs-var">mapDerivations</span></a></span><span> </span><span id="local-6989586621679462113"><span class="annot"><span class="annottext">a -&gt; r
</span><a href="#local-6989586621679462113"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Then"><span class="hs-identifier hs-type">Then</span></a></span><span> </span><span id="local-6989586621679462114"><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679462114"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679462115"><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679462115"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; r) -&gt; Derivations a -&gt; r
forall r a. Semiring r =&gt; (a -&gt; r) -&gt; Derivations a -&gt; r
</span><a href="Common.html#mapDerivations"><span class="hs-identifier hs-var">mapDerivations</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; r
</span><a href="#local-6989586621679462113"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679462114"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; r
forall a. Semiring a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">R.*</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; r) -&gt; Derivations a -&gt; r
forall r a. Semiring r =&gt; (a -&gt; r) -&gt; Derivations a -&gt; r
</span><a href="Common.html#mapDerivations"><span class="hs-identifier hs-var">mapDerivations</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; r
</span><a href="#local-6989586621679462113"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679462115"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-1007"></span><span>
</span><span id="line-1008"></span><span class="annot"><span class="hs-comment">-- | Flatten the prefix-tree structure of 'Derivations' into a simple set of derivations.</span></span><span>
</span><span id="line-1009"></span><span id="local-6989586621679459526"><span class="annot"><a href="Common.html#flattenDerivations"><span class="hs-identifier hs-type">flattenDerivations</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679459526"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Common.html#Derivations"><span class="hs-identifier hs-type">Derivations</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459526"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">S.Set</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679459526"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-1010"></span><span id="flattenDerivations"><span class="annot"><span class="annottext">flattenDerivations :: forall a. Ord a =&gt; Derivations a -&gt; Set [a]
</span><a href="Common.html#flattenDerivations"><span class="hs-identifier hs-var hs-var">flattenDerivations</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Set [a]) -&gt; Derivations a -&gt; Set [a]
forall r a. Semiring r =&gt; (a -&gt; r) -&gt; Derivations a -&gt; r
</span><a href="Common.html#mapDerivations"><span class="hs-identifier hs-var">mapDerivations</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679462122"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679462122"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Set [a]
forall a. a -&gt; Set a
</span><span class="hs-identifier hs-var">S.singleton</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679462122"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><span id="line-1011"></span><span>
</span><span id="line-1012"></span><span class="annot"><span class="hs-comment">{- | Flatten the prefix-tree structure of 'Derivations'
 into a simple list of (potentially redundant) derivations.
-}</span></span><span>
</span><span id="line-1015"></span><span id="local-6989586621679459531"><span class="annot"><a href="Common.html#flattenDerivationsRed"><span class="hs-identifier hs-type">flattenDerivationsRed</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679459531"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Common.html#Derivations"><span class="hs-identifier hs-type">Derivations</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459531"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679459531"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span></span><span>
</span><span id="line-1016"></span><span id="flattenDerivationsRed"><span class="annot"><span class="annottext">flattenDerivationsRed :: forall a. Ord a =&gt; Derivations a -&gt; [[a]]
</span><a href="Common.html#flattenDerivationsRed"><span class="hs-identifier hs-var hs-var">flattenDerivationsRed</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Do"><span class="hs-identifier hs-type">Do</span></a></span><span> </span><span id="local-6989586621679462136"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679462136"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [[a]]
forall a. a -&gt; [a]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679462136"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1017"></span><span class="annot"><a href="Common.html#flattenDerivationsRed"><span class="hs-identifier hs-var">flattenDerivationsRed</span></a></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="Common.html#NoOp"><span class="hs-identifier hs-var">NoOp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [[a]]
forall a. a -&gt; [a]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1018"></span><span class="annot"><a href="Common.html#flattenDerivationsRed"><span class="hs-identifier hs-var">flattenDerivationsRed</span></a></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="Common.html#Cannot"><span class="hs-identifier hs-var">Cannot</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1019"></span><span class="annot"><a href="Common.html#flattenDerivationsRed"><span class="hs-identifier hs-var">flattenDerivationsRed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Or"><span class="hs-identifier hs-type">Or</span></a></span><span> </span><span id="local-6989586621679462137"><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679462137"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679462138"><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679462138"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1020"></span><span>  </span><span class="annot"><span class="annottext">Derivations a -&gt; [[a]]
forall a. Ord a =&gt; Derivations a -&gt; [[a]]
</span><a href="Common.html#flattenDerivationsRed"><span class="hs-identifier hs-var">flattenDerivationsRed</span></a></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679462137"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">[[a]] -&gt; [[a]] -&gt; [[a]]
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Derivations a -&gt; [[a]]
forall a. Ord a =&gt; Derivations a -&gt; [[a]]
</span><a href="Common.html#flattenDerivationsRed"><span class="hs-identifier hs-var">flattenDerivationsRed</span></a></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679462138"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-1021"></span><span class="annot"><a href="Common.html#flattenDerivationsRed"><span class="hs-identifier hs-var">flattenDerivationsRed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Then"><span class="hs-identifier hs-type">Then</span></a></span><span> </span><span id="local-6989586621679462139"><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679462139"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679462140"><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679462140"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1022"></span><span>  </span><span id="local-6989586621679462141"><span class="annot"><a href="#local-6989586621679462141"><span class="hs-keyword hs-var">as</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Derivations a -&gt; [[a]]
forall a. Ord a =&gt; Derivations a -&gt; [[a]]
</span><a href="Common.html#flattenDerivationsRed"><span class="hs-identifier hs-var">flattenDerivationsRed</span></a></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679462139"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-1023"></span><span>  </span><span id="local-6989586621679462142"><span class="annot"><a href="#local-6989586621679462142"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Common.html#flattenDerivationsRed"><span class="hs-identifier hs-type">flattenDerivationsRed</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462140"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-1024"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679462141"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621679462142"><span class="hs-identifier hs-type">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1025"></span><span>
</span><span id="line-1026"></span><span class="annot"><span class="hs-comment">-- | Obtain the first derivation from a 'Derivations' tree.</span></span><span>
</span><span id="line-1027"></span><span id="local-6989586621679459533"><span class="annot"><a href="Common.html#firstDerivation"><span class="hs-identifier hs-type">firstDerivation</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679459533"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Common.html#Derivations"><span class="hs-identifier hs-type">Derivations</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459533"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679459533"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-1028"></span><span id="firstDerivation"><span class="annot"><span class="annottext">firstDerivation :: forall a. Ord a =&gt; Derivations a -&gt; Maybe [a]
</span><a href="Common.html#firstDerivation"><span class="hs-identifier hs-var hs-var">firstDerivation</span></a></span></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="Common.html#Cannot"><span class="hs-identifier hs-var">Cannot</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe [a]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-1029"></span><span class="annot"><a href="Common.html#firstDerivation"><span class="hs-identifier hs-var">firstDerivation</span></a></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="Common.html#NoOp"><span class="hs-identifier hs-var">NoOp</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Maybe [a]
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1030"></span><span class="annot"><a href="Common.html#firstDerivation"><span class="hs-identifier hs-var">firstDerivation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Do"><span class="hs-identifier hs-type">Do</span></a></span><span> </span><span id="local-6989586621679462153"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679462153"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; Maybe [a]
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679462153"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1031"></span><span class="annot"><a href="Common.html#firstDerivation"><span class="hs-identifier hs-var">firstDerivation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Or"><span class="hs-identifier hs-type">Or</span></a></span><span> </span><span id="local-6989586621679462154"><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679462154"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Derivations a -&gt; Maybe [a]
forall a. Ord a =&gt; Derivations a -&gt; Maybe [a]
</span><a href="Common.html#firstDerivation"><span class="hs-identifier hs-var">firstDerivation</span></a></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679462154"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-1032"></span><span class="annot"><a href="Common.html#firstDerivation"><span class="hs-identifier hs-var">firstDerivation</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Common.html#Then"><span class="hs-identifier hs-type">Then</span></a></span><span> </span><span id="local-6989586621679462155"><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679462155"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679462156"><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679462156"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1033"></span><span>  </span><span id="local-6989586621679462157"><span class="annot"><a href="#local-6989586621679462157"><span class="hs-identifier hs-var">da</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Derivations a -&gt; Maybe [a]
forall a. Ord a =&gt; Derivations a -&gt; Maybe [a]
</span><a href="Common.html#firstDerivation"><span class="hs-identifier hs-var">firstDerivation</span></a></span><span> </span><span class="annot"><span class="annottext">Derivations a
</span><a href="#local-6989586621679462155"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-1034"></span><span>  </span><span id="local-6989586621679462158"><span class="annot"><a href="#local-6989586621679462158"><span class="hs-identifier hs-var">db</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Common.html#firstDerivation"><span class="hs-identifier hs-type">firstDerivation</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462156"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-1035"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621679462157"><span class="hs-identifier hs-type">da</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621679462158"><span class="hs-identifier hs-type">db</span></a></span><span>
</span><span id="line-1036"></span><span>
</span><span id="line-1037"></span><span class="hs-comment">-- utilities</span><span>
</span><span id="line-1038"></span><span class="hs-comment">-- =========</span><span>
</span><span id="line-1039"></span><span>
</span><span id="line-1040"></span><span class="annot"><span class="hs-comment">-- | Compute the cartesian product for a list of lists</span></span><span>
</span><span id="line-1041"></span><span id="local-6989586621679459535"><span class="annot"><a href="Common.html#cartProd"><span class="hs-identifier hs-type">cartProd</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679459535"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679459535"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span></span><span>
</span><span id="line-1042"></span><span id="cartProd"><span class="annot"><span class="annottext">cartProd :: forall a. [[a]] -&gt; [[a]]
</span><a href="Common.html#cartProd"><span class="hs-identifier hs-var hs-var">cartProd</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; [[a]]
forall a. a -&gt; [a]
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-1043"></span><span class="annot"><a href="Common.html#cartProd"><span class="hs-identifier hs-var">cartProd</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679462163"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679462163"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679462164"><span class="annot"><span class="annottext">[[a]]
</span><a href="#local-6989586621679462164"><span class="hs-identifier hs-var">gs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-1044"></span><span>  </span><span id="local-6989586621679462165"><span class="annot"><a href="#local-6989586621679462165"><span class="hs-identifier hs-var">matching</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679462163"><span class="hs-identifier hs-var">g</span></a></span><span>
</span><span id="line-1045"></span><span>  </span><span id="local-6989586621679462166"><span class="annot"><a href="#local-6989586621679462166"><span class="hs-identifier hs-var">rest</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><a href="Common.html#cartProd"><span class="hs-identifier hs-type">cartProd</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679462164"><span class="hs-identifier hs-type">gs</span></a></span><span>
</span><span id="line-1046"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621679462165"><span class="hs-identifier hs-type">matching</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span class="annot"><a href="#local-6989586621679462166"><span class="hs-identifier hs-type">rest</span></a></span><span>
</span><span id="line-1047"></span><span>
</span><span id="line-1048"></span><span class="annot"><span class="hs-comment">-- | 'traverse' on a 'HashSet'</span></span><span>
</span><span id="line-1049"></span><span id="local-6989586621679459537"><span id="local-6989586621679459538"><span id="local-6989586621679459539"><span class="annot"><a href="Common.html#traverseSet"><span class="hs-identifier hs-type">traverseSet</span></a></span><span>
</span><span id="line-1050"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="#local-6989586621679459537"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679459538"><span class="hs-identifier hs-type">n'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Hashable</span></span><span> </span><span class="annot"><a href="#local-6989586621679459538"><span class="hs-identifier hs-type">n'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1051"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679459539"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679459537"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679459538"><span class="hs-identifier hs-type">n'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1052"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">HS.HashSet</span></span><span> </span><span class="annot"><a href="#local-6989586621679459539"><span class="hs-identifier hs-type">n</span></a></span><span>
</span><span id="line-1053"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679459537"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">HS.HashSet</span></span><span> </span><span class="annot"><a href="#local-6989586621679459538"><span class="hs-identifier hs-type">n'</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-1054"></span><span id="traverseSet"><span class="annot"><span class="annottext">traverseSet :: forall (f :: * -&gt; *) n' n.
(Applicative f, Eq n', Hashable n') =&gt;
(n -&gt; f n') -&gt; HashSet n -&gt; f (HashSet n')
</span><a href="Common.html#traverseSet"><span class="hs-identifier hs-var hs-var">traverseSet</span></a></span></span><span> </span><span id="local-6989586621679462176"><span class="annot"><span class="annottext">n -&gt; f n'
</span><a href="#local-6989586621679462176"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679462177"><span class="annot"><span class="annottext">HashSet n
</span><a href="#local-6989586621679462177"><span class="hs-identifier hs-var">set</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[n'] -&gt; HashSet n'
forall a. (Eq a, Hashable a) =&gt; [a] -&gt; HashSet a
</span><span class="hs-identifier hs-var">HS.fromList</span></span><span> </span><span class="annot"><span class="annottext">([n'] -&gt; HashSet n') -&gt; f [n'] -&gt; f (HashSet n')
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">(n -&gt; f n') -&gt; [n] -&gt; f [n']
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; [a] -&gt; f [b]
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">n -&gt; f n'
</span><a href="#local-6989586621679462176"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HashSet n -&gt; [n]
forall a. HashSet a -&gt; [a]
</span><span class="hs-identifier hs-var">HS.toList</span></span><span> </span><span class="annot"><span class="annottext">HashSet n
</span><a href="#local-6989586621679462177"><span class="hs-identifier hs-var">set</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-1055"></span><span>
</span><span id="line-1056"></span><span class="annot"><span class="hs-comment">-- | The global trace level. Only trace messages &gt;= this level are shown.</span></span><span>
</span><span id="line-1057"></span><span class="annot"><a href="Common.html#traceLevel"><span class="hs-identifier hs-type">traceLevel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-1058"></span><span id="traceLevel"><span class="annot"><span class="annottext">traceLevel :: Int
</span><a href="Common.html#traceLevel"><span class="hs-identifier hs-var hs-var">traceLevel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-1059"></span><span>
</span><span id="line-1060"></span><span class="annot"><span class="hs-comment">-- | A helper for conditionally tracing a message.</span></span><span>
</span><span id="line-1061"></span><span class="annot"><a href="Common.html#traceIf"><span class="hs-identifier hs-type">traceIf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-1062"></span><span id="traceIf"><span class="annot"><span class="annottext">traceIf :: Int -&gt; String -&gt; Bool -&gt; Bool
</span><a href="Common.html#traceIf"><span class="hs-identifier hs-var hs-var">traceIf</span></a></span></span><span> </span><span id="local-6989586621679462180"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679462180"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679462181"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679462181"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span id="local-6989586621679462182"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679462182"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1063"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="Common.html#traceLevel"><span class="hs-identifier hs-var">traceLevel</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679462180"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679462182"><span class="hs-identifier hs-var">value</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String -&gt; Bool -&gt; Bool
forall a. String -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">trace</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679462181"><span class="hs-identifier hs-var">msg</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679462182"><span class="hs-identifier hs-var">value</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679462182"><span class="hs-identifier hs-var">value</span></a></span><span>
</span><span id="line-1064"></span><span>
</span><span id="line-1065"></span><span class="hs-comment">-- toVariant :: ToJSON a =&gt; T.Text -&gt; a -&gt; Aeson.Value</span><span>
</span><span id="line-1066"></span><span class="hs-comment">-- toVariant typ val = Aeson.object [&quot;type&quot; .= typ, &quot;value&quot; .= val]</span><span>
</span><span id="line-1067"></span><span>
</span><span id="line-1068"></span><span class="hs-comment">-- toVariantEnc :: (ToJSON a) =&gt; T.Text -&gt; a -&gt; Aeson.Encoding</span><span>
</span><span id="line-1069"></span><span class="hs-comment">-- toVariantEnc typ val = Aeson.pairs (&quot;type&quot; .= typ &lt;&gt; &quot;value&quot; .= val)</span><span>
</span><span id="line-1070"></span><span>
</span><span id="line-1071"></span><span class="annot"><span class="hs-comment">-- | Lowercase the first character in a string.</span></span><span>
</span><span id="line-1072"></span><span class="annot"><a href="Common.html#firstToLower"><span class="hs-identifier hs-type">firstToLower</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-1073"></span><span id="firstToLower"><span class="annot"><span class="annottext">firstToLower :: ShowS
</span><a href="Common.html#firstToLower"><span class="hs-identifier hs-var hs-var">firstToLower</span></a></span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-1074"></span><span class="annot"><a href="Common.html#firstToLower"><span class="hs-identifier hs-var">firstToLower</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679462184"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679462184"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679462185"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679462185"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Char
</span><span class="hs-identifier hs-var">toLower</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679462184"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; ShowS
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679462185"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-1075"></span><span>
</span><span id="line-1076"></span><span class="annot"><span class="hs-comment">-- | Aeson options for parsing &quot;variant&quot; types (generated in PureScript)</span></span><span>
</span><span id="line-1077"></span><span class="annot"><a href="Common.html#variantDefaults"><span class="hs-identifier hs-type">variantDefaults</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Aeson.Options</span></span><span>
</span><span id="line-1078"></span><span id="variantDefaults"><span class="annot"><span class="annottext">variantDefaults :: ShowS -&gt; Options
</span><a href="Common.html#variantDefaults"><span class="hs-identifier hs-var hs-var">variantDefaults</span></a></span></span><span> </span><span id="local-6989586621679462186"><span class="annot"><span class="annottext">ShowS
</span><a href="#local-6989586621679462186"><span class="hs-identifier hs-var">rename</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-1079"></span><span>  </span><span class="annot"><span class="annottext">Options
</span><span class="hs-identifier hs-var">Aeson.defaultOptions</span></span><span>
</span><span id="line-1080"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="hs-identifier hs-var">Aeson.constructorTagModifier</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679462186"><span class="hs-identifier hs-type">rename</span></a></span><span>
</span><span id="line-1081"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-var">Aeson.sumEncoding</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Aeson.TaggedObject</span></span><span> </span><span class="annot"><span class="hs-string">&quot;type&quot;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;value&quot;</span></span><span>
</span><span id="line-1082"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-1083"></span><span>
</span><span id="line-1084"></span><span class="annot"><span class="hs-comment">-- | Convert special characters to TeX commands.</span></span><span>
</span><span id="line-1085"></span><span id="local-6989586621679462191"><span class="annot"><a href="Common.html#showTex"><span class="hs-identifier hs-type">showTex</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679462191"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679462191"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span></span><span>
</span><span id="line-1086"></span><span id="showTex"><span class="annot"><span class="annottext">showTex :: forall a. Show a =&gt; a -&gt; String
</span><a href="Common.html#showTex"><span class="hs-identifier hs-var hs-var">showTex</span></a></span></span><span> </span><span id="local-6989586621679462196"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679462196"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; String) -&gt; ShowS
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; String
</span><a href="#local-6989586621679462198"><span class="hs-identifier hs-var">escapeTex</span></a></span><span> </span><span class="annot"><span class="annottext">ShowS -&gt; ShowS
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679462196"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-1087"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-1088"></span><span>  </span><span id="local-6989586621679462198"><span class="annot"><span class="annottext">escapeTex :: Char -&gt; String
</span><a href="#local-6989586621679462198"><span class="hs-identifier hs-var hs-var">escapeTex</span></a></span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'&#9837;'</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;$\\flat$&quot;</span></span><span>
</span><span id="line-1089"></span><span>  </span><span class="annot"><a href="#local-6989586621679462198"><span class="hs-identifier hs-var">escapeTex</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'&#9839;'</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;$\\sharp$&quot;</span></span><span>
</span><span id="line-1090"></span><span>  </span><span class="annot"><a href="#local-6989586621679462198"><span class="hs-identifier hs-var">escapeTex</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'{'</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\\{&quot;</span></span><span>
</span><span id="line-1091"></span><span>  </span><span class="annot"><a href="#local-6989586621679462198"><span class="hs-identifier hs-var">escapeTex</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'}'</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\\}&quot;</span></span><span>
</span><span id="line-1092"></span><span>  </span><span class="annot"><a href="#local-6989586621679462198"><span class="hs-identifier hs-var">escapeTex</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'&#8905;'</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;$\\ltimes$&quot;</span></span><span>
</span><span id="line-1093"></span><span>  </span><span class="annot"><a href="#local-6989586621679462198"><span class="hs-identifier hs-var">escapeTex</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'&#8906;'</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;$\\rtimes$&quot;</span></span><span>
</span><span id="line-1094"></span><span>  </span><span class="annot"><a href="#local-6989586621679462198"><span class="hs-identifier hs-var">escapeTex</span></a></span><span> </span><span id="local-6989586621679462206"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679462206"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679462206"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-1095"></span><span>
</span><span id="line-1096"></span><span class="annot"><span class="hs-comment">-- | Convert special characters to TeX commands (using 'T.Text')</span></span><span>
</span><span id="line-1097"></span><span id="local-6989586621679459552"><span class="annot"><a href="Common.html#showTexT"><span class="hs-identifier hs-type">showTexT</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679459552"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679459552"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span></span><span>
</span><span id="line-1098"></span><span id="showTexT"><span class="annot"><span class="annottext">showTexT :: forall a. Show a =&gt; a -&gt; Text
</span><a href="Common.html#showTexT"><span class="hs-identifier hs-var hs-var">showTexT</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; Text) -&gt; (a -&gt; String) -&gt; a -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><a href="Common.html#showTex"><span class="hs-identifier hs-var">showTex</span></a></span><span>
</span><span id="line-1099"></span></pre></body></html>