<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE AllowAmbiguousTypes #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE DeriveGeneric #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE FunctionalDependencies #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE GeneralizedNewtypeDeriving #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE InstanceSigs #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE PartialTypeSignatures #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE PolyKinds #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE StandaloneDeriving #-}</span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# LANGUAGE StandaloneKindSignatures #-}</span><span>
</span><span id="line-15"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-16"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-17"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators #-}</span><span>
</span><span id="line-18"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><span id="line-19"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-partial-type-signatures #-}</span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Inference.Conjugate.html"><span class="hs-identifier">Inference.Conjugate</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">replicateM</span></span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Primitive</span></span><span>
</span><span id="line-25"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">PrimMonad</span></span><span>
</span><span id="line-26"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">PrimState</span></span><span>
</span><span id="line-27"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Reader</span></span><span>
</span><span id="line-29"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">ReaderT</span></span><span>
</span><span id="line-30"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">runReaderT</span></span><span>
</span><span id="line-31"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Reader.Class</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MonadReader</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ask</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.State</span></span><span>
</span><span id="line-34"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">State</span></span><span>
</span><span id="line-35"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">StateT</span></span><span>
</span><span id="line-36"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">evalState</span></span><span>
</span><span id="line-37"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">evalStateT</span></span><span>
</span><span id="line-38"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">execStateT</span></span><span>
</span><span id="line-39"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">runStateT</span></span><span>
</span><span id="line-40"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.State.Class</span></span><span>
</span><span id="line-42"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">get</span></span><span>
</span><span id="line-43"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">modify</span></span><span>
</span><span id="line-44"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">put</span></span><span>
</span><span id="line-45"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Trans.Maybe</span></span><span>
</span><span id="line-47"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">MaybeT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MaybeT</span></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">runMaybeT</span></span><span>
</span><span id="line-49"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad.Writer</span></span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Dynamic</span></span><span>
</span><span id="line-52"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Dynamic</span></span><span>
</span><span id="line-53"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Typeable</span></span><span>
</span><span id="line-54"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">fromDynamic</span></span><span>
</span><span id="line-55"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">toDyn</span></span><span>
</span><span id="line-56"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Kind</span></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromMaybe</span></span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.MultiSet</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">MS</span></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Sequence</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">S</span></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Typeable</span></span><span>
</span><span id="line-62"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Proxy</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Proxy</span></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">typeRep</span></span><span>
</span><span id="line-64"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Vector</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">V</span></span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Debug.Trace</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">DT</span></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Float</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">int2Double</span></span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">GHC.TypeNats</span></span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Lens.Micro</span></span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Lens.Micro.Extras</span></span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Lens.Micro.TH</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">makeLenses</span></span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Numeric.SpecFunctions</span></span><span>
</span><span id="line-74"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">logBeta</span></span><span>
</span><span id="line-75"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">logChoose</span></span><span>
</span><span id="line-76"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">logFactorial</span></span><span>
</span><span id="line-77"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">logGamma</span></span><span>
</span><span id="line-78"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Random.MWC.Probability</span></span><span> </span><span class="hs-keyword">hiding</span><span>
</span><span id="line-80"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Uniform</span></span><span>
</span><span id="line-81"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span>
</span><span id="line-83"></span><span class="hs-comment">----------------------------------------------------------------</span><span>
</span><span id="line-84"></span><span class="hs-comment">-- type classes and families for distributions and conjugates --</span><span>
</span><span id="line-85"></span><span class="hs-comment">----------------------------------------------------------------</span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span class="annot"><span class="hs-comment">{- | Describes a family of distributions with a fixed form.
For example, a 'Bernoulli' distribution is parameterized by a probability @p@
and produces binary samples
(@True@ with probability @p@, @False@ with probability @1-p@).

Its 'Distribution' instance is:
&gt; instance Distribution Bernoulli where
&gt;   type Params Bernoulli = Double
&gt;   type Support Bernoulli = Bool
&gt;   distSample _ = uncurry bernoulli
&gt;   distLogP _ p True = log p
&gt;   distLogP _ p False = log (1 - p)
-}</span></span><span>
</span><span id="line-100"></span><span class="hs-keyword">class</span><span> </span><span id="Distribution"><span class="annot"><a href="Inference.Conjugate.html#Distribution"><span class="hs-identifier hs-var">Distribution</span></a></span></span><span> </span><span id="local-6989586621679098102"><span class="annot"><a href="#local-6989586621679098102"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-101"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Params"><span class="annot"><a href="Inference.Conjugate.html#Params"><span class="hs-identifier hs-var">Params</span></a></span></span><span> </span><span id="local-6989586621679098102"><span class="annot"><a href="#local-6989586621679098102"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-102"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Support"><span class="annot"><a href="Inference.Conjugate.html#Support"><span class="hs-identifier hs-var">Support</span></a></span></span><span> </span><span id="local-6989586621679098102"><span class="annot"><a href="#local-6989586621679098102"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-103"></span><span>  </span><span id="distSample"><span class="annot"><a href="Inference.Conjugate.html#distSample"><span class="hs-identifier hs-type">distSample</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679098103"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PrimMonad</span></span><span> </span><span class="annot"><a href="#local-6989586621679098103"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679098102"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Params"><span class="hs-identifier hs-type">Params</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098102"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Prob</span></span><span> </span><span class="annot"><a href="#local-6989586621679098103"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Support"><span class="hs-identifier hs-type">Support</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098102"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-104"></span><span>  </span><span id="distLogP"><span class="annot"><a href="Inference.Conjugate.html#distLogP"><span class="hs-identifier hs-type">distLogP</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679098102"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Params"><span class="hs-identifier hs-type">Params</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098102"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Support"><span class="hs-identifier hs-type">Support</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098102"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span class="hs-comment">-- -- | Used as a type-lifted kind for conjugate distribution pairs.</span><span>
</span><span id="line-107"></span><span class="hs-comment">-- data Conj a b = Conj a bb</span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span class="annot"><span class="hs-comment">-- | A type-level marker for treating a distribution as a prior.</span></span><span>
</span><span id="line-110"></span><span class="hs-keyword">newtype</span><span> </span><span id="AsPrior"><span class="annot"><a href="Inference.Conjugate.html#AsPrior"><span class="hs-identifier hs-var">AsPrior</span></a></span></span><span> </span><span id="local-6989586621679098617"><span class="annot"><a href="#local-6989586621679098617"><span class="hs-identifier hs-type">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="AsPrior"><span class="annot"><a href="Inference.Conjugate.html#AsPrior"><span class="hs-identifier hs-var">AsPrior</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679098617"><span class="hs-identifier hs-type">p</span></a></span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span class="hs-comment">-- -- | A type-level marker for treating a distribution as a likelihood.</span><span>
</span><span id="line-113"></span><span class="hs-comment">-- newtype AsLk l = AsLk l</span><span>
</span><span id="line-114"></span><span>
</span><span id="line-115"></span><span class="annot"><span class="hs-comment">{- | Marks two distributions as a conjugate pair of prior and likelihood.
The property of such a pair is that the posterior has the same form as the prior
(including the same 'Params' and 'Support'),
and that its parameters can be obtained analytically from the parameters of the prior
and a set of observations.

The class method 'updatePrior' returns the parameters of the posterior
given the prior parameters after a single observation.
-}</span></span><span>
</span><span id="line-124"></span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Distribution"><span class="hs-identifier hs-type">Distribution</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097729"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Distribution"><span class="hs-identifier hs-type">Distribution</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097730"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Support"><span class="hs-identifier hs-type">Support</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097729"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Params"><span class="hs-identifier hs-type">Params</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097730"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="Conjugate"><span class="annot"><a href="Inference.Conjugate.html#Conjugate"><span class="hs-identifier hs-var">Conjugate</span></a></span></span><span> </span><span id="local-6989586621679097729"><span class="annot"><a href="#local-6989586621679097729"><span class="hs-identifier hs-type">p</span></a></span></span><span> </span><span id="local-6989586621679097730"><span class="annot"><a href="#local-6989586621679097730"><span class="hs-identifier hs-type">l</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-125"></span><span>  </span><span id="priorSingleton"><span class="annot"><a href="Inference.Conjugate.html#priorSingleton"><span class="hs-identifier hs-type">priorSingleton</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679097729"><span class="hs-identifier hs-type">p</span></a></span><span>
</span><span id="line-126"></span><span>    </span><span class="hs-comment">-- ^ provides a singleton instance of the prior distribution</span><span>
</span><span id="line-127"></span><span>    </span><span class="hs-comment">-- in order to make sampling from priors easier.</span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span>  </span><span id="updatePrior"><span class="annot"><a href="Inference.Conjugate.html#updatePrior"><span class="hs-identifier hs-type">updatePrior</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679097730"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Params"><span class="hs-identifier hs-type">Params</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097729"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Support"><span class="hs-identifier hs-type">Support</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097730"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Params"><span class="hs-identifier hs-type">Params</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097729"><span class="hs-identifier hs-type">p</span></a></span><span>
</span><span id="line-130"></span><span>  </span><span id="predLogP"><span class="annot"><a href="Inference.Conjugate.html#predLogP"><span class="hs-identifier hs-type">predLogP</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679097730"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Params"><span class="hs-identifier hs-type">Params</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097729"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Support"><span class="hs-identifier hs-type">Support</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097730"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-131"></span><span>
</span><span id="line-132"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="Hyper"><span class="annot"><a href="Inference.Conjugate.html#Hyper"><span class="hs-identifier hs-var">Hyper</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679098625"><span id="local-6989586621679098626"><span class="annot"><a href="#local-6989586621679098626"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679098625"><span class="hs-identifier hs-type">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-133"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="Hyper"><span class="annot"><a href="Inference.Conjugate.html#Hyper"><span class="hs-identifier hs-var">Hyper</span></a></span></span><span> </span><span id="local-6989586621679098627"><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#AsPrior"><span class="hs-identifier hs-type">AsPrior</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098627"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Params"><span class="hs-identifier hs-type">Params</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098627"><span class="hs-identifier hs-type">p</span></a></span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><span id="Probs"><span class="annot"><a href="Inference.Conjugate.html#Probs"><span class="hs-identifier hs-var">Probs</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679098628"><span id="local-6989586621679098629"><span class="annot"><a href="#local-6989586621679098629"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679098628"><span class="hs-identifier hs-type">k</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-136"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="Probs"><span class="annot"><a href="Inference.Conjugate.html#Probs"><span class="hs-identifier hs-var">Probs</span></a></span></span><span> </span><span id="local-6989586621679098630"><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#AsPrior"><span class="hs-identifier hs-type">AsPrior</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098630"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Support"><span class="hs-identifier hs-type">Support</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098630"><span class="hs-identifier hs-type">p</span></a></span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span class="hs-comment">-- type family Value (a :: k) :: Type</span><span>
</span><span id="line-139"></span><span class="hs-comment">-- type instance Value (Conj p l) = Support l</span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span class="hs-comment">-- helper types for instantiating hyperparameters, parameters, and values</span><span>
</span><span id="line-142"></span><span class="hs-comment">-- ----------------------------------------------------------------------</span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span class="hs-keyword">newtype</span><span> </span><span id="HyperRep"><span class="annot"><a href="Inference.Conjugate.html#HyperRep"><span class="hs-identifier hs-var">HyperRep</span></a></span></span><span> </span><span id="local-6989586621679097735"><span class="annot"><a href="#local-6989586621679097735"><span class="hs-identifier hs-type">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="HyperRep"><span class="annot"><a href="Inference.Conjugate.html#HyperRep"><span class="hs-identifier hs-var">HyperRep</span></a></span></span><span> </span><span class="hs-special">{</span><span id="runHyper"><span class="annot"><span class="annottext">forall p. HyperRep p -&gt; Hyper (AsPrior p)
</span><a href="Inference.Conjugate.html#runHyper"><span class="hs-identifier hs-var hs-var">runHyper</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Hyper"><span class="hs-identifier hs-type">Hyper</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#AsPrior"><span class="hs-identifier hs-type">AsPrior</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097735"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><span id="line-145"></span><span id="local-6989586621679097743"><span id="local-6989586621679098635"><span id="local-6989586621679098641"><span id="local-6989586621679098646"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Hyper"><span class="hs-identifier hs-type">Hyper</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#AsPrior"><span class="hs-identifier hs-type">AsPrior</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097743"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#HyperRep"><span class="hs-identifier hs-type">HyperRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097743"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-146"></span><span>
</span><span id="line-147"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="Hyper"><span class="annot"><a href="Inference.Conjugate.html#Hyper"><span class="hs-identifier hs-var">Hyper</span></a></span></span><span> </span><span id="local-6989586621679098651"><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679098651"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679098651"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#HyperRep"><span class="hs-identifier hs-type">HyperRep</span></a></span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span class="hs-keyword">newtype</span><span> </span><span id="ProbsRep"><span class="annot"><a href="Inference.Conjugate.html#ProbsRep"><span class="hs-identifier hs-var">ProbsRep</span></a></span></span><span> </span><span id="local-6989586621679097744"><span class="annot"><a href="#local-6989586621679097744"><span class="hs-identifier hs-type">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ProbsRep"><span class="annot"><a href="Inference.Conjugate.html#ProbsRep"><span class="hs-identifier hs-var">ProbsRep</span></a></span></span><span> </span><span class="hs-special">{</span><span id="runProbs"><span class="annot"><span class="annottext">forall p. ProbsRep p -&gt; Probs (AsPrior p)
</span><a href="Inference.Conjugate.html#runProbs"><span class="hs-identifier hs-var hs-var">runProbs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Probs"><span class="hs-identifier hs-type">Probs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#AsPrior"><span class="hs-identifier hs-type">AsPrior</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097744"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><span id="line-150"></span><span id="local-6989586621679097749"><span id="local-6989586621679098656"><span id="local-6989586621679098661"><span id="local-6989586621679098666"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Probs"><span class="hs-identifier hs-type">Probs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#AsPrior"><span class="hs-identifier hs-type">AsPrior</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097749"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#ProbsRep"><span class="hs-identifier hs-type">ProbsRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097749"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-151"></span><span>
</span><span id="line-152"></span><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><span id="Probs"><span class="annot"><a href="Inference.Conjugate.html#Probs"><span class="hs-identifier hs-var">Probs</span></a></span></span><span> </span><span id="local-6989586621679098669"><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679098669"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679098669"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#ProbsRep"><span class="hs-identifier hs-type">ProbsRep</span></a></span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span class="hs-comment">-- newtype ValueRep p l = ValueRep { runValue :: Value (Conj p l) }</span><span>
</span><span id="line-155"></span><span class="hs-comment">-- deriving instance Show (Value (Conj p l)) =&gt; Show (ValueRep p l)</span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span class="hs-comment">-- type instance Value (a :: (Type -&gt; Type -&gt; Type) -&gt; Type) = a ValueRep</span><span>
</span><span id="line-158"></span><span>
</span><span id="line-159"></span><span class="hs-comment">-----------------------------------------------------</span><span>
</span><span id="line-160"></span><span class="hs-comment">-- generic magic for conjugates and parameter sets --</span><span>
</span><span id="line-161"></span><span class="hs-comment">-----------------------------------------------------</span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span class="hs-comment">-- Jeffreys prior</span><span>
</span><span id="line-164"></span><span class="hs-comment">-- ---------------</span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span class="hs-keyword">class</span><span> </span><span id="Jeffreys"><span class="annot"><a href="Inference.Conjugate.html#Jeffreys"><span class="hs-identifier hs-var">Jeffreys</span></a></span></span><span> </span><span id="local-6989586621679097779"><span class="annot"><a href="#local-6989586621679097779"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-167"></span><span>  </span><span id="jeffreysPrior"><span class="annot"><a href="Inference.Conjugate.html#jeffreysPrior"><span class="hs-identifier hs-type">jeffreysPrior</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Hyper"><span class="hs-identifier hs-type">Hyper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097779"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-168"></span><span>
</span><span id="line-169"></span><span class="hs-keyword">class</span><span> </span><span id="GJeffreys"><span class="annot"><a href="Inference.Conjugate.html#GJeffreys"><span class="hs-identifier hs-var">GJeffreys</span></a></span></span><span> </span><span id="local-6989586621679097754"><span class="annot"><a href="#local-6989586621679097754"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-170"></span><span>  </span><span id="gjeffreysPrior"><span class="annot"><a href="Inference.Conjugate.html#gjeffreysPrior"><span class="hs-identifier hs-type">gjeffreysPrior</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679097751"><span class="annot"><a href="#local-6989586621679097751"><span class="hs-identifier hs-type">p</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621679097754"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097751"><span class="hs-identifier hs-type">p</span></a></span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#GJeffreys"><span class="hs-identifier hs-type">GJeffreys</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">V1</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-173"></span><span>  </span><span id="local-6989586621679098677"><span class="annot"><span class="annottext">gjeffreysPrior :: forall (p :: k). V1 p
</span><a href="Inference.Conjugate.html#gjeffreysPrior"><span class="hs-identifier hs-var hs-var hs-var">gjeffreysPrior</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">V1 p
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span> </span><span class="hs-comment">-- ok</span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#GJeffreys"><span class="hs-identifier hs-type">GJeffreys</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">U1</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-176"></span><span>  </span><span id="local-6989586621679098681"><span class="annot"><span class="annottext">gjeffreysPrior :: forall (p :: k). U1 p
</span><a href="Inference.Conjugate.html#gjeffreysPrior"><span class="hs-identifier hs-var hs-var hs-var">gjeffreysPrior</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">U1 p
forall k (p :: k). U1 p
</span><span class="hs-identifier hs-var">U1</span></span><span>
</span><span id="line-177"></span><span>
</span><span id="line-178"></span><span class="hs-comment">-- base case: k is a conjugate distribution</span><span>
</span><span id="line-179"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679097767"><span id="local-6989586621679097769"><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Jeffreys"><span class="hs-identifier hs-type">Jeffreys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#AsPrior"><span class="hs-identifier hs-type">AsPrior</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097767"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#GJeffreys"><span class="hs-identifier hs-type">GJeffreys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">K1</span></span><span> </span><span class="annot"><a href="#local-6989586621679097769"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#HyperRep"><span class="hs-identifier hs-type">HyperRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097767"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-180"></span><span>  </span><span id="local-6989586621679098687"><span class="annot"><span class="annottext">gjeffreysPrior :: forall (p :: k). K1 i (HyperRep p) p
</span><a href="Inference.Conjugate.html#gjeffreysPrior"><span class="hs-identifier hs-var hs-var hs-var">gjeffreysPrior</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HyperRep p -&gt; K1 i (HyperRep p) p
forall k i c (p :: k). c -&gt; K1 i c p
</span><span class="hs-identifier hs-var">K1</span></span><span> </span><span class="annot"><span class="annottext">(HyperRep p -&gt; K1 i (HyperRep p) p)
-&gt; HyperRep p -&gt; K1 i (HyperRep p) p
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Hyper (AsPrior p) -&gt; HyperRep p
forall p. Hyper (AsPrior p) -&gt; HyperRep p
</span><a href="Inference.Conjugate.html#HyperRep"><span class="hs-identifier hs-var">HyperRep</span></a></span><span> </span><span class="annot"><span class="annottext">(Hyper (AsPrior p) -&gt; HyperRep p)
-&gt; Hyper (AsPrior p) -&gt; HyperRep p
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Jeffreys a =&gt; Hyper a
forall {k} (a :: k). Jeffreys a =&gt; Hyper a
</span><a href="Inference.Conjugate.html#jeffreysPrior"><span class="hs-identifier hs-var">jeffreysPrior</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#AsPrior"><span class="hs-identifier hs-type">AsPrior</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097767"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span class="hs-comment">-- recursive case: k is another record</span><span>
</span><span id="line-183"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679097784"><span id="local-6989586621679097786"><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Jeffreys"><span class="hs-identifier hs-type">Jeffreys</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097784"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679097784"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#HyperRep"><span class="hs-identifier hs-type">HyperRep</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Hyper"><span class="hs-identifier hs-type">Hyper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097784"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#GJeffreys"><span class="hs-identifier hs-type">GJeffreys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">K1</span></span><span> </span><span class="annot"><a href="#local-6989586621679097786"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679097784"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#HyperRep"><span class="hs-identifier hs-type">HyperRep</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-184"></span><span>  </span><span id="local-6989586621679098694"><span class="annot"><span class="annottext">gjeffreysPrior :: forall (p :: k). K1 i (k HyperRep) p
</span><a href="Inference.Conjugate.html#gjeffreysPrior"><span class="hs-identifier hs-var hs-var hs-var">gjeffreysPrior</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k HyperRep -&gt; K1 i (k HyperRep) p
forall k i c (p :: k). c -&gt; K1 i c p
</span><span class="hs-identifier hs-var">K1</span></span><span> </span><span class="annot"><span class="annottext">(k HyperRep -&gt; K1 i (k HyperRep) p)
-&gt; k HyperRep -&gt; K1 i (k HyperRep) p
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall {k} (a :: k). Jeffreys a =&gt; Hyper a
forall (a :: (* -&gt; *) -&gt; *). Jeffreys a =&gt; Hyper a
</span><a href="Inference.Conjugate.html#jeffreysPrior"><span class="hs-identifier hs-var">jeffreysPrior</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679097784"><span class="hs-identifier hs-type">k</span></a></span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679097792"><span id="local-6989586621679097793"><span id="local-6989586621679097794"><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#GJeffreys"><span class="hs-identifier hs-type">GJeffreys</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097792"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#GJeffreys"><span class="hs-identifier hs-type">GJeffreys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">M1</span></span><span> </span><span class="annot"><a href="#local-6989586621679097793"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097794"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679097792"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-187"></span><span>  </span><span id="local-6989586621679098699"><span class="annot"><span class="annottext">gjeffreysPrior :: forall p. M1 i c t p
</span><a href="Inference.Conjugate.html#gjeffreysPrior"><span class="hs-identifier hs-var hs-var hs-var">gjeffreysPrior</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t p -&gt; M1 i c t p
forall k i (c :: Meta) (f :: k -&gt; *) (p :: k). f p -&gt; M1 i c f p
</span><span class="hs-identifier hs-var">M1</span></span><span> </span><span class="annot"><span class="annottext">t p
forall p. t p
forall {k} (t :: k -&gt; *) (p :: k). GJeffreys t =&gt; t p
</span><a href="Inference.Conjugate.html#gjeffreysPrior"><span class="hs-identifier hs-var">gjeffreysPrior</span></a></span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679097805"><span id="local-6989586621679097806"><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#GJeffreys"><span class="hs-identifier hs-type">GJeffreys</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097805"><span class="hs-identifier hs-type">ta</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#GJeffreys"><span class="hs-identifier hs-type">GJeffreys</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097806"><span class="hs-identifier hs-type">tb</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#GJeffreys"><span class="hs-identifier hs-type">GJeffreys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679097805"><span class="hs-identifier hs-type">ta</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:*:</span></span><span> </span><span class="annot"><a href="#local-6989586621679097806"><span class="hs-identifier hs-type">tb</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-190"></span><span>  </span><span id="local-6989586621679098707"><span class="annot"><span class="annottext">gjeffreysPrior :: forall (p :: k). (:*:) ta tb p
</span><a href="Inference.Conjugate.html#gjeffreysPrior"><span class="hs-identifier hs-var hs-var hs-var">gjeffreysPrior</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {k} (t :: k -&gt; *) (p :: k). GJeffreys t =&gt; t p
forall (t :: k -&gt; *) (p :: k). GJeffreys t =&gt; t p
</span><a href="Inference.Conjugate.html#gjeffreysPrior"><span class="hs-identifier hs-var">gjeffreysPrior</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679097805"><span class="hs-identifier hs-type">ta</span></a></span><span> </span><span class="annot"><span class="annottext">ta p -&gt; tb p -&gt; (:*:) ta tb p
forall k (f :: k -&gt; *) (g :: k -&gt; *) (p :: k).
f p -&gt; g p -&gt; (:*:) f g p
</span><span class="hs-operator hs-var">:*:</span></span><span> </span><span class="annot"><span class="annottext">forall {k} (t :: k -&gt; *) (p :: k). GJeffreys t =&gt; t p
forall (t :: k -&gt; *) (p :: k). GJeffreys t =&gt; t p
</span><a href="Inference.Conjugate.html#gjeffreysPrior"><span class="hs-identifier hs-var">gjeffreysPrior</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679097806"><span class="hs-identifier hs-type">tb</span></a></span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679097813"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Generic</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679097813"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#HyperRep"><span class="hs-identifier hs-type">HyperRep</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#GJeffreys"><span class="hs-identifier hs-type">GJeffreys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Rep</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679097813"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#HyperRep"><span class="hs-identifier hs-type">HyperRep</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Jeffreys"><span class="hs-identifier hs-type">Jeffreys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679097813"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-193"></span><span>  </span><span id="local-6989586621679098716"><span class="annot"><span class="annottext">jeffreysPrior :: Hyper t
</span><a href="Inference.Conjugate.html#jeffreysPrior"><span class="hs-identifier hs-var hs-var hs-var">jeffreysPrior</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rep (t HyperRep) (ZonkAny 4) -&gt; t HyperRep
forall a x. Generic a =&gt; Rep a x -&gt; a
forall x. Rep (t HyperRep) x -&gt; t HyperRep
</span><span class="hs-identifier hs-var">GHC.Generics.to</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {k} (t :: k -&gt; *) (p :: k). GJeffreys t =&gt; t p
forall (t :: * -&gt; *) p. GJeffreys t =&gt; t p
</span><a href="Inference.Conjugate.html#gjeffreysPrior"><span class="hs-identifier hs-var">gjeffreysPrior</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Rep</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679097813"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#HyperRep"><span class="hs-identifier hs-type">HyperRep</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-194"></span><span>
</span><span id="line-195"></span><span class="hs-comment">-- uniform prior</span><span>
</span><span id="line-196"></span><span class="hs-comment">-- -------------</span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span class="hs-keyword">class</span><span> </span><span id="Uniform"><span class="annot"><a href="Inference.Conjugate.html#Uniform"><span class="hs-identifier hs-var">Uniform</span></a></span></span><span> </span><span id="local-6989586621679097834"><span class="annot"><a href="#local-6989586621679097834"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-199"></span><span>  </span><span id="uniformPrior"><span class="annot"><a href="Inference.Conjugate.html#uniformPrior"><span class="hs-identifier hs-type">uniformPrior</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Hyper"><span class="hs-identifier hs-type">Hyper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097834"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span class="hs-keyword">class</span><span> </span><span id="GUniform"><span class="annot"><a href="Inference.Conjugate.html#GUniform"><span class="hs-identifier hs-var">GUniform</span></a></span></span><span> </span><span id="local-6989586621679097820"><span class="annot"><a href="#local-6989586621679097820"><span class="hs-identifier hs-type">t</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-202"></span><span>  </span><span id="guniformPrior"><span class="annot"><a href="Inference.Conjugate.html#guniformPrior"><span class="hs-identifier hs-type">guniformPrior</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679097817"><span class="annot"><a href="#local-6989586621679097817"><span class="hs-identifier hs-type">p</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621679097820"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097817"><span class="hs-identifier hs-type">p</span></a></span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#GUniform"><span class="hs-identifier hs-type">GUniform</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">V1</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-205"></span><span>  </span><span id="local-6989586621679098725"><span class="annot"><span class="annottext">guniformPrior :: forall (p :: k). V1 p
</span><a href="Inference.Conjugate.html#guniformPrior"><span class="hs-identifier hs-var hs-var hs-var">guniformPrior</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">V1 p
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span> </span><span class="hs-comment">-- ok</span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#GUniform"><span class="hs-identifier hs-type">GUniform</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">U1</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-208"></span><span>  </span><span id="local-6989586621679098728"><span class="annot"><span class="annottext">guniformPrior :: forall (p :: k). U1 p
</span><a href="Inference.Conjugate.html#guniformPrior"><span class="hs-identifier hs-var hs-var hs-var">guniformPrior</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">U1 p
forall k (p :: k). U1 p
</span><span class="hs-identifier hs-var">U1</span></span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span class="hs-comment">-- base case: k is a conjugate distribution</span><span>
</span><span id="line-211"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679097830"><span id="local-6989586621679097832"><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Uniform"><span class="hs-identifier hs-type">Uniform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#AsPrior"><span class="hs-identifier hs-type">AsPrior</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097830"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#GUniform"><span class="hs-identifier hs-type">GUniform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">K1</span></span><span> </span><span class="annot"><a href="#local-6989586621679097832"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#HyperRep"><span class="hs-identifier hs-type">HyperRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097830"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-212"></span><span>  </span><span id="local-6989586621679098733"><span class="annot"><span class="annottext">guniformPrior :: forall (p :: k). K1 i (HyperRep p) p
</span><a href="Inference.Conjugate.html#guniformPrior"><span class="hs-identifier hs-var hs-var hs-var">guniformPrior</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HyperRep p -&gt; K1 i (HyperRep p) p
forall k i c (p :: k). c -&gt; K1 i c p
</span><span class="hs-identifier hs-var">K1</span></span><span> </span><span class="annot"><span class="annottext">(HyperRep p -&gt; K1 i (HyperRep p) p)
-&gt; HyperRep p -&gt; K1 i (HyperRep p) p
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Hyper (AsPrior p) -&gt; HyperRep p
forall p. Hyper (AsPrior p) -&gt; HyperRep p
</span><a href="Inference.Conjugate.html#HyperRep"><span class="hs-identifier hs-var">HyperRep</span></a></span><span> </span><span class="annot"><span class="annottext">(Hyper (AsPrior p) -&gt; HyperRep p)
-&gt; Hyper (AsPrior p) -&gt; HyperRep p
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Uniform a =&gt; Hyper a
forall {k} (a :: k). Uniform a =&gt; Hyper a
</span><a href="Inference.Conjugate.html#uniformPrior"><span class="hs-identifier hs-var">uniformPrior</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#AsPrior"><span class="hs-identifier hs-type">AsPrior</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097830"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-213"></span><span>
</span><span id="line-214"></span><span class="hs-comment">-- recursive case: k is another record</span><span>
</span><span id="line-215"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679097839"><span id="local-6989586621679097841"><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Uniform"><span class="hs-identifier hs-type">Uniform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097839"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679097839"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#HyperRep"><span class="hs-identifier hs-type">HyperRep</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Hyper"><span class="hs-identifier hs-type">Hyper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097839"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#GUniform"><span class="hs-identifier hs-type">GUniform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">K1</span></span><span> </span><span class="annot"><a href="#local-6989586621679097841"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679097839"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#HyperRep"><span class="hs-identifier hs-type">HyperRep</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-216"></span><span>  </span><span id="local-6989586621679098739"><span class="annot"><span class="annottext">guniformPrior :: forall (p :: k). K1 i (k HyperRep) p
</span><a href="Inference.Conjugate.html#guniformPrior"><span class="hs-identifier hs-var hs-var hs-var">guniformPrior</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k HyperRep -&gt; K1 i (k HyperRep) p
forall k i c (p :: k). c -&gt; K1 i c p
</span><span class="hs-identifier hs-var">K1</span></span><span> </span><span class="annot"><span class="annottext">(k HyperRep -&gt; K1 i (k HyperRep) p)
-&gt; k HyperRep -&gt; K1 i (k HyperRep) p
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall {k} (a :: k). Uniform a =&gt; Hyper a
forall (a :: (* -&gt; *) -&gt; *). Uniform a =&gt; Hyper a
</span><a href="Inference.Conjugate.html#uniformPrior"><span class="hs-identifier hs-var">uniformPrior</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679097839"><span class="hs-identifier hs-type">k</span></a></span><span>
</span><span id="line-217"></span><span>
</span><span id="line-218"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679097846"><span id="local-6989586621679097847"><span id="local-6989586621679097848"><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#GUniform"><span class="hs-identifier hs-type">GUniform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097846"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#GUniform"><span class="hs-identifier hs-type">GUniform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">M1</span></span><span> </span><span class="annot"><a href="#local-6989586621679097847"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097848"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679097846"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-219"></span><span>  </span><span id="local-6989586621679098744"><span class="annot"><span class="annottext">guniformPrior :: forall p. M1 i c t p
</span><a href="Inference.Conjugate.html#guniformPrior"><span class="hs-identifier hs-var hs-var hs-var">guniformPrior</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t p -&gt; M1 i c t p
forall k i (c :: Meta) (f :: k -&gt; *) (p :: k). f p -&gt; M1 i c f p
</span><span class="hs-identifier hs-var">M1</span></span><span> </span><span class="annot"><span class="annottext">t p
forall p. t p
forall {k} (t :: k -&gt; *) (p :: k). GUniform t =&gt; t p
</span><a href="Inference.Conjugate.html#guniformPrior"><span class="hs-identifier hs-var">guniformPrior</span></a></span><span>
</span><span id="line-220"></span><span>
</span><span id="line-221"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679097854"><span id="local-6989586621679097855"><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#GUniform"><span class="hs-identifier hs-type">GUniform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097854"><span class="hs-identifier hs-type">ta</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#GUniform"><span class="hs-identifier hs-type">GUniform</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097855"><span class="hs-identifier hs-type">tb</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#GUniform"><span class="hs-identifier hs-type">GUniform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679097854"><span class="hs-identifier hs-type">ta</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:*:</span></span><span> </span><span class="annot"><a href="#local-6989586621679097855"><span class="hs-identifier hs-type">tb</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-222"></span><span>  </span><span id="local-6989586621679098751"><span class="annot"><span class="annottext">guniformPrior :: forall (p :: k). (:*:) ta tb p
</span><a href="Inference.Conjugate.html#guniformPrior"><span class="hs-identifier hs-var hs-var hs-var">guniformPrior</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {k} (t :: k -&gt; *) (p :: k). GUniform t =&gt; t p
forall (t :: k -&gt; *) (p :: k). GUniform t =&gt; t p
</span><a href="Inference.Conjugate.html#guniformPrior"><span class="hs-identifier hs-var">guniformPrior</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679097854"><span class="hs-identifier hs-type">ta</span></a></span><span> </span><span class="annot"><span class="annottext">ta p -&gt; tb p -&gt; (:*:) ta tb p
forall k (f :: k -&gt; *) (g :: k -&gt; *) (p :: k).
f p -&gt; g p -&gt; (:*:) f g p
</span><span class="hs-operator hs-var">:*:</span></span><span> </span><span class="annot"><span class="annottext">forall {k} (t :: k -&gt; *) (p :: k). GUniform t =&gt; t p
forall (t :: k -&gt; *) (p :: k). GUniform t =&gt; t p
</span><a href="Inference.Conjugate.html#guniformPrior"><span class="hs-identifier hs-var">guniformPrior</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679097855"><span class="hs-identifier hs-type">tb</span></a></span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679097858"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Generic</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679097858"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#HyperRep"><span class="hs-identifier hs-type">HyperRep</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#GUniform"><span class="hs-identifier hs-type">GUniform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Rep</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679097858"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#HyperRep"><span class="hs-identifier hs-type">HyperRep</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Uniform"><span class="hs-identifier hs-type">Uniform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679097858"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-225"></span><span>  </span><span id="local-6989586621679098759"><span class="annot"><span class="annottext">uniformPrior :: Hyper t
</span><a href="Inference.Conjugate.html#uniformPrior"><span class="hs-identifier hs-var hs-var hs-var">uniformPrior</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rep (t HyperRep) (ZonkAny 3) -&gt; t HyperRep
forall a x. Generic a =&gt; Rep a x -&gt; a
forall x. Rep (t HyperRep) x -&gt; t HyperRep
</span><span class="hs-identifier hs-var">GHC.Generics.to</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {k} (t :: k -&gt; *) (p :: k). GUniform t =&gt; t p
forall (t :: * -&gt; *) p. GUniform t =&gt; t p
</span><a href="Inference.Conjugate.html#guniformPrior"><span class="hs-identifier hs-var">guniformPrior</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Rep</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679097858"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#HyperRep"><span class="hs-identifier hs-type">HyperRep</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-226"></span><span>
</span><span id="line-227"></span><span class="hs-comment">-- sampling from prior</span><span>
</span><span id="line-228"></span><span class="hs-comment">-- ------------------</span><span>
</span><span id="line-229"></span><span>
</span><span id="line-230"></span><span class="hs-keyword">class</span><span> </span><span id="Prior"><span class="annot"><a href="Inference.Conjugate.html#Prior"><span class="hs-identifier hs-var">Prior</span></a></span></span><span> </span><span id="local-6989586621679097900"><span class="annot"><a href="#local-6989586621679097900"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-231"></span><span>  </span><span id="sampleProbs"><span class="annot"><a href="Inference.Conjugate.html#sampleProbs"><span class="hs-identifier hs-type">sampleProbs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679097899"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PrimMonad</span></span><span> </span><span class="annot"><a href="#local-6989586621679097899"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Hyper"><span class="hs-identifier hs-type">Hyper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097900"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Prob</span></span><span> </span><span class="annot"><a href="#local-6989586621679097899"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Probs"><span class="hs-identifier hs-type">Probs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097900"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-232"></span><span>  </span><span id="expectedProbs"><span class="annot"><a href="Inference.Conjugate.html#expectedProbs"><span class="hs-identifier hs-type">expectedProbs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Hyper"><span class="hs-identifier hs-type">Hyper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097900"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Probs"><span class="hs-identifier hs-type">Probs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097900"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-233"></span><span>
</span><span id="line-234"></span><span class="hs-keyword">class</span><span> </span><span id="GPrior"><span class="annot"><a href="Inference.Conjugate.html#GPrior"><span class="hs-identifier hs-var">GPrior</span></a></span></span><span> </span><span id="local-6989586621679097867"><span class="annot"><a href="#local-6989586621679097867"><span class="hs-identifier hs-type">i</span></a></span></span><span> </span><span id="local-6989586621679097868"><span class="annot"><a href="#local-6989586621679097868"><span class="hs-identifier hs-type">o</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-235"></span><span>  </span><span id="gsampleProbs"><span class="annot"><a href="Inference.Conjugate.html#gsampleProbs"><span class="hs-identifier hs-type">gsampleProbs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679097860"><span class="annot"><a href="#local-6989586621679097860"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679097862"><span class="annot"><a href="#local-6989586621679097862"><span class="hs-identifier hs-type">p</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PrimMonad</span></span><span> </span><span class="annot"><a href="#local-6989586621679097860"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679097867"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097862"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Prob</span></span><span> </span><span class="annot"><a href="#local-6989586621679097860"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679097868"><span class="hs-identifier hs-type">o</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097862"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-236"></span><span>  </span><span id="gexpectedProbs"><span class="annot"><a href="Inference.Conjugate.html#gexpectedProbs"><span class="hs-identifier hs-type">gexpectedProbs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679097864"><span class="annot"><a href="#local-6989586621679097867"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097864"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679097868"><span class="hs-identifier hs-type">o</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097864"><span class="hs-identifier hs-type">p</span></a></span></span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#GPrior"><span class="hs-identifier hs-type">GPrior</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">V1</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">V1</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-239"></span><span>  </span><span id="local-6989586621679098771"><span class="annot"><span class="annottext">gsampleProbs :: forall (m :: * -&gt; *) (p :: k). PrimMonad m =&gt; V1 p -&gt; Prob m (V1 p)
</span><a href="Inference.Conjugate.html#gsampleProbs"><span class="hs-identifier hs-var hs-var hs-var">gsampleProbs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">V1 p -&gt; Prob m (V1 p)
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span> </span><span class="hs-comment">-- ok</span><span>
</span><span id="line-240"></span><span>  </span><span id="local-6989586621679098774"><span class="annot"><span class="annottext">gexpectedProbs :: forall (p :: k). V1 p -&gt; V1 p
</span><a href="Inference.Conjugate.html#gexpectedProbs"><span class="hs-identifier hs-var hs-var hs-var">gexpectedProbs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">V1 p -&gt; V1 p
forall a. HasCallStack =&gt; a
</span><span class="hs-identifier hs-var">undefined</span></span><span>
</span><span id="line-241"></span><span>
</span><span id="line-242"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#GPrior"><span class="hs-identifier hs-type">GPrior</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">U1</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">U1</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-243"></span><span>  </span><span id="local-6989586621679098783"><span class="annot"><span class="annottext">gsampleProbs :: forall (m :: * -&gt; *) (p :: k). PrimMonad m =&gt; U1 p -&gt; Prob m (U1 p)
</span><a href="Inference.Conjugate.html#gsampleProbs"><span class="hs-identifier hs-var hs-var hs-var">gsampleProbs</span></a></span></span><span> </span><span class="annot"><span class="annottext">U1 p
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">U1 p -&gt; Prob m (U1 p)
forall a. a -&gt; Prob m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">U1 p
forall k (p :: k). U1 p
</span><span class="hs-identifier hs-var">U1</span></span><span>
</span><span id="line-244"></span><span>  </span><span id="local-6989586621679098784"><span class="annot"><span class="annottext">gexpectedProbs :: forall (p :: k). U1 p -&gt; U1 p
</span><a href="Inference.Conjugate.html#gexpectedProbs"><span class="hs-identifier hs-var hs-var hs-var">gexpectedProbs</span></a></span></span><span> </span><span class="annot"><span class="annottext">U1 p
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">U1 p
forall k (p :: k). U1 p
</span><span class="hs-identifier hs-var">U1</span></span><span>
</span><span id="line-245"></span><span>
</span><span id="line-246"></span><span class="hs-comment">-- base case: k is a conjugate distribution</span><span>
</span><span id="line-247"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679097886"><span id="local-6989586621679097888"><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Prior"><span class="hs-identifier hs-type">Prior</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#AsPrior"><span class="hs-identifier hs-type">AsPrior</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097886"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#GPrior"><span class="hs-identifier hs-type">GPrior</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">K1</span></span><span> </span><span class="annot"><a href="#local-6989586621679097888"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#HyperRep"><span class="hs-identifier hs-type">HyperRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097886"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">K1</span></span><span> </span><span class="annot"><a href="#local-6989586621679097888"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#ProbsRep"><span class="hs-identifier hs-type">ProbsRep</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097886"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-248"></span><span>  </span><span id="local-6989586621679098799"><span class="annot"><span class="annottext">gsampleProbs :: forall (m :: * -&gt; *) (p :: k).
PrimMonad m =&gt;
K1 i (HyperRep p) p -&gt; Prob m (K1 i (ProbsRep p) p)
</span><a href="Inference.Conjugate.html#gsampleProbs"><span class="hs-identifier hs-var hs-var hs-var">gsampleProbs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">K1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#HyperRep"><span class="hs-identifier hs-type">HyperRep</span></a></span><span> </span><span id="local-6989586621679098800"><span class="annot"><span class="annottext">Hyper (AsPrior p)
</span><a href="#local-6989586621679098800"><span class="hs-identifier hs-var">hyper</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-249"></span><span>    </span><span class="annot"><span class="annottext">ProbsRep p -&gt; K1 i (ProbsRep p) p
forall k i c (p :: k). c -&gt; K1 i c p
</span><span class="hs-identifier hs-var">K1</span></span><span> </span><span class="annot"><span class="annottext">(ProbsRep p -&gt; K1 i (ProbsRep p) p)
-&gt; (Support p -&gt; ProbsRep p) -&gt; Support p -&gt; K1 i (ProbsRep p) p
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Probs (AsPrior p) -&gt; ProbsRep p
Support p -&gt; ProbsRep p
forall p. Probs (AsPrior p) -&gt; ProbsRep p
</span><a href="Inference.Conjugate.html#ProbsRep"><span class="hs-identifier hs-var">ProbsRep</span></a></span><span> </span><span class="annot"><span class="annottext">(Support p -&gt; K1 i (ProbsRep p) p)
-&gt; Prob m (Support p) -&gt; Prob m (K1 i (ProbsRep p) p)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall a (m :: * -&gt; *).
(Prior a, PrimMonad m) =&gt;
Hyper a -&gt; Prob m (Probs a)
forall {k} (a :: k) (m :: * -&gt; *).
(Prior a, PrimMonad m) =&gt;
Hyper a -&gt; Prob m (Probs a)
</span><a href="Inference.Conjugate.html#sampleProbs"><span class="hs-identifier hs-var">sampleProbs</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#AsPrior"><span class="hs-identifier hs-type">AsPrior</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097886"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Hyper (AsPrior p)
</span><a href="#local-6989586621679098800"><span class="hs-identifier hs-var">hyper</span></a></span><span>
</span><span id="line-250"></span><span>  </span><span id="local-6989586621679098804"><span class="annot"><span class="annottext">gexpectedProbs :: forall (p :: k). K1 i (HyperRep p) p -&gt; K1 i (ProbsRep p) p
</span><a href="Inference.Conjugate.html#gexpectedProbs"><span class="hs-identifier hs-var hs-var hs-var">gexpectedProbs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">K1</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#HyperRep"><span class="hs-identifier hs-type">HyperRep</span></a></span><span> </span><span id="local-6989586621679098805"><span class="annot"><span class="annottext">Hyper (AsPrior p)
</span><a href="#local-6989586621679098805"><span class="hs-identifier hs-var">hyper</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProbsRep p -&gt; K1 i (ProbsRep p) p
forall k i c (p :: k). c -&gt; K1 i c p
</span><span class="hs-identifier hs-var">K1</span></span><span> </span><span class="annot"><span class="annottext">(ProbsRep p -&gt; K1 i (ProbsRep p) p)
-&gt; ProbsRep p -&gt; K1 i (ProbsRep p) p
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Probs (AsPrior p) -&gt; ProbsRep p
forall p. Probs (AsPrior p) -&gt; ProbsRep p
</span><a href="Inference.Conjugate.html#ProbsRep"><span class="hs-identifier hs-var">ProbsRep</span></a></span><span> </span><span class="annot"><span class="annottext">(Probs (AsPrior p) -&gt; ProbsRep p)
-&gt; Probs (AsPrior p) -&gt; ProbsRep p
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall a. Prior a =&gt; Hyper a -&gt; Probs a
forall {k} (a :: k). Prior a =&gt; Hyper a -&gt; Probs a
</span><a href="Inference.Conjugate.html#expectedProbs"><span class="hs-identifier hs-var">expectedProbs</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#AsPrior"><span class="hs-identifier hs-type">AsPrior</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097886"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Hyper (AsPrior p)
</span><a href="#local-6989586621679098805"><span class="hs-identifier hs-var">hyper</span></a></span><span>
</span><span id="line-251"></span><span>
</span><span id="line-252"></span><span class="hs-comment">-- recursive case: k is another record</span><span>
</span><span id="line-253"></span><span class="hs-keyword">instance</span><span>
</span><span id="line-254"></span><span>  </span><span id="local-6989586621679097906"><span id="local-6989586621679097908"><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Prior"><span class="hs-identifier hs-type">Prior</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097906"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679097906"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#HyperRep"><span class="hs-identifier hs-type">HyperRep</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Hyper"><span class="hs-identifier hs-type">Hyper</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097906"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679097906"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#ProbsRep"><span class="hs-identifier hs-type">ProbsRep</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Probs"><span class="hs-identifier hs-type">Probs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097906"><span class="hs-identifier hs-type">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-255"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#GPrior"><span class="hs-identifier hs-type">GPrior</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">K1</span></span><span> </span><span class="annot"><a href="#local-6989586621679097908"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679097906"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#HyperRep"><span class="hs-identifier hs-type">HyperRep</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">K1</span></span><span> </span><span class="annot"><a href="#local-6989586621679097908"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679097906"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#ProbsRep"><span class="hs-identifier hs-type">ProbsRep</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-256"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-257"></span><span>  </span><span id="local-6989586621679098819"><span class="annot"><span class="annottext">gsampleProbs :: forall (m :: * -&gt; *) (p :: k).
PrimMonad m =&gt;
K1 i (k HyperRep) p -&gt; Prob m (K1 i (k ProbsRep) p)
</span><a href="Inference.Conjugate.html#gsampleProbs"><span class="hs-identifier hs-var hs-var hs-var">gsampleProbs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">K1</span></span><span> </span><span id="local-6989586621679098820"><span class="annot"><span class="annottext">k HyperRep
</span><a href="#local-6989586621679098820"><span class="hs-identifier hs-var">hyper</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k ProbsRep -&gt; K1 i (k ProbsRep) p
forall k i c (p :: k). c -&gt; K1 i c p
</span><span class="hs-identifier hs-var">K1</span></span><span> </span><span class="annot"><span class="annottext">(k ProbsRep -&gt; K1 i (k ProbsRep) p)
-&gt; Prob m (k ProbsRep) -&gt; Prob m (K1 i (k ProbsRep) p)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">forall {k} (a :: k) (m :: * -&gt; *).
(Prior a, PrimMonad m) =&gt;
Hyper a -&gt; Prob m (Probs a)
forall (a :: (* -&gt; *) -&gt; *) (m :: * -&gt; *).
(Prior a, PrimMonad m) =&gt;
Hyper a -&gt; Prob m (Probs a)
</span><a href="Inference.Conjugate.html#sampleProbs"><span class="hs-identifier hs-var">sampleProbs</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679097906"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><span class="annottext">k HyperRep
Hyper k
</span><a href="#local-6989586621679098820"><span class="hs-identifier hs-var">hyper</span></a></span><span>
</span><span id="line-258"></span><span>  </span><span id="local-6989586621679098822"><span class="annot"><span class="annottext">gexpectedProbs :: forall (p :: k). K1 i (k HyperRep) p -&gt; K1 i (k ProbsRep) p
</span><a href="Inference.Conjugate.html#gexpectedProbs"><span class="hs-identifier hs-var hs-var hs-var">gexpectedProbs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">K1</span></span><span> </span><span id="local-6989586621679098823"><span class="annot"><span class="annottext">k HyperRep
</span><a href="#local-6989586621679098823"><span class="hs-identifier hs-var">hyper</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">k ProbsRep -&gt; K1 i (k ProbsRep) p
forall k i c (p :: k). c -&gt; K1 i c p
</span><span class="hs-identifier hs-var">K1</span></span><span> </span><span class="annot"><span class="annottext">(k ProbsRep -&gt; K1 i (k ProbsRep) p)
-&gt; k ProbsRep -&gt; K1 i (k ProbsRep) p
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall {k} (a :: k). Prior a =&gt; Hyper a -&gt; Probs a
forall (a :: (* -&gt; *) -&gt; *). Prior a =&gt; Hyper a -&gt; Probs a
</span><a href="Inference.Conjugate.html#expectedProbs"><span class="hs-identifier hs-var">expectedProbs</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679097906"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><span class="annottext">k HyperRep
Hyper k
</span><a href="#local-6989586621679098823"><span class="hs-identifier hs-var">hyper</span></a></span><span>
</span><span id="line-259"></span><span>
</span><span id="line-260"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679097920"><span id="local-6989586621679097921"><span id="local-6989586621679097922"><span id="local-6989586621679097923"><span id="local-6989586621679097924"><span id="local-6989586621679097925"><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#GPrior"><span class="hs-identifier hs-type">GPrior</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097920"><span class="hs-identifier hs-type">ti</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097921"><span class="hs-identifier hs-type">to</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#GPrior"><span class="hs-identifier hs-type">GPrior</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">M1</span></span><span> </span><span class="annot"><a href="#local-6989586621679097922"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097923"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097920"><span class="hs-identifier hs-type">ti</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">M1</span></span><span> </span><span class="annot"><a href="#local-6989586621679097924"><span class="hs-identifier hs-type">i'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097925"><span class="hs-identifier hs-type">c'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097921"><span class="hs-identifier hs-type">to</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-261"></span><span>  </span><span id="local-6989586621679098835"><span class="annot"><span class="annottext">gsampleProbs :: forall (m :: * -&gt; *) (p :: k).
PrimMonad m =&gt;
M1 i c ti p -&gt; Prob m (M1 i' c' to p)
</span><a href="Inference.Conjugate.html#gsampleProbs"><span class="hs-identifier hs-var hs-var hs-var">gsampleProbs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">M1</span></span><span> </span><span id="local-6989586621679098836"><span class="annot"><span class="annottext">ti p
</span><a href="#local-6989586621679098836"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">to p -&gt; M1 i' c' to p
forall k i (c :: Meta) (f :: k -&gt; *) (p :: k). f p -&gt; M1 i c f p
</span><span class="hs-identifier hs-var">M1</span></span><span> </span><span class="annot"><span class="annottext">(to p -&gt; M1 i' c' to p) -&gt; Prob m (to p) -&gt; Prob m (M1 i' c' to p)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ti p -&gt; Prob m (to p)
forall {k} (i :: k -&gt; *) (o :: k -&gt; *) (m :: * -&gt; *) (p :: k).
(GPrior i o, PrimMonad m) =&gt;
i p -&gt; Prob m (o p)
forall (m :: * -&gt; *) (p :: k). PrimMonad m =&gt; ti p -&gt; Prob m (to p)
</span><a href="Inference.Conjugate.html#gsampleProbs"><span class="hs-identifier hs-var">gsampleProbs</span></a></span><span> </span><span class="annot"><span class="annottext">ti p
</span><a href="#local-6989586621679098836"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-262"></span><span>  </span><span id="local-6989586621679098838"><span class="annot"><span class="annottext">gexpectedProbs :: forall (p :: k). M1 i c ti p -&gt; M1 i' c' to p
</span><a href="Inference.Conjugate.html#gexpectedProbs"><span class="hs-identifier hs-var hs-var hs-var">gexpectedProbs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">M1</span></span><span> </span><span id="local-6989586621679098839"><span class="annot"><span class="annottext">ti p
</span><a href="#local-6989586621679098839"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">to p -&gt; M1 i' c' to p
forall k i (c :: Meta) (f :: k -&gt; *) (p :: k). f p -&gt; M1 i c f p
</span><span class="hs-identifier hs-var">M1</span></span><span> </span><span class="annot"><span class="annottext">(to p -&gt; M1 i' c' to p) -&gt; to p -&gt; M1 i' c' to p
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ti p -&gt; to p
forall (p :: k). ti p -&gt; to p
forall {k} (i :: k -&gt; *) (o :: k -&gt; *) (p :: k).
GPrior i o =&gt;
i p -&gt; o p
</span><a href="Inference.Conjugate.html#gexpectedProbs"><span class="hs-identifier hs-var">gexpectedProbs</span></a></span><span> </span><span class="annot"><span class="annottext">ti p
</span><a href="#local-6989586621679098839"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-263"></span><span>
</span><span id="line-264"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679097935"><span id="local-6989586621679097936"><span id="local-6989586621679097937"><span id="local-6989586621679097938"><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#GPrior"><span class="hs-identifier hs-type">GPrior</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097935"><span class="hs-identifier hs-type">ia</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097936"><span class="hs-identifier hs-type">oa</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#GPrior"><span class="hs-identifier hs-type">GPrior</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097937"><span class="hs-identifier hs-type">ib</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097938"><span class="hs-identifier hs-type">ob</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#GPrior"><span class="hs-identifier hs-type">GPrior</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679097935"><span class="hs-identifier hs-type">ia</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:*:</span></span><span> </span><span class="annot"><a href="#local-6989586621679097937"><span class="hs-identifier hs-type">ib</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679097936"><span class="hs-identifier hs-type">oa</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:*:</span></span><span> </span><span class="annot"><a href="#local-6989586621679097938"><span class="hs-identifier hs-type">ob</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-265"></span><span>  </span><span id="local-6989586621679098855"><span class="annot"><span class="annottext">gsampleProbs :: forall (m :: * -&gt; *) (p :: k).
PrimMonad m =&gt;
(:*:) ia ib p -&gt; Prob m ((:*:) oa ob p)
</span><a href="Inference.Conjugate.html#gsampleProbs"><span class="hs-identifier hs-var hs-var hs-var">gsampleProbs</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679098856"><span class="annot"><span class="annottext">ia p
</span><a href="#local-6989586621679098856"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:*:</span></span><span> </span><span id="local-6989586621679098857"><span class="annot"><span class="annottext">ib p
</span><a href="#local-6989586621679098857"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">oa p -&gt; ob p -&gt; (:*:) oa ob p
forall k (f :: k -&gt; *) (g :: k -&gt; *) (p :: k).
f p -&gt; g p -&gt; (:*:) f g p
</span><span class="hs-operator hs-var">(:*:)</span></span><span> </span><span class="annot"><span class="annottext">(oa p -&gt; ob p -&gt; (:*:) oa ob p)
-&gt; Prob m (oa p) -&gt; Prob m (ob p -&gt; (:*:) oa ob p)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ia p -&gt; Prob m (oa p)
forall {k} (i :: k -&gt; *) (o :: k -&gt; *) (m :: * -&gt; *) (p :: k).
(GPrior i o, PrimMonad m) =&gt;
i p -&gt; Prob m (o p)
forall (m :: * -&gt; *) (p :: k). PrimMonad m =&gt; ia p -&gt; Prob m (oa p)
</span><a href="Inference.Conjugate.html#gsampleProbs"><span class="hs-identifier hs-var">gsampleProbs</span></a></span><span> </span><span class="annot"><span class="annottext">ia p
</span><a href="#local-6989586621679098856"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Prob m (ob p -&gt; (:*:) oa ob p)
-&gt; Prob m (ob p) -&gt; Prob m ((:*:) oa ob p)
forall a b. Prob m (a -&gt; b) -&gt; Prob m a -&gt; Prob m b
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">ib p -&gt; Prob m (ob p)
forall {k} (i :: k -&gt; *) (o :: k -&gt; *) (m :: * -&gt; *) (p :: k).
(GPrior i o, PrimMonad m) =&gt;
i p -&gt; Prob m (o p)
forall (m :: * -&gt; *) (p :: k). PrimMonad m =&gt; ib p -&gt; Prob m (ob p)
</span><a href="Inference.Conjugate.html#gsampleProbs"><span class="hs-identifier hs-var">gsampleProbs</span></a></span><span> </span><span class="annot"><span class="annottext">ib p
</span><a href="#local-6989586621679098857"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-266"></span><span>  </span><span id="local-6989586621679098860"><span class="annot"><span class="annottext">gexpectedProbs :: forall (p :: k). (:*:) ia ib p -&gt; (:*:) oa ob p
</span><a href="Inference.Conjugate.html#gexpectedProbs"><span class="hs-identifier hs-var hs-var hs-var">gexpectedProbs</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679098861"><span class="annot"><span class="annottext">ia p
</span><a href="#local-6989586621679098861"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:*:</span></span><span> </span><span id="local-6989586621679098862"><span class="annot"><span class="annottext">ib p
</span><a href="#local-6989586621679098862"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ia p -&gt; oa p
forall (p :: k). ia p -&gt; oa p
forall {k} (i :: k -&gt; *) (o :: k -&gt; *) (p :: k).
GPrior i o =&gt;
i p -&gt; o p
</span><a href="Inference.Conjugate.html#gexpectedProbs"><span class="hs-identifier hs-var">gexpectedProbs</span></a></span><span> </span><span class="annot"><span class="annottext">ia p
</span><a href="#local-6989586621679098861"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">oa p -&gt; ob p -&gt; (:*:) oa ob p
forall k (f :: k -&gt; *) (g :: k -&gt; *) (p :: k).
f p -&gt; g p -&gt; (:*:) f g p
</span><span class="hs-operator hs-var">:*:</span></span><span> </span><span class="annot"><span class="annottext">ib p -&gt; ob p
forall (p :: k). ib p -&gt; ob p
forall {k} (i :: k -&gt; *) (o :: k -&gt; *) (p :: k).
GPrior i o =&gt;
i p -&gt; o p
</span><a href="Inference.Conjugate.html#gexpectedProbs"><span class="hs-identifier hs-var">gexpectedProbs</span></a></span><span> </span><span class="annot"><span class="annottext">ib p
</span><a href="#local-6989586621679098862"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-267"></span><span>
</span><span id="line-268"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679097950"><span id="local-6989586621679097951"><span id="local-6989586621679097952"><span id="local-6989586621679097953"><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#GPrior"><span class="hs-identifier hs-type">GPrior</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097950"><span class="hs-identifier hs-type">ia</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097951"><span class="hs-identifier hs-type">oa</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#GPrior"><span class="hs-identifier hs-type">GPrior</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097952"><span class="hs-identifier hs-type">ib</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097953"><span class="hs-identifier hs-type">ob</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#GPrior"><span class="hs-identifier hs-type">GPrior</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679097950"><span class="hs-identifier hs-type">ia</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+:</span></span><span> </span><span class="annot"><a href="#local-6989586621679097952"><span class="hs-identifier hs-type">ib</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679097951"><span class="hs-identifier hs-type">oa</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+:</span></span><span> </span><span class="annot"><a href="#local-6989586621679097953"><span class="hs-identifier hs-type">ob</span></a></span><span class="hs-special">)</span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-269"></span><span>  </span><span id="local-6989586621679098878"><span class="annot"><span class="annottext">gsampleProbs :: forall (m :: * -&gt; *) (p :: k).
PrimMonad m =&gt;
(:+:) ia ib p -&gt; Prob m ((:+:) oa ob p)
</span><a href="Inference.Conjugate.html#gsampleProbs"><span class="hs-identifier hs-var hs-var hs-var">gsampleProbs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">L1</span></span><span> </span><span id="local-6989586621679098880"><span class="annot"><span class="annottext">ia p
</span><a href="#local-6989586621679098880"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">oa p -&gt; (:+:) oa ob p
forall k (f :: k -&gt; *) (g :: k -&gt; *) (p :: k). f p -&gt; (:+:) f g p
</span><span class="hs-identifier hs-var">L1</span></span><span> </span><span class="annot"><span class="annottext">(oa p -&gt; (:+:) oa ob p) -&gt; Prob m (oa p) -&gt; Prob m ((:+:) oa ob p)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ia p -&gt; Prob m (oa p)
forall {k} (i :: k -&gt; *) (o :: k -&gt; *) (m :: * -&gt; *) (p :: k).
(GPrior i o, PrimMonad m) =&gt;
i p -&gt; Prob m (o p)
forall (m :: * -&gt; *) (p :: k). PrimMonad m =&gt; ia p -&gt; Prob m (oa p)
</span><a href="Inference.Conjugate.html#gsampleProbs"><span class="hs-identifier hs-var">gsampleProbs</span></a></span><span> </span><span class="annot"><span class="annottext">ia p
</span><a href="#local-6989586621679098880"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-270"></span><span>  </span><span class="annot"><a href="Inference.Conjugate.html#gsampleProbs"><span class="hs-identifier hs-var">gsampleProbs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">R1</span></span><span> </span><span id="local-6989586621679098882"><span class="annot"><span class="annottext">ib p
</span><a href="#local-6989586621679098882"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ob p -&gt; (:+:) oa ob p
forall k (f :: k -&gt; *) (g :: k -&gt; *) (p :: k). g p -&gt; (:+:) f g p
</span><span class="hs-identifier hs-var">R1</span></span><span> </span><span class="annot"><span class="annottext">(ob p -&gt; (:+:) oa ob p) -&gt; Prob m (ob p) -&gt; Prob m ((:+:) oa ob p)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">ib p -&gt; Prob m (ob p)
forall {k} (i :: k -&gt; *) (o :: k -&gt; *) (m :: * -&gt; *) (p :: k).
(GPrior i o, PrimMonad m) =&gt;
i p -&gt; Prob m (o p)
forall (m :: * -&gt; *) (p :: k). PrimMonad m =&gt; ib p -&gt; Prob m (ob p)
</span><a href="Inference.Conjugate.html#gsampleProbs"><span class="hs-identifier hs-var">gsampleProbs</span></a></span><span> </span><span class="annot"><span class="annottext">ib p
</span><a href="#local-6989586621679098882"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-271"></span><span>  </span><span id="local-6989586621679098885"><span class="annot"><span class="annottext">gexpectedProbs :: forall (p :: k). (:+:) ia ib p -&gt; (:+:) oa ob p
</span><a href="Inference.Conjugate.html#gexpectedProbs"><span class="hs-identifier hs-var hs-var hs-var">gexpectedProbs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">L1</span></span><span> </span><span id="local-6989586621679098886"><span class="annot"><span class="annottext">ia p
</span><a href="#local-6989586621679098886"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">oa p -&gt; (:+:) oa ob p
forall k (f :: k -&gt; *) (g :: k -&gt; *) (p :: k). f p -&gt; (:+:) f g p
</span><span class="hs-identifier hs-var">L1</span></span><span> </span><span class="annot"><span class="annottext">(oa p -&gt; (:+:) oa ob p) -&gt; oa p -&gt; (:+:) oa ob p
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ia p -&gt; oa p
forall (p :: k). ia p -&gt; oa p
forall {k} (i :: k -&gt; *) (o :: k -&gt; *) (p :: k).
GPrior i o =&gt;
i p -&gt; o p
</span><a href="Inference.Conjugate.html#gexpectedProbs"><span class="hs-identifier hs-var">gexpectedProbs</span></a></span><span> </span><span class="annot"><span class="annottext">ia p
</span><a href="#local-6989586621679098886"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-272"></span><span>  </span><span class="annot"><a href="Inference.Conjugate.html#gexpectedProbs"><span class="hs-identifier hs-var">gexpectedProbs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">R1</span></span><span> </span><span id="local-6989586621679098887"><span class="annot"><span class="annottext">ib p
</span><a href="#local-6989586621679098887"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ob p -&gt; (:+:) oa ob p
forall k (f :: k -&gt; *) (g :: k -&gt; *) (p :: k). g p -&gt; (:+:) f g p
</span><span class="hs-identifier hs-var">R1</span></span><span> </span><span class="annot"><span class="annottext">(ob p -&gt; (:+:) oa ob p) -&gt; ob p -&gt; (:+:) oa ob p
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ib p -&gt; ob p
forall (p :: k). ib p -&gt; ob p
forall {k} (i :: k -&gt; *) (o :: k -&gt; *) (p :: k).
GPrior i o =&gt;
i p -&gt; o p
</span><a href="Inference.Conjugate.html#gexpectedProbs"><span class="hs-identifier hs-var">gexpectedProbs</span></a></span><span> </span><span class="annot"><span class="annottext">ib p
</span><a href="#local-6989586621679098887"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-273"></span><span>
</span><span id="line-274"></span><span class="hs-keyword">instance</span><span>
</span><span id="line-275"></span><span>  </span><span id="local-6989586621679097962"><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Generic</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679097962"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#HyperRep"><span class="hs-identifier hs-type">HyperRep</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-276"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Generic</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679097962"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#ProbsRep"><span class="hs-identifier hs-type">ProbsRep</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-277"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#GPrior"><span class="hs-identifier hs-type">GPrior</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Rep</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679097962"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#HyperRep"><span class="hs-identifier hs-type">HyperRep</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Rep</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679097962"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#ProbsRep"><span class="hs-identifier hs-type">ProbsRep</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-278"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-279"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Prior"><span class="hs-identifier hs-type">Prior</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679097962"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-280"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-281"></span><span>  </span><span id="local-6989586621679098904"><span class="annot"><span class="annottext">sampleProbs :: forall (m :: * -&gt; *). PrimMonad m =&gt; Hyper a -&gt; Prob m (Probs a)
</span><a href="Inference.Conjugate.html#sampleProbs"><span class="hs-identifier hs-var hs-var hs-var">sampleProbs</span></a></span></span><span> </span><span id="local-6989586621679098905"><span class="annot"><span class="annottext">Hyper a
</span><a href="#local-6989586621679098905"><span class="hs-identifier hs-var">hyper</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rep (a ProbsRep) (ZonkAny 1) -&gt; a ProbsRep
forall a x. Generic a =&gt; Rep a x -&gt; a
forall x. Rep (a ProbsRep) x -&gt; a ProbsRep
</span><span class="hs-identifier hs-var">GHC.Generics.to</span></span><span> </span><span class="annot"><span class="annottext">(Rep (a ProbsRep) (ZonkAny 1) -&gt; a ProbsRep)
-&gt; Prob m (Rep (a ProbsRep) (ZonkAny 1)) -&gt; Prob m (a ProbsRep)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Rep (a HyperRep) (ZonkAny 1)
-&gt; Prob m (Rep (a ProbsRep) (ZonkAny 1))
forall {k} (i :: k -&gt; *) (o :: k -&gt; *) (m :: * -&gt; *) (p :: k).
(GPrior i o, PrimMonad m) =&gt;
i p -&gt; Prob m (o p)
forall (m :: * -&gt; *) p.
PrimMonad m =&gt;
Rep (a HyperRep) p -&gt; Prob m (Rep (a ProbsRep) p)
</span><a href="Inference.Conjugate.html#gsampleProbs"><span class="hs-identifier hs-var">gsampleProbs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a HyperRep -&gt; Rep (a HyperRep) (ZonkAny 1)
forall x. a HyperRep -&gt; Rep (a HyperRep) x
forall a x. Generic a =&gt; a -&gt; Rep a x
</span><span class="hs-identifier hs-var">from</span></span><span> </span><span class="annot"><span class="annottext">a HyperRep
Hyper a
</span><a href="#local-6989586621679098905"><span class="hs-identifier hs-var">hyper</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-282"></span><span>  </span><span id="local-6989586621679098910"><span class="annot"><span class="annottext">expectedProbs :: Hyper a -&gt; Probs a
</span><a href="Inference.Conjugate.html#expectedProbs"><span class="hs-identifier hs-var hs-var hs-var">expectedProbs</span></a></span></span><span> </span><span id="local-6989586621679098911"><span class="annot"><span class="annottext">Hyper a
</span><a href="#local-6989586621679098911"><span class="hs-identifier hs-var">hyper</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rep (Probs a) (ZonkAny 2) -&gt; Probs a
forall a x. Generic a =&gt; Rep a x -&gt; a
forall x. Rep (Probs a) x -&gt; Probs a
</span><span class="hs-identifier hs-var">GHC.Generics.to</span></span><span> </span><span class="annot"><span class="annottext">(Rep (Probs a) (ZonkAny 2) -&gt; Probs a)
-&gt; Rep (Probs a) (ZonkAny 2) -&gt; Probs a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Rep (a HyperRep) (ZonkAny 2) -&gt; Rep (Probs a) (ZonkAny 2)
forall p. Rep (a HyperRep) p -&gt; Rep (Probs a) p
forall {k} (i :: k -&gt; *) (o :: k -&gt; *) (p :: k).
GPrior i o =&gt;
i p -&gt; o p
</span><a href="Inference.Conjugate.html#gexpectedProbs"><span class="hs-identifier hs-var">gexpectedProbs</span></a></span><span> </span><span class="annot"><span class="annottext">(Rep (a HyperRep) (ZonkAny 2) -&gt; Rep (Probs a) (ZonkAny 2))
-&gt; Rep (a HyperRep) (ZonkAny 2) -&gt; Rep (Probs a) (ZonkAny 2)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a HyperRep -&gt; Rep (a HyperRep) (ZonkAny 2)
forall x. a HyperRep -&gt; Rep (a HyperRep) x
forall a x. Generic a =&gt; a -&gt; Rep a x
</span><span class="hs-identifier hs-var">from</span></span><span> </span><span class="annot"><span class="annottext">a HyperRep
Hyper a
</span><a href="#local-6989586621679098911"><span class="hs-identifier hs-var">hyper</span></a></span><span>
</span><span id="line-283"></span><span>
</span><span id="line-284"></span><span class="hs-comment">-----------------------</span><span>
</span><span id="line-285"></span><span class="hs-comment">-- likelihood monads --</span><span>
</span><span id="line-286"></span><span class="hs-comment">-----------------------</span><span>
</span><span id="line-287"></span><span>
</span><span id="line-288"></span><span class="hs-keyword">type</span><span> </span><span id="Accessor"><span class="annot"><a href="Inference.Conjugate.html#Accessor"><span class="hs-identifier hs-var">Accessor</span></a></span></span><span> </span><span id="local-6989586621679098912"><span class="annot"><a href="#local-6989586621679098912"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span id="local-6989586621679098913"><span class="annot"><a href="#local-6989586621679098913"><span class="hs-identifier hs-type">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679098914"><span class="annot"><a href="#local-6989586621679098914"><span class="hs-identifier hs-type">f</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lens'</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679098912"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098914"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679098914"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098913"><span class="hs-identifier hs-type">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-289"></span><span>
</span><span id="line-290"></span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679097965"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="RandomInterpreter"><span class="annot"><a href="Inference.Conjugate.html#RandomInterpreter"><span class="hs-identifier hs-var">RandomInterpreter</span></a></span></span><span> </span><span id="local-6989586621679097965"><span class="annot"><a href="#local-6989586621679097965"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679097966"><span class="annot"><a href="#local-6989586621679097966"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="#local-6989586621679097965"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679097966"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-291"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="SampleCtx"><span class="annot"><a href="Inference.Conjugate.html#SampleCtx"><span class="hs-identifier hs-var">SampleCtx</span></a></span></span><span> </span><span id="local-6989586621679097965"><span class="annot"><a href="#local-6989586621679097965"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679098917"><span class="annot"><a href="#local-6989586621679098917"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Constraint</span></span><span>
</span><span id="line-292"></span><span>  </span><span id="sampleValue"><span class="annot"><a href="Inference.Conjugate.html#sampleValue"><span class="hs-identifier hs-type">sampleValue</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679098073"><span id="local-6989586621679098074"><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Conjugate"><span class="hs-identifier hs-type">Conjugate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098073"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098074"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#SampleCtx"><span class="hs-identifier hs-type">SampleCtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097965"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098074"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679098074"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Accessor"><span class="hs-identifier hs-type">Accessor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097966"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098073"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679097965"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Support"><span class="hs-identifier hs-type">Support</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098074"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-293"></span><span>  </span><span id="sampleConst"><span class="annot"><a href="Inference.Conjugate.html#sampleConst"><span class="hs-identifier hs-type">sampleConst</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679098076"><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Distribution"><span class="hs-identifier hs-type">Distribution</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098076"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#SampleCtx"><span class="hs-identifier hs-type">SampleCtx</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097965"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098076"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679098076"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Params"><span class="hs-identifier hs-type">Params</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098076"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679097965"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Support"><span class="hs-identifier hs-type">Support</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098076"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-294"></span><span>  </span><span id="permutationPlate"><span class="annot"><a href="Inference.Conjugate.html#permutationPlate"><span class="hs-identifier hs-type">permutationPlate</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679098077"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679098077"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679097965"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098077"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679097965"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679098077"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-295"></span><span>
</span><span id="line-296"></span><span class="hs-keyword">newtype</span><span> </span><span id="Trace"><span class="annot"><a href="Inference.Conjugate.html#Trace"><span class="hs-identifier hs-var">Trace</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679097968"><span class="annot"><a href="#local-6989586621679097968"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Trace"><span class="annot"><a href="Inference.Conjugate.html#Trace"><span class="hs-identifier hs-var">Trace</span></a></span></span><span> </span><span class="hs-special">{</span><span id="runTrace"><span class="annot"><span class="annottext">forall (r :: (* -&gt; *) -&gt; *). Trace r -&gt; Seq (String, Dynamic)
</span><a href="Inference.Conjugate.html#runTrace"><span class="hs-identifier hs-var hs-var">runTrace</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">S.Seq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dynamic</span></span><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><span id="line-297"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679098924"><span id="local-6989586621679098930"><span id="local-6989586621679098934"><span class="annot"><span class="annottext">Int -&gt; Trace r -&gt; ShowS
[Trace r] -&gt; ShowS
Trace r -&gt; String
(Int -&gt; Trace r -&gt; ShowS)
-&gt; (Trace r -&gt; String) -&gt; ([Trace r] -&gt; ShowS) -&gt; Show (Trace r)
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
forall (r :: (* -&gt; *) -&gt; *). Int -&gt; Trace r -&gt; ShowS
forall (r :: (* -&gt; *) -&gt; *). [Trace r] -&gt; ShowS
forall (r :: (* -&gt; *) -&gt; *). Trace r -&gt; String
$cshowsPrec :: forall (r :: (* -&gt; *) -&gt; *). Int -&gt; Trace r -&gt; ShowS
showsPrec :: Int -&gt; Trace r -&gt; ShowS
$cshow :: forall (r :: (* -&gt; *) -&gt; *). Trace r -&gt; String
show :: Trace r -&gt; String
$cshowList :: forall (r :: (* -&gt; *) -&gt; *). [Trace r] -&gt; ShowS
showList :: [Trace r] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-298"></span><span>
</span><span id="line-299"></span><span id="local-6989586621679097979"><span id="local-6989586621679097980"><span id="local-6989586621679097981"><span id="local-6989586621679097982"><span class="annot"><a href="Inference.Conjugate.html#observeValue"><span class="hs-identifier hs-type">observeValue</span></a></span><span>
</span><span id="line-300"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Conjugate"><span class="hs-identifier hs-type">Conjugate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097979"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097980"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Support"><span class="hs-identifier hs-type">Support</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097980"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679097981"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-301"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-302"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679097980"><span class="hs-identifier hs-type">l</span></a></span><span>
</span><span id="line-303"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Accessor"><span class="hs-identifier hs-type">Accessor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097982"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097979"><span class="hs-identifier hs-type">p</span></a></span><span>
</span><span id="line-304"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Support"><span class="hs-identifier hs-type">Support</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097980"><span class="hs-identifier hs-type">l</span></a></span><span>
</span><span id="line-305"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StateT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Trace"><span class="hs-identifier hs-type">Trace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097982"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679097981"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-306"></span><span id="observeValue"><span class="annot"><span class="annottext">observeValue :: forall p l (m :: * -&gt; *) (r :: (* -&gt; *) -&gt; *).
(Conjugate p l, Typeable (Support l), Monad m) =&gt;
String -&gt; l -&gt; Accessor r p -&gt; Support l -&gt; StateT (Trace r) m ()
</span><a href="Inference.Conjugate.html#observeValue"><span class="hs-identifier hs-var hs-var">observeValue</span></a></span></span><span> </span><span id="local-6989586621679098950"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679098950"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="annot"><span class="annottext">l
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Accessor r p
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679098951"><span class="annot"><span class="annottext">Support l
</span><a href="#local-6989586621679098951"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Trace r -&gt; Trace r) -&gt; StateT (Trace r) m ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((Trace r -&gt; Trace r) -&gt; StateT (Trace r) m ())
-&gt; (Trace r -&gt; Trace r) -&gt; StateT (Trace r) m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Trace"><span class="hs-identifier hs-type">Trace</span></a></span><span> </span><span id="local-6989586621679098952"><span class="annot"><span class="annottext">Seq (String, Dynamic)
</span><a href="#local-6989586621679098952"><span class="hs-identifier hs-var">st</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Seq (String, Dynamic) -&gt; Trace r
forall (r :: (* -&gt; *) -&gt; *). Seq (String, Dynamic) -&gt; Trace r
</span><a href="Inference.Conjugate.html#Trace"><span class="hs-identifier hs-var">Trace</span></a></span><span> </span><span class="annot"><span class="annottext">(Seq (String, Dynamic) -&gt; Trace r)
-&gt; Seq (String, Dynamic) -&gt; Trace r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Seq (String, Dynamic)
</span><a href="#local-6989586621679098952"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">Seq (String, Dynamic) -&gt; (String, Dynamic) -&gt; Seq (String, Dynamic)
forall a. Seq a -&gt; a -&gt; Seq a
</span><span class="hs-operator hs-var">S.|&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679098950"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Support l -&gt; Dynamic
forall a. Typeable a =&gt; a -&gt; Dynamic
</span><span class="hs-identifier hs-var">toDyn</span></span><span> </span><span class="annot"><span class="annottext">Support l
</span><a href="#local-6989586621679098951"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-307"></span><span>
</span><span id="line-308"></span><span id="local-6989586621679097996"><span id="local-6989586621679097997"><span id="local-6989586621679097998"><span class="annot"><a href="Inference.Conjugate.html#observeConst"><span class="hs-identifier hs-type">observeConst</span></a></span><span>
</span><span id="line-309"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Distribution"><span class="hs-identifier hs-type">Distribution</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097996"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Support"><span class="hs-identifier hs-type">Support</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097996"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monad</span></span><span> </span><span class="annot"><a href="#local-6989586621679097997"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-310"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-311"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679097996"><span class="hs-identifier hs-type">d</span></a></span><span>
</span><span id="line-312"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Params"><span class="hs-identifier hs-type">Params</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097996"><span class="hs-identifier hs-type">d</span></a></span><span>
</span><span id="line-313"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Support"><span class="hs-identifier hs-type">Support</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097996"><span class="hs-identifier hs-type">d</span></a></span><span>
</span><span id="line-314"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StateT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Trace"><span class="hs-identifier hs-type">Trace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679097998"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679097997"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-315"></span><span id="observeConst"><span class="annot"><span class="annottext">observeConst :: forall d (m :: * -&gt; *) (r :: (* -&gt; *) -&gt; *).
(Distribution d, Typeable (Support d), Monad m) =&gt;
String -&gt; d -&gt; Params d -&gt; Support d -&gt; StateT (Trace r) m ()
</span><a href="Inference.Conjugate.html#observeConst"><span class="hs-identifier hs-var hs-var">observeConst</span></a></span></span><span> </span><span id="local-6989586621679098960"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679098960"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="annot"><span class="annottext">d
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Params d
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679098961"><span class="annot"><span class="annottext">Support d
</span><a href="#local-6989586621679098961"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Trace r -&gt; Trace r) -&gt; StateT (Trace r) m ()
forall s (m :: * -&gt; *). MonadState s m =&gt; (s -&gt; s) -&gt; m ()
</span><span class="hs-identifier hs-var">modify</span></span><span> </span><span class="annot"><span class="annottext">((Trace r -&gt; Trace r) -&gt; StateT (Trace r) m ())
-&gt; (Trace r -&gt; Trace r) -&gt; StateT (Trace r) m ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Trace"><span class="hs-identifier hs-type">Trace</span></a></span><span> </span><span id="local-6989586621679098962"><span class="annot"><span class="annottext">Seq (String, Dynamic)
</span><a href="#local-6989586621679098962"><span class="hs-identifier hs-var">st</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Seq (String, Dynamic) -&gt; Trace r
forall (r :: (* -&gt; *) -&gt; *). Seq (String, Dynamic) -&gt; Trace r
</span><a href="Inference.Conjugate.html#Trace"><span class="hs-identifier hs-var">Trace</span></a></span><span> </span><span class="annot"><span class="annottext">(Seq (String, Dynamic) -&gt; Trace r)
-&gt; Seq (String, Dynamic) -&gt; Trace r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Seq (String, Dynamic)
</span><a href="#local-6989586621679098962"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">Seq (String, Dynamic) -&gt; (String, Dynamic) -&gt; Seq (String, Dynamic)
forall a. Seq a -&gt; a -&gt; Seq a
</span><span class="hs-operator hs-var">S.|&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679098960"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Support d -&gt; Dynamic
forall a. Typeable a =&gt; a -&gt; Dynamic
</span><span class="hs-identifier hs-var">toDyn</span></span><span> </span><span class="annot"><span class="annottext">Support d
</span><a href="#local-6989586621679098961"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-316"></span><span>
</span><span id="line-317"></span><span id="local-6989586621679098002"><span id="local-6989586621679098003"><span class="annot"><a href="Inference.Conjugate.html#takeTrace"><span class="hs-identifier hs-type">takeTrace</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621679098002"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Trace"><span class="hs-identifier hs-type">Trace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098003"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679098002"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Trace"><span class="hs-identifier hs-type">Trace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098003"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-318"></span><span id="takeTrace"><span class="annot"><span class="annottext">takeTrace :: forall a (r :: (* -&gt; *) -&gt; *).
Typeable a =&gt;
Trace r -&gt; Maybe ((String, a), Trace r)
</span><a href="Inference.Conjugate.html#takeTrace"><span class="hs-identifier hs-var hs-var">takeTrace</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Trace"><span class="hs-identifier hs-type">Trace</span></a></span><span> </span><span id="local-6989586621679098971"><span class="annot"><span class="annottext">Seq (String, Dynamic)
</span><a href="#local-6989586621679098971"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-319"></span><span>  </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679098972"><span class="annot"><a href="#local-6989586621679098972"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679098973"><span class="annot"><a href="#local-6989586621679098973"><span class="hs-identifier hs-var">valDyn</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679098974"><span class="annot"><a href="#local-6989586621679098974"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Seq (String, Dynamic) -&gt; ViewL (String, Dynamic)
forall a. Seq a -&gt; ViewL a
</span><span class="hs-identifier hs-var">S.viewl</span></span><span> </span><span class="annot"><span class="annottext">Seq (String, Dynamic)
</span><a href="#local-6989586621679098971"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-320"></span><span>    </span><span class="annot"><span class="annottext">ViewL (String, Dynamic)
</span><span class="hs-identifier hs-var">S.EmptyL</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe ((String, Dynamic), Seq (String, Dynamic))
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-321"></span><span>    </span><span id="local-6989586621679098977"><span class="annot"><span class="annottext">(String, Dynamic)
</span><a href="#local-6989586621679098977"><span class="hs-identifier hs-var">entry</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">S.:&lt;</span></span><span> </span><span id="local-6989586621679098979"><span class="annot"><span class="annottext">Seq (String, Dynamic)
</span><a href="#local-6989586621679098979"><span class="hs-identifier hs-var">rest</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">((String, Dynamic), Seq (String, Dynamic))
-&gt; Maybe ((String, Dynamic), Seq (String, Dynamic))
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(String, Dynamic)
</span><a href="#local-6989586621679098977"><span class="hs-identifier hs-var">entry</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Seq (String, Dynamic)
</span><a href="#local-6989586621679098979"><span class="hs-identifier hs-var">rest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-322"></span><span>  </span><span id="local-6989586621679098980"><span class="annot"><a href="#local-6989586621679098980"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">fromDynamic</span></span><span> </span><span class="annot"><a href="#local-6989586621679098973"><span class="hs-identifier hs-type">valDyn</span></a></span><span>
</span><span id="line-323"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679098972"><span class="hs-identifier hs-type">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679098980"><span class="hs-identifier hs-type">val</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Trace"><span class="hs-identifier hs-type">Trace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098974"><span class="hs-identifier hs-type">rest</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-324"></span><span>
</span><span id="line-325"></span><span id="local-6989586621679098010"><span class="annot"><a href="Inference.Conjugate.html#peekTrace"><span class="hs-identifier hs-type">peekTrace</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Trace"><span class="hs-identifier hs-type">Trace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098010"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Dynamic</span></span><span class="hs-special">)</span></span><span>
</span><span id="line-326"></span><span id="peekTrace"><span class="annot"><span class="annottext">peekTrace :: forall (r :: (* -&gt; *) -&gt; *). Trace r -&gt; Maybe (String, Dynamic)
</span><a href="Inference.Conjugate.html#peekTrace"><span class="hs-identifier hs-var hs-var">peekTrace</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Trace"><span class="hs-identifier hs-type">Trace</span></a></span><span> </span><span id="local-6989586621679098982"><span class="annot"><span class="annottext">Seq (String, Dynamic)
</span><a href="#local-6989586621679098982"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Seq (String, Dynamic) -&gt; ViewL (String, Dynamic)
forall a. Seq a -&gt; ViewL a
</span><span class="hs-identifier hs-var">S.viewl</span></span><span> </span><span class="annot"><span class="annottext">Seq (String, Dynamic)
</span><a href="#local-6989586621679098982"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-327"></span><span>  </span><span class="annot"><span class="annottext">ViewL (String, Dynamic)
</span><span class="hs-identifier hs-var">S.EmptyL</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (String, Dynamic)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-328"></span><span>  </span><span id="local-6989586621679098983"><span class="annot"><span class="annottext">(String, Dynamic)
</span><a href="#local-6989586621679098983"><span class="hs-identifier hs-var">item</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">S.:&lt;</span></span><span> </span><span id="local-6989586621679098984"><span class="annot"><span class="annottext">Seq (String, Dynamic)
</span><a href="#local-6989586621679098984"><span class="hs-identifier hs-var">_rest</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(String, Dynamic) -&gt; Maybe (String, Dynamic)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(String, Dynamic)
</span><a href="#local-6989586621679098983"><span class="hs-identifier hs-var">item</span></a></span><span>
</span><span id="line-329"></span><span>
</span><span id="line-330"></span><span class="hs-comment">-- just sample</span><span>
</span><span id="line-331"></span><span class="hs-comment">-- -----------</span><span>
</span><span id="line-332"></span><span>
</span><span id="line-333"></span><span class="hs-keyword">newtype</span><span> </span><span id="SampleI"><span class="annot"><a href="Inference.Conjugate.html#SampleI"><span class="hs-identifier hs-var">SampleI</span></a></span></span><span> </span><span id="local-6989586621679098095"><span class="annot"><a href="#local-6989586621679098095"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679098094"><span class="annot"><a href="#local-6989586621679098094"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span id="local-6989586621679098096"><span class="annot"><a href="#local-6989586621679098096"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="SampleI"><span class="annot"><a href="Inference.Conjugate.html#SampleI"><span class="hs-identifier hs-var">SampleI</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679098094"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#ProbsRep"><span class="hs-identifier hs-type">ProbsRep</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Prob</span></span><span> </span><span class="annot"><a href="#local-6989586621679098095"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679098096"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-334"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679098988"><span id="local-6989586621679098994"><span class="annot"><span class="annottext">(forall a b. (a -&gt; b) -&gt; SampleI m r a -&gt; SampleI m r b)
-&gt; (forall a b. a -&gt; SampleI m r b -&gt; SampleI m r a)
-&gt; Functor (SampleI m r)
forall a b. a -&gt; SampleI m r b -&gt; SampleI m r a
forall a b. (a -&gt; b) -&gt; SampleI m r a -&gt; SampleI m r b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
forall (m :: * -&gt; *) (r :: (* -&gt; *) -&gt; *) a b.
Functor m =&gt;
a -&gt; SampleI m r b -&gt; SampleI m r a
forall (m :: * -&gt; *) (r :: (* -&gt; *) -&gt; *) a b.
Functor m =&gt;
(a -&gt; b) -&gt; SampleI m r a -&gt; SampleI m r b
$cfmap :: forall (m :: * -&gt; *) (r :: (* -&gt; *) -&gt; *) a b.
Functor m =&gt;
(a -&gt; b) -&gt; SampleI m r a -&gt; SampleI m r b
fmap :: forall a b. (a -&gt; b) -&gt; SampleI m r a -&gt; SampleI m r b
$c&lt;$ :: forall (m :: * -&gt; *) (r :: (* -&gt; *) -&gt; *) a b.
Functor m =&gt;
a -&gt; SampleI m r b -&gt; SampleI m r a
&lt;$ :: forall a b. a -&gt; SampleI m r b -&gt; SampleI m r a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679099006"><span id="local-6989586621679099012"><span id="local-6989586621679099017"><span id="local-6989586621679099022"><span id="local-6989586621679099027"><span class="annot"><span class="annottext">Functor (SampleI m r)
Functor (SampleI m r) =&gt;
(forall a. a -&gt; SampleI m r a)
-&gt; (forall a b.
    SampleI m r (a -&gt; b) -&gt; SampleI m r a -&gt; SampleI m r b)
-&gt; (forall a b c.
    (a -&gt; b -&gt; c) -&gt; SampleI m r a -&gt; SampleI m r b -&gt; SampleI m r c)
-&gt; (forall a b. SampleI m r a -&gt; SampleI m r b -&gt; SampleI m r b)
-&gt; (forall a b. SampleI m r a -&gt; SampleI m r b -&gt; SampleI m r a)
-&gt; Applicative (SampleI m r)
forall a. a -&gt; SampleI m r a
forall a b. SampleI m r a -&gt; SampleI m r b -&gt; SampleI m r a
forall a b. SampleI m r a -&gt; SampleI m r b -&gt; SampleI m r b
forall a b. SampleI m r (a -&gt; b) -&gt; SampleI m r a -&gt; SampleI m r b
forall a b c.
(a -&gt; b -&gt; c) -&gt; SampleI m r a -&gt; SampleI m r b -&gt; SampleI m r c
forall (f :: * -&gt; *).
Functor f =&gt;
(forall a. a -&gt; f a)
-&gt; (forall a b. f (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b c. (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c)
-&gt; (forall a b. f a -&gt; f b -&gt; f b)
-&gt; (forall a b. f a -&gt; f b -&gt; f a)
-&gt; Applicative f
forall (m :: * -&gt; *) (r :: (* -&gt; *) -&gt; *).
Monad m =&gt;
Functor (SampleI m r)
forall (m :: * -&gt; *) (r :: (* -&gt; *) -&gt; *) a.
Monad m =&gt;
a -&gt; SampleI m r a
forall (m :: * -&gt; *) (r :: (* -&gt; *) -&gt; *) a b.
Monad m =&gt;
SampleI m r a -&gt; SampleI m r b -&gt; SampleI m r a
forall (m :: * -&gt; *) (r :: (* -&gt; *) -&gt; *) a b.
Monad m =&gt;
SampleI m r a -&gt; SampleI m r b -&gt; SampleI m r b
forall (m :: * -&gt; *) (r :: (* -&gt; *) -&gt; *) a b.
Monad m =&gt;
SampleI m r (a -&gt; b) -&gt; SampleI m r a -&gt; SampleI m r b
forall (m :: * -&gt; *) (r :: (* -&gt; *) -&gt; *) a b c.
Monad m =&gt;
(a -&gt; b -&gt; c) -&gt; SampleI m r a -&gt; SampleI m r b -&gt; SampleI m r c
$cpure :: forall (m :: * -&gt; *) (r :: (* -&gt; *) -&gt; *) a.
Monad m =&gt;
a -&gt; SampleI m r a
pure :: forall a. a -&gt; SampleI m r a
$c&lt;*&gt; :: forall (m :: * -&gt; *) (r :: (* -&gt; *) -&gt; *) a b.
Monad m =&gt;
SampleI m r (a -&gt; b) -&gt; SampleI m r a -&gt; SampleI m r b
&lt;*&gt; :: forall a b. SampleI m r (a -&gt; b) -&gt; SampleI m r a -&gt; SampleI m r b
$cliftA2 :: forall (m :: * -&gt; *) (r :: (* -&gt; *) -&gt; *) a b c.
Monad m =&gt;
(a -&gt; b -&gt; c) -&gt; SampleI m r a -&gt; SampleI m r b -&gt; SampleI m r c
liftA2 :: forall a b c.
(a -&gt; b -&gt; c) -&gt; SampleI m r a -&gt; SampleI m r b -&gt; SampleI m r c
$c*&gt; :: forall (m :: * -&gt; *) (r :: (* -&gt; *) -&gt; *) a b.
Monad m =&gt;
SampleI m r a -&gt; SampleI m r b -&gt; SampleI m r b
*&gt; :: forall a b. SampleI m r a -&gt; SampleI m r b -&gt; SampleI m r b
$c&lt;* :: forall (m :: * -&gt; *) (r :: (* -&gt; *) -&gt; *) a b.
Monad m =&gt;
SampleI m r a -&gt; SampleI m r b -&gt; SampleI m r a
&lt;* :: forall a b. SampleI m r a -&gt; SampleI m r b -&gt; SampleI m r a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Applicative</span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679099040"><span id="local-6989586621679099046"><span id="local-6989586621679099051"><span class="annot"><span class="annottext">Applicative (SampleI m r)
Applicative (SampleI m r) =&gt;
(forall a b.
 SampleI m r a -&gt; (a -&gt; SampleI m r b) -&gt; SampleI m r b)
-&gt; (forall a b. SampleI m r a -&gt; SampleI m r b -&gt; SampleI m r b)
-&gt; (forall a. a -&gt; SampleI m r a)
-&gt; Monad (SampleI m r)
forall a. a -&gt; SampleI m r a
forall a b. SampleI m r a -&gt; SampleI m r b -&gt; SampleI m r b
forall a b. SampleI m r a -&gt; (a -&gt; SampleI m r b) -&gt; SampleI m r b
forall (m :: * -&gt; *).
Applicative m =&gt;
(forall a b. m a -&gt; (a -&gt; m b) -&gt; m b)
-&gt; (forall a b. m a -&gt; m b -&gt; m b)
-&gt; (forall a. a -&gt; m a)
-&gt; Monad m
forall (m :: * -&gt; *) (r :: (* -&gt; *) -&gt; *).
Monad m =&gt;
Applicative (SampleI m r)
forall (m :: * -&gt; *) (r :: (* -&gt; *) -&gt; *) a.
Monad m =&gt;
a -&gt; SampleI m r a
forall (m :: * -&gt; *) (r :: (* -&gt; *) -&gt; *) a b.
Monad m =&gt;
SampleI m r a -&gt; SampleI m r b -&gt; SampleI m r b
forall (m :: * -&gt; *) (r :: (* -&gt; *) -&gt; *) a b.
Monad m =&gt;
SampleI m r a -&gt; (a -&gt; SampleI m r b) -&gt; SampleI m r b
$c&gt;&gt;= :: forall (m :: * -&gt; *) (r :: (* -&gt; *) -&gt; *) a b.
Monad m =&gt;
SampleI m r a -&gt; (a -&gt; SampleI m r b) -&gt; SampleI m r b
&gt;&gt;= :: forall a b. SampleI m r a -&gt; (a -&gt; SampleI m r b) -&gt; SampleI m r b
$c&gt;&gt; :: forall (m :: * -&gt; *) (r :: (* -&gt; *) -&gt; *) a b.
Monad m =&gt;
SampleI m r a -&gt; SampleI m r b -&gt; SampleI m r b
&gt;&gt; :: forall a b. SampleI m r a -&gt; SampleI m r b -&gt; SampleI m r b
$creturn :: forall (m :: * -&gt; *) (r :: (* -&gt; *) -&gt; *) a.
Monad m =&gt;
a -&gt; SampleI m r a
return :: forall a. a -&gt; SampleI m r a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Monad</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-335"></span><span>
</span><span id="line-336"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679098078"><span id="local-6989586621679098079"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PrimMonad</span></span><span> </span><span class="annot"><a href="#local-6989586621679098078"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#RandomInterpreter"><span class="hs-identifier hs-type">RandomInterpreter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#SampleI"><span class="hs-identifier hs-type">SampleI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098078"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098079"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679098079"><span class="hs-identifier hs-type">r</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-337"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="SampleCtx"><span class="annot"><a href="Inference.Conjugate.html#SampleCtx"><span class="hs-identifier hs-var">SampleCtx</span></a></span></span><span> </span><span id="local-6989586621679099067"><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#SampleI"><span class="hs-identifier hs-type">SampleI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098078"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098079"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679099067"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-338"></span><span>  </span><span class="annot"><a href="Inference.Conjugate.html#sampleValue"><span class="hs-identifier hs-type">sampleValue</span></a></span><span>
</span><span id="line-339"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679098080"><span class="annot"><a href="#local-6989586621679098080"><span class="hs-identifier hs-type">p</span></a></span></span><span> </span><span id="local-6989586621679098081"><span class="annot"><a href="#local-6989586621679098081"><span class="hs-identifier hs-type">l</span></a></span></span><span>
</span><span id="line-340"></span><span>     </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Conjugate"><span class="hs-identifier hs-type">Conjugate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098080"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098081"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-341"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-342"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679098081"><span class="hs-identifier hs-type">l</span></a></span><span>
</span><span id="line-343"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Accessor"><span class="hs-identifier hs-type">Accessor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098079"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098080"><span class="hs-identifier hs-type">p</span></a></span><span>
</span><span id="line-344"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#SampleI"><span class="hs-identifier hs-type">SampleI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098078"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098079"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Support"><span class="hs-identifier hs-type">Support</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098081"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-345"></span><span>  </span><span id="local-6989586621679099088"><span class="annot"><span class="annottext">sampleValue :: forall p l.
Conjugate p l =&gt;
String -&gt; l -&gt; Accessor r p -&gt; SampleI m r (Support l)
</span><a href="Inference.Conjugate.html#sampleValue"><span class="hs-identifier hs-var hs-var hs-var">sampleValue</span></a></span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679099089"><span class="annot"><span class="annottext">l
</span><a href="#local-6989586621679099089"><span class="hs-identifier hs-var">lk</span></a></span></span><span> </span><span id="local-6989586621679099090"><span class="annot"><span class="annottext">Accessor r p
</span><a href="#local-6989586621679099090"><span class="hs-identifier hs-var">getProbs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReaderT (r ProbsRep) (Prob m) (Support l)
-&gt; SampleI m r (Support l)
forall (m :: * -&gt; *) (r :: (* -&gt; *) -&gt; *) a.
ReaderT (r ProbsRep) (Prob m) a -&gt; SampleI m r a
</span><a href="Inference.Conjugate.html#SampleI"><span class="hs-identifier hs-var">SampleI</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT (r ProbsRep) (Prob m) (Support l)
 -&gt; SampleI m r (Support l))
-&gt; ReaderT (r ProbsRep) (Prob m) (Support l)
-&gt; SampleI m r (Support l)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-346"></span><span>    </span><span id="local-6989586621679099091"><span class="annot"><a href="#local-6989586621679099091"><span class="hs-identifier hs-var">probs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT (r ProbsRep) (Prob m) (r ProbsRep)
forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span>
</span><span id="line-347"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">lift</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#distSample"><span class="hs-identifier hs-type">distSample</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679099089"><span class="hs-identifier hs-type">lk</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#runProbs"><span class="hs-identifier hs-var">runProbs</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">view</span></span><span> </span><span class="annot"><a href="#local-6989586621679099090"><span class="hs-identifier hs-type">getProbs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679099091"><span class="hs-identifier hs-type">probs</span></a></span><span>
</span><span id="line-348"></span><span>  </span><span class="annot"><a href="Inference.Conjugate.html#sampleConst"><span class="hs-identifier hs-type">sampleConst</span></a></span><span>
</span><span id="line-349"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679098107"><span class="annot"><a href="#local-6989586621679098107"><span class="hs-identifier hs-type">d</span></a></span></span><span>
</span><span id="line-350"></span><span>     </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Distribution"><span class="hs-identifier hs-type">Distribution</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098107"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-351"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-352"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679098107"><span class="hs-identifier hs-type">d</span></a></span><span>
</span><span id="line-353"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Params"><span class="hs-identifier hs-type">Params</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098107"><span class="hs-identifier hs-type">d</span></a></span><span>
</span><span id="line-354"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#SampleI"><span class="hs-identifier hs-type">SampleI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098078"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098079"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Support"><span class="hs-identifier hs-type">Support</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098107"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-355"></span><span>  </span><span id="local-6989586621679099102"><span class="annot"><span class="annottext">sampleConst :: forall d.
Distribution d =&gt;
String -&gt; d -&gt; Params d -&gt; SampleI m r (Support d)
</span><a href="Inference.Conjugate.html#sampleConst"><span class="hs-identifier hs-var hs-var hs-var">sampleConst</span></a></span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679099103"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679099103"><span class="hs-identifier hs-var">dist</span></a></span></span><span> </span><span id="local-6989586621679099104"><span class="annot"><span class="annottext">Params d
</span><a href="#local-6989586621679099104"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReaderT (r ProbsRep) (Prob m) (Support d)
-&gt; SampleI m r (Support d)
forall (m :: * -&gt; *) (r :: (* -&gt; *) -&gt; *) a.
ReaderT (r ProbsRep) (Prob m) a -&gt; SampleI m r a
</span><a href="Inference.Conjugate.html#SampleI"><span class="hs-identifier hs-var">SampleI</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT (r ProbsRep) (Prob m) (Support d)
 -&gt; SampleI m r (Support d))
-&gt; ReaderT (r ProbsRep) (Prob m) (Support d)
-&gt; SampleI m r (Support d)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Prob m (Support d) -&gt; ReaderT (r ProbsRep) (Prob m) (Support d)
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ReaderT (r ProbsRep) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(Prob m (Support d) -&gt; ReaderT (r ProbsRep) (Prob m) (Support d))
-&gt; Prob m (Support d) -&gt; ReaderT (r ProbsRep) (Prob m) (Support d)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">d -&gt; Params d -&gt; Prob m (Support d)
forall a (m :: * -&gt; *).
(Distribution a, PrimMonad m) =&gt;
a -&gt; Params a -&gt; Prob m (Support a)
forall (m :: * -&gt; *).
PrimMonad m =&gt;
d -&gt; Params d -&gt; Prob m (Support d)
</span><a href="Inference.Conjugate.html#distSample"><span class="hs-identifier hs-var">distSample</span></a></span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679099103"><span class="hs-identifier hs-var">dist</span></a></span><span> </span><span class="annot"><span class="annottext">Params d
</span><a href="#local-6989586621679099104"><span class="hs-identifier hs-var">params</span></a></span><span>
</span><span id="line-356"></span><span>  </span><span id="local-6989586621679099107"><span class="annot"><span class="annottext">permutationPlate :: forall a. Ord a =&gt; Int -&gt; (Int -&gt; SampleI m r a) -&gt; SampleI m r [a]
</span><a href="Inference.Conjugate.html#permutationPlate"><span class="hs-identifier hs-var hs-var hs-var">permutationPlate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; (Int -&gt; SampleI m r a) -&gt; SampleI m r [a]
forall (m :: * -&gt; *) a.
Applicative m =&gt;
Int -&gt; (Int -&gt; m a) -&gt; m [a]
</span><a href="Inference.Conjugate.html#replicateMWithI"><span class="hs-identifier hs-var">replicateMWithI</span></a></span><span>
</span><span id="line-357"></span><span>
</span><span id="line-358"></span><span id="local-6989586621679098113"><span id="local-6989586621679098114"><span id="local-6989586621679098115"><span class="annot"><a href="Inference.Conjugate.html#sampleResult"><span class="hs-identifier hs-type">sampleResult</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679098113"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#ProbsRep"><span class="hs-identifier hs-type">ProbsRep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#SampleI"><span class="hs-identifier hs-type">SampleI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098114"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098113"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098115"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PrimState</span></span><span> </span><span class="annot"><a href="#local-6989586621679098114"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679098114"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098115"><span class="hs-identifier hs-type">a</span></a></span></span></span></span><span>
</span><span id="line-359"></span><span id="sampleResult"><span class="annot"><span class="annottext">sampleResult :: forall (p :: (* -&gt; *) -&gt; *) (m :: * -&gt; *) a.
p ProbsRep -&gt; SampleI m p a -&gt; Gen (PrimState m) -&gt; m a
</span><a href="Inference.Conjugate.html#sampleResult"><span class="hs-identifier hs-var hs-var">sampleResult</span></a></span></span><span> </span><span id="local-6989586621679099110"><span class="annot"><span class="annottext">p ProbsRep
</span><a href="#local-6989586621679099110"><span class="hs-identifier hs-var">probs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#SampleI"><span class="hs-identifier hs-type">SampleI</span></a></span><span> </span><span id="local-6989586621679099111"><span class="annot"><span class="annottext">ReaderT (p ProbsRep) (Prob m) a
</span><a href="#local-6989586621679099111"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Prob m a -&gt; Gen (PrimState m) -&gt; m a
forall (m :: * -&gt; *) a. Prob m a -&gt; Gen (PrimState m) -&gt; m a
</span><span class="hs-identifier hs-var">sample</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ReaderT (p ProbsRep) (Prob m) a -&gt; p ProbsRep -&gt; Prob m a
forall r (m :: * -&gt; *) a. ReaderT r m a -&gt; r -&gt; m a
</span><span class="hs-identifier hs-var">runReaderT</span></span><span> </span><span class="annot"><span class="annottext">ReaderT (p ProbsRep) (Prob m) a
</span><a href="#local-6989586621679099111"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">p ProbsRep
</span><a href="#local-6989586621679099110"><span class="hs-identifier hs-var">probs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-360"></span><span>
</span><span id="line-361"></span><span class="hs-comment">-- sample and trace the execution process</span><span>
</span><span id="line-362"></span><span class="hs-comment">-- --------------------------------------</span><span>
</span><span id="line-363"></span><span>
</span><span id="line-364"></span><span class="hs-keyword">newtype</span><span> </span><span id="TraceI"><span class="annot"><a href="Inference.Conjugate.html#TraceI"><span class="hs-identifier hs-var">TraceI</span></a></span></span><span> </span><span id="local-6989586621679098180"><span class="annot"><a href="#local-6989586621679098180"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span id="local-6989586621679098179"><span class="annot"><a href="#local-6989586621679098179"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span id="local-6989586621679098181"><span class="annot"><a href="#local-6989586621679098181"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="TraceI"><span class="annot"><a href="Inference.Conjugate.html#TraceI"><span class="hs-identifier hs-var">TraceI</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679098179"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#ProbsRep"><span class="hs-identifier hs-type">ProbsRep</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">StateT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Trace"><span class="hs-identifier hs-type">Trace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098179"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Prob</span></span><span> </span><span class="annot"><a href="#local-6989586621679098180"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679098181"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-365"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679099116"><span id="local-6989586621679099121"><span class="annot"><span class="annottext">(forall a b. (a -&gt; b) -&gt; TraceI m r a -&gt; TraceI m r b)
-&gt; (forall a b. a -&gt; TraceI m r b -&gt; TraceI m r a)
-&gt; Functor (TraceI m r)
forall a b. a -&gt; TraceI m r b -&gt; TraceI m r a
forall a b. (a -&gt; b) -&gt; TraceI m r a -&gt; TraceI m r b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
forall (m :: * -&gt; *) (r :: (* -&gt; *) -&gt; *) a b.
Functor m =&gt;
a -&gt; TraceI m r b -&gt; TraceI m r a
forall (m :: * -&gt; *) (r :: (* -&gt; *) -&gt; *) a b.
Functor m =&gt;
(a -&gt; b) -&gt; TraceI m r a -&gt; TraceI m r b
$cfmap :: forall (m :: * -&gt; *) (r :: (* -&gt; *) -&gt; *) a b.
Functor m =&gt;
(a -&gt; b) -&gt; TraceI m r a -&gt; TraceI m r b
fmap :: forall a b. (a -&gt; b) -&gt; TraceI m r a -&gt; TraceI m r b
$c&lt;$ :: forall (m :: * -&gt; *) (r :: (* -&gt; *) -&gt; *) a b.
Functor m =&gt;
a -&gt; TraceI m r b -&gt; TraceI m r a
&lt;$ :: forall a b. a -&gt; TraceI m r b -&gt; TraceI m r a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679099134"><span id="local-6989586621679099139"><span id="local-6989586621679099144"><span id="local-6989586621679099149"><span id="local-6989586621679099154"><span class="annot"><span class="annottext">Functor (TraceI m r)
Functor (TraceI m r) =&gt;
(forall a. a -&gt; TraceI m r a)
-&gt; (forall a b.
    TraceI m r (a -&gt; b) -&gt; TraceI m r a -&gt; TraceI m r b)
-&gt; (forall a b c.
    (a -&gt; b -&gt; c) -&gt; TraceI m r a -&gt; TraceI m r b -&gt; TraceI m r c)
-&gt; (forall a b. TraceI m r a -&gt; TraceI m r b -&gt; TraceI m r b)
-&gt; (forall a b. TraceI m r a -&gt; TraceI m r b -&gt; TraceI m r a)
-&gt; Applicative (TraceI m r)
forall a. a -&gt; TraceI m r a
forall a b. TraceI m r a -&gt; TraceI m r b -&gt; TraceI m r a
forall a b. TraceI m r a -&gt; TraceI m r b -&gt; TraceI m r b
forall a b. TraceI m r (a -&gt; b) -&gt; TraceI m r a -&gt; TraceI m r b
forall a b c.
(a -&gt; b -&gt; c) -&gt; TraceI m r a -&gt; TraceI m r b -&gt; TraceI m r c
forall (f :: * -&gt; *).
Functor f =&gt;
(forall a. a -&gt; f a)
-&gt; (forall a b. f (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b c. (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c)
-&gt; (forall a b. f a -&gt; f b -&gt; f b)
-&gt; (forall a b. f a -&gt; f b -&gt; f a)
-&gt; Applicative f
forall (m :: * -&gt; *) (r :: (* -&gt; *) -&gt; *).
Monad m =&gt;
Functor (TraceI m r)
forall (m :: * -&gt; *) (r :: (* -&gt; *) -&gt; *) a.
Monad m =&gt;
a -&gt; TraceI m r a
forall (m :: * -&gt; *) (r :: (* -&gt; *) -&gt; *) a b.
Monad m =&gt;
TraceI m r a -&gt; TraceI m r b -&gt; TraceI m r a
forall (m :: * -&gt; *) (r :: (* -&gt; *) -&gt; *) a b.
Monad m =&gt;
TraceI m r a -&gt; TraceI m r b -&gt; TraceI m r b
forall (m :: * -&gt; *) (r :: (* -&gt; *) -&gt; *) a b.
Monad m =&gt;
TraceI m r (a -&gt; b) -&gt; TraceI m r a -&gt; TraceI m r b
forall (m :: * -&gt; *) (r :: (* -&gt; *) -&gt; *) a b c.
Monad m =&gt;
(a -&gt; b -&gt; c) -&gt; TraceI m r a -&gt; TraceI m r b -&gt; TraceI m r c
$cpure :: forall (m :: * -&gt; *) (r :: (* -&gt; *) -&gt; *) a.
Monad m =&gt;
a -&gt; TraceI m r a
pure :: forall a. a -&gt; TraceI m r a
$c&lt;*&gt; :: forall (m :: * -&gt; *) (r :: (* -&gt; *) -&gt; *) a b.
Monad m =&gt;
TraceI m r (a -&gt; b) -&gt; TraceI m r a -&gt; TraceI m r b
&lt;*&gt; :: forall a b. TraceI m r (a -&gt; b) -&gt; TraceI m r a -&gt; TraceI m r b
$cliftA2 :: forall (m :: * -&gt; *) (r :: (* -&gt; *) -&gt; *) a b c.
Monad m =&gt;
(a -&gt; b -&gt; c) -&gt; TraceI m r a -&gt; TraceI m r b -&gt; TraceI m r c
liftA2 :: forall a b c.
(a -&gt; b -&gt; c) -&gt; TraceI m r a -&gt; TraceI m r b -&gt; TraceI m r c
$c*&gt; :: forall (m :: * -&gt; *) (r :: (* -&gt; *) -&gt; *) a b.
Monad m =&gt;
TraceI m r a -&gt; TraceI m r b -&gt; TraceI m r b
*&gt; :: forall a b. TraceI m r a -&gt; TraceI m r b -&gt; TraceI m r b
$c&lt;* :: forall (m :: * -&gt; *) (r :: (* -&gt; *) -&gt; *) a b.
Monad m =&gt;
TraceI m r a -&gt; TraceI m r b -&gt; TraceI m r a
&lt;* :: forall a b. TraceI m r a -&gt; TraceI m r b -&gt; TraceI m r a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Applicative</span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679099175"><span id="local-6989586621679099180"><span id="local-6989586621679099185"><span class="annot"><span class="annottext">Applicative (TraceI m r)
Applicative (TraceI m r) =&gt;
(forall a b. TraceI m r a -&gt; (a -&gt; TraceI m r b) -&gt; TraceI m r b)
-&gt; (forall a b. TraceI m r a -&gt; TraceI m r b -&gt; TraceI m r b)
-&gt; (forall a. a -&gt; TraceI m r a)
-&gt; Monad (TraceI m r)
forall a. a -&gt; TraceI m r a
forall a b. TraceI m r a -&gt; TraceI m r b -&gt; TraceI m r b
forall a b. TraceI m r a -&gt; (a -&gt; TraceI m r b) -&gt; TraceI m r b
forall (m :: * -&gt; *).
Applicative m =&gt;
(forall a b. m a -&gt; (a -&gt; m b) -&gt; m b)
-&gt; (forall a b. m a -&gt; m b -&gt; m b)
-&gt; (forall a. a -&gt; m a)
-&gt; Monad m
forall (m :: * -&gt; *) (r :: (* -&gt; *) -&gt; *).
Monad m =&gt;
Applicative (TraceI m r)
forall (m :: * -&gt; *) (r :: (* -&gt; *) -&gt; *) a.
Monad m =&gt;
a -&gt; TraceI m r a
forall (m :: * -&gt; *) (r :: (* -&gt; *) -&gt; *) a b.
Monad m =&gt;
TraceI m r a -&gt; TraceI m r b -&gt; TraceI m r b
forall (m :: * -&gt; *) (r :: (* -&gt; *) -&gt; *) a b.
Monad m =&gt;
TraceI m r a -&gt; (a -&gt; TraceI m r b) -&gt; TraceI m r b
$c&gt;&gt;= :: forall (m :: * -&gt; *) (r :: (* -&gt; *) -&gt; *) a b.
Monad m =&gt;
TraceI m r a -&gt; (a -&gt; TraceI m r b) -&gt; TraceI m r b
&gt;&gt;= :: forall a b. TraceI m r a -&gt; (a -&gt; TraceI m r b) -&gt; TraceI m r b
$c&gt;&gt; :: forall (m :: * -&gt; *) (r :: (* -&gt; *) -&gt; *) a b.
Monad m =&gt;
TraceI m r a -&gt; TraceI m r b -&gt; TraceI m r b
&gt;&gt; :: forall a b. TraceI m r a -&gt; TraceI m r b -&gt; TraceI m r b
$creturn :: forall (m :: * -&gt; *) (r :: (* -&gt; *) -&gt; *) a.
Monad m =&gt;
a -&gt; TraceI m r a
return :: forall a. a -&gt; TraceI m r a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Monad</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-366"></span><span>
</span><span id="line-367"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679098166"><span id="local-6989586621679098167"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PrimMonad</span></span><span> </span><span class="annot"><a href="#local-6989586621679098166"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#RandomInterpreter"><span class="hs-identifier hs-type">RandomInterpreter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#TraceI"><span class="hs-identifier hs-type">TraceI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098166"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098167"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679098167"><span class="hs-identifier hs-type">r</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-368"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="SampleCtx"><span class="annot"><a href="Inference.Conjugate.html#SampleCtx"><span class="hs-identifier hs-var">SampleCtx</span></a></span></span><span> </span><span id="local-6989586621679099204"><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#TraceI"><span class="hs-identifier hs-type">TraceI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098166"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098167"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679099204"><span class="hs-identifier hs-type">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Support"><span class="hs-identifier hs-type">Support</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679099204"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-369"></span><span>  </span><span class="annot"><a href="Inference.Conjugate.html#sampleValue"><span class="hs-identifier hs-type">sampleValue</span></a></span><span>
</span><span id="line-370"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679098168"><span class="annot"><a href="#local-6989586621679098168"><span class="hs-identifier hs-type">p</span></a></span></span><span> </span><span id="local-6989586621679098169"><span class="annot"><a href="#local-6989586621679098169"><span class="hs-identifier hs-type">l</span></a></span></span><span>
</span><span id="line-371"></span><span>     </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Conjugate"><span class="hs-identifier hs-type">Conjugate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098168"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098169"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Support"><span class="hs-identifier hs-type">Support</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098169"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-372"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-373"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679098169"><span class="hs-identifier hs-type">l</span></a></span><span>
</span><span id="line-374"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Accessor"><span class="hs-identifier hs-type">Accessor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098167"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098168"><span class="hs-identifier hs-type">p</span></a></span><span>
</span><span id="line-375"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#TraceI"><span class="hs-identifier hs-type">TraceI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098166"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098167"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Support"><span class="hs-identifier hs-type">Support</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098169"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-376"></span><span>  </span><span id="local-6989586621679099238"><span class="annot"><span class="annottext">sampleValue :: forall p l.
(Conjugate p l, Typeable (Support l)) =&gt;
String -&gt; l -&gt; Accessor r p -&gt; TraceI m r (Support l)
</span><a href="Inference.Conjugate.html#sampleValue"><span class="hs-identifier hs-var hs-var hs-var">sampleValue</span></a></span></span><span> </span><span id="local-6989586621679099239"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679099239"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679099240"><span class="annot"><span class="annottext">l
</span><a href="#local-6989586621679099240"><span class="hs-identifier hs-var">lk</span></a></span></span><span> </span><span id="local-6989586621679099241"><span class="annot"><span class="annottext">Accessor r p
</span><a href="#local-6989586621679099241"><span class="hs-identifier hs-var">getProbs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReaderT (r ProbsRep) (StateT (Trace r) (Prob m)) (Support l)
-&gt; TraceI m r (Support l)
forall (m :: * -&gt; *) (r :: (* -&gt; *) -&gt; *) a.
ReaderT (r ProbsRep) (StateT (Trace r) (Prob m)) a -&gt; TraceI m r a
</span><a href="Inference.Conjugate.html#TraceI"><span class="hs-identifier hs-var">TraceI</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT (r ProbsRep) (StateT (Trace r) (Prob m)) (Support l)
 -&gt; TraceI m r (Support l))
-&gt; ReaderT (r ProbsRep) (StateT (Trace r) (Prob m)) (Support l)
-&gt; TraceI m r (Support l)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-377"></span><span>    </span><span id="local-6989586621679099242"><span class="annot"><a href="#local-6989586621679099242"><span class="hs-identifier hs-var">probs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT (r ProbsRep) (StateT (Trace r) (Prob m)) (r ProbsRep)
forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span>
</span><span id="line-378"></span><span>    </span><span id="local-6989586621679099243"><span class="annot"><a href="#local-6989586621679099243"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">lift</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">lift</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#distSample"><span class="hs-identifier hs-type">distSample</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679099240"><span class="hs-identifier hs-type">lk</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#runProbs"><span class="hs-identifier hs-var">runProbs</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">view</span></span><span> </span><span class="annot"><a href="#local-6989586621679099241"><span class="hs-identifier hs-type">getProbs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679099242"><span class="hs-identifier hs-type">probs</span></a></span><span>
</span><span id="line-379"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">modify</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Trace"><span class="hs-identifier hs-type">Trace</span></a></span><span> </span><span id="local-6989586621679099244"><span class="annot"><span class="annottext">Seq (String, Dynamic)
</span><a href="#local-6989586621679099244"><span class="hs-identifier hs-var">obs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Seq (String, Dynamic) -&gt; Trace r
forall (r :: (* -&gt; *) -&gt; *). Seq (String, Dynamic) -&gt; Trace r
</span><a href="Inference.Conjugate.html#Trace"><span class="hs-identifier hs-var">Trace</span></a></span><span> </span><span class="annot"><span class="annottext">(Seq (String, Dynamic) -&gt; Trace r)
-&gt; Seq (String, Dynamic) -&gt; Trace r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Seq (String, Dynamic)
</span><a href="#local-6989586621679099244"><span class="hs-identifier hs-var">obs</span></a></span><span> </span><span class="annot"><span class="annottext">Seq (String, Dynamic) -&gt; (String, Dynamic) -&gt; Seq (String, Dynamic)
forall a. Seq a -&gt; a -&gt; Seq a
</span><span class="hs-operator hs-var">S.|&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679099239"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Support l -&gt; Dynamic
forall a. Typeable a =&gt; a -&gt; Dynamic
</span><span class="hs-identifier hs-var">toDyn</span></span><span> </span><span class="annot"><span class="annottext">Support l
</span><a href="#local-6989586621679099243"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-380"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><a href="#local-6989586621679099243"><span class="hs-identifier hs-type">val</span></a></span><span>
</span><span id="line-381"></span><span>  </span><span class="annot"><a href="Inference.Conjugate.html#sampleConst"><span class="hs-identifier hs-type">sampleConst</span></a></span><span>
</span><span id="line-382"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679098182"><span class="annot"><a href="#local-6989586621679098182"><span class="hs-identifier hs-type">d</span></a></span></span><span>
</span><span id="line-383"></span><span>     </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Distribution"><span class="hs-identifier hs-type">Distribution</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098182"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Support"><span class="hs-identifier hs-type">Support</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098182"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-384"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-385"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679098182"><span class="hs-identifier hs-type">d</span></a></span><span>
</span><span id="line-386"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Params"><span class="hs-identifier hs-type">Params</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098182"><span class="hs-identifier hs-type">d</span></a></span><span>
</span><span id="line-387"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#TraceI"><span class="hs-identifier hs-type">TraceI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098166"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098167"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Support"><span class="hs-identifier hs-type">Support</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098182"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-388"></span><span>  </span><span id="local-6989586621679099268"><span class="annot"><span class="annottext">sampleConst :: forall d.
(Distribution d, Typeable (Support d)) =&gt;
String -&gt; d -&gt; Params d -&gt; TraceI m r (Support d)
</span><a href="Inference.Conjugate.html#sampleConst"><span class="hs-identifier hs-var hs-var hs-var">sampleConst</span></a></span></span><span> </span><span id="local-6989586621679099269"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679099269"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679099270"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679099270"><span class="hs-identifier hs-var">dist</span></a></span></span><span> </span><span id="local-6989586621679099271"><span class="annot"><span class="annottext">Params d
</span><a href="#local-6989586621679099271"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReaderT (r ProbsRep) (StateT (Trace r) (Prob m)) (Support d)
-&gt; TraceI m r (Support d)
forall (m :: * -&gt; *) (r :: (* -&gt; *) -&gt; *) a.
ReaderT (r ProbsRep) (StateT (Trace r) (Prob m)) a -&gt; TraceI m r a
</span><a href="Inference.Conjugate.html#TraceI"><span class="hs-identifier hs-var">TraceI</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT (r ProbsRep) (StateT (Trace r) (Prob m)) (Support d)
 -&gt; TraceI m r (Support d))
-&gt; ReaderT (r ProbsRep) (StateT (Trace r) (Prob m)) (Support d)
-&gt; TraceI m r (Support d)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-389"></span><span>    </span><span id="local-6989586621679099272"><span class="annot"><a href="#local-6989586621679099272"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT (Trace r) (Prob m) (Support d)
-&gt; ReaderT (r ProbsRep) (StateT (Trace r) (Prob m)) (Support d)
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; ReaderT (r ProbsRep) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(StateT (Trace r) (Prob m) (Support d)
 -&gt; ReaderT (r ProbsRep) (StateT (Trace r) (Prob m)) (Support d))
-&gt; StateT (Trace r) (Prob m) (Support d)
-&gt; ReaderT (r ProbsRep) (StateT (Trace r) (Prob m)) (Support d)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Prob m (Support d) -&gt; StateT (Trace r) (Prob m) (Support d)
forall (m :: * -&gt; *) a. Monad m =&gt; m a -&gt; StateT (Trace r) m a
forall (t :: (* -&gt; *) -&gt; * -&gt; *) (m :: * -&gt; *) a.
(MonadTrans t, Monad m) =&gt;
m a -&gt; t m a
</span><span class="hs-identifier hs-var">lift</span></span><span> </span><span class="annot"><span class="annottext">(Prob m (Support d) -&gt; StateT (Trace r) (Prob m) (Support d))
-&gt; Prob m (Support d) -&gt; StateT (Trace r) (Prob m) (Support d)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">d -&gt; Params d -&gt; Prob m (Support d)
forall a (m :: * -&gt; *).
(Distribution a, PrimMonad m) =&gt;
a -&gt; Params a -&gt; Prob m (Support a)
forall (m :: * -&gt; *).
PrimMonad m =&gt;
d -&gt; Params d -&gt; Prob m (Support d)
</span><a href="Inference.Conjugate.html#distSample"><span class="hs-identifier hs-var">distSample</span></a></span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679099270"><span class="hs-identifier hs-var">dist</span></a></span><span> </span><span class="annot"><span class="annottext">Params d
</span><a href="#local-6989586621679099271"><span class="hs-identifier hs-var">params</span></a></span><span>
</span><span id="line-390"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">modify</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Trace"><span class="hs-identifier hs-type">Trace</span></a></span><span> </span><span id="local-6989586621679099273"><span class="annot"><span class="annottext">Seq (String, Dynamic)
</span><a href="#local-6989586621679099273"><span class="hs-identifier hs-var">obs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Seq (String, Dynamic) -&gt; Trace r
forall (r :: (* -&gt; *) -&gt; *). Seq (String, Dynamic) -&gt; Trace r
</span><a href="Inference.Conjugate.html#Trace"><span class="hs-identifier hs-var">Trace</span></a></span><span> </span><span class="annot"><span class="annottext">(Seq (String, Dynamic) -&gt; Trace r)
-&gt; Seq (String, Dynamic) -&gt; Trace r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Seq (String, Dynamic)
</span><a href="#local-6989586621679099273"><span class="hs-identifier hs-var">obs</span></a></span><span> </span><span class="annot"><span class="annottext">Seq (String, Dynamic) -&gt; (String, Dynamic) -&gt; Seq (String, Dynamic)
forall a. Seq a -&gt; a -&gt; Seq a
</span><span class="hs-operator hs-var">S.|&gt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679099269"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Support d -&gt; Dynamic
forall a. Typeable a =&gt; a -&gt; Dynamic
</span><span class="hs-identifier hs-var">toDyn</span></span><span> </span><span class="annot"><span class="annottext">Support d
</span><a href="#local-6989586621679099272"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-391"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><a href="#local-6989586621679099272"><span class="hs-identifier hs-type">val</span></a></span><span>
</span><span id="line-392"></span><span>  </span><span id="local-6989586621679099276"><span class="annot"><span class="annottext">permutationPlate :: forall a. Ord a =&gt; Int -&gt; (Int -&gt; TraceI m r a) -&gt; TraceI m r [a]
</span><a href="Inference.Conjugate.html#permutationPlate"><span class="hs-identifier hs-var hs-var hs-var">permutationPlate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; (Int -&gt; TraceI m r a) -&gt; TraceI m r [a]
forall (m :: * -&gt; *) a.
Applicative m =&gt;
Int -&gt; (Int -&gt; m a) -&gt; m [a]
</span><a href="Inference.Conjugate.html#replicateMWithI"><span class="hs-identifier hs-var">replicateMWithI</span></a></span><span>
</span><span id="line-393"></span><span>
</span><span id="line-394"></span><span id="local-6989586621679098186"><span id="local-6989586621679098187"><span id="local-6989586621679098188"><span class="annot"><a href="Inference.Conjugate.html#sampleTrace"><span class="hs-identifier hs-type">sampleTrace</span></a></span><span>
</span><span id="line-395"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679098186"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#ProbsRep"><span class="hs-identifier hs-type">ProbsRep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#TraceI"><span class="hs-identifier hs-type">TraceI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098187"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098186"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098188"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">PrimState</span></span><span> </span><span class="annot"><a href="#local-6989586621679098187"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679098187"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679098188"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Trace"><span class="hs-identifier hs-type">Trace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098186"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-396"></span><span id="sampleTrace"><span class="annot"><span class="annottext">sampleTrace :: forall (r :: (* -&gt; *) -&gt; *) (m :: * -&gt; *) a.
r ProbsRep -&gt; TraceI m r a -&gt; Gen (PrimState m) -&gt; m (a, Trace r)
</span><a href="Inference.Conjugate.html#sampleTrace"><span class="hs-identifier hs-var hs-var">sampleTrace</span></a></span></span><span> </span><span id="local-6989586621679099280"><span class="annot"><span class="annottext">r ProbsRep
</span><a href="#local-6989586621679099280"><span class="hs-identifier hs-var">probs</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#TraceI"><span class="hs-identifier hs-type">TraceI</span></a></span><span> </span><span id="local-6989586621679099281"><span class="annot"><span class="annottext">ReaderT (r ProbsRep) (StateT (Trace r) (Prob m)) a
</span><a href="#local-6989586621679099281"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-397"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679099282"><span class="annot"><span class="annottext">st :: StateT (Trace r) (Prob m) a
</span><a href="#local-6989586621679099282"><span class="hs-identifier hs-var hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReaderT (r ProbsRep) (StateT (Trace r) (Prob m)) a
-&gt; r ProbsRep -&gt; StateT (Trace r) (Prob m) a
forall r (m :: * -&gt; *) a. ReaderT r m a -&gt; r -&gt; m a
</span><span class="hs-identifier hs-var">runReaderT</span></span><span> </span><span class="annot"><span class="annottext">ReaderT (r ProbsRep) (StateT (Trace r) (Prob m)) a
</span><a href="#local-6989586621679099281"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">r ProbsRep
</span><a href="#local-6989586621679099280"><span class="hs-identifier hs-var">probs</span></a></span><span>
</span><span id="line-398"></span><span>      </span><span id="local-6989586621679099283"><span class="annot"><span class="annottext">pr :: Prob m (a, Trace r)
</span><a href="#local-6989586621679099283"><span class="hs-identifier hs-var hs-var">pr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateT (Trace r) (Prob m) a -&gt; Trace r -&gt; Prob m (a, Trace r)
forall s (m :: * -&gt; *) a. StateT s m a -&gt; s -&gt; m (a, s)
</span><span class="hs-identifier hs-var">runStateT</span></span><span> </span><span class="annot"><span class="annottext">StateT (Trace r) (Prob m) a
</span><a href="#local-6989586621679099282"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Seq (String, Dynamic) -&gt; Trace r
forall (r :: (* -&gt; *) -&gt; *). Seq (String, Dynamic) -&gt; Trace r
</span><a href="Inference.Conjugate.html#Trace"><span class="hs-identifier hs-var">Trace</span></a></span><span> </span><span class="annot"><span class="annottext">Seq (String, Dynamic)
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">)</span><span>
</span><span id="line-399"></span><span>  </span><span class="annot"><span class="annottext">Prob m (a, Trace r) -&gt; Gen (PrimState m) -&gt; m (a, Trace r)
forall (m :: * -&gt; *) a. Prob m a -&gt; Gen (PrimState m) -&gt; m a
</span><span class="hs-identifier hs-var">sample</span></span><span> </span><span class="annot"><span class="annottext">Prob m (a, Trace r)
</span><a href="#local-6989586621679099283"><span class="hs-identifier hs-var">pr</span></a></span><span>
</span><span id="line-400"></span><span>
</span><span id="line-401"></span><span class="hs-comment">-- evaluate the probability of a trace</span><span>
</span><span id="line-402"></span><span class="hs-comment">-- -----------------------------------</span><span>
</span><span id="line-403"></span><span>
</span><span id="line-404"></span><span class="hs-keyword">newtype</span><span> </span><span id="EvalTraceI"><span class="annot"><a href="Inference.Conjugate.html#EvalTraceI"><span class="hs-identifier hs-var">EvalTraceI</span></a></span></span><span> </span><span id="local-6989586621679098232"><span class="annot"><a href="#local-6989586621679098232"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span id="local-6989586621679098233"><span class="annot"><a href="#local-6989586621679098233"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="EvalTraceI"><span class="annot"><a href="Inference.Conjugate.html#EvalTraceI"><span class="hs-identifier hs-var">EvalTraceI</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679098232"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#ProbsRep"><span class="hs-identifier hs-type">ProbsRep</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">StateT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Trace"><span class="hs-identifier hs-type">Trace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098232"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679098233"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-405"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679099286"><span id="local-6989586621679099291"><span class="annot"><span class="annottext">(forall a b. (a -&gt; b) -&gt; EvalTraceI r a -&gt; EvalTraceI r b)
-&gt; (forall a b. a -&gt; EvalTraceI r b -&gt; EvalTraceI r a)
-&gt; Functor (EvalTraceI r)
forall a b. a -&gt; EvalTraceI r b -&gt; EvalTraceI r a
forall a b. (a -&gt; b) -&gt; EvalTraceI r a -&gt; EvalTraceI r b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
forall (r :: (* -&gt; *) -&gt; *) a b.
a -&gt; EvalTraceI r b -&gt; EvalTraceI r a
forall (r :: (* -&gt; *) -&gt; *) a b.
(a -&gt; b) -&gt; EvalTraceI r a -&gt; EvalTraceI r b
$cfmap :: forall (r :: (* -&gt; *) -&gt; *) a b.
(a -&gt; b) -&gt; EvalTraceI r a -&gt; EvalTraceI r b
fmap :: forall a b. (a -&gt; b) -&gt; EvalTraceI r a -&gt; EvalTraceI r b
$c&lt;$ :: forall (r :: (* -&gt; *) -&gt; *) a b.
a -&gt; EvalTraceI r b -&gt; EvalTraceI r a
&lt;$ :: forall a b. a -&gt; EvalTraceI r b -&gt; EvalTraceI r a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679099302"><span id="local-6989586621679099307"><span id="local-6989586621679099312"><span id="local-6989586621679099317"><span id="local-6989586621679099322"><span class="annot"><span class="annottext">Functor (EvalTraceI r)
Functor (EvalTraceI r) =&gt;
(forall a. a -&gt; EvalTraceI r a)
-&gt; (forall a b.
    EvalTraceI r (a -&gt; b) -&gt; EvalTraceI r a -&gt; EvalTraceI r b)
-&gt; (forall a b c.
    (a -&gt; b -&gt; c)
    -&gt; EvalTraceI r a -&gt; EvalTraceI r b -&gt; EvalTraceI r c)
-&gt; (forall a b. EvalTraceI r a -&gt; EvalTraceI r b -&gt; EvalTraceI r b)
-&gt; (forall a b. EvalTraceI r a -&gt; EvalTraceI r b -&gt; EvalTraceI r a)
-&gt; Applicative (EvalTraceI r)
forall a. a -&gt; EvalTraceI r a
forall a b. EvalTraceI r a -&gt; EvalTraceI r b -&gt; EvalTraceI r a
forall a b. EvalTraceI r a -&gt; EvalTraceI r b -&gt; EvalTraceI r b
forall a b.
EvalTraceI r (a -&gt; b) -&gt; EvalTraceI r a -&gt; EvalTraceI r b
forall a b c.
(a -&gt; b -&gt; c) -&gt; EvalTraceI r a -&gt; EvalTraceI r b -&gt; EvalTraceI r c
forall (f :: * -&gt; *).
Functor f =&gt;
(forall a. a -&gt; f a)
-&gt; (forall a b. f (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b c. (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c)
-&gt; (forall a b. f a -&gt; f b -&gt; f b)
-&gt; (forall a b. f a -&gt; f b -&gt; f a)
-&gt; Applicative f
forall (r :: (* -&gt; *) -&gt; *). Functor (EvalTraceI r)
forall (r :: (* -&gt; *) -&gt; *) a. a -&gt; EvalTraceI r a
forall (r :: (* -&gt; *) -&gt; *) a b.
EvalTraceI r a -&gt; EvalTraceI r b -&gt; EvalTraceI r a
forall (r :: (* -&gt; *) -&gt; *) a b.
EvalTraceI r a -&gt; EvalTraceI r b -&gt; EvalTraceI r b
forall (r :: (* -&gt; *) -&gt; *) a b.
EvalTraceI r (a -&gt; b) -&gt; EvalTraceI r a -&gt; EvalTraceI r b
forall (r :: (* -&gt; *) -&gt; *) a b c.
(a -&gt; b -&gt; c) -&gt; EvalTraceI r a -&gt; EvalTraceI r b -&gt; EvalTraceI r c
$cpure :: forall (r :: (* -&gt; *) -&gt; *) a. a -&gt; EvalTraceI r a
pure :: forall a. a -&gt; EvalTraceI r a
$c&lt;*&gt; :: forall (r :: (* -&gt; *) -&gt; *) a b.
EvalTraceI r (a -&gt; b) -&gt; EvalTraceI r a -&gt; EvalTraceI r b
&lt;*&gt; :: forall a b.
EvalTraceI r (a -&gt; b) -&gt; EvalTraceI r a -&gt; EvalTraceI r b
$cliftA2 :: forall (r :: (* -&gt; *) -&gt; *) a b c.
(a -&gt; b -&gt; c) -&gt; EvalTraceI r a -&gt; EvalTraceI r b -&gt; EvalTraceI r c
liftA2 :: forall a b c.
(a -&gt; b -&gt; c) -&gt; EvalTraceI r a -&gt; EvalTraceI r b -&gt; EvalTraceI r c
$c*&gt; :: forall (r :: (* -&gt; *) -&gt; *) a b.
EvalTraceI r a -&gt; EvalTraceI r b -&gt; EvalTraceI r b
*&gt; :: forall a b. EvalTraceI r a -&gt; EvalTraceI r b -&gt; EvalTraceI r b
$c&lt;* :: forall (r :: (* -&gt; *) -&gt; *) a b.
EvalTraceI r a -&gt; EvalTraceI r b -&gt; EvalTraceI r a
&lt;* :: forall a b. EvalTraceI r a -&gt; EvalTraceI r b -&gt; EvalTraceI r a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Applicative</span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679099340"><span id="local-6989586621679099345"><span id="local-6989586621679099350"><span class="annot"><span class="annottext">Applicative (EvalTraceI r)
Applicative (EvalTraceI r) =&gt;
(forall a b.
 EvalTraceI r a -&gt; (a -&gt; EvalTraceI r b) -&gt; EvalTraceI r b)
-&gt; (forall a b. EvalTraceI r a -&gt; EvalTraceI r b -&gt; EvalTraceI r b)
-&gt; (forall a. a -&gt; EvalTraceI r a)
-&gt; Monad (EvalTraceI r)
forall a. a -&gt; EvalTraceI r a
forall a b. EvalTraceI r a -&gt; EvalTraceI r b -&gt; EvalTraceI r b
forall a b.
EvalTraceI r a -&gt; (a -&gt; EvalTraceI r b) -&gt; EvalTraceI r b
forall (m :: * -&gt; *).
Applicative m =&gt;
(forall a b. m a -&gt; (a -&gt; m b) -&gt; m b)
-&gt; (forall a b. m a -&gt; m b -&gt; m b)
-&gt; (forall a. a -&gt; m a)
-&gt; Monad m
forall (r :: (* -&gt; *) -&gt; *). Applicative (EvalTraceI r)
forall (r :: (* -&gt; *) -&gt; *) a. a -&gt; EvalTraceI r a
forall (r :: (* -&gt; *) -&gt; *) a b.
EvalTraceI r a -&gt; EvalTraceI r b -&gt; EvalTraceI r b
forall (r :: (* -&gt; *) -&gt; *) a b.
EvalTraceI r a -&gt; (a -&gt; EvalTraceI r b) -&gt; EvalTraceI r b
$c&gt;&gt;= :: forall (r :: (* -&gt; *) -&gt; *) a b.
EvalTraceI r a -&gt; (a -&gt; EvalTraceI r b) -&gt; EvalTraceI r b
&gt;&gt;= :: forall a b.
EvalTraceI r a -&gt; (a -&gt; EvalTraceI r b) -&gt; EvalTraceI r b
$c&gt;&gt; :: forall (r :: (* -&gt; *) -&gt; *) a b.
EvalTraceI r a -&gt; EvalTraceI r b -&gt; EvalTraceI r b
&gt;&gt; :: forall a b. EvalTraceI r a -&gt; EvalTraceI r b -&gt; EvalTraceI r b
$creturn :: forall (r :: (* -&gt; *) -&gt; *) a. a -&gt; EvalTraceI r a
return :: forall a. a -&gt; EvalTraceI r a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Monad</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-406"></span><span>
</span><span id="line-407"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679098224"><span class="annot"><a href="Inference.Conjugate.html#RandomInterpreter"><span class="hs-identifier hs-type">RandomInterpreter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#EvalTraceI"><span class="hs-identifier hs-type">EvalTraceI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098224"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679098224"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-408"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="SampleCtx"><span class="annot"><a href="Inference.Conjugate.html#SampleCtx"><span class="hs-identifier hs-var">SampleCtx</span></a></span></span><span> </span><span id="local-6989586621679099364"><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#EvalTraceI"><span class="hs-identifier hs-type">EvalTraceI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098224"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679099364"><span class="hs-identifier hs-type">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Support"><span class="hs-identifier hs-type">Support</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679099364"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-409"></span><span>  </span><span class="annot"><a href="Inference.Conjugate.html#sampleValue"><span class="hs-identifier hs-type">sampleValue</span></a></span><span>
</span><span id="line-410"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679098225"><span class="annot"><a href="#local-6989586621679098225"><span class="hs-identifier hs-type">p</span></a></span></span><span> </span><span id="local-6989586621679098226"><span class="annot"><a href="#local-6989586621679098226"><span class="hs-identifier hs-type">l</span></a></span></span><span>
</span><span id="line-411"></span><span>     </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Conjugate"><span class="hs-identifier hs-type">Conjugate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098225"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098226"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Support"><span class="hs-identifier hs-type">Support</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098226"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-412"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-413"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679098226"><span class="hs-identifier hs-type">l</span></a></span><span>
</span><span id="line-414"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Accessor"><span class="hs-identifier hs-type">Accessor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098224"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098225"><span class="hs-identifier hs-type">p</span></a></span><span>
</span><span id="line-415"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#EvalTraceI"><span class="hs-identifier hs-type">EvalTraceI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098224"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Support"><span class="hs-identifier hs-type">Support</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098226"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-416"></span><span>  </span><span id="local-6989586621679099399"><span class="annot"><span class="annottext">sampleValue :: forall p l.
(Conjugate p l, Typeable (Support l)) =&gt;
String -&gt; l -&gt; Accessor r p -&gt; EvalTraceI r (Support l)
</span><a href="Inference.Conjugate.html#sampleValue"><span class="hs-identifier hs-var hs-var hs-var">sampleValue</span></a></span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679099400"><span class="annot"><span class="annottext">l
</span><a href="#local-6989586621679099400"><span class="hs-identifier hs-var">lk</span></a></span></span><span> </span><span id="local-6989586621679099401"><span class="annot"><span class="annottext">Accessor r p
</span><a href="#local-6989586621679099401"><span class="hs-identifier hs-var">getProbs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReaderT (r ProbsRep) (StateT (Trace r, Double) Maybe) (Support l)
-&gt; EvalTraceI r (Support l)
forall (r :: (* -&gt; *) -&gt; *) a.
ReaderT (r ProbsRep) (StateT (Trace r, Double) Maybe) a
-&gt; EvalTraceI r a
</span><a href="Inference.Conjugate.html#EvalTraceI"><span class="hs-identifier hs-var">EvalTraceI</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT (r ProbsRep) (StateT (Trace r, Double) Maybe) (Support l)
 -&gt; EvalTraceI r (Support l))
-&gt; ReaderT
     (r ProbsRep) (StateT (Trace r, Double) Maybe) (Support l)
-&gt; EvalTraceI r (Support l)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-417"></span><span>    </span><span id="local-6989586621679099402"><span class="annot"><a href="#local-6989586621679099402"><span class="hs-identifier hs-var">probs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT (r ProbsRep) (StateT (Trace r, Double) Maybe) (r ProbsRep)
forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span>
</span><span id="line-418"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679099403"><span class="annot"><a href="#local-6989586621679099403"><span class="hs-identifier hs-var">trace</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679099404"><span class="annot"><a href="#local-6989586621679099404"><span class="hs-identifier hs-var">totalLogP</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">get</span></span><span>
</span><span id="line-419"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679099405"><span class="annot"><a href="#local-6989586621679099405"><span class="hs-identifier hs-var">_name</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679099406"><span class="annot"><a href="#local-6989586621679099406"><span class="hs-identifier hs-var">val</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679099407"><span class="annot"><a href="#local-6989586621679099407"><span class="hs-identifier hs-var">trace'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">lift</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">lift</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#takeTrace"><span class="hs-identifier hs-type">takeTrace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679099403"><span class="hs-identifier hs-type">trace</span></a></span><span>
</span><span id="line-420"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679099408"><span class="annot"><a href="#local-6989586621679099408"><span class="hs-identifier hs-var hs-var">logP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">l -&gt; Params l -&gt; Support l -&gt; Double
forall a. Distribution a =&gt; a -&gt; Params a -&gt; Support a -&gt; Double
</span><a href="Inference.Conjugate.html#distLogP"><span class="hs-identifier hs-var">distLogP</span></a></span><span> </span><span class="annot"><span class="annottext">l
</span><a href="#local-6989586621679099400"><span class="hs-identifier hs-var">lk</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProbsRep p -&gt; Probs (AsPrior p)
forall p. ProbsRep p -&gt; Probs (AsPrior p)
</span><a href="Inference.Conjugate.html#runProbs"><span class="hs-identifier hs-var">runProbs</span></a></span><span> </span><span class="annot"><span class="annottext">(ProbsRep p -&gt; Probs (AsPrior p))
-&gt; ProbsRep p -&gt; Probs (AsPrior p)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Getting (ProbsRep p) (r ProbsRep) (ProbsRep p)
-&gt; r ProbsRep -&gt; ProbsRep p
forall a s. Getting a s a -&gt; s -&gt; a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting (ProbsRep p) (r ProbsRep) (ProbsRep p)
Accessor r p
</span><a href="#local-6989586621679099401"><span class="hs-identifier hs-var">getProbs</span></a></span><span> </span><span class="annot"><span class="annottext">r ProbsRep
</span><a href="#local-6989586621679099402"><span class="hs-identifier hs-var">probs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Support l
</span><a href="#local-6989586621679099406"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-421"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">put</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679099407"><span class="hs-identifier hs-type">trace'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679099404"><span class="hs-identifier hs-type">totalLogP</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><a href="#local-6989586621679099408"><span class="hs-identifier hs-type">logP</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-422"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><a href="#local-6989586621679099406"><span class="hs-identifier hs-type">val</span></a></span><span>
</span><span id="line-423"></span><span>  </span><span class="annot"><a href="Inference.Conjugate.html#sampleConst"><span class="hs-identifier hs-type">sampleConst</span></a></span><span>
</span><span id="line-424"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679098237"><span class="annot"><a href="#local-6989586621679098237"><span class="hs-identifier hs-type">d</span></a></span></span><span>
</span><span id="line-425"></span><span>     </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Distribution"><span class="hs-identifier hs-type">Distribution</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098237"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Support"><span class="hs-identifier hs-type">Support</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098237"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-426"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-427"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679098237"><span class="hs-identifier hs-type">d</span></a></span><span>
</span><span id="line-428"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Params"><span class="hs-identifier hs-type">Params</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098237"><span class="hs-identifier hs-type">d</span></a></span><span>
</span><span id="line-429"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#EvalTraceI"><span class="hs-identifier hs-type">EvalTraceI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098224"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Support"><span class="hs-identifier hs-type">Support</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098237"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-430"></span><span>  </span><span id="local-6989586621679099435"><span class="annot"><span class="annottext">sampleConst :: forall d.
(Distribution d, Typeable (Support d)) =&gt;
String -&gt; d -&gt; Params d -&gt; EvalTraceI r (Support d)
</span><a href="Inference.Conjugate.html#sampleConst"><span class="hs-identifier hs-var hs-var hs-var">sampleConst</span></a></span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679099436"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679099436"><span class="hs-identifier hs-var">dist</span></a></span></span><span> </span><span id="local-6989586621679099437"><span class="annot"><span class="annottext">Params d
</span><a href="#local-6989586621679099437"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReaderT (r ProbsRep) (StateT (Trace r, Double) Maybe) (Support d)
-&gt; EvalTraceI r (Support d)
forall (r :: (* -&gt; *) -&gt; *) a.
ReaderT (r ProbsRep) (StateT (Trace r, Double) Maybe) a
-&gt; EvalTraceI r a
</span><a href="Inference.Conjugate.html#EvalTraceI"><span class="hs-identifier hs-var">EvalTraceI</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT (r ProbsRep) (StateT (Trace r, Double) Maybe) (Support d)
 -&gt; EvalTraceI r (Support d))
-&gt; ReaderT
     (r ProbsRep) (StateT (Trace r, Double) Maybe) (Support d)
-&gt; EvalTraceI r (Support d)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-431"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679099438"><span class="annot"><a href="#local-6989586621679099438"><span class="hs-identifier hs-var">trace</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679099439"><span class="annot"><a href="#local-6989586621679099439"><span class="hs-identifier hs-var">totalLogP</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT
  (r ProbsRep) (StateT (Trace r, Double) Maybe) (Trace r, Double)
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-432"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679099440"><span class="annot"><a href="#local-6989586621679099440"><span class="hs-identifier hs-var">_name</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679099441"><span class="annot"><a href="#local-6989586621679099441"><span class="hs-identifier hs-var">val</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679099442"><span class="annot"><a href="#local-6989586621679099442"><span class="hs-identifier hs-var">trace'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">lift</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">lift</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#takeTrace"><span class="hs-identifier hs-type">takeTrace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679099438"><span class="hs-identifier hs-type">trace</span></a></span><span>
</span><span id="line-433"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679099443"><span class="annot"><a href="#local-6989586621679099443"><span class="hs-identifier hs-var hs-var">logP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">d -&gt; Params d -&gt; Support d -&gt; Double
forall a. Distribution a =&gt; a -&gt; Params a -&gt; Support a -&gt; Double
</span><a href="Inference.Conjugate.html#distLogP"><span class="hs-identifier hs-var">distLogP</span></a></span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679099436"><span class="hs-identifier hs-var">dist</span></a></span><span> </span><span class="annot"><span class="annottext">Params d
</span><a href="#local-6989586621679099437"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="annot"><span class="annottext">Support d
</span><a href="#local-6989586621679099441"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-434"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">put</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679099442"><span class="hs-identifier hs-type">trace'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679099439"><span class="hs-identifier hs-type">totalLogP</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><a href="#local-6989586621679099443"><span class="hs-identifier hs-type">logP</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-435"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><a href="#local-6989586621679099441"><span class="hs-identifier hs-type">val</span></a></span><span>
</span><span id="line-436"></span><span>  </span><span id="local-6989586621679099475"><span class="annot"><span class="annottext">permutationPlate :: forall a.
Ord a =&gt;
Int -&gt; (Int -&gt; EvalTraceI r a) -&gt; EvalTraceI r [a]
</span><a href="Inference.Conjugate.html#permutationPlate"><span class="hs-identifier hs-var hs-var hs-var">permutationPlate</span></a></span></span><span> </span><span id="local-6989586621679099476"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679099476"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679099477"><span class="annot"><span class="annottext">Int -&gt; EvalTraceI r a
</span><a href="#local-6989586621679099477"><span class="hs-identifier hs-var">submodel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReaderT (r ProbsRep) (StateT (Trace r, Double) Maybe) [a]
-&gt; EvalTraceI r [a]
forall (r :: (* -&gt; *) -&gt; *) a.
ReaderT (r ProbsRep) (StateT (Trace r, Double) Maybe) a
-&gt; EvalTraceI r a
</span><a href="Inference.Conjugate.html#EvalTraceI"><span class="hs-identifier hs-var">EvalTraceI</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT (r ProbsRep) (StateT (Trace r, Double) Maybe) [a]
 -&gt; EvalTraceI r [a])
-&gt; ReaderT (r ProbsRep) (StateT (Trace r, Double) Maybe) [a]
-&gt; EvalTraceI r [a]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-437"></span><span>    </span><span id="local-6989586621679099478"><span class="annot"><a href="#local-6989586621679099478"><span class="hs-identifier hs-var">probs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT (r ProbsRep) (StateT (Trace r, Double) Maybe) (r ProbsRep)
forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span>
</span><span id="line-438"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679099479"><span class="annot"><a href="#local-6989586621679099479"><span class="hs-identifier hs-var">trace</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679099480"><span class="annot"><a href="#local-6989586621679099480"><span class="hs-identifier hs-var">totalLogP</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">get</span></span><span>
</span><span id="line-439"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679099481"><span class="annot"><a href="#local-6989586621679099481"><span class="hs-identifier hs-var">results</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679099482"><span class="annot"><a href="#local-6989586621679099482"><span class="hs-identifier hs-var">trace'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679099483"><span class="annot"><a href="#local-6989586621679099483"><span class="hs-identifier hs-var">logP</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-440"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">lift</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-441"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">lift</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-442"></span><span>          </span><span class="annot"><a href="Inference.Conjugate.html#runTraceLogP"><span class="hs-identifier hs-type">runTraceLogP</span></a></span><span>
</span><span id="line-443"></span><span>            </span><span class="annot"><a href="#local-6989586621679099478"><span class="hs-identifier hs-type">probs</span></a></span><span>
</span><span id="line-444"></span><span>            </span><span class="annot"><a href="#local-6989586621679099479"><span class="hs-identifier hs-type">trace</span></a></span><span>
</span><span id="line-445"></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#replicateMWithI"><span class="hs-identifier hs-type">replicateMWithI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679099476"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679099477"><span class="hs-identifier hs-type">submodel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-446"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679099485"><span class="annot"><a href="#local-6989586621679099485"><span class="hs-identifier hs-var hs-var">unique</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; MultiSet a
forall a. Ord a =&gt; [a] -&gt; MultiSet a
</span><span class="hs-identifier hs-var">MS.fromList</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679099481"><span class="hs-identifier hs-var">results</span></a></span><span>
</span><span id="line-447"></span><span>        </span><span id="local-6989586621679099487"><span class="annot"><a href="#local-6989586621679099487"><span class="hs-identifier hs-var hs-var">permutations</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-448"></span><span>          </span><span class="annot"><span class="annottext">Int -&gt; Double
forall a. Integral a =&gt; a -&gt; Double
</span><span class="hs-identifier hs-var">logFactorial</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679099476"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">[Double] -&gt; Double
forall a. Num a =&gt; [a] -&gt; a
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">sum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Double
forall a. Integral a =&gt; a -&gt; Double
</span><span class="hs-identifier hs-var">logFactorial</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Double) -&gt; ((a, Int) -&gt; Int) -&gt; (a, Int) -&gt; Double
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a, Int) -&gt; Int
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((a, Int) -&gt; Double) -&gt; [(a, Int)] -&gt; [Double]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">MultiSet a -&gt; [(a, Int)]
forall a. MultiSet a -&gt; [(a, Int)]
</span><span class="hs-identifier hs-var">MS.toOccurList</span></span><span> </span><span class="annot"><span class="annottext">MultiSet a
</span><a href="#local-6989586621679099485"><span class="hs-identifier hs-var">unique</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-449"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">put</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679099482"><span class="hs-identifier hs-type">trace'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679099480"><span class="hs-identifier hs-type">totalLogP</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><a href="#local-6989586621679099483"><span class="hs-identifier hs-type">logP</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><a href="#local-6989586621679099487"><span class="hs-identifier hs-type">permutations</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-450"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><a href="#local-6989586621679099481"><span class="hs-identifier hs-type">results</span></a></span><span>
</span><span id="line-451"></span><span>
</span><span id="line-452"></span><span id="local-6989586621679098241"><span id="local-6989586621679098242"><span class="annot"><a href="Inference.Conjugate.html#runTraceLogP"><span class="hs-identifier hs-type">runTraceLogP</span></a></span><span>
</span><span id="line-453"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679098241"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#ProbsRep"><span class="hs-identifier hs-type">ProbsRep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Trace"><span class="hs-identifier hs-type">Trace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098241"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#EvalTraceI"><span class="hs-identifier hs-type">EvalTraceI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098241"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098242"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679098242"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Trace"><span class="hs-identifier hs-type">Trace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098241"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-454"></span><span id="runTraceLogP"><span class="annot"><span class="annottext">runTraceLogP :: forall (r :: (* -&gt; *) -&gt; *) a.
r ProbsRep
-&gt; Trace r -&gt; EvalTraceI r a -&gt; Maybe (a, (Trace r, Double))
</span><a href="Inference.Conjugate.html#runTraceLogP"><span class="hs-identifier hs-var hs-var">runTraceLogP</span></a></span></span><span> </span><span id="local-6989586621679099491"><span class="annot"><span class="annottext">r ProbsRep
</span><a href="#local-6989586621679099491"><span class="hs-identifier hs-var">probs</span></a></span></span><span> </span><span id="local-6989586621679099492"><span class="annot"><span class="annottext">Trace r
</span><a href="#local-6989586621679099492"><span class="hs-identifier hs-var">trace</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#EvalTraceI"><span class="hs-identifier hs-type">EvalTraceI</span></a></span><span> </span><span id="local-6989586621679099493"><span class="annot"><span class="annottext">ReaderT (r ProbsRep) (StateT (Trace r, Double) Maybe) a
</span><a href="#local-6989586621679099493"><span class="hs-identifier hs-var">model</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-455"></span><span>  </span><span class="annot"><span class="annottext">StateT (Trace r, Double) Maybe a
-&gt; (Trace r, Double) -&gt; Maybe (a, (Trace r, Double))
forall s (m :: * -&gt; *) a. StateT s m a -&gt; s -&gt; m (a, s)
</span><span class="hs-identifier hs-var">runStateT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ReaderT (r ProbsRep) (StateT (Trace r, Double) Maybe) a
-&gt; r ProbsRep -&gt; StateT (Trace r, Double) Maybe a
forall r (m :: * -&gt; *) a. ReaderT r m a -&gt; r -&gt; m a
</span><span class="hs-identifier hs-var">runReaderT</span></span><span> </span><span class="annot"><span class="annottext">ReaderT (r ProbsRep) (StateT (Trace r, Double) Maybe) a
</span><a href="#local-6989586621679099493"><span class="hs-identifier hs-var">model</span></a></span><span> </span><span class="annot"><span class="annottext">r ProbsRep
</span><a href="#local-6989586621679099491"><span class="hs-identifier hs-var">probs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Trace r
</span><a href="#local-6989586621679099492"><span class="hs-identifier hs-var">trace</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-456"></span><span>
</span><span id="line-457"></span><span id="local-6989586621679098253"><span id="local-6989586621679098254"><span class="annot"><a href="Inference.Conjugate.html#evalTraceLogP"><span class="hs-identifier hs-type">evalTraceLogP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679098253"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#ProbsRep"><span class="hs-identifier hs-type">ProbsRep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Trace"><span class="hs-identifier hs-type">Trace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098253"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#EvalTraceI"><span class="hs-identifier hs-type">EvalTraceI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098253"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098254"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679098254"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-458"></span><span id="evalTraceLogP"><span class="annot"><span class="annottext">evalTraceLogP :: forall (r :: (* -&gt; *) -&gt; *) a.
r ProbsRep -&gt; Trace r -&gt; EvalTraceI r a -&gt; Maybe (a, Double)
</span><a href="Inference.Conjugate.html#evalTraceLogP"><span class="hs-identifier hs-var hs-var">evalTraceLogP</span></a></span></span><span> </span><span id="local-6989586621679099497"><span class="annot"><span class="annottext">r ProbsRep
</span><a href="#local-6989586621679099497"><span class="hs-identifier hs-var">probs</span></a></span></span><span> </span><span id="local-6989586621679099498"><span class="annot"><span class="annottext">Trace r
</span><a href="#local-6989586621679099498"><span class="hs-identifier hs-var">trace</span></a></span></span><span> </span><span id="local-6989586621679099499"><span class="annot"><span class="annottext">EvalTraceI r a
</span><a href="#local-6989586621679099499"><span class="hs-identifier hs-var">model</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-459"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679099500"><span class="annot"><a href="#local-6989586621679099500"><span class="hs-identifier hs-var">val</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679099501"><span class="annot"><a href="#local-6989586621679099501"><span class="hs-identifier hs-var">_trace</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679099502"><span class="annot"><a href="#local-6989586621679099502"><span class="hs-identifier hs-var">logp</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">r ProbsRep
-&gt; Trace r -&gt; EvalTraceI r a -&gt; Maybe (a, (Trace r, Double))
forall (r :: (* -&gt; *) -&gt; *) a.
r ProbsRep
-&gt; Trace r -&gt; EvalTraceI r a -&gt; Maybe (a, (Trace r, Double))
</span><a href="Inference.Conjugate.html#runTraceLogP"><span class="hs-identifier hs-var">runTraceLogP</span></a></span><span> </span><span class="annot"><span class="annottext">r ProbsRep
</span><a href="#local-6989586621679099497"><span class="hs-identifier hs-var">probs</span></a></span><span> </span><span class="annot"><span class="annottext">Trace r
</span><a href="#local-6989586621679099498"><span class="hs-identifier hs-var">trace</span></a></span><span> </span><span class="annot"><span class="annottext">EvalTraceI r a
</span><a href="#local-6989586621679099499"><span class="hs-identifier hs-var">model</span></a></span><span>
</span><span id="line-460"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679099500"><span class="hs-identifier hs-type">val</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679099502"><span class="hs-identifier hs-type">logp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-461"></span><span>
</span><span id="line-462"></span><span class="hs-comment">-- evaluate the predictive probability of a trace</span><span>
</span><span id="line-463"></span><span class="hs-comment">-- -----------------------------------</span><span>
</span><span id="line-464"></span><span>
</span><span id="line-465"></span><span class="hs-keyword">newtype</span><span> </span><span id="EvalPredTraceI"><span class="annot"><a href="Inference.Conjugate.html#EvalPredTraceI"><span class="hs-identifier hs-var">EvalPredTraceI</span></a></span></span><span> </span><span id="local-6989586621679098292"><span class="annot"><a href="#local-6989586621679098292"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span id="local-6989586621679098293"><span class="annot"><a href="#local-6989586621679098293"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="EvalPredTraceI"><span class="annot"><a href="Inference.Conjugate.html#EvalPredTraceI"><span class="hs-identifier hs-var">EvalPredTraceI</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ReaderT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679098292"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#HyperRep"><span class="hs-identifier hs-type">HyperRep</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">StateT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Trace"><span class="hs-identifier hs-type">Trace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098292"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679098293"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-466"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679099505"><span id="local-6989586621679099510"><span class="annot"><span class="annottext">(forall a b. (a -&gt; b) -&gt; EvalPredTraceI r a -&gt; EvalPredTraceI r b)
-&gt; (forall a b. a -&gt; EvalPredTraceI r b -&gt; EvalPredTraceI r a)
-&gt; Functor (EvalPredTraceI r)
forall a b. a -&gt; EvalPredTraceI r b -&gt; EvalPredTraceI r a
forall a b. (a -&gt; b) -&gt; EvalPredTraceI r a -&gt; EvalPredTraceI r b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
forall (r :: (* -&gt; *) -&gt; *) a b.
a -&gt; EvalPredTraceI r b -&gt; EvalPredTraceI r a
forall (r :: (* -&gt; *) -&gt; *) a b.
(a -&gt; b) -&gt; EvalPredTraceI r a -&gt; EvalPredTraceI r b
$cfmap :: forall (r :: (* -&gt; *) -&gt; *) a b.
(a -&gt; b) -&gt; EvalPredTraceI r a -&gt; EvalPredTraceI r b
fmap :: forall a b. (a -&gt; b) -&gt; EvalPredTraceI r a -&gt; EvalPredTraceI r b
$c&lt;$ :: forall (r :: (* -&gt; *) -&gt; *) a b.
a -&gt; EvalPredTraceI r b -&gt; EvalPredTraceI r a
&lt;$ :: forall a b. a -&gt; EvalPredTraceI r b -&gt; EvalPredTraceI r a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679099520"><span id="local-6989586621679099525"><span id="local-6989586621679099530"><span id="local-6989586621679099535"><span id="local-6989586621679099540"><span class="annot"><span class="annottext">Functor (EvalPredTraceI r)
Functor (EvalPredTraceI r) =&gt;
(forall a. a -&gt; EvalPredTraceI r a)
-&gt; (forall a b.
    EvalPredTraceI r (a -&gt; b)
    -&gt; EvalPredTraceI r a -&gt; EvalPredTraceI r b)
-&gt; (forall a b c.
    (a -&gt; b -&gt; c)
    -&gt; EvalPredTraceI r a -&gt; EvalPredTraceI r b -&gt; EvalPredTraceI r c)
-&gt; (forall a b.
    EvalPredTraceI r a -&gt; EvalPredTraceI r b -&gt; EvalPredTraceI r b)
-&gt; (forall a b.
    EvalPredTraceI r a -&gt; EvalPredTraceI r b -&gt; EvalPredTraceI r a)
-&gt; Applicative (EvalPredTraceI r)
forall a. a -&gt; EvalPredTraceI r a
forall a b.
EvalPredTraceI r a -&gt; EvalPredTraceI r b -&gt; EvalPredTraceI r a
forall a b.
EvalPredTraceI r a -&gt; EvalPredTraceI r b -&gt; EvalPredTraceI r b
forall a b.
EvalPredTraceI r (a -&gt; b)
-&gt; EvalPredTraceI r a -&gt; EvalPredTraceI r b
forall a b c.
(a -&gt; b -&gt; c)
-&gt; EvalPredTraceI r a -&gt; EvalPredTraceI r b -&gt; EvalPredTraceI r c
forall (f :: * -&gt; *).
Functor f =&gt;
(forall a. a -&gt; f a)
-&gt; (forall a b. f (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b c. (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c)
-&gt; (forall a b. f a -&gt; f b -&gt; f b)
-&gt; (forall a b. f a -&gt; f b -&gt; f a)
-&gt; Applicative f
forall (r :: (* -&gt; *) -&gt; *). Functor (EvalPredTraceI r)
forall (r :: (* -&gt; *) -&gt; *) a. a -&gt; EvalPredTraceI r a
forall (r :: (* -&gt; *) -&gt; *) a b.
EvalPredTraceI r a -&gt; EvalPredTraceI r b -&gt; EvalPredTraceI r a
forall (r :: (* -&gt; *) -&gt; *) a b.
EvalPredTraceI r a -&gt; EvalPredTraceI r b -&gt; EvalPredTraceI r b
forall (r :: (* -&gt; *) -&gt; *) a b.
EvalPredTraceI r (a -&gt; b)
-&gt; EvalPredTraceI r a -&gt; EvalPredTraceI r b
forall (r :: (* -&gt; *) -&gt; *) a b c.
(a -&gt; b -&gt; c)
-&gt; EvalPredTraceI r a -&gt; EvalPredTraceI r b -&gt; EvalPredTraceI r c
$cpure :: forall (r :: (* -&gt; *) -&gt; *) a. a -&gt; EvalPredTraceI r a
pure :: forall a. a -&gt; EvalPredTraceI r a
$c&lt;*&gt; :: forall (r :: (* -&gt; *) -&gt; *) a b.
EvalPredTraceI r (a -&gt; b)
-&gt; EvalPredTraceI r a -&gt; EvalPredTraceI r b
&lt;*&gt; :: forall a b.
EvalPredTraceI r (a -&gt; b)
-&gt; EvalPredTraceI r a -&gt; EvalPredTraceI r b
$cliftA2 :: forall (r :: (* -&gt; *) -&gt; *) a b c.
(a -&gt; b -&gt; c)
-&gt; EvalPredTraceI r a -&gt; EvalPredTraceI r b -&gt; EvalPredTraceI r c
liftA2 :: forall a b c.
(a -&gt; b -&gt; c)
-&gt; EvalPredTraceI r a -&gt; EvalPredTraceI r b -&gt; EvalPredTraceI r c
$c*&gt; :: forall (r :: (* -&gt; *) -&gt; *) a b.
EvalPredTraceI r a -&gt; EvalPredTraceI r b -&gt; EvalPredTraceI r b
*&gt; :: forall a b.
EvalPredTraceI r a -&gt; EvalPredTraceI r b -&gt; EvalPredTraceI r b
$c&lt;* :: forall (r :: (* -&gt; *) -&gt; *) a b.
EvalPredTraceI r a -&gt; EvalPredTraceI r b -&gt; EvalPredTraceI r a
&lt;* :: forall a b.
EvalPredTraceI r a -&gt; EvalPredTraceI r b -&gt; EvalPredTraceI r a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Applicative</span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679099558"><span id="local-6989586621679099563"><span id="local-6989586621679099568"><span class="annot"><span class="annottext">Applicative (EvalPredTraceI r)
Applicative (EvalPredTraceI r) =&gt;
(forall a b.
 EvalPredTraceI r a
 -&gt; (a -&gt; EvalPredTraceI r b) -&gt; EvalPredTraceI r b)
-&gt; (forall a b.
    EvalPredTraceI r a -&gt; EvalPredTraceI r b -&gt; EvalPredTraceI r b)
-&gt; (forall a. a -&gt; EvalPredTraceI r a)
-&gt; Monad (EvalPredTraceI r)
forall a. a -&gt; EvalPredTraceI r a
forall a b.
EvalPredTraceI r a -&gt; EvalPredTraceI r b -&gt; EvalPredTraceI r b
forall a b.
EvalPredTraceI r a
-&gt; (a -&gt; EvalPredTraceI r b) -&gt; EvalPredTraceI r b
forall (m :: * -&gt; *).
Applicative m =&gt;
(forall a b. m a -&gt; (a -&gt; m b) -&gt; m b)
-&gt; (forall a b. m a -&gt; m b -&gt; m b)
-&gt; (forall a. a -&gt; m a)
-&gt; Monad m
forall (r :: (* -&gt; *) -&gt; *). Applicative (EvalPredTraceI r)
forall (r :: (* -&gt; *) -&gt; *) a. a -&gt; EvalPredTraceI r a
forall (r :: (* -&gt; *) -&gt; *) a b.
EvalPredTraceI r a -&gt; EvalPredTraceI r b -&gt; EvalPredTraceI r b
forall (r :: (* -&gt; *) -&gt; *) a b.
EvalPredTraceI r a
-&gt; (a -&gt; EvalPredTraceI r b) -&gt; EvalPredTraceI r b
$c&gt;&gt;= :: forall (r :: (* -&gt; *) -&gt; *) a b.
EvalPredTraceI r a
-&gt; (a -&gt; EvalPredTraceI r b) -&gt; EvalPredTraceI r b
&gt;&gt;= :: forall a b.
EvalPredTraceI r a
-&gt; (a -&gt; EvalPredTraceI r b) -&gt; EvalPredTraceI r b
$c&gt;&gt; :: forall (r :: (* -&gt; *) -&gt; *) a b.
EvalPredTraceI r a -&gt; EvalPredTraceI r b -&gt; EvalPredTraceI r b
&gt;&gt; :: forall a b.
EvalPredTraceI r a -&gt; EvalPredTraceI r b -&gt; EvalPredTraceI r b
$creturn :: forall (r :: (* -&gt; *) -&gt; *) a. a -&gt; EvalPredTraceI r a
return :: forall a. a -&gt; EvalPredTraceI r a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Monad</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-467"></span><span>
</span><span id="line-468"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679098284"><span class="annot"><a href="Inference.Conjugate.html#RandomInterpreter"><span class="hs-identifier hs-type">RandomInterpreter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#EvalPredTraceI"><span class="hs-identifier hs-type">EvalPredTraceI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098284"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679098284"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-469"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="SampleCtx"><span class="annot"><a href="Inference.Conjugate.html#SampleCtx"><span class="hs-identifier hs-var">SampleCtx</span></a></span></span><span> </span><span id="local-6989586621679099582"><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#EvalPredTraceI"><span class="hs-identifier hs-type">EvalPredTraceI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098284"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679099582"><span class="hs-identifier hs-type">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Support"><span class="hs-identifier hs-type">Support</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679099582"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-470"></span><span>  </span><span class="annot"><a href="Inference.Conjugate.html#sampleValue"><span class="hs-identifier hs-type">sampleValue</span></a></span><span>
</span><span id="line-471"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679098285"><span class="annot"><a href="#local-6989586621679098285"><span class="hs-identifier hs-type">p</span></a></span></span><span> </span><span id="local-6989586621679098286"><span class="annot"><a href="#local-6989586621679098286"><span class="hs-identifier hs-type">l</span></a></span></span><span>
</span><span id="line-472"></span><span>     </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Conjugate"><span class="hs-identifier hs-type">Conjugate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098285"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098286"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Support"><span class="hs-identifier hs-type">Support</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098286"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-473"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-474"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679098286"><span class="hs-identifier hs-type">l</span></a></span><span>
</span><span id="line-475"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Accessor"><span class="hs-identifier hs-type">Accessor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098284"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098285"><span class="hs-identifier hs-type">p</span></a></span><span>
</span><span id="line-476"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#EvalPredTraceI"><span class="hs-identifier hs-type">EvalPredTraceI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098284"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Support"><span class="hs-identifier hs-type">Support</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098286"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-477"></span><span>  </span><span id="local-6989586621679099613"><span class="annot"><span class="annottext">sampleValue :: forall p l.
(Conjugate p l, Typeable (Support l)) =&gt;
String -&gt; l -&gt; Accessor r p -&gt; EvalPredTraceI r (Support l)
</span><a href="Inference.Conjugate.html#sampleValue"><span class="hs-identifier hs-var hs-var hs-var">sampleValue</span></a></span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679099614"><span class="annot"><span class="annottext">l
</span><a href="#local-6989586621679099614"><span class="hs-identifier hs-var">lk</span></a></span></span><span> </span><span id="local-6989586621679099615"><span class="annot"><span class="annottext">Accessor r p
</span><a href="#local-6989586621679099615"><span class="hs-identifier hs-var">getHyper</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReaderT (r HyperRep) (StateT (Trace r, Double) Maybe) (Support l)
-&gt; EvalPredTraceI r (Support l)
forall (r :: (* -&gt; *) -&gt; *) a.
ReaderT (r HyperRep) (StateT (Trace r, Double) Maybe) a
-&gt; EvalPredTraceI r a
</span><a href="Inference.Conjugate.html#EvalPredTraceI"><span class="hs-identifier hs-var">EvalPredTraceI</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT (r HyperRep) (StateT (Trace r, Double) Maybe) (Support l)
 -&gt; EvalPredTraceI r (Support l))
-&gt; ReaderT
     (r HyperRep) (StateT (Trace r, Double) Maybe) (Support l)
-&gt; EvalPredTraceI r (Support l)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-478"></span><span>    </span><span id="local-6989586621679099616"><span class="annot"><a href="#local-6989586621679099616"><span class="hs-identifier hs-var">hyper</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT (r HyperRep) (StateT (Trace r, Double) Maybe) (r HyperRep)
forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span>
</span><span id="line-479"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679099617"><span class="annot"><a href="#local-6989586621679099617"><span class="hs-identifier hs-var">trace</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679099618"><span class="annot"><a href="#local-6989586621679099618"><span class="hs-identifier hs-var">totalLogP</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">get</span></span><span>
</span><span id="line-480"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679099619"><span class="annot"><a href="#local-6989586621679099619"><span class="hs-identifier hs-var">_name</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679099620"><span class="annot"><a href="#local-6989586621679099620"><span class="hs-identifier hs-var">val</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679099621"><span class="annot"><a href="#local-6989586621679099621"><span class="hs-identifier hs-var">trace'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">lift</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">lift</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#takeTrace"><span class="hs-identifier hs-type">takeTrace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679099617"><span class="hs-identifier hs-type">trace</span></a></span><span>
</span><span id="line-481"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679099622"><span class="annot"><a href="#local-6989586621679099622"><span class="hs-identifier hs-var hs-var">logP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall p l. Conjugate p l =&gt; l -&gt; Params p -&gt; Support l -&gt; Double
</span><a href="Inference.Conjugate.html#predLogP"><span class="hs-identifier hs-var">predLogP</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679098285"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="annottext">l
</span><a href="#local-6989586621679099614"><span class="hs-identifier hs-var">lk</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HyperRep p -&gt; Hyper (AsPrior p)
forall p. HyperRep p -&gt; Hyper (AsPrior p)
</span><a href="Inference.Conjugate.html#runHyper"><span class="hs-identifier hs-var">runHyper</span></a></span><span> </span><span class="annot"><span class="annottext">(HyperRep p -&gt; Hyper (AsPrior p))
-&gt; HyperRep p -&gt; Hyper (AsPrior p)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Getting (HyperRep p) (r HyperRep) (HyperRep p)
-&gt; r HyperRep -&gt; HyperRep p
forall a s. Getting a s a -&gt; s -&gt; a
</span><span class="hs-identifier hs-var">view</span></span><span> </span><span class="annot"><span class="annottext">Getting (HyperRep p) (r HyperRep) (HyperRep p)
Accessor r p
</span><a href="#local-6989586621679099615"><span class="hs-identifier hs-var">getHyper</span></a></span><span> </span><span class="annot"><span class="annottext">r HyperRep
</span><a href="#local-6989586621679099616"><span class="hs-identifier hs-var">hyper</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Support l
</span><a href="#local-6989586621679099620"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-482"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">put</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679099621"><span class="hs-identifier hs-type">trace'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679099618"><span class="hs-identifier hs-type">totalLogP</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><a href="#local-6989586621679099622"><span class="hs-identifier hs-type">logP</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-483"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><a href="#local-6989586621679099620"><span class="hs-identifier hs-type">val</span></a></span><span>
</span><span id="line-484"></span><span>  </span><span class="annot"><a href="Inference.Conjugate.html#sampleConst"><span class="hs-identifier hs-type">sampleConst</span></a></span><span>
</span><span id="line-485"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679098294"><span class="annot"><a href="#local-6989586621679098294"><span class="hs-identifier hs-type">d</span></a></span></span><span>
</span><span id="line-486"></span><span>     </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Distribution"><span class="hs-identifier hs-type">Distribution</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098294"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Support"><span class="hs-identifier hs-type">Support</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098294"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-487"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-488"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679098294"><span class="hs-identifier hs-type">d</span></a></span><span>
</span><span id="line-489"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Params"><span class="hs-identifier hs-type">Params</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098294"><span class="hs-identifier hs-type">d</span></a></span><span>
</span><span id="line-490"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#EvalPredTraceI"><span class="hs-identifier hs-type">EvalPredTraceI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098284"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Support"><span class="hs-identifier hs-type">Support</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098294"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-491"></span><span>  </span><span id="local-6989586621679099648"><span class="annot"><span class="annottext">sampleConst :: forall d.
(Distribution d, Typeable (Support d)) =&gt;
String -&gt; d -&gt; Params d -&gt; EvalPredTraceI r (Support d)
</span><a href="Inference.Conjugate.html#sampleConst"><span class="hs-identifier hs-var hs-var hs-var">sampleConst</span></a></span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679099649"><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679099649"><span class="hs-identifier hs-var">dist</span></a></span></span><span> </span><span id="local-6989586621679099650"><span class="annot"><span class="annottext">Params d
</span><a href="#local-6989586621679099650"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReaderT (r HyperRep) (StateT (Trace r, Double) Maybe) (Support d)
-&gt; EvalPredTraceI r (Support d)
forall (r :: (* -&gt; *) -&gt; *) a.
ReaderT (r HyperRep) (StateT (Trace r, Double) Maybe) a
-&gt; EvalPredTraceI r a
</span><a href="Inference.Conjugate.html#EvalPredTraceI"><span class="hs-identifier hs-var">EvalPredTraceI</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT (r HyperRep) (StateT (Trace r, Double) Maybe) (Support d)
 -&gt; EvalPredTraceI r (Support d))
-&gt; ReaderT
     (r HyperRep) (StateT (Trace r, Double) Maybe) (Support d)
-&gt; EvalPredTraceI r (Support d)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-492"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679099651"><span class="annot"><a href="#local-6989586621679099651"><span class="hs-identifier hs-var">trace</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679099652"><span class="annot"><a href="#local-6989586621679099652"><span class="hs-identifier hs-var">totalLogP</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT
  (r HyperRep) (StateT (Trace r, Double) Maybe) (Trace r, Double)
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-493"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679099653"><span class="annot"><a href="#local-6989586621679099653"><span class="hs-identifier hs-var">_name</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679099654"><span class="annot"><a href="#local-6989586621679099654"><span class="hs-identifier hs-var">val</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679099655"><span class="annot"><a href="#local-6989586621679099655"><span class="hs-identifier hs-var">trace'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">lift</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">lift</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#takeTrace"><span class="hs-identifier hs-type">takeTrace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679099651"><span class="hs-identifier hs-type">trace</span></a></span><span>
</span><span id="line-494"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679099656"><span class="annot"><a href="#local-6989586621679099656"><span class="hs-identifier hs-var hs-var">logP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">d -&gt; Params d -&gt; Support d -&gt; Double
forall a. Distribution a =&gt; a -&gt; Params a -&gt; Support a -&gt; Double
</span><a href="Inference.Conjugate.html#distLogP"><span class="hs-identifier hs-var">distLogP</span></a></span><span> </span><span class="annot"><span class="annottext">d
</span><a href="#local-6989586621679099649"><span class="hs-identifier hs-var">dist</span></a></span><span> </span><span class="annot"><span class="annottext">Params d
</span><a href="#local-6989586621679099650"><span class="hs-identifier hs-var">params</span></a></span><span> </span><span class="annot"><span class="annottext">Support d
</span><a href="#local-6989586621679099654"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-495"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">put</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679099655"><span class="hs-identifier hs-type">trace'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679099652"><span class="hs-identifier hs-type">totalLogP</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><a href="#local-6989586621679099656"><span class="hs-identifier hs-type">logP</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-496"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><a href="#local-6989586621679099654"><span class="hs-identifier hs-type">val</span></a></span><span>
</span><span id="line-497"></span><span>  </span><span id="local-6989586621679099685"><span class="annot"><span class="annottext">permutationPlate :: forall a.
Ord a =&gt;
Int -&gt; (Int -&gt; EvalPredTraceI r a) -&gt; EvalPredTraceI r [a]
</span><a href="Inference.Conjugate.html#permutationPlate"><span class="hs-identifier hs-var hs-var hs-var">permutationPlate</span></a></span></span><span> </span><span id="local-6989586621679099686"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679099686"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679099687"><span class="annot"><span class="annottext">Int -&gt; EvalPredTraceI r a
</span><a href="#local-6989586621679099687"><span class="hs-identifier hs-var">submodel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ReaderT (r HyperRep) (StateT (Trace r, Double) Maybe) [a]
-&gt; EvalPredTraceI r [a]
forall (r :: (* -&gt; *) -&gt; *) a.
ReaderT (r HyperRep) (StateT (Trace r, Double) Maybe) a
-&gt; EvalPredTraceI r a
</span><a href="Inference.Conjugate.html#EvalPredTraceI"><span class="hs-identifier hs-var">EvalPredTraceI</span></a></span><span> </span><span class="annot"><span class="annottext">(ReaderT (r HyperRep) (StateT (Trace r, Double) Maybe) [a]
 -&gt; EvalPredTraceI r [a])
-&gt; ReaderT (r HyperRep) (StateT (Trace r, Double) Maybe) [a]
-&gt; EvalPredTraceI r [a]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-498"></span><span>    </span><span id="local-6989586621679099688"><span class="annot"><a href="#local-6989586621679099688"><span class="hs-identifier hs-var">probs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ReaderT (r HyperRep) (StateT (Trace r, Double) Maybe) (r HyperRep)
forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><span class="hs-identifier hs-var">ask</span></span><span>
</span><span id="line-499"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679099689"><span class="annot"><a href="#local-6989586621679099689"><span class="hs-identifier hs-var">trace</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679099690"><span class="annot"><a href="#local-6989586621679099690"><span class="hs-identifier hs-var">totalLogP</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">get</span></span><span>
</span><span id="line-500"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679099691"><span class="annot"><a href="#local-6989586621679099691"><span class="hs-identifier hs-var">results</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679099692"><span class="annot"><a href="#local-6989586621679099692"><span class="hs-identifier hs-var">trace'</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679099693"><span class="annot"><a href="#local-6989586621679099693"><span class="hs-identifier hs-var">logP</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-501"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">lift</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-502"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">lift</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-503"></span><span>          </span><span class="annot"><a href="Inference.Conjugate.html#runTracePredLogP"><span class="hs-identifier hs-type">runTracePredLogP</span></a></span><span>
</span><span id="line-504"></span><span>            </span><span class="annot"><a href="#local-6989586621679099688"><span class="hs-identifier hs-type">probs</span></a></span><span>
</span><span id="line-505"></span><span>            </span><span class="annot"><a href="#local-6989586621679099689"><span class="hs-identifier hs-type">trace</span></a></span><span>
</span><span id="line-506"></span><span>            </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#replicateMWithI"><span class="hs-identifier hs-type">replicateMWithI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679099686"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679099687"><span class="hs-identifier hs-type">submodel</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-507"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679099695"><span class="annot"><a href="#local-6989586621679099695"><span class="hs-identifier hs-var hs-var">unique</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[a] -&gt; MultiSet a
forall a. Ord a =&gt; [a] -&gt; MultiSet a
</span><span class="hs-identifier hs-var">MS.fromList</span></span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679099691"><span class="hs-identifier hs-var">results</span></a></span><span>
</span><span id="line-508"></span><span>        </span><span id="local-6989586621679099696"><span class="annot"><a href="#local-6989586621679099696"><span class="hs-identifier hs-var hs-var">permutations</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-509"></span><span>          </span><span class="annot"><span class="annottext">Int -&gt; Double
forall a. Integral a =&gt; a -&gt; Double
</span><span class="hs-identifier hs-var">logFactorial</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679099686"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">[Double] -&gt; Double
forall a. Num a =&gt; [a] -&gt; a
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">sum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Double
forall a. Integral a =&gt; a -&gt; Double
</span><span class="hs-identifier hs-var">logFactorial</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Double) -&gt; ((a, Int) -&gt; Int) -&gt; (a, Int) -&gt; Double
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a, Int) -&gt; Int
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((a, Int) -&gt; Double) -&gt; [(a, Int)] -&gt; [Double]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">MultiSet a -&gt; [(a, Int)]
forall a. MultiSet a -&gt; [(a, Int)]
</span><span class="hs-identifier hs-var">MS.toOccurList</span></span><span> </span><span class="annot"><span class="annottext">MultiSet a
</span><a href="#local-6989586621679099695"><span class="hs-identifier hs-var">unique</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-510"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">put</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679099692"><span class="hs-identifier hs-type">trace'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679099690"><span class="hs-identifier hs-type">totalLogP</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><a href="#local-6989586621679099693"><span class="hs-identifier hs-type">logP</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><a href="#local-6989586621679099696"><span class="hs-identifier hs-type">permutations</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-511"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><a href="#local-6989586621679099691"><span class="hs-identifier hs-type">results</span></a></span><span>
</span><span id="line-512"></span><span>
</span><span id="line-513"></span><span id="local-6989586621679098298"><span id="local-6989586621679098299"><span class="annot"><a href="Inference.Conjugate.html#runTracePredLogP"><span class="hs-identifier hs-type">runTracePredLogP</span></a></span><span>
</span><span id="line-514"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679098298"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#HyperRep"><span class="hs-identifier hs-type">HyperRep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Trace"><span class="hs-identifier hs-type">Trace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098298"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#EvalPredTraceI"><span class="hs-identifier hs-type">EvalPredTraceI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098298"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098299"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679098299"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Trace"><span class="hs-identifier hs-type">Trace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098298"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-515"></span><span id="runTracePredLogP"><span class="annot"><span class="annottext">runTracePredLogP :: forall (r :: (* -&gt; *) -&gt; *) a.
r HyperRep
-&gt; Trace r -&gt; EvalPredTraceI r a -&gt; Maybe (a, (Trace r, Double))
</span><a href="Inference.Conjugate.html#runTracePredLogP"><span class="hs-identifier hs-var hs-var">runTracePredLogP</span></a></span></span><span> </span><span id="local-6989586621679099697"><span class="annot"><span class="annottext">r HyperRep
</span><a href="#local-6989586621679099697"><span class="hs-identifier hs-var">hyper</span></a></span></span><span> </span><span id="local-6989586621679099698"><span class="annot"><span class="annottext">Trace r
</span><a href="#local-6989586621679099698"><span class="hs-identifier hs-var">trace</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#EvalPredTraceI"><span class="hs-identifier hs-type">EvalPredTraceI</span></a></span><span> </span><span id="local-6989586621679099699"><span class="annot"><span class="annottext">ReaderT (r HyperRep) (StateT (Trace r, Double) Maybe) a
</span><a href="#local-6989586621679099699"><span class="hs-identifier hs-var">model</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-516"></span><span>  </span><span class="annot"><span class="annottext">StateT (Trace r, Double) Maybe a
-&gt; (Trace r, Double) -&gt; Maybe (a, (Trace r, Double))
forall s (m :: * -&gt; *) a. StateT s m a -&gt; s -&gt; m (a, s)
</span><span class="hs-identifier hs-var">runStateT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ReaderT (r HyperRep) (StateT (Trace r, Double) Maybe) a
-&gt; r HyperRep -&gt; StateT (Trace r, Double) Maybe a
forall r (m :: * -&gt; *) a. ReaderT r m a -&gt; r -&gt; m a
</span><span class="hs-identifier hs-var">runReaderT</span></span><span> </span><span class="annot"><span class="annottext">ReaderT (r HyperRep) (StateT (Trace r, Double) Maybe) a
</span><a href="#local-6989586621679099699"><span class="hs-identifier hs-var">model</span></a></span><span> </span><span class="annot"><span class="annottext">r HyperRep
</span><a href="#local-6989586621679099697"><span class="hs-identifier hs-var">hyper</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Trace r
</span><a href="#local-6989586621679099698"><span class="hs-identifier hs-var">trace</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-517"></span><span>
</span><span id="line-518"></span><span id="local-6989586621679098302"><span id="local-6989586621679098303"><span class="annot"><a href="Inference.Conjugate.html#evalTracePredLogP"><span class="hs-identifier hs-type">evalTracePredLogP</span></a></span><span>
</span><span id="line-519"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679098302"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#HyperRep"><span class="hs-identifier hs-type">HyperRep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Trace"><span class="hs-identifier hs-type">Trace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098302"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#EvalPredTraceI"><span class="hs-identifier hs-type">EvalPredTraceI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098302"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098303"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679098303"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-520"></span><span id="evalTracePredLogP"><span class="annot"><span class="annottext">evalTracePredLogP :: forall (r :: (* -&gt; *) -&gt; *) a.
r HyperRep -&gt; Trace r -&gt; EvalPredTraceI r a -&gt; Maybe (a, Double)
</span><a href="Inference.Conjugate.html#evalTracePredLogP"><span class="hs-identifier hs-var hs-var">evalTracePredLogP</span></a></span></span><span> </span><span id="local-6989586621679099703"><span class="annot"><span class="annottext">r HyperRep
</span><a href="#local-6989586621679099703"><span class="hs-identifier hs-var">hyper</span></a></span></span><span> </span><span id="local-6989586621679099704"><span class="annot"><span class="annottext">Trace r
</span><a href="#local-6989586621679099704"><span class="hs-identifier hs-var">trace</span></a></span></span><span> </span><span id="local-6989586621679099705"><span class="annot"><span class="annottext">EvalPredTraceI r a
</span><a href="#local-6989586621679099705"><span class="hs-identifier hs-var">model</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-521"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679099706"><span class="annot"><a href="#local-6989586621679099706"><span class="hs-identifier hs-var">val</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679099707"><span class="annot"><a href="#local-6989586621679099707"><span class="hs-identifier hs-var">_trace</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679099708"><span class="annot"><a href="#local-6989586621679099708"><span class="hs-identifier hs-var">logp</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">r HyperRep
-&gt; Trace r -&gt; EvalPredTraceI r a -&gt; Maybe (a, (Trace r, Double))
forall (r :: (* -&gt; *) -&gt; *) a.
r HyperRep
-&gt; Trace r -&gt; EvalPredTraceI r a -&gt; Maybe (a, (Trace r, Double))
</span><a href="Inference.Conjugate.html#runTracePredLogP"><span class="hs-identifier hs-var">runTracePredLogP</span></a></span><span> </span><span class="annot"><span class="annottext">r HyperRep
</span><a href="#local-6989586621679099703"><span class="hs-identifier hs-var">hyper</span></a></span><span> </span><span class="annot"><span class="annottext">Trace r
</span><a href="#local-6989586621679099704"><span class="hs-identifier hs-var">trace</span></a></span><span> </span><span class="annot"><span class="annottext">EvalPredTraceI r a
</span><a href="#local-6989586621679099705"><span class="hs-identifier hs-var">model</span></a></span><span>
</span><span id="line-522"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679099706"><span class="hs-identifier hs-type">val</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679099708"><span class="hs-identifier hs-type">logp</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-523"></span><span>
</span><span id="line-524"></span><span class="hs-comment">-- update priors</span><span>
</span><span id="line-525"></span><span class="hs-comment">-- -------------</span><span>
</span><span id="line-526"></span><span>
</span><span id="line-527"></span><span class="hs-keyword">newtype</span><span> </span><span id="UpdatePriorsI"><span class="annot"><a href="Inference.Conjugate.html#UpdatePriorsI"><span class="hs-identifier hs-var">UpdatePriorsI</span></a></span></span><span> </span><span id="local-6989586621679098342"><span class="annot"><a href="#local-6989586621679098342"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span id="local-6989586621679098343"><span class="annot"><a href="#local-6989586621679098343"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="UpdatePriorsI"><span class="annot"><a href="Inference.Conjugate.html#UpdatePriorsI"><span class="hs-identifier hs-var">UpdatePriorsI</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">StateT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Trace"><span class="hs-identifier hs-type">Trace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098342"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679098342"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#HyperRep"><span class="hs-identifier hs-type">HyperRep</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679098343"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-528"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679099711"><span id="local-6989586621679099716"><span class="annot"><span class="annottext">(forall a b. (a -&gt; b) -&gt; UpdatePriorsI r a -&gt; UpdatePriorsI r b)
-&gt; (forall a b. a -&gt; UpdatePriorsI r b -&gt; UpdatePriorsI r a)
-&gt; Functor (UpdatePriorsI r)
forall a b. a -&gt; UpdatePriorsI r b -&gt; UpdatePriorsI r a
forall a b. (a -&gt; b) -&gt; UpdatePriorsI r a -&gt; UpdatePriorsI r b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
forall (r :: (* -&gt; *) -&gt; *) a b.
a -&gt; UpdatePriorsI r b -&gt; UpdatePriorsI r a
forall (r :: (* -&gt; *) -&gt; *) a b.
(a -&gt; b) -&gt; UpdatePriorsI r a -&gt; UpdatePriorsI r b
$cfmap :: forall (r :: (* -&gt; *) -&gt; *) a b.
(a -&gt; b) -&gt; UpdatePriorsI r a -&gt; UpdatePriorsI r b
fmap :: forall a b. (a -&gt; b) -&gt; UpdatePriorsI r a -&gt; UpdatePriorsI r b
$c&lt;$ :: forall (r :: (* -&gt; *) -&gt; *) a b.
a -&gt; UpdatePriorsI r b -&gt; UpdatePriorsI r a
&lt;$ :: forall a b. a -&gt; UpdatePriorsI r b -&gt; UpdatePriorsI r a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679099724"><span id="local-6989586621679099730"><span id="local-6989586621679099736"><span id="local-6989586621679099742"><span id="local-6989586621679099748"><span class="annot"><span class="annottext">Functor (UpdatePriorsI r)
Functor (UpdatePriorsI r) =&gt;
(forall a. a -&gt; UpdatePriorsI r a)
-&gt; (forall a b.
    UpdatePriorsI r (a -&gt; b) -&gt; UpdatePriorsI r a -&gt; UpdatePriorsI r b)
-&gt; (forall a b c.
    (a -&gt; b -&gt; c)
    -&gt; UpdatePriorsI r a -&gt; UpdatePriorsI r b -&gt; UpdatePriorsI r c)
-&gt; (forall a b.
    UpdatePriorsI r a -&gt; UpdatePriorsI r b -&gt; UpdatePriorsI r b)
-&gt; (forall a b.
    UpdatePriorsI r a -&gt; UpdatePriorsI r b -&gt; UpdatePriorsI r a)
-&gt; Applicative (UpdatePriorsI r)
forall a. a -&gt; UpdatePriorsI r a
forall a b.
UpdatePriorsI r a -&gt; UpdatePriorsI r b -&gt; UpdatePriorsI r a
forall a b.
UpdatePriorsI r a -&gt; UpdatePriorsI r b -&gt; UpdatePriorsI r b
forall a b.
UpdatePriorsI r (a -&gt; b) -&gt; UpdatePriorsI r a -&gt; UpdatePriorsI r b
forall a b c.
(a -&gt; b -&gt; c)
-&gt; UpdatePriorsI r a -&gt; UpdatePriorsI r b -&gt; UpdatePriorsI r c
forall (f :: * -&gt; *).
Functor f =&gt;
(forall a. a -&gt; f a)
-&gt; (forall a b. f (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b c. (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c)
-&gt; (forall a b. f a -&gt; f b -&gt; f b)
-&gt; (forall a b. f a -&gt; f b -&gt; f a)
-&gt; Applicative f
forall (r :: (* -&gt; *) -&gt; *). Functor (UpdatePriorsI r)
forall (r :: (* -&gt; *) -&gt; *) a. a -&gt; UpdatePriorsI r a
forall (r :: (* -&gt; *) -&gt; *) a b.
UpdatePriorsI r a -&gt; UpdatePriorsI r b -&gt; UpdatePriorsI r a
forall (r :: (* -&gt; *) -&gt; *) a b.
UpdatePriorsI r a -&gt; UpdatePriorsI r b -&gt; UpdatePriorsI r b
forall (r :: (* -&gt; *) -&gt; *) a b.
UpdatePriorsI r (a -&gt; b) -&gt; UpdatePriorsI r a -&gt; UpdatePriorsI r b
forall (r :: (* -&gt; *) -&gt; *) a b c.
(a -&gt; b -&gt; c)
-&gt; UpdatePriorsI r a -&gt; UpdatePriorsI r b -&gt; UpdatePriorsI r c
$cpure :: forall (r :: (* -&gt; *) -&gt; *) a. a -&gt; UpdatePriorsI r a
pure :: forall a. a -&gt; UpdatePriorsI r a
$c&lt;*&gt; :: forall (r :: (* -&gt; *) -&gt; *) a b.
UpdatePriorsI r (a -&gt; b) -&gt; UpdatePriorsI r a -&gt; UpdatePriorsI r b
&lt;*&gt; :: forall a b.
UpdatePriorsI r (a -&gt; b) -&gt; UpdatePriorsI r a -&gt; UpdatePriorsI r b
$cliftA2 :: forall (r :: (* -&gt; *) -&gt; *) a b c.
(a -&gt; b -&gt; c)
-&gt; UpdatePriorsI r a -&gt; UpdatePriorsI r b -&gt; UpdatePriorsI r c
liftA2 :: forall a b c.
(a -&gt; b -&gt; c)
-&gt; UpdatePriorsI r a -&gt; UpdatePriorsI r b -&gt; UpdatePriorsI r c
$c*&gt; :: forall (r :: (* -&gt; *) -&gt; *) a b.
UpdatePriorsI r a -&gt; UpdatePriorsI r b -&gt; UpdatePriorsI r b
*&gt; :: forall a b.
UpdatePriorsI r a -&gt; UpdatePriorsI r b -&gt; UpdatePriorsI r b
$c&lt;* :: forall (r :: (* -&gt; *) -&gt; *) a b.
UpdatePriorsI r a -&gt; UpdatePriorsI r b -&gt; UpdatePriorsI r a
&lt;* :: forall a b.
UpdatePriorsI r a -&gt; UpdatePriorsI r b -&gt; UpdatePriorsI r a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Applicative</span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679099757"><span id="local-6989586621679099762"><span id="local-6989586621679099767"><span class="annot"><span class="annottext">Applicative (UpdatePriorsI r)
Applicative (UpdatePriorsI r) =&gt;
(forall a b.
 UpdatePriorsI r a -&gt; (a -&gt; UpdatePriorsI r b) -&gt; UpdatePriorsI r b)
-&gt; (forall a b.
    UpdatePriorsI r a -&gt; UpdatePriorsI r b -&gt; UpdatePriorsI r b)
-&gt; (forall a. a -&gt; UpdatePriorsI r a)
-&gt; Monad (UpdatePriorsI r)
forall a. a -&gt; UpdatePriorsI r a
forall a b.
UpdatePriorsI r a -&gt; UpdatePriorsI r b -&gt; UpdatePriorsI r b
forall a b.
UpdatePriorsI r a -&gt; (a -&gt; UpdatePriorsI r b) -&gt; UpdatePriorsI r b
forall (m :: * -&gt; *).
Applicative m =&gt;
(forall a b. m a -&gt; (a -&gt; m b) -&gt; m b)
-&gt; (forall a b. m a -&gt; m b -&gt; m b)
-&gt; (forall a. a -&gt; m a)
-&gt; Monad m
forall (r :: (* -&gt; *) -&gt; *). Applicative (UpdatePriorsI r)
forall (r :: (* -&gt; *) -&gt; *) a. a -&gt; UpdatePriorsI r a
forall (r :: (* -&gt; *) -&gt; *) a b.
UpdatePriorsI r a -&gt; UpdatePriorsI r b -&gt; UpdatePriorsI r b
forall (r :: (* -&gt; *) -&gt; *) a b.
UpdatePriorsI r a -&gt; (a -&gt; UpdatePriorsI r b) -&gt; UpdatePriorsI r b
$c&gt;&gt;= :: forall (r :: (* -&gt; *) -&gt; *) a b.
UpdatePriorsI r a -&gt; (a -&gt; UpdatePriorsI r b) -&gt; UpdatePriorsI r b
&gt;&gt;= :: forall a b.
UpdatePriorsI r a -&gt; (a -&gt; UpdatePriorsI r b) -&gt; UpdatePriorsI r b
$c&gt;&gt; :: forall (r :: (* -&gt; *) -&gt; *) a b.
UpdatePriorsI r a -&gt; UpdatePriorsI r b -&gt; UpdatePriorsI r b
&gt;&gt; :: forall a b.
UpdatePriorsI r a -&gt; UpdatePriorsI r b -&gt; UpdatePriorsI r b
$creturn :: forall (r :: (* -&gt; *) -&gt; *) a. a -&gt; UpdatePriorsI r a
return :: forall a. a -&gt; UpdatePriorsI r a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Monad</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-529"></span><span>
</span><span id="line-530"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679098333"><span class="annot"><a href="Inference.Conjugate.html#RandomInterpreter"><span class="hs-identifier hs-type">RandomInterpreter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#UpdatePriorsI"><span class="hs-identifier hs-type">UpdatePriorsI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098333"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679098333"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-531"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="SampleCtx"><span class="annot"><a href="Inference.Conjugate.html#SampleCtx"><span class="hs-identifier hs-var">SampleCtx</span></a></span></span><span> </span><span id="local-6989586621679099778"><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#UpdatePriorsI"><span class="hs-identifier hs-type">UpdatePriorsI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098333"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679099778"><span class="hs-identifier hs-type">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Support"><span class="hs-identifier hs-type">Support</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679099778"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-532"></span><span>  </span><span class="annot"><a href="Inference.Conjugate.html#sampleValue"><span class="hs-identifier hs-type">sampleValue</span></a></span><span>
</span><span id="line-533"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679098334"><span class="annot"><a href="#local-6989586621679098334"><span class="hs-identifier hs-type">p</span></a></span></span><span> </span><span id="local-6989586621679098335"><span class="annot"><a href="#local-6989586621679098335"><span class="hs-identifier hs-type">l</span></a></span></span><span>
</span><span id="line-534"></span><span>     </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Conjugate"><span class="hs-identifier hs-type">Conjugate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098334"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098335"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Support"><span class="hs-identifier hs-type">Support</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098335"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-535"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-536"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679098335"><span class="hs-identifier hs-type">l</span></a></span><span>
</span><span id="line-537"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Accessor"><span class="hs-identifier hs-type">Accessor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098333"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098334"><span class="hs-identifier hs-type">p</span></a></span><span>
</span><span id="line-538"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#UpdatePriorsI"><span class="hs-identifier hs-type">UpdatePriorsI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098333"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Support"><span class="hs-identifier hs-type">Support</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098335"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-539"></span><span>  </span><span id="local-6989586621679099802"><span class="annot"><span class="annottext">sampleValue :: forall p l.
(Conjugate p l, Typeable (Support l)) =&gt;
String -&gt; l -&gt; Accessor r p -&gt; UpdatePriorsI r (Support l)
</span><a href="Inference.Conjugate.html#sampleValue"><span class="hs-identifier hs-var hs-var hs-var">sampleValue</span></a></span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679099803"><span class="annot"><span class="annottext">l
</span><a href="#local-6989586621679099803"><span class="hs-identifier hs-var">lk</span></a></span></span><span> </span><span id="local-6989586621679099804"><span class="annot"><span class="annottext">Accessor r p
</span><a href="#local-6989586621679099804"><span class="hs-identifier hs-var">accessor</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateT (Trace r, r HyperRep) Maybe (Support l)
-&gt; UpdatePriorsI r (Support l)
forall (r :: (* -&gt; *) -&gt; *) a.
StateT (Trace r, r HyperRep) Maybe a -&gt; UpdatePriorsI r a
</span><a href="Inference.Conjugate.html#UpdatePriorsI"><span class="hs-identifier hs-var">UpdatePriorsI</span></a></span><span> </span><span class="annot"><span class="annottext">(StateT (Trace r, r HyperRep) Maybe (Support l)
 -&gt; UpdatePriorsI r (Support l))
-&gt; StateT (Trace r, r HyperRep) Maybe (Support l)
-&gt; UpdatePriorsI r (Support l)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-540"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679099805"><span class="annot"><a href="#local-6989586621679099805"><span class="hs-identifier hs-var">trace</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679099806"><span class="annot"><a href="#local-6989586621679099806"><span class="hs-identifier hs-var">priors</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT (Trace r, r HyperRep) Maybe (Trace r, r HyperRep)
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-541"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679099807"><span class="annot"><a href="#local-6989586621679099807"><span class="hs-identifier hs-var">_name</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679099808"><span class="annot"><a href="#local-6989586621679099808"><span class="hs-identifier hs-var">val</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679099809"><span class="annot"><a href="#local-6989586621679099809"><span class="hs-identifier hs-var">trace'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">lift</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#takeTrace"><span class="hs-identifier hs-type">takeTrace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679099805"><span class="hs-identifier hs-type">trace</span></a></span><span>
</span><span id="line-542"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="annot"><a href="#local-6989586621679099810"><span class="hs-identifier hs-type">priors'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679098333"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#HyperRep"><span class="hs-identifier hs-type">HyperRep</span></a></span><span>
</span><span id="line-543"></span><span>        </span><span id="local-6989586621679099810"><span class="annot"><a href="#local-6989586621679099810"><span class="hs-identifier hs-var hs-var">priors'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-544"></span><span>          </span><span class="annot"><span class="annottext">ASetter (r HyperRep) (r HyperRep) (HyperRep p) (HyperRep p)
-&gt; (HyperRep p -&gt; HyperRep p) -&gt; r HyperRep -&gt; r HyperRep
forall s t a b. ASetter s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-identifier hs-var">over</span></span><span>
</span><span id="line-545"></span><span>            </span><span class="annot"><span class="annottext">ASetter (r HyperRep) (r HyperRep) (HyperRep p) (HyperRep p)
Accessor r p
</span><a href="#local-6989586621679099804"><span class="hs-identifier hs-var">accessor</span></a></span><span>
</span><span id="line-546"></span><span>            </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#HyperRep"><span class="hs-identifier hs-type">HyperRep</span></a></span><span> </span><span id="local-6989586621679099812"><span class="annot"><span class="annottext">Hyper (AsPrior p)
</span><a href="#local-6989586621679099812"><span class="hs-identifier hs-var">pr</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Hyper (AsPrior p) -&gt; HyperRep p
forall p. Hyper (AsPrior p) -&gt; HyperRep p
</span><a href="Inference.Conjugate.html#HyperRep"><span class="hs-identifier hs-var">HyperRep</span></a></span><span> </span><span class="annot"><span class="annottext">(Hyper (AsPrior p) -&gt; HyperRep p)
-&gt; Hyper (AsPrior p) -&gt; HyperRep p
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">forall p l. Conjugate p l =&gt; l -&gt; Params p -&gt; Support l -&gt; Params p
</span><a href="Inference.Conjugate.html#updatePrior"><span class="hs-identifier hs-var">updatePrior</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679098334"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679098335"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><span class="annottext">l
</span><a href="#local-6989586621679099803"><span class="hs-identifier hs-var">lk</span></a></span><span> </span><span class="annot"><span class="annottext">Hyper (AsPrior p)
Params p
</span><a href="#local-6989586621679099812"><span class="hs-identifier hs-var">pr</span></a></span><span> </span><span class="annot"><span class="annottext">Support l
</span><a href="#local-6989586621679099808"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-547"></span><span>            </span><span class="annot"><span class="annottext">r HyperRep
</span><a href="#local-6989586621679099806"><span class="hs-identifier hs-var">priors</span></a></span><span>
</span><span id="line-548"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">put</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679099809"><span class="hs-identifier hs-type">trace'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679099810"><span class="hs-identifier hs-type">priors'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-549"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><a href="#local-6989586621679099808"><span class="hs-identifier hs-type">val</span></a></span><span>
</span><span id="line-550"></span><span>  </span><span id="local-6989586621679099827"><span class="annot"><span class="annottext">sampleConst :: forall d.
(Distribution d, SampleCtx (UpdatePriorsI r) d) =&gt;
String -&gt; d -&gt; Params d -&gt; UpdatePriorsI r (Support d)
</span><a href="Inference.Conjugate.html#sampleConst"><span class="hs-identifier hs-var hs-var hs-var">sampleConst</span></a></span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">d
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Params d
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">StateT (Trace r, r HyperRep) Maybe (Support d)
-&gt; UpdatePriorsI r (Support d)
forall (r :: (* -&gt; *) -&gt; *) a.
StateT (Trace r, r HyperRep) Maybe a -&gt; UpdatePriorsI r a
</span><a href="Inference.Conjugate.html#UpdatePriorsI"><span class="hs-identifier hs-var">UpdatePriorsI</span></a></span><span> </span><span class="annot"><span class="annottext">(StateT (Trace r, r HyperRep) Maybe (Support d)
 -&gt; UpdatePriorsI r (Support d))
-&gt; StateT (Trace r, r HyperRep) Maybe (Support d)
-&gt; UpdatePriorsI r (Support d)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-551"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679099828"><span class="annot"><a href="#local-6989586621679099828"><span class="hs-identifier hs-var">trace</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679099829"><span class="annot"><a href="#local-6989586621679099829"><span class="hs-identifier hs-var">priors</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT (Trace r, r HyperRep) Maybe (Trace r, r HyperRep)
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-552"></span><span>    </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679099830"><span class="annot"><a href="#local-6989586621679099830"><span class="hs-identifier hs-var">_name</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679099831"><span class="annot"><a href="#local-6989586621679099831"><span class="hs-identifier hs-var">val</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679099832"><span class="annot"><a href="#local-6989586621679099832"><span class="hs-identifier hs-var">trace'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">lift</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#takeTrace"><span class="hs-identifier hs-type">takeTrace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679099828"><span class="hs-identifier hs-type">trace</span></a></span><span>
</span><span id="line-553"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">put</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679099832"><span class="hs-identifier hs-type">trace'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679099829"><span class="hs-identifier hs-type">priors</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-554"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><a href="#local-6989586621679099831"><span class="hs-identifier hs-type">val</span></a></span><span>
</span><span id="line-555"></span><span>  </span><span id="local-6989586621679099835"><span class="annot"><span class="annottext">permutationPlate :: forall a.
Ord a =&gt;
Int -&gt; (Int -&gt; UpdatePriorsI r a) -&gt; UpdatePriorsI r [a]
</span><a href="Inference.Conjugate.html#permutationPlate"><span class="hs-identifier hs-var hs-var hs-var">permutationPlate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; (Int -&gt; UpdatePriorsI r a) -&gt; UpdatePriorsI r [a]
forall (m :: * -&gt; *) a.
Applicative m =&gt;
Int -&gt; (Int -&gt; m a) -&gt; m [a]
</span><a href="Inference.Conjugate.html#replicateMWithI"><span class="hs-identifier hs-var">replicateMWithI</span></a></span><span>
</span><span id="line-556"></span><span>
</span><span id="line-557"></span><span id="local-6989586621679098351"><span id="local-6989586621679098352"><span class="annot"><a href="Inference.Conjugate.html#getPosterior"><span class="hs-identifier hs-type">getPosterior</span></a></span><span>
</span><span id="line-558"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679098351"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#HyperRep"><span class="hs-identifier hs-type">HyperRep</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Trace"><span class="hs-identifier hs-type">Trace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098351"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#UpdatePriorsI"><span class="hs-identifier hs-type">UpdatePriorsI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098351"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098352"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679098351"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#HyperRep"><span class="hs-identifier hs-type">HyperRep</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-559"></span><span id="getPosterior"><span class="annot"><span class="annottext">getPosterior :: forall (r :: (* -&gt; *) -&gt; *) a.
r HyperRep -&gt; Trace r -&gt; UpdatePriorsI r a -&gt; Maybe (r HyperRep)
</span><a href="Inference.Conjugate.html#getPosterior"><span class="hs-identifier hs-var hs-var">getPosterior</span></a></span></span><span> </span><span id="local-6989586621679099840"><span class="annot"><span class="annottext">r HyperRep
</span><a href="#local-6989586621679099840"><span class="hs-identifier hs-var">priors</span></a></span></span><span> </span><span id="local-6989586621679099841"><span class="annot"><span class="annottext">Trace r
</span><a href="#local-6989586621679099841"><span class="hs-identifier hs-var">trace</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#UpdatePriorsI"><span class="hs-identifier hs-type">UpdatePriorsI</span></a></span><span> </span><span id="local-6989586621679099842"><span class="annot"><span class="annottext">StateT (Trace r, r HyperRep) Maybe a
</span><a href="#local-6989586621679099842"><span class="hs-identifier hs-var">model</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-560"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679099843"><span class="annot"><a href="#local-6989586621679099843"><span class="hs-identifier hs-var">_trace</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679099844"><span class="annot"><a href="#local-6989586621679099844"><span class="hs-identifier hs-var">posteriors</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT (Trace r, r HyperRep) Maybe a
-&gt; (Trace r, r HyperRep) -&gt; Maybe (Trace r, r HyperRep)
forall (m :: * -&gt; *) s a. Monad m =&gt; StateT s m a -&gt; s -&gt; m s
</span><span class="hs-identifier hs-var">execStateT</span></span><span> </span><span class="annot"><span class="annottext">StateT (Trace r, r HyperRep) Maybe a
</span><a href="#local-6989586621679099842"><span class="hs-identifier hs-var">model</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Trace r
</span><a href="#local-6989586621679099841"><span class="hs-identifier hs-var">trace</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">r HyperRep
</span><a href="#local-6989586621679099840"><span class="hs-identifier hs-var">priors</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-561"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><a href="#local-6989586621679099844"><span class="hs-identifier hs-type">posteriors</span></a></span><span>
</span><span id="line-562"></span><span>
</span><span id="line-563"></span><span class="hs-comment">-- show how a trace is generated by a model</span><span>
</span><span id="line-564"></span><span class="hs-comment">-- ----------------------------------------</span><span>
</span><span id="line-565"></span><span>
</span><span id="line-566"></span><span class="hs-keyword">newtype</span><span> </span><span id="ShowTraceI"><span class="annot"><a href="Inference.Conjugate.html#ShowTraceI"><span class="hs-identifier hs-var">ShowTraceI</span></a></span></span><span> </span><span id="local-6989586621679098413"><span class="annot"><a href="#local-6989586621679098413"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span id="local-6989586621679098414"><span class="annot"><a href="#local-6989586621679098414"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ShowTraceI"><span class="annot"><a href="Inference.Conjugate.html#ShowTraceI"><span class="hs-identifier hs-var">ShowTraceI</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MaybeT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">WriterT</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Trace"><span class="hs-identifier hs-type">Trace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098413"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679098414"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-567"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679099847"><span id="local-6989586621679099853"><span class="annot"><span class="annottext">(forall a b. (a -&gt; b) -&gt; ShowTraceI r a -&gt; ShowTraceI r b)
-&gt; (forall a b. a -&gt; ShowTraceI r b -&gt; ShowTraceI r a)
-&gt; Functor (ShowTraceI r)
forall a b. a -&gt; ShowTraceI r b -&gt; ShowTraceI r a
forall a b. (a -&gt; b) -&gt; ShowTraceI r a -&gt; ShowTraceI r b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
forall (r :: (* -&gt; *) -&gt; *) a b.
a -&gt; ShowTraceI r b -&gt; ShowTraceI r a
forall (r :: (* -&gt; *) -&gt; *) a b.
(a -&gt; b) -&gt; ShowTraceI r a -&gt; ShowTraceI r b
$cfmap :: forall (r :: (* -&gt; *) -&gt; *) a b.
(a -&gt; b) -&gt; ShowTraceI r a -&gt; ShowTraceI r b
fmap :: forall a b. (a -&gt; b) -&gt; ShowTraceI r a -&gt; ShowTraceI r b
$c&lt;$ :: forall (r :: (* -&gt; *) -&gt; *) a b.
a -&gt; ShowTraceI r b -&gt; ShowTraceI r a
&lt;$ :: forall a b. a -&gt; ShowTraceI r b -&gt; ShowTraceI r a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679099866"><span id="local-6989586621679099873"><span id="local-6989586621679099879"><span id="local-6989586621679099885"><span id="local-6989586621679099891"><span class="annot"><span class="annottext">Functor (ShowTraceI r)
Functor (ShowTraceI r) =&gt;
(forall a. a -&gt; ShowTraceI r a)
-&gt; (forall a b.
    ShowTraceI r (a -&gt; b) -&gt; ShowTraceI r a -&gt; ShowTraceI r b)
-&gt; (forall a b c.
    (a -&gt; b -&gt; c)
    -&gt; ShowTraceI r a -&gt; ShowTraceI r b -&gt; ShowTraceI r c)
-&gt; (forall a b. ShowTraceI r a -&gt; ShowTraceI r b -&gt; ShowTraceI r b)
-&gt; (forall a b. ShowTraceI r a -&gt; ShowTraceI r b -&gt; ShowTraceI r a)
-&gt; Applicative (ShowTraceI r)
forall a. a -&gt; ShowTraceI r a
forall a b. ShowTraceI r a -&gt; ShowTraceI r b -&gt; ShowTraceI r a
forall a b. ShowTraceI r a -&gt; ShowTraceI r b -&gt; ShowTraceI r b
forall a b.
ShowTraceI r (a -&gt; b) -&gt; ShowTraceI r a -&gt; ShowTraceI r b
forall a b c.
(a -&gt; b -&gt; c) -&gt; ShowTraceI r a -&gt; ShowTraceI r b -&gt; ShowTraceI r c
forall (f :: * -&gt; *).
Functor f =&gt;
(forall a. a -&gt; f a)
-&gt; (forall a b. f (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b c. (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c)
-&gt; (forall a b. f a -&gt; f b -&gt; f b)
-&gt; (forall a b. f a -&gt; f b -&gt; f a)
-&gt; Applicative f
forall (r :: (* -&gt; *) -&gt; *). Functor (ShowTraceI r)
forall (r :: (* -&gt; *) -&gt; *) a. a -&gt; ShowTraceI r a
forall (r :: (* -&gt; *) -&gt; *) a b.
ShowTraceI r a -&gt; ShowTraceI r b -&gt; ShowTraceI r a
forall (r :: (* -&gt; *) -&gt; *) a b.
ShowTraceI r a -&gt; ShowTraceI r b -&gt; ShowTraceI r b
forall (r :: (* -&gt; *) -&gt; *) a b.
ShowTraceI r (a -&gt; b) -&gt; ShowTraceI r a -&gt; ShowTraceI r b
forall (r :: (* -&gt; *) -&gt; *) a b c.
(a -&gt; b -&gt; c) -&gt; ShowTraceI r a -&gt; ShowTraceI r b -&gt; ShowTraceI r c
$cpure :: forall (r :: (* -&gt; *) -&gt; *) a. a -&gt; ShowTraceI r a
pure :: forall a. a -&gt; ShowTraceI r a
$c&lt;*&gt; :: forall (r :: (* -&gt; *) -&gt; *) a b.
ShowTraceI r (a -&gt; b) -&gt; ShowTraceI r a -&gt; ShowTraceI r b
&lt;*&gt; :: forall a b.
ShowTraceI r (a -&gt; b) -&gt; ShowTraceI r a -&gt; ShowTraceI r b
$cliftA2 :: forall (r :: (* -&gt; *) -&gt; *) a b c.
(a -&gt; b -&gt; c) -&gt; ShowTraceI r a -&gt; ShowTraceI r b -&gt; ShowTraceI r c
liftA2 :: forall a b c.
(a -&gt; b -&gt; c) -&gt; ShowTraceI r a -&gt; ShowTraceI r b -&gt; ShowTraceI r c
$c*&gt; :: forall (r :: (* -&gt; *) -&gt; *) a b.
ShowTraceI r a -&gt; ShowTraceI r b -&gt; ShowTraceI r b
*&gt; :: forall a b. ShowTraceI r a -&gt; ShowTraceI r b -&gt; ShowTraceI r b
$c&lt;* :: forall (r :: (* -&gt; *) -&gt; *) a b.
ShowTraceI r a -&gt; ShowTraceI r b -&gt; ShowTraceI r a
&lt;* :: forall a b. ShowTraceI r a -&gt; ShowTraceI r b -&gt; ShowTraceI r a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Applicative</span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679099928"><span id="local-6989586621679099934"><span id="local-6989586621679099939"><span class="annot"><span class="annottext">Applicative (ShowTraceI r)
Applicative (ShowTraceI r) =&gt;
(forall a b.
 ShowTraceI r a -&gt; (a -&gt; ShowTraceI r b) -&gt; ShowTraceI r b)
-&gt; (forall a b. ShowTraceI r a -&gt; ShowTraceI r b -&gt; ShowTraceI r b)
-&gt; (forall a. a -&gt; ShowTraceI r a)
-&gt; Monad (ShowTraceI r)
forall a. a -&gt; ShowTraceI r a
forall a b. ShowTraceI r a -&gt; ShowTraceI r b -&gt; ShowTraceI r b
forall a b.
ShowTraceI r a -&gt; (a -&gt; ShowTraceI r b) -&gt; ShowTraceI r b
forall (m :: * -&gt; *).
Applicative m =&gt;
(forall a b. m a -&gt; (a -&gt; m b) -&gt; m b)
-&gt; (forall a b. m a -&gt; m b -&gt; m b)
-&gt; (forall a. a -&gt; m a)
-&gt; Monad m
forall (r :: (* -&gt; *) -&gt; *). Applicative (ShowTraceI r)
forall (r :: (* -&gt; *) -&gt; *) a. a -&gt; ShowTraceI r a
forall (r :: (* -&gt; *) -&gt; *) a b.
ShowTraceI r a -&gt; ShowTraceI r b -&gt; ShowTraceI r b
forall (r :: (* -&gt; *) -&gt; *) a b.
ShowTraceI r a -&gt; (a -&gt; ShowTraceI r b) -&gt; ShowTraceI r b
$c&gt;&gt;= :: forall (r :: (* -&gt; *) -&gt; *) a b.
ShowTraceI r a -&gt; (a -&gt; ShowTraceI r b) -&gt; ShowTraceI r b
&gt;&gt;= :: forall a b.
ShowTraceI r a -&gt; (a -&gt; ShowTraceI r b) -&gt; ShowTraceI r b
$c&gt;&gt; :: forall (r :: (* -&gt; *) -&gt; *) a b.
ShowTraceI r a -&gt; ShowTraceI r b -&gt; ShowTraceI r b
&gt;&gt; :: forall a b. ShowTraceI r a -&gt; ShowTraceI r b -&gt; ShowTraceI r b
$creturn :: forall (r :: (* -&gt; *) -&gt; *) a. a -&gt; ShowTraceI r a
return :: forall a. a -&gt; ShowTraceI r a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Monad</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-568"></span><span>
</span><span id="line-569"></span><span class="annot"><a href="Inference.Conjugate.html#showTraceItem"><span class="hs-identifier hs-type">showTraceItem</span></a></span><span>
</span><span id="line-570"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679098395"><span class="annot"><a href="#local-6989586621679098395"><span class="hs-identifier hs-type">l</span></a></span></span><span> </span><span id="local-6989586621679098396"><span class="annot"><a href="#local-6989586621679098396"><span class="hs-identifier hs-type">r</span></a></span></span><span>
</span><span id="line-571"></span><span>   </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Support"><span class="hs-identifier hs-type">Support</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098395"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621679098395"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Support"><span class="hs-identifier hs-type">Support</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098395"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-572"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-573"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#ShowTraceI"><span class="hs-identifier hs-type">ShowTraceI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098396"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Support"><span class="hs-identifier hs-type">Support</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098395"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-574"></span><span id="showTraceItem"><span class="annot"><span class="annottext">showTraceItem :: forall l (r :: (* -&gt; *) -&gt; *).
(Show (Support l), Typeable l, Typeable (Support l)) =&gt;
String -&gt; ShowTraceI r (Support l)
</span><a href="Inference.Conjugate.html#showTraceItem"><span class="hs-identifier hs-var hs-var">showTraceItem</span></a></span></span><span> </span><span id="local-6989586621679099995"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679099995"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MaybeT (WriterT String (State (Trace r))) (Support l)
-&gt; ShowTraceI r (Support l)
forall (r :: (* -&gt; *) -&gt; *) a.
MaybeT (WriterT String (State (Trace r))) a -&gt; ShowTraceI r a
</span><a href="Inference.Conjugate.html#ShowTraceI"><span class="hs-identifier hs-var">ShowTraceI</span></a></span><span> </span><span class="annot"><span class="annottext">(MaybeT (WriterT String (State (Trace r))) (Support l)
 -&gt; ShowTraceI r (Support l))
-&gt; MaybeT (WriterT String (State (Trace r))) (Support l)
-&gt; ShowTraceI r (Support l)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-575"></span><span>  </span><span id="local-6989586621679099996"><span class="annot"><a href="#local-6989586621679099996"><span class="hs-identifier hs-var">trace</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">MaybeT (WriterT String (State (Trace r))) (Trace r)
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-576"></span><span>  </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679099997"><span class="annot"><a href="#local-6989586621679099997"><span class="hs-identifier hs-var">_name</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679099998"><span class="annot"><a href="#local-6989586621679099998"><span class="hs-identifier hs-var">val</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679099999"><span class="annot"><a href="#local-6989586621679099999"><span class="hs-identifier hs-var">trace'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">MaybeT</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#takeTrace"><span class="hs-identifier hs-type">takeTrace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679099996"><span class="hs-identifier hs-type">trace</span></a></span><span>
</span><span id="line-577"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">put</span></span><span> </span><span class="annot"><a href="#local-6989586621679099999"><span class="hs-identifier hs-type">trace'</span></a></span><span>
</span><span id="line-578"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679100000"><span class="annot"><a href="#local-6989586621679100000"><span class="hs-identifier hs-var hs-var">distName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeRep -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy l -&gt; TypeRep
forall {k} (proxy :: k -&gt; *) (a :: k).
Typeable a =&gt;
proxy a -&gt; TypeRep
</span><span class="hs-identifier hs-var">typeRep</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy l
forall {k} (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679098395"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-579"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">tell</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span>
</span><span id="line-580"></span><span>    </span><span class="annot"><span class="hs-string">&quot;Sampled value &quot;</span></span><span>
</span><span id="line-581"></span><span>      </span><span class="annot"><span class="hs-operator hs-type">&lt;&gt;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">show</span></span><span> </span><span class="annot"><a href="#local-6989586621679099998"><span class="hs-identifier hs-type">val</span></a></span><span>
</span><span id="line-582"></span><span>      </span><span class="annot"><span class="hs-operator hs-type">&lt;&gt;</span></span><span> </span><span class="annot"><span class="hs-string">&quot; from a &quot;</span></span><span>
</span><span id="line-583"></span><span>      </span><span class="annot"><span class="hs-operator hs-type">&lt;&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621679100000"><span class="hs-identifier hs-type">distName</span></a></span><span>
</span><span id="line-584"></span><span>      </span><span class="annot"><span class="hs-operator hs-type">&lt;&gt;</span></span><span> </span><span class="annot"><span class="hs-string">&quot; at &quot;</span></span><span>
</span><span id="line-585"></span><span>      </span><span class="annot"><span class="hs-operator hs-type">&lt;&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621679099995"><span class="hs-identifier hs-type">name</span></a></span><span>
</span><span id="line-586"></span><span>      </span><span class="annot"><span class="hs-operator hs-type">&lt;&gt;</span></span><span> </span><span class="annot"><span class="hs-string">&quot;.\n&quot;</span></span><span>
</span><span id="line-587"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><a href="#local-6989586621679099998"><span class="hs-identifier hs-type">val</span></a></span><span>
</span><span id="line-588"></span><span>
</span><span id="line-589"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679098427"><span class="annot"><a href="Inference.Conjugate.html#RandomInterpreter"><span class="hs-identifier hs-type">RandomInterpreter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#ShowTraceI"><span class="hs-identifier hs-type">ShowTraceI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098427"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679098427"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-590"></span><span>  </span><span class="hs-keyword">type</span><span>
</span><span id="line-591"></span><span>    </span><span id="SampleCtx"><span class="annot"><a href="Inference.Conjugate.html#SampleCtx"><span class="hs-identifier hs-var">SampleCtx</span></a></span></span><span> </span><span id="local-6989586621679100009"><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#ShowTraceI"><span class="hs-identifier hs-type">ShowTraceI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098427"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679100009"><span class="hs-identifier hs-type">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-592"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Support"><span class="hs-identifier hs-type">Support</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679100009"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621679100009"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Support"><span class="hs-identifier hs-type">Support</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679100009"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-593"></span><span>  </span><span class="annot"><a href="Inference.Conjugate.html#sampleValue"><span class="hs-identifier hs-type">sampleValue</span></a></span><span>
</span><span id="line-594"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679098428"><span class="annot"><a href="#local-6989586621679098428"><span class="hs-identifier hs-type">p</span></a></span></span><span> </span><span id="local-6989586621679098429"><span class="annot"><a href="#local-6989586621679098429"><span class="hs-identifier hs-type">l</span></a></span></span><span>
</span><span id="line-595"></span><span>     </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Conjugate"><span class="hs-identifier hs-type">Conjugate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098428"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098429"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Support"><span class="hs-identifier hs-type">Support</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098429"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621679098429"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Support"><span class="hs-identifier hs-type">Support</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098429"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-596"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-597"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679098429"><span class="hs-identifier hs-type">l</span></a></span><span>
</span><span id="line-598"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Accessor"><span class="hs-identifier hs-type">Accessor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098427"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098428"><span class="hs-identifier hs-type">p</span></a></span><span>
</span><span id="line-599"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#ShowTraceI"><span class="hs-identifier hs-type">ShowTraceI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098427"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Support"><span class="hs-identifier hs-type">Support</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098429"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-600"></span><span>  </span><span id="local-6989586621679100029"><span class="annot"><span class="annottext">sampleValue :: forall p l.
(Conjugate p l, Typeable (Support l), Typeable l,
 Show (Support l)) =&gt;
String -&gt; l -&gt; Accessor r p -&gt; ShowTraceI r (Support l)
</span><a href="Inference.Conjugate.html#sampleValue"><span class="hs-identifier hs-var hs-var hs-var">sampleValue</span></a></span></span><span> </span><span id="local-6989586621679100030"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679100030"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="annot"><span class="annottext">l
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679100031"><span class="annot"><span class="annottext">Accessor r p
</span><a href="#local-6989586621679100031"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall l (r :: (* -&gt; *) -&gt; *).
(Show (Support l), Typeable l, Typeable (Support l)) =&gt;
String -&gt; ShowTraceI r (Support l)
</span><a href="Inference.Conjugate.html#showTraceItem"><span class="hs-identifier hs-var">showTraceItem</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679098429"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679100030"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-601"></span><span>  </span><span class="annot"><a href="Inference.Conjugate.html#sampleConst"><span class="hs-identifier hs-type">sampleConst</span></a></span><span>
</span><span id="line-602"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679100032"><span class="annot"><a href="#local-6989586621679100032"><span class="hs-identifier hs-type">d</span></a></span></span><span>
</span><span id="line-603"></span><span>     </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Distribution"><span class="hs-identifier hs-type">Distribution</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679100032"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#SampleCtx"><span class="hs-identifier hs-type">SampleCtx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#ShowTraceI"><span class="hs-identifier hs-type">ShowTraceI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098427"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679100032"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-604"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-605"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679100032"><span class="hs-identifier hs-type">d</span></a></span><span>
</span><span id="line-606"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Params"><span class="hs-identifier hs-type">Params</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679100032"><span class="hs-identifier hs-type">d</span></a></span><span>
</span><span id="line-607"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#ShowTraceI"><span class="hs-identifier hs-type">ShowTraceI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098427"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Support"><span class="hs-identifier hs-type">Support</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679100032"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-608"></span><span>  </span><span id="local-6989586621679100047"><span class="annot"><span class="annottext">sampleConst :: forall d.
(Distribution d, SampleCtx (ShowTraceI r) d) =&gt;
String -&gt; d -&gt; Params d -&gt; ShowTraceI r (Support d)
</span><a href="Inference.Conjugate.html#sampleConst"><span class="hs-identifier hs-var hs-var hs-var">sampleConst</span></a></span></span><span> </span><span id="local-6989586621679100048"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679100048"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="annot"><span class="annottext">d
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Params d
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall l (r :: (* -&gt; *) -&gt; *).
(Show (Support l), Typeable l, Typeable (Support l)) =&gt;
String -&gt; ShowTraceI r (Support l)
</span><a href="Inference.Conjugate.html#showTraceItem"><span class="hs-identifier hs-var">showTraceItem</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679100032"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679100048"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-609"></span><span>  </span><span id="local-6989586621679100051"><span class="annot"><span class="annottext">permutationPlate :: forall a.
Ord a =&gt;
Int -&gt; (Int -&gt; ShowTraceI r a) -&gt; ShowTraceI r [a]
</span><a href="Inference.Conjugate.html#permutationPlate"><span class="hs-identifier hs-var hs-var hs-var">permutationPlate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; (Int -&gt; ShowTraceI r a) -&gt; ShowTraceI r [a]
forall (m :: * -&gt; *) a.
Applicative m =&gt;
Int -&gt; (Int -&gt; m a) -&gt; m [a]
</span><a href="Inference.Conjugate.html#replicateMWithI"><span class="hs-identifier hs-var">replicateMWithI</span></a></span><span>
</span><span id="line-610"></span><span>
</span><span id="line-611"></span><span id="local-6989586621679098439"><span id="local-6989586621679098440"><span class="annot"><a href="Inference.Conjugate.html#showTrace"><span class="hs-identifier hs-type">showTrace</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Trace"><span class="hs-identifier hs-type">Trace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098439"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#ShowTraceI"><span class="hs-identifier hs-type">ShowTraceI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098439"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098440"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679098440"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-612"></span><span id="showTrace"><span class="annot"><span class="annottext">showTrace :: forall (r :: (* -&gt; *) -&gt; *) a.
Trace r -&gt; ShowTraceI r a -&gt; (Maybe a, String)
</span><a href="Inference.Conjugate.html#showTrace"><span class="hs-identifier hs-var hs-var">showTrace</span></a></span></span><span> </span><span id="local-6989586621679100053"><span class="annot"><span class="annottext">Trace r
</span><a href="#local-6989586621679100053"><span class="hs-identifier hs-var">trace</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#ShowTraceI"><span class="hs-identifier hs-type">ShowTraceI</span></a></span><span> </span><span id="local-6989586621679100054"><span class="annot"><span class="annottext">MaybeT (WriterT String (State (Trace r))) a
</span><a href="#local-6989586621679100054"><span class="hs-identifier hs-var">model</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-613"></span><span>  </span><span class="annot"><span class="annottext">State (Trace r) (Maybe a, String) -&gt; Trace r -&gt; (Maybe a, String)
forall s a. State s a -&gt; s -&gt; a
</span><span class="hs-identifier hs-var">evalState</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">WriterT String (State (Trace r)) (Maybe a)
-&gt; State (Trace r) (Maybe a, String)
forall w (m :: * -&gt; *) a. WriterT w m a -&gt; m (a, w)
</span><span class="hs-identifier hs-var">runWriterT</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MaybeT (WriterT String (State (Trace r))) a
-&gt; WriterT String (State (Trace r)) (Maybe a)
forall (m :: * -&gt; *) a. MaybeT m a -&gt; m (Maybe a)
</span><span class="hs-identifier hs-var">runMaybeT</span></span><span> </span><span class="annot"><span class="annottext">MaybeT (WriterT String (State (Trace r))) a
</span><a href="#local-6989586621679100054"><span class="hs-identifier hs-var">model</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Trace r
</span><a href="#local-6989586621679100053"><span class="hs-identifier hs-var">trace</span></a></span><span>
</span><span id="line-614"></span><span>
</span><span id="line-615"></span><span id="local-6989586621679098450"><span id="local-6989586621679098451"><span class="annot"><a href="Inference.Conjugate.html#printTrace"><span class="hs-identifier hs-type">printTrace</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Trace"><span class="hs-identifier hs-type">Trace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098450"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#ShowTraceI"><span class="hs-identifier hs-type">ShowTraceI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098450"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098451"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-616"></span><span id="printTrace"><span class="annot"><span class="annottext">printTrace :: forall (r :: (* -&gt; *) -&gt; *) a. Trace r -&gt; ShowTraceI r a -&gt; IO ()
</span><a href="Inference.Conjugate.html#printTrace"><span class="hs-identifier hs-var hs-var">printTrace</span></a></span></span><span> </span><span id="local-6989586621679100061"><span class="annot"><span class="annottext">Trace r
</span><a href="#local-6989586621679100061"><span class="hs-identifier hs-var">trace</span></a></span></span><span> </span><span id="local-6989586621679100062"><span class="annot"><span class="annottext">ShowTraceI r a
</span><a href="#local-6989586621679100062"><span class="hs-identifier hs-var">model</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-617"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679100063"><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679100063"><span class="hs-identifier hs-var hs-var">res</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679100064"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679100064"><span class="hs-identifier hs-var hs-var">txt</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Trace r -&gt; ShowTraceI r a -&gt; (Maybe a, String)
forall (r :: (* -&gt; *) -&gt; *) a.
Trace r -&gt; ShowTraceI r a -&gt; (Maybe a, String)
</span><a href="Inference.Conjugate.html#showTrace"><span class="hs-identifier hs-var">showTrace</span></a></span><span> </span><span class="annot"><span class="annottext">Trace r
</span><a href="#local-6989586621679100061"><span class="hs-identifier hs-var">trace</span></a></span><span> </span><span class="annot"><span class="annottext">ShowTraceI r a
</span><a href="#local-6989586621679100062"><span class="hs-identifier hs-var">model</span></a></span><span>
</span><span id="line-618"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679100064"><span class="hs-identifier hs-var">txt</span></a></span><span>
</span><span id="line-619"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe a
</span><a href="#local-6989586621679100063"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-620"></span><span>    </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-621"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Trace does not match the model (stops here)&quot;</span></span><span>
</span><span id="line-622"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-623"></span><span>
</span><span id="line-624"></span><span class="hs-comment">-- tracing interpreter (for debugging)</span><span>
</span><span id="line-625"></span><span class="hs-comment">-- -----------------------------------</span><span>
</span><span id="line-626"></span><span>
</span><span id="line-627"></span><span class="hs-keyword">newtype</span><span> </span><span id="TraceTraceI"><span class="annot"><a href="Inference.Conjugate.html#TraceTraceI"><span class="hs-identifier hs-var">TraceTraceI</span></a></span></span><span> </span><span id="local-6989586621679098485"><span class="annot"><a href="#local-6989586621679098485"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span id="local-6989586621679098486"><span class="annot"><a href="#local-6989586621679098486"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="TraceTraceI"><span class="annot"><a href="Inference.Conjugate.html#TraceTraceI"><span class="hs-identifier hs-var">TraceTraceI</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">State</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Trace"><span class="hs-identifier hs-type">Trace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098485"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679098486"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-628"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679100068"><span id="local-6989586621679100073"><span class="annot"><span class="annottext">(forall a b. (a -&gt; b) -&gt; TraceTraceI r a -&gt; TraceTraceI r b)
-&gt; (forall a b. a -&gt; TraceTraceI r b -&gt; TraceTraceI r a)
-&gt; Functor (TraceTraceI r)
forall a b. a -&gt; TraceTraceI r b -&gt; TraceTraceI r a
forall a b. (a -&gt; b) -&gt; TraceTraceI r a -&gt; TraceTraceI r b
forall (f :: * -&gt; *).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
forall (r :: (* -&gt; *) -&gt; *) a b.
a -&gt; TraceTraceI r b -&gt; TraceTraceI r a
forall (r :: (* -&gt; *) -&gt; *) a b.
(a -&gt; b) -&gt; TraceTraceI r a -&gt; TraceTraceI r b
$cfmap :: forall (r :: (* -&gt; *) -&gt; *) a b.
(a -&gt; b) -&gt; TraceTraceI r a -&gt; TraceTraceI r b
fmap :: forall a b. (a -&gt; b) -&gt; TraceTraceI r a -&gt; TraceTraceI r b
$c&lt;$ :: forall (r :: (* -&gt; *) -&gt; *) a b.
a -&gt; TraceTraceI r b -&gt; TraceTraceI r a
&lt;$ :: forall a b. a -&gt; TraceTraceI r b -&gt; TraceTraceI r a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679100081"><span id="local-6989586621679100087"><span id="local-6989586621679100093"><span id="local-6989586621679100099"><span id="local-6989586621679100105"><span class="annot"><span class="annottext">Functor (TraceTraceI r)
Functor (TraceTraceI r) =&gt;
(forall a. a -&gt; TraceTraceI r a)
-&gt; (forall a b.
    TraceTraceI r (a -&gt; b) -&gt; TraceTraceI r a -&gt; TraceTraceI r b)
-&gt; (forall a b c.
    (a -&gt; b -&gt; c)
    -&gt; TraceTraceI r a -&gt; TraceTraceI r b -&gt; TraceTraceI r c)
-&gt; (forall a b.
    TraceTraceI r a -&gt; TraceTraceI r b -&gt; TraceTraceI r b)
-&gt; (forall a b.
    TraceTraceI r a -&gt; TraceTraceI r b -&gt; TraceTraceI r a)
-&gt; Applicative (TraceTraceI r)
forall a. a -&gt; TraceTraceI r a
forall a b. TraceTraceI r a -&gt; TraceTraceI r b -&gt; TraceTraceI r a
forall a b. TraceTraceI r a -&gt; TraceTraceI r b -&gt; TraceTraceI r b
forall a b.
TraceTraceI r (a -&gt; b) -&gt; TraceTraceI r a -&gt; TraceTraceI r b
forall a b c.
(a -&gt; b -&gt; c)
-&gt; TraceTraceI r a -&gt; TraceTraceI r b -&gt; TraceTraceI r c
forall (f :: * -&gt; *).
Functor f =&gt;
(forall a. a -&gt; f a)
-&gt; (forall a b. f (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b c. (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c)
-&gt; (forall a b. f a -&gt; f b -&gt; f b)
-&gt; (forall a b. f a -&gt; f b -&gt; f a)
-&gt; Applicative f
forall (r :: (* -&gt; *) -&gt; *). Functor (TraceTraceI r)
forall (r :: (* -&gt; *) -&gt; *) a. a -&gt; TraceTraceI r a
forall (r :: (* -&gt; *) -&gt; *) a b.
TraceTraceI r a -&gt; TraceTraceI r b -&gt; TraceTraceI r a
forall (r :: (* -&gt; *) -&gt; *) a b.
TraceTraceI r a -&gt; TraceTraceI r b -&gt; TraceTraceI r b
forall (r :: (* -&gt; *) -&gt; *) a b.
TraceTraceI r (a -&gt; b) -&gt; TraceTraceI r a -&gt; TraceTraceI r b
forall (r :: (* -&gt; *) -&gt; *) a b c.
(a -&gt; b -&gt; c)
-&gt; TraceTraceI r a -&gt; TraceTraceI r b -&gt; TraceTraceI r c
$cpure :: forall (r :: (* -&gt; *) -&gt; *) a. a -&gt; TraceTraceI r a
pure :: forall a. a -&gt; TraceTraceI r a
$c&lt;*&gt; :: forall (r :: (* -&gt; *) -&gt; *) a b.
TraceTraceI r (a -&gt; b) -&gt; TraceTraceI r a -&gt; TraceTraceI r b
&lt;*&gt; :: forall a b.
TraceTraceI r (a -&gt; b) -&gt; TraceTraceI r a -&gt; TraceTraceI r b
$cliftA2 :: forall (r :: (* -&gt; *) -&gt; *) a b c.
(a -&gt; b -&gt; c)
-&gt; TraceTraceI r a -&gt; TraceTraceI r b -&gt; TraceTraceI r c
liftA2 :: forall a b c.
(a -&gt; b -&gt; c)
-&gt; TraceTraceI r a -&gt; TraceTraceI r b -&gt; TraceTraceI r c
$c*&gt; :: forall (r :: (* -&gt; *) -&gt; *) a b.
TraceTraceI r a -&gt; TraceTraceI r b -&gt; TraceTraceI r b
*&gt; :: forall a b. TraceTraceI r a -&gt; TraceTraceI r b -&gt; TraceTraceI r b
$c&lt;* :: forall (r :: (* -&gt; *) -&gt; *) a b.
TraceTraceI r a -&gt; TraceTraceI r b -&gt; TraceTraceI r a
&lt;* :: forall a b. TraceTraceI r a -&gt; TraceTraceI r b -&gt; TraceTraceI r a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Applicative</span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679100114"><span id="local-6989586621679100119"><span id="local-6989586621679100124"><span class="annot"><span class="annottext">Applicative (TraceTraceI r)
Applicative (TraceTraceI r) =&gt;
(forall a b.
 TraceTraceI r a -&gt; (a -&gt; TraceTraceI r b) -&gt; TraceTraceI r b)
-&gt; (forall a b.
    TraceTraceI r a -&gt; TraceTraceI r b -&gt; TraceTraceI r b)
-&gt; (forall a. a -&gt; TraceTraceI r a)
-&gt; Monad (TraceTraceI r)
forall a. a -&gt; TraceTraceI r a
forall a b. TraceTraceI r a -&gt; TraceTraceI r b -&gt; TraceTraceI r b
forall a b.
TraceTraceI r a -&gt; (a -&gt; TraceTraceI r b) -&gt; TraceTraceI r b
forall (m :: * -&gt; *).
Applicative m =&gt;
(forall a b. m a -&gt; (a -&gt; m b) -&gt; m b)
-&gt; (forall a b. m a -&gt; m b -&gt; m b)
-&gt; (forall a. a -&gt; m a)
-&gt; Monad m
forall (r :: (* -&gt; *) -&gt; *). Applicative (TraceTraceI r)
forall (r :: (* -&gt; *) -&gt; *) a. a -&gt; TraceTraceI r a
forall (r :: (* -&gt; *) -&gt; *) a b.
TraceTraceI r a -&gt; TraceTraceI r b -&gt; TraceTraceI r b
forall (r :: (* -&gt; *) -&gt; *) a b.
TraceTraceI r a -&gt; (a -&gt; TraceTraceI r b) -&gt; TraceTraceI r b
$c&gt;&gt;= :: forall (r :: (* -&gt; *) -&gt; *) a b.
TraceTraceI r a -&gt; (a -&gt; TraceTraceI r b) -&gt; TraceTraceI r b
&gt;&gt;= :: forall a b.
TraceTraceI r a -&gt; (a -&gt; TraceTraceI r b) -&gt; TraceTraceI r b
$c&gt;&gt; :: forall (r :: (* -&gt; *) -&gt; *) a b.
TraceTraceI r a -&gt; TraceTraceI r b -&gt; TraceTraceI r b
&gt;&gt; :: forall a b. TraceTraceI r a -&gt; TraceTraceI r b -&gt; TraceTraceI r b
$creturn :: forall (r :: (* -&gt; *) -&gt; *) a. a -&gt; TraceTraceI r a
return :: forall a. a -&gt; TraceTraceI r a
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Monad</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-629"></span><span>
</span><span id="line-630"></span><span class="annot"><a href="Inference.Conjugate.html#traceTraceItem"><span class="hs-identifier hs-type">traceTraceItem</span></a></span><span>
</span><span id="line-631"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679098480"><span class="annot"><a href="#local-6989586621679098480"><span class="hs-identifier hs-type">l</span></a></span></span><span> </span><span id="local-6989586621679098481"><span class="annot"><a href="#local-6989586621679098481"><span class="hs-identifier hs-type">r</span></a></span></span><span>
</span><span id="line-632"></span><span>   </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Support"><span class="hs-identifier hs-type">Support</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098480"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621679098480"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Support"><span class="hs-identifier hs-type">Support</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098480"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-633"></span><span>  </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-634"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#TraceTraceI"><span class="hs-identifier hs-type">TraceTraceI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098481"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Support"><span class="hs-identifier hs-type">Support</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098480"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-635"></span><span id="traceTraceItem"><span class="annot"><span class="annottext">traceTraceItem :: forall l (r :: (* -&gt; *) -&gt; *).
(Show (Support l), Typeable l, Typeable (Support l)) =&gt;
String -&gt; TraceTraceI r (Support l)
</span><a href="Inference.Conjugate.html#traceTraceItem"><span class="hs-identifier hs-var hs-var">traceTraceItem</span></a></span></span><span> </span><span id="local-6989586621679100175"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679100175"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State (Trace r) (Support l) -&gt; TraceTraceI r (Support l)
forall (r :: (* -&gt; *) -&gt; *) a. State (Trace r) a -&gt; TraceTraceI r a
</span><a href="Inference.Conjugate.html#TraceTraceI"><span class="hs-identifier hs-var">TraceTraceI</span></a></span><span> </span><span class="annot"><span class="annottext">(State (Trace r) (Support l) -&gt; TraceTraceI r (Support l))
-&gt; State (Trace r) (Support l) -&gt; TraceTraceI r (Support l)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-636"></span><span>  </span><span id="local-6989586621679100176"><span class="annot"><a href="#local-6989586621679100176"><span class="hs-identifier hs-var">trace</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">StateT (Trace r) Identity (Trace r)
forall s (m :: * -&gt; *). MonadState s m =&gt; m s
</span><span class="hs-identifier hs-var">get</span></span><span>
</span><span id="line-637"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679100177"><span class="annot"><a href="#local-6989586621679100177"><span class="hs-identifier hs-var hs-var">loc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TypeRep -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy l -&gt; TypeRep
forall {k} (proxy :: k -&gt; *) (a :: k).
Typeable a =&gt;
proxy a -&gt; TypeRep
</span><span class="hs-identifier hs-var">typeRep</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy l
forall {k} (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679098480"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; at &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679100175"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-638"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679100178"><span class="annot"><a href="#local-6989586621679100178"><span class="hs-identifier hs-var hs-var">itemMaybe</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Trace r -&gt; Maybe (String, Dynamic)
forall (r :: (* -&gt; *) -&gt; *). Trace r -&gt; Maybe (String, Dynamic)
</span><a href="Inference.Conjugate.html#peekTrace"><span class="hs-identifier hs-var">peekTrace</span></a></span><span> </span><span class="annot"><span class="annottext">Trace r
</span><a href="#local-6989586621679100176"><span class="hs-identifier hs-var">trace</span></a></span><span>
</span><span id="line-639"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621679100178"><span class="hs-identifier hs-type">itemMaybe</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-640"></span><span>    </span><span class="annot"><span class="annottext">Maybe (String, Dynamic)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; State (Trace r) (Support l)
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; State (Trace r) (Support l))
-&gt; String -&gt; State (Trace r) (Support l)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Expected &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679100175"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; but trace is empty.&quot;</span></span><span>
</span><span id="line-641"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679100180"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679100180"><span class="hs-identifier hs-var">tname</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679100181"><span class="annot"><span class="annottext">Dynamic
</span><a href="#local-6989586621679100181"><span class="hs-identifier hs-var">tval</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-642"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679100175"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679100180"><span class="hs-identifier hs-var">tname</span></a></span><span>
</span><span id="line-643"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Trace r -&gt; Maybe ((String, Support l), Trace r)
forall a (r :: (* -&gt; *) -&gt; *).
Typeable a =&gt;
Trace r -&gt; Maybe ((String, a), Trace r)
</span><a href="Inference.Conjugate.html#takeTrace"><span class="hs-identifier hs-var">takeTrace</span></a></span><span> </span><span class="annot"><span class="annottext">Trace r
</span><a href="#local-6989586621679100176"><span class="hs-identifier hs-var">trace</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-644"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span id="local-6989586621679100182"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679100182"><span class="hs-identifier hs-var">_tname</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679100183"><span class="annot"><span class="annottext">Support l
</span><a href="#local-6989586621679100183"><span class="hs-identifier hs-var">val</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span id="local-6989586621679100184"><span class="annot"><span class="annottext">Trace r
</span><a href="#local-6989586621679100184"><span class="hs-identifier hs-var">trace'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-645"></span><span>            </span><span class="annot"><span class="annottext">Trace r -&gt; StateT (Trace r) Identity ()
forall s (m :: * -&gt; *). MonadState s m =&gt; s -&gt; m ()
</span><span class="hs-identifier hs-var">put</span></span><span> </span><span class="annot"><span class="annottext">Trace r
</span><a href="#local-6989586621679100184"><span class="hs-identifier hs-var">trace'</span></a></span><span>
</span><span id="line-646"></span><span>            </span><span class="annot"><span class="annottext">String -&gt; StateT (Trace r) Identity ()
forall (f :: * -&gt; *). Applicative f =&gt; String -&gt; f ()
</span><span class="hs-identifier hs-var">DT.traceM</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; StateT (Trace r) Identity ())
-&gt; String -&gt; StateT (Trace r) Identity ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Sampled value &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Support l -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Support l
</span><a href="#local-6989586621679100183"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; from a &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679100177"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.&quot;</span></span><span>
</span><span id="line-647"></span><span>            </span><span class="annot"><span class="annottext">Support l -&gt; State (Trace r) (Support l)
forall a. a -&gt; StateT (Trace r) Identity a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Support l
</span><a href="#local-6989586621679100183"><span class="hs-identifier hs-var">val</span></a></span><span>
</span><span id="line-648"></span><span>          </span><span class="annot"><span class="annottext">Maybe ((String, Support l), Trace r)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; State (Trace r) (Support l)
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; State (Trace r) (Support l))
-&gt; String -&gt; State (Trace r) (Support l)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Incompatible trace at &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679100177"><span class="hs-identifier hs-var">loc</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;. Got &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">(String, Dynamic) -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679100180"><span class="hs-identifier hs-var">tname</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Dynamic
</span><a href="#local-6989586621679100181"><span class="hs-identifier hs-var">tval</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-649"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String -&gt; State (Trace r) (Support l)
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; State (Trace r) (Support l))
-&gt; String -&gt; State (Trace r) (Support l)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;RV names don't match. expected: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679100175"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;. actual: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679100180"><span class="hs-identifier hs-var">tname</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.&quot;</span></span><span>
</span><span id="line-650"></span><span>
</span><span id="line-651"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679098492"><span class="annot"><a href="Inference.Conjugate.html#RandomInterpreter"><span class="hs-identifier hs-type">RandomInterpreter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#TraceTraceI"><span class="hs-identifier hs-type">TraceTraceI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098492"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679098492"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-652"></span><span>  </span><span class="hs-keyword">type</span><span>
</span><span id="line-653"></span><span>    </span><span id="SampleCtx"><span class="annot"><a href="Inference.Conjugate.html#SampleCtx"><span class="hs-identifier hs-var">SampleCtx</span></a></span></span><span> </span><span id="local-6989586621679100192"><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#TraceTraceI"><span class="hs-identifier hs-type">TraceTraceI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098492"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679100192"><span class="hs-identifier hs-type">l</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-654"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Support"><span class="hs-identifier hs-type">Support</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679100192"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621679100192"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Support"><span class="hs-identifier hs-type">Support</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679100192"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-655"></span><span>  </span><span class="annot"><a href="Inference.Conjugate.html#sampleValue"><span class="hs-identifier hs-type">sampleValue</span></a></span><span>
</span><span id="line-656"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679098493"><span class="annot"><a href="#local-6989586621679098493"><span class="hs-identifier hs-type">p</span></a></span></span><span> </span><span id="local-6989586621679098494"><span class="annot"><a href="#local-6989586621679098494"><span class="hs-identifier hs-type">l</span></a></span></span><span>
</span><span id="line-657"></span><span>     </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Conjugate"><span class="hs-identifier hs-type">Conjugate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098493"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098494"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Support"><span class="hs-identifier hs-type">Support</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098494"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621679098494"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Support"><span class="hs-identifier hs-type">Support</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098494"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-658"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-659"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679098494"><span class="hs-identifier hs-type">l</span></a></span><span>
</span><span id="line-660"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Accessor"><span class="hs-identifier hs-type">Accessor</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098492"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098493"><span class="hs-identifier hs-type">p</span></a></span><span>
</span><span id="line-661"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#TraceTraceI"><span class="hs-identifier hs-type">TraceTraceI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098492"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Support"><span class="hs-identifier hs-type">Support</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098494"><span class="hs-identifier hs-type">l</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-662"></span><span>  </span><span id="local-6989586621679100212"><span class="annot"><span class="annottext">sampleValue :: forall p l.
(Conjugate p l, Typeable (Support l), Typeable l,
 Show (Support l)) =&gt;
String -&gt; l -&gt; Accessor r p -&gt; TraceTraceI r (Support l)
</span><a href="Inference.Conjugate.html#sampleValue"><span class="hs-identifier hs-var hs-var hs-var">sampleValue</span></a></span></span><span> </span><span id="local-6989586621679100213"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679100213"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="annot"><span class="annottext">l
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679100214"><span class="annot"><span class="annottext">Accessor r p
</span><a href="#local-6989586621679100214"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall l (r :: (* -&gt; *) -&gt; *).
(Show (Support l), Typeable l, Typeable (Support l)) =&gt;
String -&gt; TraceTraceI r (Support l)
</span><a href="Inference.Conjugate.html#traceTraceItem"><span class="hs-identifier hs-var">traceTraceItem</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679098494"><span class="hs-identifier hs-type">l</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679100213"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-663"></span><span>  </span><span class="annot"><a href="Inference.Conjugate.html#sampleConst"><span class="hs-identifier hs-type">sampleConst</span></a></span><span>
</span><span id="line-664"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679100215"><span class="annot"><a href="#local-6989586621679100215"><span class="hs-identifier hs-type">d</span></a></span></span><span>
</span><span id="line-665"></span><span>     </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Distribution"><span class="hs-identifier hs-type">Distribution</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679100215"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#SampleCtx"><span class="hs-identifier hs-type">SampleCtx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#TraceTraceI"><span class="hs-identifier hs-type">TraceTraceI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098492"><span class="hs-identifier hs-type">r</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679100215"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-666"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-667"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679100215"><span class="hs-identifier hs-type">d</span></a></span><span>
</span><span id="line-668"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Params"><span class="hs-identifier hs-type">Params</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679100215"><span class="hs-identifier hs-type">d</span></a></span><span>
</span><span id="line-669"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#TraceTraceI"><span class="hs-identifier hs-type">TraceTraceI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098492"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Support"><span class="hs-identifier hs-type">Support</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679100215"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-670"></span><span>  </span><span id="local-6989586621679100230"><span class="annot"><span class="annottext">sampleConst :: forall d.
(Distribution d, SampleCtx (TraceTraceI r) d) =&gt;
String -&gt; d -&gt; Params d -&gt; TraceTraceI r (Support d)
</span><a href="Inference.Conjugate.html#sampleConst"><span class="hs-identifier hs-var hs-var hs-var">sampleConst</span></a></span></span><span> </span><span id="local-6989586621679100231"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679100231"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="annot"><span class="annottext">d
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Params d
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall l (r :: (* -&gt; *) -&gt; *).
(Show (Support l), Typeable l, Typeable (Support l)) =&gt;
String -&gt; TraceTraceI r (Support l)
</span><a href="Inference.Conjugate.html#traceTraceItem"><span class="hs-identifier hs-var">traceTraceItem</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679100215"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679100231"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-671"></span><span>  </span><span id="local-6989586621679100234"><span class="annot"><span class="annottext">permutationPlate :: forall a.
Ord a =&gt;
Int -&gt; (Int -&gt; TraceTraceI r a) -&gt; TraceTraceI r [a]
</span><a href="Inference.Conjugate.html#permutationPlate"><span class="hs-identifier hs-var hs-var hs-var">permutationPlate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; (Int -&gt; TraceTraceI r a) -&gt; TraceTraceI r [a]
forall (m :: * -&gt; *) a.
Applicative m =&gt;
Int -&gt; (Int -&gt; m a) -&gt; m [a]
</span><a href="Inference.Conjugate.html#replicateMWithI"><span class="hs-identifier hs-var">replicateMWithI</span></a></span><span>
</span><span id="line-672"></span><span>
</span><span id="line-673"></span><span id="local-6989586621679098503"><span id="local-6989586621679098504"><span class="annot"><a href="Inference.Conjugate.html#traceTrace"><span class="hs-identifier hs-type">traceTrace</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Trace"><span class="hs-identifier hs-type">Trace</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098503"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#TraceTraceI"><span class="hs-identifier hs-type">TraceTraceI</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098503"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098504"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679098504"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-674"></span><span id="traceTrace"><span class="annot"><span class="annottext">traceTrace :: forall (r :: (* -&gt; *) -&gt; *) a. Trace r -&gt; TraceTraceI r a -&gt; a
</span><a href="Inference.Conjugate.html#traceTrace"><span class="hs-identifier hs-var hs-var">traceTrace</span></a></span></span><span> </span><span id="local-6989586621679100236"><span class="annot"><span class="annottext">Trace r
</span><a href="#local-6989586621679100236"><span class="hs-identifier hs-var">trace</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#TraceTraceI"><span class="hs-identifier hs-type">TraceTraceI</span></a></span><span> </span><span id="local-6989586621679100237"><span class="annot"><span class="annottext">State (Trace r) a
</span><a href="#local-6989586621679100237"><span class="hs-identifier hs-var">model</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State (Trace r) a -&gt; Trace r -&gt; a
forall s a. State s a -&gt; s -&gt; a
</span><span class="hs-identifier hs-var">evalState</span></span><span> </span><span class="annot"><span class="annottext">State (Trace r) a
</span><a href="#local-6989586621679100237"><span class="hs-identifier hs-var">model</span></a></span><span> </span><span class="annot"><span class="annottext">Trace r
</span><a href="#local-6989586621679100236"><span class="hs-identifier hs-var">trace</span></a></span><span>
</span><span id="line-675"></span><span>
</span><span id="line-676"></span><span class="hs-comment">-------------------</span><span>
</span><span id="line-677"></span><span class="hs-comment">-- distributions --</span><span>
</span><span id="line-678"></span><span class="hs-comment">-------------------</span><span>
</span><span id="line-679"></span><span>
</span><span id="line-680"></span><span class="hs-comment">-- Beta</span><span>
</span><span id="line-681"></span><span class="hs-comment">-- ----</span><span>
</span><span id="line-682"></span><span>
</span><span id="line-683"></span><span class="hs-keyword">data</span><span> </span><span id="Beta"><span class="annot"><a href="Inference.Conjugate.html#Beta"><span class="hs-identifier hs-var">Beta</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Beta"><span class="annot"><a href="Inference.Conjugate.html#Beta"><span class="hs-identifier hs-var">Beta</span></a></span></span><span>
</span><span id="line-684"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679100240"><span id="local-6989586621679100242"><span class="annot"><span class="annottext">Beta -&gt; Beta -&gt; Bool
(Beta -&gt; Beta -&gt; Bool) -&gt; (Beta -&gt; Beta -&gt; Bool) -&gt; Eq Beta
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: Beta -&gt; Beta -&gt; Bool
== :: Beta -&gt; Beta -&gt; Bool
$c/= :: Beta -&gt; Beta -&gt; Bool
/= :: Beta -&gt; Beta -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679100249"><span id="local-6989586621679100251"><span id="local-6989586621679100253"><span id="local-6989586621679100257"><span id="local-6989586621679100260"><span id="local-6989586621679100263"><span id="local-6989586621679100266"><span class="annot"><span class="annottext">Eq Beta
Eq Beta =&gt;
(Beta -&gt; Beta -&gt; Ordering)
-&gt; (Beta -&gt; Beta -&gt; Bool)
-&gt; (Beta -&gt; Beta -&gt; Bool)
-&gt; (Beta -&gt; Beta -&gt; Bool)
-&gt; (Beta -&gt; Beta -&gt; Bool)
-&gt; (Beta -&gt; Beta -&gt; Beta)
-&gt; (Beta -&gt; Beta -&gt; Beta)
-&gt; Ord Beta
Beta -&gt; Beta -&gt; Bool
Beta -&gt; Beta -&gt; Ordering
Beta -&gt; Beta -&gt; Beta
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
$ccompare :: Beta -&gt; Beta -&gt; Ordering
compare :: Beta -&gt; Beta -&gt; Ordering
$c&lt; :: Beta -&gt; Beta -&gt; Bool
&lt; :: Beta -&gt; Beta -&gt; Bool
$c&lt;= :: Beta -&gt; Beta -&gt; Bool
&lt;= :: Beta -&gt; Beta -&gt; Bool
$c&gt; :: Beta -&gt; Beta -&gt; Bool
&gt; :: Beta -&gt; Beta -&gt; Bool
$c&gt;= :: Beta -&gt; Beta -&gt; Bool
&gt;= :: Beta -&gt; Beta -&gt; Bool
$cmax :: Beta -&gt; Beta -&gt; Beta
max :: Beta -&gt; Beta -&gt; Beta
$cmin :: Beta -&gt; Beta -&gt; Beta
min :: Beta -&gt; Beta -&gt; Beta
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679100274"><span id="local-6989586621679100276"><span id="local-6989586621679100280"><span class="annot"><span class="annottext">Int -&gt; Beta -&gt; ShowS
[Beta] -&gt; ShowS
Beta -&gt; String
(Int -&gt; Beta -&gt; ShowS)
-&gt; (Beta -&gt; String) -&gt; ([Beta] -&gt; ShowS) -&gt; Show Beta
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; Beta -&gt; ShowS
showsPrec :: Int -&gt; Beta -&gt; ShowS
$cshow :: Beta -&gt; String
show :: Beta -&gt; String
$cshowList :: [Beta] -&gt; ShowS
showList :: [Beta] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679100283"><span id="local-6989586621679100285"><span class="annot"><span class="annottext">(forall x. Beta -&gt; Rep Beta x)
-&gt; (forall x. Rep Beta x -&gt; Beta) -&gt; Generic Beta
forall x. Rep Beta x -&gt; Beta
forall x. Beta -&gt; Rep Beta x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x. Beta -&gt; Rep Beta x
from :: forall x. Beta -&gt; Rep Beta x
$cto :: forall x. Rep Beta x -&gt; Beta
to :: forall x. Rep Beta x -&gt; Beta
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-685"></span><span>
</span><span id="line-686"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Distribution"><span class="hs-identifier hs-type">Distribution</span></a></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Beta"><span class="hs-identifier hs-type">Beta</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-687"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Params"><span class="annot"><a href="Inference.Conjugate.html#Params"><span class="hs-identifier hs-var">Params</span></a></span></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Beta"><span class="hs-identifier hs-type">Beta</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span class="hs-special">)</span><span>
</span><span id="line-688"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Support"><span class="annot"><a href="Inference.Conjugate.html#Support"><span class="hs-identifier hs-var">Support</span></a></span></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Beta"><span class="hs-identifier hs-type">Beta</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-689"></span><span>  </span><span id="local-6989586621679100294"><span class="annot"><span class="annottext">distSample :: forall (m :: * -&gt; *).
PrimMonad m =&gt;
Beta -&gt; Params Beta -&gt; Prob m (Support Beta)
</span><a href="Inference.Conjugate.html#distSample"><span class="hs-identifier hs-var hs-var hs-var">distSample</span></a></span></span><span> </span><span class="annot"><span class="annottext">Beta
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Double -&gt; Prob m Double)
-&gt; (Double, Double) -&gt; Prob m Double
forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><span class="hs-identifier hs-var">uncurry</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Prob m Double
forall (m :: * -&gt; *).
PrimMonad m =&gt;
Double -&gt; Double -&gt; Prob m Double
</span><span class="hs-identifier hs-var">beta</span></span><span>
</span><span id="line-690"></span><span>  </span><span id="local-6989586621679100310"><span class="annot"><span class="annottext">distLogP :: Beta -&gt; Params Beta -&gt; Support Beta -&gt; Double
</span><a href="Inference.Conjugate.html#distLogP"><span class="hs-identifier hs-var hs-var hs-var">distLogP</span></a></span></span><span> </span><span class="annot"><span class="annottext">Beta
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679100311"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100311"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679100312"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100312"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679100313"><span class="annot"><span class="annottext">Support Beta
</span><a href="#local-6989586621679100313"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-691"></span><span>    </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">log</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
Support Beta
</span><a href="#local-6989586621679100313"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">**</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100311"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">log</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
Support Beta
</span><a href="#local-6989586621679100313"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">**</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100312"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
</span><span class="hs-identifier hs-var">logBeta</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100311"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100312"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-692"></span><span>
</span><span id="line-693"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Jeffreys"><span class="hs-identifier hs-type">Jeffreys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#AsPrior"><span class="hs-identifier hs-type">AsPrior</span></a></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Beta"><span class="hs-identifier hs-type">Beta</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-694"></span><span>  </span><span id="local-6989586621679100321"><span class="annot"><span class="annottext">jeffreysPrior :: Hyper (AsPrior Beta)
</span><a href="Inference.Conjugate.html#jeffreysPrior"><span class="hs-identifier hs-var hs-var hs-var">jeffreysPrior</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.5</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.5</span></span><span class="hs-special">)</span><span>
</span><span id="line-695"></span><span>
</span><span id="line-696"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Uniform"><span class="hs-identifier hs-type">Uniform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#AsPrior"><span class="hs-identifier hs-type">AsPrior</span></a></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Beta"><span class="hs-identifier hs-type">Beta</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-697"></span><span>  </span><span id="local-6989586621679100326"><span class="annot"><span class="annottext">uniformPrior :: Hyper (AsPrior Beta)
</span><a href="Inference.Conjugate.html#uniformPrior"><span class="hs-identifier hs-var hs-var hs-var">uniformPrior</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-698"></span><span>
</span><span id="line-699"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Prior"><span class="hs-identifier hs-type">Prior</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#AsPrior"><span class="hs-identifier hs-type">AsPrior</span></a></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Beta"><span class="hs-identifier hs-type">Beta</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-700"></span><span>  </span><span id="local-6989586621679100333"><span class="annot"><span class="annottext">sampleProbs :: forall (m :: * -&gt; *).
PrimMonad m =&gt;
Hyper (AsPrior Beta) -&gt; Prob m (Probs (AsPrior Beta))
</span><a href="Inference.Conjugate.html#sampleProbs"><span class="hs-identifier hs-var hs-var hs-var">sampleProbs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Beta -&gt; Params Beta -&gt; Prob m (Support Beta)
forall a (m :: * -&gt; *).
(Distribution a, PrimMonad m) =&gt;
a -&gt; Params a -&gt; Prob m (Support a)
forall (m :: * -&gt; *).
PrimMonad m =&gt;
Beta -&gt; Params Beta -&gt; Prob m (Support Beta)
</span><a href="Inference.Conjugate.html#distSample"><span class="hs-identifier hs-var">distSample</span></a></span><span> </span><span class="annot"><span class="annottext">Beta
</span><a href="Inference.Conjugate.html#Beta"><span class="hs-identifier hs-var">Beta</span></a></span><span>
</span><span id="line-701"></span><span>  </span><span id="local-6989586621679100336"><span class="annot"><span class="annottext">expectedProbs :: Hyper (AsPrior Beta) -&gt; Probs (AsPrior Beta)
</span><a href="Inference.Conjugate.html#expectedProbs"><span class="hs-identifier hs-var hs-var hs-var">expectedProbs</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679100337"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100337"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679100338"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100338"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100337"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100337"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100338"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-702"></span><span>
</span><span id="line-703"></span><span class="hs-comment">-- Bernoulli</span><span>
</span><span id="line-704"></span><span class="hs-comment">-- ---------</span><span>
</span><span id="line-705"></span><span>
</span><span id="line-706"></span><span class="hs-keyword">data</span><span> </span><span id="Bernoulli"><span class="annot"><a href="Inference.Conjugate.html#Bernoulli"><span class="hs-identifier hs-var">Bernoulli</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Bernoulli"><span class="annot"><a href="Inference.Conjugate.html#Bernoulli"><span class="hs-identifier hs-var">Bernoulli</span></a></span></span><span>
</span><span id="line-707"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679100341"><span id="local-6989586621679100343"><span class="annot"><span class="annottext">Bernoulli -&gt; Bernoulli -&gt; Bool
(Bernoulli -&gt; Bernoulli -&gt; Bool)
-&gt; (Bernoulli -&gt; Bernoulli -&gt; Bool) -&gt; Eq Bernoulli
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: Bernoulli -&gt; Bernoulli -&gt; Bool
== :: Bernoulli -&gt; Bernoulli -&gt; Bool
$c/= :: Bernoulli -&gt; Bernoulli -&gt; Bool
/= :: Bernoulli -&gt; Bernoulli -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679100349"><span id="local-6989586621679100351"><span id="local-6989586621679100353"><span id="local-6989586621679100357"><span id="local-6989586621679100360"><span id="local-6989586621679100363"><span id="local-6989586621679100366"><span class="annot"><span class="annottext">Eq Bernoulli
Eq Bernoulli =&gt;
(Bernoulli -&gt; Bernoulli -&gt; Ordering)
-&gt; (Bernoulli -&gt; Bernoulli -&gt; Bool)
-&gt; (Bernoulli -&gt; Bernoulli -&gt; Bool)
-&gt; (Bernoulli -&gt; Bernoulli -&gt; Bool)
-&gt; (Bernoulli -&gt; Bernoulli -&gt; Bool)
-&gt; (Bernoulli -&gt; Bernoulli -&gt; Bernoulli)
-&gt; (Bernoulli -&gt; Bernoulli -&gt; Bernoulli)
-&gt; Ord Bernoulli
Bernoulli -&gt; Bernoulli -&gt; Bool
Bernoulli -&gt; Bernoulli -&gt; Ordering
Bernoulli -&gt; Bernoulli -&gt; Bernoulli
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
$ccompare :: Bernoulli -&gt; Bernoulli -&gt; Ordering
compare :: Bernoulli -&gt; Bernoulli -&gt; Ordering
$c&lt; :: Bernoulli -&gt; Bernoulli -&gt; Bool
&lt; :: Bernoulli -&gt; Bernoulli -&gt; Bool
$c&lt;= :: Bernoulli -&gt; Bernoulli -&gt; Bool
&lt;= :: Bernoulli -&gt; Bernoulli -&gt; Bool
$c&gt; :: Bernoulli -&gt; Bernoulli -&gt; Bool
&gt; :: Bernoulli -&gt; Bernoulli -&gt; Bool
$c&gt;= :: Bernoulli -&gt; Bernoulli -&gt; Bool
&gt;= :: Bernoulli -&gt; Bernoulli -&gt; Bool
$cmax :: Bernoulli -&gt; Bernoulli -&gt; Bernoulli
max :: Bernoulli -&gt; Bernoulli -&gt; Bernoulli
$cmin :: Bernoulli -&gt; Bernoulli -&gt; Bernoulli
min :: Bernoulli -&gt; Bernoulli -&gt; Bernoulli
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679100369"><span id="local-6989586621679100371"><span id="local-6989586621679100375"><span class="annot"><span class="annottext">Int -&gt; Bernoulli -&gt; ShowS
[Bernoulli] -&gt; ShowS
Bernoulli -&gt; String
(Int -&gt; Bernoulli -&gt; ShowS)
-&gt; (Bernoulli -&gt; String)
-&gt; ([Bernoulli] -&gt; ShowS)
-&gt; Show Bernoulli
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; Bernoulli -&gt; ShowS
showsPrec :: Int -&gt; Bernoulli -&gt; ShowS
$cshow :: Bernoulli -&gt; String
show :: Bernoulli -&gt; String
$cshowList :: [Bernoulli] -&gt; ShowS
showList :: [Bernoulli] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679100378"><span id="local-6989586621679100380"><span class="annot"><span class="annottext">(forall x. Bernoulli -&gt; Rep Bernoulli x)
-&gt; (forall x. Rep Bernoulli x -&gt; Bernoulli) -&gt; Generic Bernoulli
forall x. Rep Bernoulli x -&gt; Bernoulli
forall x. Bernoulli -&gt; Rep Bernoulli x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x. Bernoulli -&gt; Rep Bernoulli x
from :: forall x. Bernoulli -&gt; Rep Bernoulli x
$cto :: forall x. Rep Bernoulli x -&gt; Bernoulli
to :: forall x. Rep Bernoulli x -&gt; Bernoulli
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-708"></span><span>
</span><span id="line-709"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Distribution"><span class="hs-identifier hs-type">Distribution</span></a></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Bernoulli"><span class="hs-identifier hs-type">Bernoulli</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-710"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Params"><span class="annot"><a href="Inference.Conjugate.html#Params"><span class="hs-identifier hs-var">Params</span></a></span></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Bernoulli"><span class="hs-identifier hs-type">Bernoulli</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-711"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Support"><span class="annot"><a href="Inference.Conjugate.html#Support"><span class="hs-identifier hs-var">Support</span></a></span></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Bernoulli"><span class="hs-identifier hs-type">Bernoulli</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-712"></span><span>  </span><span id="local-6989586621679100387"><span class="annot"><span class="annottext">distSample :: forall (m :: * -&gt; *).
PrimMonad m =&gt;
Bernoulli -&gt; Params Bernoulli -&gt; Prob m (Support Bernoulli)
</span><a href="Inference.Conjugate.html#distSample"><span class="hs-identifier hs-var hs-var hs-var">distSample</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bernoulli
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Prob m Bool
Params Bernoulli -&gt; Prob m (Support Bernoulli)
forall (m :: * -&gt; *). PrimMonad m =&gt; Double -&gt; Prob m Bool
</span><span class="hs-identifier hs-var">bernoulli</span></span><span>
</span><span id="line-713"></span><span>  </span><span id="local-6989586621679100393"><span class="annot"><span class="annottext">distLogP :: Bernoulli -&gt; Params Bernoulli -&gt; Support Bernoulli -&gt; Double
</span><a href="Inference.Conjugate.html#distLogP"><span class="hs-identifier hs-var hs-var hs-var">distLogP</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bernoulli
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679100394"><span class="annot"><span class="annottext">Params Bernoulli
</span><a href="#local-6989586621679100394"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
Support Bernoulli
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">log</span></span><span> </span><span class="annot"><span class="annottext">Double
Params Bernoulli
</span><a href="#local-6989586621679100394"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-714"></span><span>  </span><span class="annot"><a href="Inference.Conjugate.html#distLogP"><span class="hs-identifier hs-var">distLogP</span></a></span><span> </span><span class="annot"><span class="annottext">Bernoulli
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679100395"><span class="annot"><span class="annottext">Params Bernoulli
</span><a href="#local-6989586621679100395"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
Support Bernoulli
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">log</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
Params Bernoulli
</span><a href="#local-6989586621679100395"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-715"></span><span>
</span><span id="line-716"></span><span class="hs-comment">-- Binomial</span><span>
</span><span id="line-717"></span><span class="hs-comment">-- --------</span><span>
</span><span id="line-718"></span><span>
</span><span id="line-719"></span><span class="hs-keyword">newtype</span><span> </span><span id="Binomial"><span class="annot"><a href="Inference.Conjugate.html#Binomial"><span class="hs-identifier hs-var">Binomial</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Binomial"><span class="annot"><a href="Inference.Conjugate.html#Binomial"><span class="hs-identifier hs-var">Binomial</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-720"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679100398"><span id="local-6989586621679100403"><span class="annot"><span class="annottext">Binomial -&gt; Binomial -&gt; Bool
(Binomial -&gt; Binomial -&gt; Bool)
-&gt; (Binomial -&gt; Binomial -&gt; Bool) -&gt; Eq Binomial
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: Binomial -&gt; Binomial -&gt; Bool
== :: Binomial -&gt; Binomial -&gt; Bool
$c/= :: Binomial -&gt; Binomial -&gt; Bool
/= :: Binomial -&gt; Binomial -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679100411"><span id="local-6989586621679100415"><span id="local-6989586621679100419"><span id="local-6989586621679100423"><span id="local-6989586621679100427"><span id="local-6989586621679100431"><span id="local-6989586621679100435"><span class="annot"><span class="annottext">Eq Binomial
Eq Binomial =&gt;
(Binomial -&gt; Binomial -&gt; Ordering)
-&gt; (Binomial -&gt; Binomial -&gt; Bool)
-&gt; (Binomial -&gt; Binomial -&gt; Bool)
-&gt; (Binomial -&gt; Binomial -&gt; Bool)
-&gt; (Binomial -&gt; Binomial -&gt; Bool)
-&gt; (Binomial -&gt; Binomial -&gt; Binomial)
-&gt; (Binomial -&gt; Binomial -&gt; Binomial)
-&gt; Ord Binomial
Binomial -&gt; Binomial -&gt; Bool
Binomial -&gt; Binomial -&gt; Ordering
Binomial -&gt; Binomial -&gt; Binomial
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
$ccompare :: Binomial -&gt; Binomial -&gt; Ordering
compare :: Binomial -&gt; Binomial -&gt; Ordering
$c&lt; :: Binomial -&gt; Binomial -&gt; Bool
&lt; :: Binomial -&gt; Binomial -&gt; Bool
$c&lt;= :: Binomial -&gt; Binomial -&gt; Bool
&lt;= :: Binomial -&gt; Binomial -&gt; Bool
$c&gt; :: Binomial -&gt; Binomial -&gt; Bool
&gt; :: Binomial -&gt; Binomial -&gt; Bool
$c&gt;= :: Binomial -&gt; Binomial -&gt; Bool
&gt;= :: Binomial -&gt; Binomial -&gt; Bool
$cmax :: Binomial -&gt; Binomial -&gt; Binomial
max :: Binomial -&gt; Binomial -&gt; Binomial
$cmin :: Binomial -&gt; Binomial -&gt; Binomial
min :: Binomial -&gt; Binomial -&gt; Binomial
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679100442"><span id="local-6989586621679100447"><span id="local-6989586621679100451"><span class="annot"><span class="annottext">Int -&gt; Binomial -&gt; ShowS
[Binomial] -&gt; ShowS
Binomial -&gt; String
(Int -&gt; Binomial -&gt; ShowS)
-&gt; (Binomial -&gt; String) -&gt; ([Binomial] -&gt; ShowS) -&gt; Show Binomial
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; Binomial -&gt; ShowS
showsPrec :: Int -&gt; Binomial -&gt; ShowS
$cshow :: Binomial -&gt; String
show :: Binomial -&gt; String
$cshowList :: [Binomial] -&gt; ShowS
showList :: [Binomial] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679100454"><span id="local-6989586621679100456"><span class="annot"><span class="annottext">(forall x. Binomial -&gt; Rep Binomial x)
-&gt; (forall x. Rep Binomial x -&gt; Binomial) -&gt; Generic Binomial
forall x. Rep Binomial x -&gt; Binomial
forall x. Binomial -&gt; Rep Binomial x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x. Binomial -&gt; Rep Binomial x
from :: forall x. Binomial -&gt; Rep Binomial x
$cto :: forall x. Rep Binomial x -&gt; Binomial
to :: forall x. Rep Binomial x -&gt; Binomial
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-721"></span><span>
</span><span id="line-722"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Distribution"><span class="hs-identifier hs-type">Distribution</span></a></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Binomial"><span class="hs-identifier hs-type">Binomial</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-723"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Params"><span class="annot"><a href="Inference.Conjugate.html#Params"><span class="hs-identifier hs-var">Params</span></a></span></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Binomial"><span class="hs-identifier hs-type">Binomial</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-724"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Support"><span class="annot"><a href="Inference.Conjugate.html#Support"><span class="hs-identifier hs-var">Support</span></a></span></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Binomial"><span class="hs-identifier hs-type">Binomial</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-725"></span><span>  </span><span id="local-6989586621679100463"><span class="annot"><span class="annottext">distSample :: forall (m :: * -&gt; *).
PrimMonad m =&gt;
Binomial -&gt; Params Binomial -&gt; Prob m (Support Binomial)
</span><a href="Inference.Conjugate.html#distSample"><span class="hs-identifier hs-var hs-var hs-var">distSample</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Binomial"><span class="hs-identifier hs-type">Binomial</span></a></span><span> </span><span id="local-6989586621679100464"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679100464"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double -&gt; Prob m Int
forall (m :: * -&gt; *). PrimMonad m =&gt; Int -&gt; Double -&gt; Prob m Int
</span><span class="hs-identifier hs-var">binomial</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679100464"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-726"></span><span>  </span><span id="local-6989586621679100475"><span class="annot"><span class="annottext">distLogP :: Binomial -&gt; Params Binomial -&gt; Support Binomial -&gt; Double
</span><a href="Inference.Conjugate.html#distLogP"><span class="hs-identifier hs-var hs-var hs-var">distLogP</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Binomial"><span class="hs-identifier hs-type">Binomial</span></a></span><span> </span><span id="local-6989586621679100476"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679100476"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679100477"><span class="annot"><span class="annottext">Params Binomial
</span><a href="#local-6989586621679100477"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679100478"><span class="annot"><span class="annottext">Support Binomial
</span><a href="#local-6989586621679100478"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-727"></span><span>    </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Double
</span><span class="hs-identifier hs-var">logChoose</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679100476"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int
Support Binomial
</span><a href="#local-6989586621679100478"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">log</span></span><span> </span><span class="annot"><span class="annottext">Double
Params Binomial
</span><a href="#local-6989586621679100477"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100480"><span class="hs-identifier hs-var">k'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">log</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
Params Binomial
</span><a href="#local-6989586621679100477"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100481"><span class="hs-identifier hs-var">n'</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100480"><span class="hs-identifier hs-var">k'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-728"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-729"></span><span>    </span><span id="local-6989586621679100480"><span class="annot"><span class="annottext">k' :: Double
</span><a href="#local-6989586621679100480"><span class="hs-identifier hs-var hs-var">k'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
</span><span class="hs-identifier hs-var">int2Double</span></span><span> </span><span class="annot"><span class="annottext">Int
Support Binomial
</span><a href="#local-6989586621679100478"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-730"></span><span>    </span><span id="local-6989586621679100481"><span class="annot"><span class="annottext">n' :: Double
</span><a href="#local-6989586621679100481"><span class="hs-identifier hs-var hs-var">n'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
</span><span class="hs-identifier hs-var">int2Double</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679100476"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-731"></span><span>
</span><span id="line-732"></span><span class="hs-comment">-- Categorical</span><span>
</span><span id="line-733"></span><span class="hs-comment">-- -----------</span><span>
</span><span id="line-734"></span><span>
</span><span id="line-735"></span><span class="hs-keyword">type</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Categorical"><span class="hs-identifier hs-type">Categorical</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-736"></span><span class="hs-keyword">data</span><span> </span><span id="Categorical"><span class="annot"><a href="Inference.Conjugate.html#Categorical"><span class="hs-identifier hs-var">Categorical</span></a></span></span><span> </span><span id="local-6989586621679100482"><span class="annot"><a href="#local-6989586621679100482"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Categorical"><span class="annot"><a href="Inference.Conjugate.html#Categorical"><span class="hs-identifier hs-var">Categorical</span></a></span></span><span>
</span><span id="line-737"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679100485"><span id="local-6989586621679100487"><span class="annot"><span class="annottext">Categorical n -&gt; Categorical n -&gt; Bool
(Categorical n -&gt; Categorical n -&gt; Bool)
-&gt; (Categorical n -&gt; Categorical n -&gt; Bool) -&gt; Eq (Categorical n)
forall (n :: Nat). Categorical n -&gt; Categorical n -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: forall (n :: Nat). Categorical n -&gt; Categorical n -&gt; Bool
== :: Categorical n -&gt; Categorical n -&gt; Bool
$c/= :: forall (n :: Nat). Categorical n -&gt; Categorical n -&gt; Bool
/= :: Categorical n -&gt; Categorical n -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679100493"><span id="local-6989586621679100495"><span id="local-6989586621679100497"><span id="local-6989586621679100501"><span id="local-6989586621679100504"><span id="local-6989586621679100507"><span id="local-6989586621679100510"><span class="annot"><span class="annottext">Eq (Categorical n)
Eq (Categorical n) =&gt;
(Categorical n -&gt; Categorical n -&gt; Ordering)
-&gt; (Categorical n -&gt; Categorical n -&gt; Bool)
-&gt; (Categorical n -&gt; Categorical n -&gt; Bool)
-&gt; (Categorical n -&gt; Categorical n -&gt; Bool)
-&gt; (Categorical n -&gt; Categorical n -&gt; Bool)
-&gt; (Categorical n -&gt; Categorical n -&gt; Categorical n)
-&gt; (Categorical n -&gt; Categorical n -&gt; Categorical n)
-&gt; Ord (Categorical n)
Categorical n -&gt; Categorical n -&gt; Bool
Categorical n -&gt; Categorical n -&gt; Ordering
Categorical n -&gt; Categorical n -&gt; Categorical n
forall (n :: Nat). Eq (Categorical n)
forall (n :: Nat). Categorical n -&gt; Categorical n -&gt; Bool
forall (n :: Nat). Categorical n -&gt; Categorical n -&gt; Ordering
forall (n :: Nat). Categorical n -&gt; Categorical n -&gt; Categorical n
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
$ccompare :: forall (n :: Nat). Categorical n -&gt; Categorical n -&gt; Ordering
compare :: Categorical n -&gt; Categorical n -&gt; Ordering
$c&lt; :: forall (n :: Nat). Categorical n -&gt; Categorical n -&gt; Bool
&lt; :: Categorical n -&gt; Categorical n -&gt; Bool
$c&lt;= :: forall (n :: Nat). Categorical n -&gt; Categorical n -&gt; Bool
&lt;= :: Categorical n -&gt; Categorical n -&gt; Bool
$c&gt; :: forall (n :: Nat). Categorical n -&gt; Categorical n -&gt; Bool
&gt; :: Categorical n -&gt; Categorical n -&gt; Bool
$c&gt;= :: forall (n :: Nat). Categorical n -&gt; Categorical n -&gt; Bool
&gt;= :: Categorical n -&gt; Categorical n -&gt; Bool
$cmax :: forall (n :: Nat). Categorical n -&gt; Categorical n -&gt; Categorical n
max :: Categorical n -&gt; Categorical n -&gt; Categorical n
$cmin :: forall (n :: Nat). Categorical n -&gt; Categorical n -&gt; Categorical n
min :: Categorical n -&gt; Categorical n -&gt; Categorical n
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679100513"><span id="local-6989586621679100515"><span id="local-6989586621679100519"><span class="annot"><span class="annottext">Int -&gt; Categorical n -&gt; ShowS
[Categorical n] -&gt; ShowS
Categorical n -&gt; String
(Int -&gt; Categorical n -&gt; ShowS)
-&gt; (Categorical n -&gt; String)
-&gt; ([Categorical n] -&gt; ShowS)
-&gt; Show (Categorical n)
forall (n :: Nat). Int -&gt; Categorical n -&gt; ShowS
forall (n :: Nat). [Categorical n] -&gt; ShowS
forall (n :: Nat). Categorical n -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: forall (n :: Nat). Int -&gt; Categorical n -&gt; ShowS
showsPrec :: Int -&gt; Categorical n -&gt; ShowS
$cshow :: forall (n :: Nat). Categorical n -&gt; String
show :: Categorical n -&gt; String
$cshowList :: forall (n :: Nat). [Categorical n] -&gt; ShowS
showList :: [Categorical n] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679100522"><span id="local-6989586621679100524"><span class="annot"><span class="annottext">(forall x. Categorical n -&gt; Rep (Categorical n) x)
-&gt; (forall x. Rep (Categorical n) x -&gt; Categorical n)
-&gt; Generic (Categorical n)
forall (n :: Nat) x. Rep (Categorical n) x -&gt; Categorical n
forall (n :: Nat) x. Categorical n -&gt; Rep (Categorical n) x
forall x. Rep (Categorical n) x -&gt; Categorical n
forall x. Categorical n -&gt; Rep (Categorical n) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall (n :: Nat) x. Categorical n -&gt; Rep (Categorical n) x
from :: forall x. Categorical n -&gt; Rep (Categorical n) x
$cto :: forall (n :: Nat) x. Rep (Categorical n) x -&gt; Categorical n
to :: forall x. Rep (Categorical n) x -&gt; Categorical n
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-738"></span><span>
</span><span id="line-739"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679098534"><span class="annot"><a href="Inference.Conjugate.html#Distribution"><span class="hs-identifier hs-type">Distribution</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Categorical"><span class="hs-identifier hs-type">Categorical</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098534"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-740"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Params"><span class="annot"><a href="Inference.Conjugate.html#Params"><span class="hs-identifier hs-var">Params</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Categorical"><span class="hs-identifier hs-type">Categorical</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098534"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-741"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Support"><span class="annot"><a href="Inference.Conjugate.html#Support"><span class="hs-identifier hs-var">Support</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Categorical"><span class="hs-identifier hs-type">Categorical</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098534"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-742"></span><span>  </span><span id="local-6989586621679100533"><span class="annot"><span class="annottext">distSample :: forall (m :: * -&gt; *).
PrimMonad m =&gt;
Categorical n
-&gt; Params (Categorical n) -&gt; Prob m (Support (Categorical n))
</span><a href="Inference.Conjugate.html#distSample"><span class="hs-identifier hs-var hs-var hs-var">distSample</span></a></span></span><span> </span><span class="annot"><span class="annottext">Categorical n
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Double -&gt; Prob m Int
Params (Categorical n) -&gt; Prob m (Support (Categorical n))
forall (f :: * -&gt; *) (m :: * -&gt; *).
(Foldable f, PrimMonad m) =&gt;
f Double -&gt; Prob m Int
</span><span class="hs-identifier hs-var">categorical</span></span><span>
</span><span id="line-743"></span><span>  </span><span id="local-6989586621679100536"><span class="annot"><span class="annottext">distLogP :: Categorical n
-&gt; Params (Categorical n) -&gt; Support (Categorical n) -&gt; Double
</span><a href="Inference.Conjugate.html#distLogP"><span class="hs-identifier hs-var hs-var hs-var">distLogP</span></a></span></span><span> </span><span class="annot"><span class="annottext">Categorical n
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679100537"><span class="annot"><span class="annottext">Params (Categorical n)
</span><a href="#local-6989586621679100537"><span class="hs-identifier hs-var">ps</span></a></span></span><span> </span><span id="local-6989586621679100538"><span class="annot"><span class="annottext">Support (Categorical n)
</span><a href="#local-6989586621679100538"><span class="hs-identifier hs-var">cat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">log</span></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Double) -&gt; Double -&gt; Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Maybe Double -&gt; Double
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Double -&gt; Double) -&gt; Maybe Double -&gt; Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vector Double
Params (Categorical n)
</span><a href="#local-6989586621679100537"><span class="hs-identifier hs-var">ps</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Double -&gt; Int -&gt; Maybe Double
forall a. Vector a -&gt; Int -&gt; Maybe a
</span><span class="hs-operator hs-var">V.!?</span></span><span> </span><span class="annot"><span class="annottext">Int
Support (Categorical n)
</span><a href="#local-6989586621679100538"><span class="hs-identifier hs-var">cat</span></a></span><span>
</span><span id="line-744"></span><span>
</span><span id="line-745"></span><span class="hs-comment">-- Dirichlet</span><span>
</span><span id="line-746"></span><span class="hs-comment">-- ---------</span><span>
</span><span id="line-747"></span><span>
</span><span id="line-748"></span><span class="hs-keyword">type</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Dirichlet"><span class="hs-identifier hs-type">Dirichlet</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Nat</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Type</span></span><span>
</span><span id="line-749"></span><span class="hs-keyword">data</span><span> </span><span id="Dirichlet"><span class="annot"><a href="Inference.Conjugate.html#Dirichlet"><span class="hs-identifier hs-var">Dirichlet</span></a></span></span><span> </span><span id="local-6989586621679098570"><span class="annot"><a href="#local-6989586621679098570"><span class="hs-identifier hs-type">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Dirichlet"><span class="annot"><a href="Inference.Conjugate.html#Dirichlet"><span class="hs-identifier hs-var">Dirichlet</span></a></span></span><span>
</span><span id="line-750"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679100542"><span id="local-6989586621679100544"><span class="annot"><span class="annottext">Dirichlet n -&gt; Dirichlet n -&gt; Bool
(Dirichlet n -&gt; Dirichlet n -&gt; Bool)
-&gt; (Dirichlet n -&gt; Dirichlet n -&gt; Bool) -&gt; Eq (Dirichlet n)
forall (n :: Nat). Dirichlet n -&gt; Dirichlet n -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: forall (n :: Nat). Dirichlet n -&gt; Dirichlet n -&gt; Bool
== :: Dirichlet n -&gt; Dirichlet n -&gt; Bool
$c/= :: forall (n :: Nat). Dirichlet n -&gt; Dirichlet n -&gt; Bool
/= :: Dirichlet n -&gt; Dirichlet n -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679100550"><span id="local-6989586621679100552"><span id="local-6989586621679100554"><span id="local-6989586621679100558"><span id="local-6989586621679100561"><span id="local-6989586621679100564"><span id="local-6989586621679100567"><span class="annot"><span class="annottext">Eq (Dirichlet n)
Eq (Dirichlet n) =&gt;
(Dirichlet n -&gt; Dirichlet n -&gt; Ordering)
-&gt; (Dirichlet n -&gt; Dirichlet n -&gt; Bool)
-&gt; (Dirichlet n -&gt; Dirichlet n -&gt; Bool)
-&gt; (Dirichlet n -&gt; Dirichlet n -&gt; Bool)
-&gt; (Dirichlet n -&gt; Dirichlet n -&gt; Bool)
-&gt; (Dirichlet n -&gt; Dirichlet n -&gt; Dirichlet n)
-&gt; (Dirichlet n -&gt; Dirichlet n -&gt; Dirichlet n)
-&gt; Ord (Dirichlet n)
Dirichlet n -&gt; Dirichlet n -&gt; Bool
Dirichlet n -&gt; Dirichlet n -&gt; Ordering
Dirichlet n -&gt; Dirichlet n -&gt; Dirichlet n
forall (n :: Nat). Eq (Dirichlet n)
forall (n :: Nat). Dirichlet n -&gt; Dirichlet n -&gt; Bool
forall (n :: Nat). Dirichlet n -&gt; Dirichlet n -&gt; Ordering
forall (n :: Nat). Dirichlet n -&gt; Dirichlet n -&gt; Dirichlet n
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
$ccompare :: forall (n :: Nat). Dirichlet n -&gt; Dirichlet n -&gt; Ordering
compare :: Dirichlet n -&gt; Dirichlet n -&gt; Ordering
$c&lt; :: forall (n :: Nat). Dirichlet n -&gt; Dirichlet n -&gt; Bool
&lt; :: Dirichlet n -&gt; Dirichlet n -&gt; Bool
$c&lt;= :: forall (n :: Nat). Dirichlet n -&gt; Dirichlet n -&gt; Bool
&lt;= :: Dirichlet n -&gt; Dirichlet n -&gt; Bool
$c&gt; :: forall (n :: Nat). Dirichlet n -&gt; Dirichlet n -&gt; Bool
&gt; :: Dirichlet n -&gt; Dirichlet n -&gt; Bool
$c&gt;= :: forall (n :: Nat). Dirichlet n -&gt; Dirichlet n -&gt; Bool
&gt;= :: Dirichlet n -&gt; Dirichlet n -&gt; Bool
$cmax :: forall (n :: Nat). Dirichlet n -&gt; Dirichlet n -&gt; Dirichlet n
max :: Dirichlet n -&gt; Dirichlet n -&gt; Dirichlet n
$cmin :: forall (n :: Nat). Dirichlet n -&gt; Dirichlet n -&gt; Dirichlet n
min :: Dirichlet n -&gt; Dirichlet n -&gt; Dirichlet n
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679100570"><span id="local-6989586621679100572"><span id="local-6989586621679100576"><span class="annot"><span class="annottext">Int -&gt; Dirichlet n -&gt; ShowS
[Dirichlet n] -&gt; ShowS
Dirichlet n -&gt; String
(Int -&gt; Dirichlet n -&gt; ShowS)
-&gt; (Dirichlet n -&gt; String)
-&gt; ([Dirichlet n] -&gt; ShowS)
-&gt; Show (Dirichlet n)
forall (n :: Nat). Int -&gt; Dirichlet n -&gt; ShowS
forall (n :: Nat). [Dirichlet n] -&gt; ShowS
forall (n :: Nat). Dirichlet n -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: forall (n :: Nat). Int -&gt; Dirichlet n -&gt; ShowS
showsPrec :: Int -&gt; Dirichlet n -&gt; ShowS
$cshow :: forall (n :: Nat). Dirichlet n -&gt; String
show :: Dirichlet n -&gt; String
$cshowList :: forall (n :: Nat). [Dirichlet n] -&gt; ShowS
showList :: [Dirichlet n] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679100579"><span id="local-6989586621679100581"><span class="annot"><span class="annottext">(forall x. Dirichlet n -&gt; Rep (Dirichlet n) x)
-&gt; (forall x. Rep (Dirichlet n) x -&gt; Dirichlet n)
-&gt; Generic (Dirichlet n)
forall (n :: Nat) x. Rep (Dirichlet n) x -&gt; Dirichlet n
forall (n :: Nat) x. Dirichlet n -&gt; Rep (Dirichlet n) x
forall x. Rep (Dirichlet n) x -&gt; Dirichlet n
forall x. Dirichlet n -&gt; Rep (Dirichlet n) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall (n :: Nat) x. Dirichlet n -&gt; Rep (Dirichlet n) x
from :: forall x. Dirichlet n -&gt; Rep (Dirichlet n) x
$cto :: forall (n :: Nat) x. Rep (Dirichlet n) x -&gt; Dirichlet n
to :: forall x. Rep (Dirichlet n) x -&gt; Dirichlet n
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-751"></span><span>
</span><span id="line-752"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679098551"><span class="annot"><a href="Inference.Conjugate.html#Distribution"><span class="hs-identifier hs-type">Distribution</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Dirichlet"><span class="hs-identifier hs-type">Dirichlet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098551"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-753"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Params"><span class="annot"><a href="Inference.Conjugate.html#Params"><span class="hs-identifier hs-var">Params</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Dirichlet"><span class="hs-identifier hs-type">Dirichlet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098551"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-754"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Support"><span class="annot"><a href="Inference.Conjugate.html#Support"><span class="hs-identifier hs-var">Support</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Dirichlet"><span class="hs-identifier hs-type">Dirichlet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098551"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-755"></span><span>  </span><span id="local-6989586621679100590"><span class="annot"><span class="annottext">distSample :: forall (m :: * -&gt; *).
PrimMonad m =&gt;
Dirichlet n
-&gt; Params (Dirichlet n) -&gt; Prob m (Support (Dirichlet n))
</span><a href="Inference.Conjugate.html#distSample"><span class="hs-identifier hs-var hs-var hs-var">distSample</span></a></span></span><span> </span><span class="annot"><span class="annottext">Dirichlet n
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Double -&gt; Prob m (Vector Double)
Params (Dirichlet n) -&gt; Prob m (Support (Dirichlet n))
forall (f :: * -&gt; *) (m :: * -&gt; *).
(Traversable f, PrimMonad m) =&gt;
f Double -&gt; Prob m (f Double)
</span><span class="hs-identifier hs-var">dirichlet</span></span><span>
</span><span id="line-756"></span><span>  </span><span id="local-6989586621679100606"><span class="annot"><span class="annottext">distLogP :: Dirichlet n
-&gt; Params (Dirichlet n) -&gt; Support (Dirichlet n) -&gt; Double
</span><a href="Inference.Conjugate.html#distLogP"><span class="hs-identifier hs-var hs-var hs-var">distLogP</span></a></span></span><span> </span><span class="annot"><span class="annottext">Dirichlet n
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679100607"><span class="annot"><span class="annottext">Params (Dirichlet n)
</span><a href="#local-6989586621679100607"><span class="hs-identifier hs-var">counts</span></a></span></span><span> </span><span id="local-6989586621679100608"><span class="annot"><span class="annottext">Support (Dirichlet n)
</span><a href="#local-6989586621679100608"><span class="hs-identifier hs-var">probs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100609"><span class="hs-identifier hs-var">logp</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100610"><span class="hs-identifier hs-var">logz</span></a></span><span>
</span><span id="line-757"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-758"></span><span>    </span><span id="local-6989586621679100609"><span class="annot"><span class="annottext">logp :: Double
</span><a href="#local-6989586621679100609"><span class="hs-identifier hs-var hs-var">logp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Double -&gt; Double
forall a. Num a =&gt; Vector a -&gt; a
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">sum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Double -&gt; Double -&gt; Double)
-&gt; Vector Double -&gt; Vector Double -&gt; Vector Double
forall a b c. (a -&gt; b -&gt; c) -&gt; Vector a -&gt; Vector b -&gt; Vector c
</span><span class="hs-identifier hs-var">V.zipWith</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679100612"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100612"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679100613"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100613"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">log</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100613"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100612"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Vector Double
Params (Dirichlet n)
</span><a href="#local-6989586621679100607"><span class="hs-identifier hs-var">counts</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Double
Support (Dirichlet n)
</span><a href="#local-6989586621679100608"><span class="hs-identifier hs-var">probs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-759"></span><span>    </span><span id="local-6989586621679100610"><span class="annot"><span class="annottext">logz :: Double
</span><a href="#local-6989586621679100610"><span class="hs-identifier hs-var hs-var">logz</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
</span><span class="hs-identifier hs-var">logGamma</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector Double -&gt; Double
forall a. Num a =&gt; Vector a -&gt; a
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">sum</span></span><span> </span><span class="annot"><span class="annottext">Vector Double
Params (Dirichlet n)
</span><a href="#local-6989586621679100607"><span class="hs-identifier hs-var">counts</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Vector Double -&gt; Double
forall a. Num a =&gt; Vector a -&gt; a
forall (t :: * -&gt; *) a. (Foldable t, Num a) =&gt; t a -&gt; a
</span><span class="hs-identifier hs-var">sum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
</span><span class="hs-identifier hs-var">logGamma</span></span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Double) -&gt; Vector Double -&gt; Vector Double
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Vector Double
Params (Dirichlet n)
</span><a href="#local-6989586621679100607"><span class="hs-identifier hs-var">counts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-760"></span><span>
</span><span id="line-761"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679098559"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679098559"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Jeffreys"><span class="hs-identifier hs-type">Jeffreys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#AsPrior"><span class="hs-identifier hs-type">AsPrior</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Dirichlet"><span class="hs-identifier hs-type">Dirichlet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098559"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-762"></span><span>  </span><span id="local-6989586621679100623"><span class="annot"><span class="annottext">jeffreysPrior :: Hyper (AsPrior (Dirichlet n))
</span><a href="Inference.Conjugate.html#jeffreysPrior"><span class="hs-identifier hs-var hs-var hs-var">jeffreysPrior</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double -&gt; Vector Double
forall a. Int -&gt; a -&gt; Vector a
</span><span class="hs-identifier hs-var">V.replicate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Nat -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Nat -&gt; Int) -&gt; Nat -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Proxy n -&gt; Nat
forall (n :: Nat) (proxy :: Nat -&gt; *). KnownNat n =&gt; proxy n -&gt; Nat
</span><span class="hs-identifier hs-var">natVal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy n
forall {k} (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679098559"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.5</span></span><span>
</span><span id="line-763"></span><span>
</span><span id="line-764"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679098566"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">KnownNat</span></span><span> </span><span class="annot"><a href="#local-6989586621679098566"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Uniform"><span class="hs-identifier hs-type">Uniform</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#AsPrior"><span class="hs-identifier hs-type">AsPrior</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Dirichlet"><span class="hs-identifier hs-type">Dirichlet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098566"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-765"></span><span>  </span><span id="local-6989586621679100633"><span class="annot"><span class="annottext">uniformPrior :: Hyper (AsPrior (Dirichlet n))
</span><a href="Inference.Conjugate.html#uniformPrior"><span class="hs-identifier hs-var hs-var hs-var">uniformPrior</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double -&gt; Vector Double
forall a. Int -&gt; a -&gt; Vector a
</span><span class="hs-identifier hs-var">V.replicate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Nat -&gt; Int
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Nat -&gt; Int) -&gt; Nat -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Proxy n -&gt; Nat
forall (n :: Nat) (proxy :: Nat -&gt; *). KnownNat n =&gt; proxy n -&gt; Nat
</span><span class="hs-identifier hs-var">natVal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy n
forall {k} (t :: k). Proxy t
</span><span class="hs-identifier hs-var">Proxy</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Proxy</span></span><span> </span><span class="annot"><a href="#local-6989586621679098566"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span>
</span><span id="line-766"></span><span>
</span><span id="line-767"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679098568"><span class="annot"><a href="Inference.Conjugate.html#Prior"><span class="hs-identifier hs-type">Prior</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#AsPrior"><span class="hs-identifier hs-type">AsPrior</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Dirichlet"><span class="hs-identifier hs-type">Dirichlet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098568"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-768"></span><span>  </span><span id="local-6989586621679100640"><span class="annot"><span class="annottext">sampleProbs :: forall (m :: * -&gt; *).
PrimMonad m =&gt;
Hyper (AsPrior (Dirichlet n))
-&gt; Prob m (Probs (AsPrior (Dirichlet n)))
</span><a href="Inference.Conjugate.html#sampleProbs"><span class="hs-identifier hs-var hs-var hs-var">sampleProbs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dirichlet (ZonkAny 0)
-&gt; Params (Dirichlet (ZonkAny 0))
-&gt; Prob m (Support (Dirichlet (ZonkAny 0)))
forall a (m :: * -&gt; *).
(Distribution a, PrimMonad m) =&gt;
a -&gt; Params a -&gt; Prob m (Support a)
forall (m :: * -&gt; *).
PrimMonad m =&gt;
Dirichlet (ZonkAny 0)
-&gt; Params (Dirichlet (ZonkAny 0))
-&gt; Prob m (Support (Dirichlet (ZonkAny 0)))
</span><a href="Inference.Conjugate.html#distSample"><span class="hs-identifier hs-var">distSample</span></a></span><span> </span><span class="annot"><span class="annottext">Dirichlet (ZonkAny 0)
forall (n :: Nat). Dirichlet n
</span><a href="Inference.Conjugate.html#Dirichlet"><span class="hs-identifier hs-var">Dirichlet</span></a></span><span>
</span><span id="line-769"></span><span>  </span><span class="annot"><a href="Inference.Conjugate.html#expectedProbs"><span class="hs-identifier hs-type">expectedProbs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V.Vector</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-770"></span><span>  </span><span id="local-6989586621679100644"><span class="annot"><span class="annottext">expectedProbs :: Vector Double -&gt; Vector Double
</span><a href="Inference.Conjugate.html#expectedProbs"><span class="hs-identifier hs-var hs-var hs-var">expectedProbs</span></a></span></span><span> </span><span id="local-6989586621679100645"><span class="annot"><span class="annottext">Vector Double
</span><a href="#local-6989586621679100645"><span class="hs-identifier hs-var">probs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100646"><span class="hs-identifier hs-var">norm</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Double -&gt; Double) -&gt; Vector Double -&gt; Vector Double
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Vector Double
</span><a href="#local-6989586621679100645"><span class="hs-identifier hs-var">probs</span></a></span><span>
</span><span id="line-771"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-772"></span><span>    </span><span id="local-6989586621679100646"><span class="annot"><span class="annottext">norm :: Double
</span><a href="#local-6989586621679100646"><span class="hs-identifier hs-var hs-var">norm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Vector Double -&gt; Double
forall a. Num a =&gt; Vector a -&gt; a
</span><span class="hs-identifier hs-var">V.sum</span></span><span> </span><span class="annot"><span class="annottext">Vector Double
</span><a href="#local-6989586621679100645"><span class="hs-identifier hs-var">probs</span></a></span><span>
</span><span id="line-773"></span><span>
</span><span id="line-774"></span><span class="hs-comment">-- Geometric (from 0)</span><span>
</span><span id="line-775"></span><span class="hs-comment">-- ------------------</span><span>
</span><span id="line-776"></span><span>
</span><span id="line-777"></span><span class="hs-keyword">data</span><span> </span><span id="Geometric0"><span class="annot"><a href="Inference.Conjugate.html#Geometric0"><span class="hs-identifier hs-var">Geometric0</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Geometric0"><span class="annot"><a href="Inference.Conjugate.html#Geometric0"><span class="hs-identifier hs-var">Geometric0</span></a></span></span><span>
</span><span id="line-778"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679100650"><span id="local-6989586621679100652"><span class="annot"><span class="annottext">Geometric0 -&gt; Geometric0 -&gt; Bool
(Geometric0 -&gt; Geometric0 -&gt; Bool)
-&gt; (Geometric0 -&gt; Geometric0 -&gt; Bool) -&gt; Eq Geometric0
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: Geometric0 -&gt; Geometric0 -&gt; Bool
== :: Geometric0 -&gt; Geometric0 -&gt; Bool
$c/= :: Geometric0 -&gt; Geometric0 -&gt; Bool
/= :: Geometric0 -&gt; Geometric0 -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679100658"><span id="local-6989586621679100660"><span id="local-6989586621679100662"><span id="local-6989586621679100666"><span id="local-6989586621679100669"><span id="local-6989586621679100672"><span id="local-6989586621679100675"><span class="annot"><span class="annottext">Eq Geometric0
Eq Geometric0 =&gt;
(Geometric0 -&gt; Geometric0 -&gt; Ordering)
-&gt; (Geometric0 -&gt; Geometric0 -&gt; Bool)
-&gt; (Geometric0 -&gt; Geometric0 -&gt; Bool)
-&gt; (Geometric0 -&gt; Geometric0 -&gt; Bool)
-&gt; (Geometric0 -&gt; Geometric0 -&gt; Bool)
-&gt; (Geometric0 -&gt; Geometric0 -&gt; Geometric0)
-&gt; (Geometric0 -&gt; Geometric0 -&gt; Geometric0)
-&gt; Ord Geometric0
Geometric0 -&gt; Geometric0 -&gt; Bool
Geometric0 -&gt; Geometric0 -&gt; Ordering
Geometric0 -&gt; Geometric0 -&gt; Geometric0
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
$ccompare :: Geometric0 -&gt; Geometric0 -&gt; Ordering
compare :: Geometric0 -&gt; Geometric0 -&gt; Ordering
$c&lt; :: Geometric0 -&gt; Geometric0 -&gt; Bool
&lt; :: Geometric0 -&gt; Geometric0 -&gt; Bool
$c&lt;= :: Geometric0 -&gt; Geometric0 -&gt; Bool
&lt;= :: Geometric0 -&gt; Geometric0 -&gt; Bool
$c&gt; :: Geometric0 -&gt; Geometric0 -&gt; Bool
&gt; :: Geometric0 -&gt; Geometric0 -&gt; Bool
$c&gt;= :: Geometric0 -&gt; Geometric0 -&gt; Bool
&gt;= :: Geometric0 -&gt; Geometric0 -&gt; Bool
$cmax :: Geometric0 -&gt; Geometric0 -&gt; Geometric0
max :: Geometric0 -&gt; Geometric0 -&gt; Geometric0
$cmin :: Geometric0 -&gt; Geometric0 -&gt; Geometric0
min :: Geometric0 -&gt; Geometric0 -&gt; Geometric0
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679100678"><span id="local-6989586621679100680"><span id="local-6989586621679100684"><span class="annot"><span class="annottext">Int -&gt; Geometric0 -&gt; ShowS
[Geometric0] -&gt; ShowS
Geometric0 -&gt; String
(Int -&gt; Geometric0 -&gt; ShowS)
-&gt; (Geometric0 -&gt; String)
-&gt; ([Geometric0] -&gt; ShowS)
-&gt; Show Geometric0
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; Geometric0 -&gt; ShowS
showsPrec :: Int -&gt; Geometric0 -&gt; ShowS
$cshow :: Geometric0 -&gt; String
show :: Geometric0 -&gt; String
$cshowList :: [Geometric0] -&gt; ShowS
showList :: [Geometric0] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679100687"><span id="local-6989586621679100689"><span class="annot"><span class="annottext">(forall x. Geometric0 -&gt; Rep Geometric0 x)
-&gt; (forall x. Rep Geometric0 x -&gt; Geometric0) -&gt; Generic Geometric0
forall x. Rep Geometric0 x -&gt; Geometric0
forall x. Geometric0 -&gt; Rep Geometric0 x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x. Geometric0 -&gt; Rep Geometric0 x
from :: forall x. Geometric0 -&gt; Rep Geometric0 x
$cto :: forall x. Rep Geometric0 x -&gt; Geometric0
to :: forall x. Rep Geometric0 x -&gt; Geometric0
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-779"></span><span>
</span><span id="line-780"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Distribution"><span class="hs-identifier hs-type">Distribution</span></a></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Geometric0"><span class="hs-identifier hs-type">Geometric0</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-781"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Params"><span class="annot"><a href="Inference.Conjugate.html#Params"><span class="hs-identifier hs-var">Params</span></a></span></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Geometric0"><span class="hs-identifier hs-type">Geometric0</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-782"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Support"><span class="annot"><a href="Inference.Conjugate.html#Support"><span class="hs-identifier hs-var">Support</span></a></span></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Geometric0"><span class="hs-identifier hs-type">Geometric0</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-783"></span><span>  </span><span id="local-6989586621679100697"><span class="annot"><span class="annottext">distSample :: forall (m :: * -&gt; *).
PrimMonad m =&gt;
Geometric0 -&gt; Params Geometric0 -&gt; Prob m (Support Geometric0)
</span><a href="Inference.Conjugate.html#distSample"><span class="hs-identifier hs-var hs-var hs-var">distSample</span></a></span></span><span> </span><span class="annot"><span class="annottext">Geometric0
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Prob m Int
Params Geometric0 -&gt; Prob m (Support Geometric0)
forall {m :: * -&gt; *} {b}.
(PrimMonad m, Num b) =&gt;
Double -&gt; Prob m b
</span><a href="#local-6989586621679100698"><span class="hs-identifier hs-var">geometric0</span></a></span><span>
</span><span id="line-784"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-785"></span><span>    </span><span id="local-6989586621679100698"><span class="annot"><span class="annottext">geometric0 :: Double -&gt; Prob m b
</span><a href="#local-6989586621679100698"><span class="hs-identifier hs-var hs-var">geometric0</span></a></span></span><span> </span><span id="local-6989586621679100718"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100718"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-786"></span><span>      </span><span id="local-6989586621679100719"><span class="annot"><a href="#local-6989586621679100719"><span class="hs-identifier hs-var">coin</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Prob m Bool
forall (m :: * -&gt; *). PrimMonad m =&gt; Double -&gt; Prob m Bool
</span><span class="hs-identifier hs-var">bernoulli</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100718"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-787"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621679100719"><span class="hs-identifier hs-type">coin</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="hs-operator">+</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621679100698"><span class="hs-identifier hs-type">geometric0</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679100718"><span class="hs-identifier hs-type">p</span></a></span><span>
</span><span id="line-788"></span><span>  </span><span id="local-6989586621679100730"><span class="annot"><span class="annottext">distLogP :: Geometric0 -&gt; Params Geometric0 -&gt; Support Geometric0 -&gt; Double
</span><a href="Inference.Conjugate.html#distLogP"><span class="hs-identifier hs-var hs-var hs-var">distLogP</span></a></span></span><span> </span><span class="annot"><span class="annottext">Geometric0
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679100731"><span class="annot"><span class="annottext">Params Geometric0
</span><a href="#local-6989586621679100731"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679100732"><span class="annot"><span class="annottext">Support Geometric0
</span><a href="#local-6989586621679100732"><span class="hs-identifier hs-var">val</span></a></span></span><span>
</span><span id="line-789"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
Support Geometric0
</span><a href="#local-6989586621679100732"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">log</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
Params Geometric0
</span><a href="#local-6989586621679100731"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
</span><span class="hs-identifier hs-var">int2Double</span></span><span> </span><span class="annot"><span class="annottext">Int
Support Geometric0
</span><a href="#local-6989586621679100732"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">log</span></span><span> </span><span class="annot"><span class="annottext">Double
Params Geometric0
</span><a href="#local-6989586621679100731"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-790"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">log</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span>
</span><span id="line-791"></span><span>
</span><span id="line-792"></span><span class="hs-comment">-- Geometric (from 1)</span><span>
</span><span id="line-793"></span><span class="hs-comment">-- ------------------</span><span>
</span><span id="line-794"></span><span>
</span><span id="line-795"></span><span class="hs-keyword">data</span><span> </span><span id="Geometric1"><span class="annot"><a href="Inference.Conjugate.html#Geometric1"><span class="hs-identifier hs-var">Geometric1</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Geometric1"><span class="annot"><a href="Inference.Conjugate.html#Geometric1"><span class="hs-identifier hs-var">Geometric1</span></a></span></span><span>
</span><span id="line-796"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679100735"><span id="local-6989586621679100737"><span class="annot"><span class="annottext">Geometric1 -&gt; Geometric1 -&gt; Bool
(Geometric1 -&gt; Geometric1 -&gt; Bool)
-&gt; (Geometric1 -&gt; Geometric1 -&gt; Bool) -&gt; Eq Geometric1
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: Geometric1 -&gt; Geometric1 -&gt; Bool
== :: Geometric1 -&gt; Geometric1 -&gt; Bool
$c/= :: Geometric1 -&gt; Geometric1 -&gt; Bool
/= :: Geometric1 -&gt; Geometric1 -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679100743"><span id="local-6989586621679100745"><span id="local-6989586621679100747"><span id="local-6989586621679100751"><span id="local-6989586621679100754"><span id="local-6989586621679100757"><span id="local-6989586621679100760"><span class="annot"><span class="annottext">Eq Geometric1
Eq Geometric1 =&gt;
(Geometric1 -&gt; Geometric1 -&gt; Ordering)
-&gt; (Geometric1 -&gt; Geometric1 -&gt; Bool)
-&gt; (Geometric1 -&gt; Geometric1 -&gt; Bool)
-&gt; (Geometric1 -&gt; Geometric1 -&gt; Bool)
-&gt; (Geometric1 -&gt; Geometric1 -&gt; Bool)
-&gt; (Geometric1 -&gt; Geometric1 -&gt; Geometric1)
-&gt; (Geometric1 -&gt; Geometric1 -&gt; Geometric1)
-&gt; Ord Geometric1
Geometric1 -&gt; Geometric1 -&gt; Bool
Geometric1 -&gt; Geometric1 -&gt; Ordering
Geometric1 -&gt; Geometric1 -&gt; Geometric1
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
$ccompare :: Geometric1 -&gt; Geometric1 -&gt; Ordering
compare :: Geometric1 -&gt; Geometric1 -&gt; Ordering
$c&lt; :: Geometric1 -&gt; Geometric1 -&gt; Bool
&lt; :: Geometric1 -&gt; Geometric1 -&gt; Bool
$c&lt;= :: Geometric1 -&gt; Geometric1 -&gt; Bool
&lt;= :: Geometric1 -&gt; Geometric1 -&gt; Bool
$c&gt; :: Geometric1 -&gt; Geometric1 -&gt; Bool
&gt; :: Geometric1 -&gt; Geometric1 -&gt; Bool
$c&gt;= :: Geometric1 -&gt; Geometric1 -&gt; Bool
&gt;= :: Geometric1 -&gt; Geometric1 -&gt; Bool
$cmax :: Geometric1 -&gt; Geometric1 -&gt; Geometric1
max :: Geometric1 -&gt; Geometric1 -&gt; Geometric1
$cmin :: Geometric1 -&gt; Geometric1 -&gt; Geometric1
min :: Geometric1 -&gt; Geometric1 -&gt; Geometric1
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679100763"><span id="local-6989586621679100765"><span id="local-6989586621679100769"><span class="annot"><span class="annottext">Int -&gt; Geometric1 -&gt; ShowS
[Geometric1] -&gt; ShowS
Geometric1 -&gt; String
(Int -&gt; Geometric1 -&gt; ShowS)
-&gt; (Geometric1 -&gt; String)
-&gt; ([Geometric1] -&gt; ShowS)
-&gt; Show Geometric1
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; Geometric1 -&gt; ShowS
showsPrec :: Int -&gt; Geometric1 -&gt; ShowS
$cshow :: Geometric1 -&gt; String
show :: Geometric1 -&gt; String
$cshowList :: [Geometric1] -&gt; ShowS
showList :: [Geometric1] -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679100772"><span id="local-6989586621679100774"><span class="annot"><span class="annottext">(forall x. Geometric1 -&gt; Rep Geometric1 x)
-&gt; (forall x. Rep Geometric1 x -&gt; Geometric1) -&gt; Generic Geometric1
forall x. Rep Geometric1 x -&gt; Geometric1
forall x. Geometric1 -&gt; Rep Geometric1 x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x. Geometric1 -&gt; Rep Geometric1 x
from :: forall x. Geometric1 -&gt; Rep Geometric1 x
$cto :: forall x. Rep Geometric1 x -&gt; Geometric1
to :: forall x. Rep Geometric1 x -&gt; Geometric1
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-797"></span><span>
</span><span id="line-798"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Distribution"><span class="hs-identifier hs-type">Distribution</span></a></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Geometric1"><span class="hs-identifier hs-type">Geometric1</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-799"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Params"><span class="annot"><a href="Inference.Conjugate.html#Params"><span class="hs-identifier hs-var">Params</span></a></span></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Geometric1"><span class="hs-identifier hs-type">Geometric1</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-800"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="Support"><span class="annot"><a href="Inference.Conjugate.html#Support"><span class="hs-identifier hs-var">Support</span></a></span></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Geometric1"><span class="hs-identifier hs-type">Geometric1</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-801"></span><span>  </span><span id="local-6989586621679100782"><span class="annot"><span class="annottext">distSample :: forall (m :: * -&gt; *).
PrimMonad m =&gt;
Geometric1 -&gt; Params Geometric1 -&gt; Prob m (Support Geometric1)
</span><a href="Inference.Conjugate.html#distSample"><span class="hs-identifier hs-var hs-var hs-var">distSample</span></a></span></span><span> </span><span class="annot"><span class="annottext">Geometric1
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Prob m Int
Params Geometric1 -&gt; Prob m (Support Geometric1)
forall {m :: * -&gt; *} {b}.
(PrimMonad m, Num b) =&gt;
Double -&gt; Prob m b
</span><a href="#local-6989586621679100783"><span class="hs-identifier hs-var">geometric1</span></a></span><span>
</span><span id="line-802"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-803"></span><span>    </span><span id="local-6989586621679100783"><span class="annot"><span class="annottext">geometric1 :: Double -&gt; Prob m b
</span><a href="#local-6989586621679100783"><span class="hs-identifier hs-var hs-var">geometric1</span></a></span></span><span> </span><span id="local-6989586621679100803"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100803"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-804"></span><span>      </span><span id="local-6989586621679100804"><span class="annot"><a href="#local-6989586621679100804"><span class="hs-identifier hs-var">coin</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Prob m Bool
forall (m :: * -&gt; *). PrimMonad m =&gt; Double -&gt; Prob m Bool
</span><span class="hs-identifier hs-var">bernoulli</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100803"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-805"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><a href="#local-6989586621679100804"><span class="hs-identifier hs-type">coin</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="hs-operator">+</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">&lt;$&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621679100783"><span class="hs-identifier hs-type">geometric1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679100803"><span class="hs-identifier hs-type">p</span></a></span><span>
</span><span id="line-806"></span><span>  </span><span id="local-6989586621679100817"><span class="annot"><span class="annottext">distLogP :: Geometric1 -&gt; Params Geometric1 -&gt; Support Geometric1 -&gt; Double
</span><a href="Inference.Conjugate.html#distLogP"><span class="hs-identifier hs-var hs-var hs-var">distLogP</span></a></span></span><span> </span><span class="annot"><span class="annottext">Geometric1
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679100818"><span class="annot"><span class="annottext">Params Geometric1
</span><a href="#local-6989586621679100818"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679100819"><span class="annot"><span class="annottext">Support Geometric1
</span><a href="#local-6989586621679100819"><span class="hs-identifier hs-var">val</span></a></span></span><span>
</span><span id="line-807"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
Support Geometric1
</span><a href="#local-6989586621679100819"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">log</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
Params Geometric1
</span><a href="#local-6989586621679100818"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
</span><span class="hs-identifier hs-var">int2Double</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
Support Geometric1
</span><a href="#local-6989586621679100819"><span class="hs-identifier hs-var">val</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">log</span></span><span> </span><span class="annot"><span class="annottext">Double
Params Geometric1
</span><a href="#local-6989586621679100818"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-808"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">log</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span>
</span><span id="line-809"></span><span>
</span><span id="line-810"></span><span class="hs-comment">-----------------------------</span><span>
</span><span id="line-811"></span><span class="hs-comment">-- conjugate distributions --</span><span>
</span><span id="line-812"></span><span class="hs-comment">-----------------------------</span><span>
</span><span id="line-813"></span><span>
</span><span id="line-814"></span><span class="hs-comment">-- beta bernoulli</span><span>
</span><span id="line-815"></span><span class="hs-comment">-- --------------</span><span>
</span><span id="line-816"></span><span>
</span><span id="line-817"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Conjugate"><span class="hs-identifier hs-type">Conjugate</span></a></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Beta"><span class="hs-identifier hs-type">Beta</span></a></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Bernoulli"><span class="hs-identifier hs-type">Bernoulli</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-818"></span><span>  </span><span id="local-6989586621679100832"><span class="annot"><span class="annottext">priorSingleton :: Beta
</span><a href="Inference.Conjugate.html#priorSingleton"><span class="hs-identifier hs-var hs-var hs-var">priorSingleton</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Beta
</span><a href="Inference.Conjugate.html#Beta"><span class="hs-identifier hs-var">Beta</span></a></span><span>
</span><span id="line-819"></span><span>  </span><span id="local-6989586621679100837"><span class="annot"><span class="annottext">updatePrior :: Bernoulli -&gt; Params Beta -&gt; Support Bernoulli -&gt; Params Beta
</span><a href="Inference.Conjugate.html#updatePrior"><span class="hs-identifier hs-var hs-var hs-var">updatePrior</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bernoulli
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679100838"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100838"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679100839"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100839"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
Support Bernoulli
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100838"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100839"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-820"></span><span>  </span><span class="annot"><a href="Inference.Conjugate.html#updatePrior"><span class="hs-identifier hs-var">updatePrior</span></a></span><span> </span><span class="annot"><span class="annottext">Bernoulli
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679100840"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100840"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679100841"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100841"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
Support Bernoulli
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100840"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100841"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-821"></span><span>  </span><span id="local-6989586621679100850"><span class="annot"><span class="annottext">predLogP :: Bernoulli -&gt; Params Beta -&gt; Support Bernoulli -&gt; Double
</span><a href="Inference.Conjugate.html#predLogP"><span class="hs-identifier hs-var hs-var hs-var">predLogP</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bernoulli
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679100851"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100851"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679100852"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100852"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
Support Bernoulli
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">log</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100851"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">log</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100851"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100852"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-822"></span><span>  </span><span class="annot"><a href="Inference.Conjugate.html#predLogP"><span class="hs-identifier hs-var">predLogP</span></a></span><span> </span><span class="annot"><span class="annottext">Bernoulli
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679100853"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100853"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679100854"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100854"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
Support Bernoulli
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">log</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100854"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">log</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100853"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100854"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-823"></span><span>
</span><span id="line-824"></span><span class="hs-comment">-- B(1+a, b)   G(1+a) G(b) G(a+b)   G(1+a) G(a+b)   a G(a) G(a+b)        a</span><span>
</span><span id="line-825"></span><span class="hs-comment">-- --------- = ------------------ = ------------- = ----------------- = ---</span><span>
</span><span id="line-826"></span><span class="hs-comment">-- B(a, b)     G(a) G(b) G(a+b+1)   G(a) G(a+b+1)   G(a) (a+b) G(a+b)   a+b</span><span>
</span><span id="line-827"></span><span>
</span><span id="line-828"></span><span class="hs-comment">-- beta binomial</span><span>
</span><span id="line-829"></span><span class="hs-comment">-- -------------</span><span>
</span><span id="line-830"></span><span>
</span><span id="line-831"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Conjugate"><span class="hs-identifier hs-type">Conjugate</span></a></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Beta"><span class="hs-identifier hs-type">Beta</span></a></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Binomial"><span class="hs-identifier hs-type">Binomial</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-832"></span><span>  </span><span id="local-6989586621679100866"><span class="annot"><span class="annottext">priorSingleton :: Beta
</span><a href="Inference.Conjugate.html#priorSingleton"><span class="hs-identifier hs-var hs-var hs-var">priorSingleton</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Beta
</span><a href="Inference.Conjugate.html#Beta"><span class="hs-identifier hs-var">Beta</span></a></span><span>
</span><span id="line-833"></span><span>  </span><span id="local-6989586621679100870"><span class="annot"><span class="annottext">updatePrior :: Binomial -&gt; Params Beta -&gt; Support Binomial -&gt; Params Beta
</span><a href="Inference.Conjugate.html#updatePrior"><span class="hs-identifier hs-var hs-var hs-var">updatePrior</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Binomial"><span class="hs-identifier hs-type">Binomial</span></a></span><span> </span><span id="local-6989586621679100871"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679100871"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679100872"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100872"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679100873"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100873"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679100874"><span class="annot"><span class="annottext">Support Binomial
</span><a href="#local-6989586621679100874"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100872"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100875"><span class="hs-identifier hs-var">x'</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100873"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100876"><span class="hs-identifier hs-var">n'</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100875"><span class="hs-identifier hs-var">x'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-834"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-835"></span><span>    </span><span id="local-6989586621679100875"><span class="annot"><span class="annottext">x' :: Double
</span><a href="#local-6989586621679100875"><span class="hs-identifier hs-var hs-var">x'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
</span><span class="hs-identifier hs-var">int2Double</span></span><span> </span><span class="annot"><span class="annottext">Int
Support Binomial
</span><a href="#local-6989586621679100874"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-836"></span><span>    </span><span id="local-6989586621679100876"><span class="annot"><span class="annottext">n' :: Double
</span><a href="#local-6989586621679100876"><span class="hs-identifier hs-var hs-var">n'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
</span><span class="hs-identifier hs-var">int2Double</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679100871"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-837"></span><span>  </span><span id="local-6989586621679100882"><span class="annot"><span class="annottext">predLogP :: Binomial -&gt; Params Beta -&gt; Support Binomial -&gt; Double
</span><a href="Inference.Conjugate.html#predLogP"><span class="hs-identifier hs-var hs-var hs-var">predLogP</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Binomial"><span class="hs-identifier hs-type">Binomial</span></a></span><span> </span><span id="local-6989586621679100883"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679100883"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679100884"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100884"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679100885"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100885"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679100886"><span class="annot"><span class="annottext">Support Binomial
</span><a href="#local-6989586621679100886"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-838"></span><span>    </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Double
</span><span class="hs-identifier hs-var">logChoose</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679100883"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Int
Support Binomial
</span><a href="#local-6989586621679100886"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
</span><span class="hs-identifier hs-var">logBeta</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100887"><span class="hs-identifier hs-var">k'</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100884"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100888"><span class="hs-identifier hs-var">n'</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100887"><span class="hs-identifier hs-var">k'</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100884"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
</span><span class="hs-identifier hs-var">logBeta</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100884"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100885"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-839"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-840"></span><span>    </span><span id="local-6989586621679100888"><span class="annot"><span class="annottext">n' :: Double
</span><a href="#local-6989586621679100888"><span class="hs-identifier hs-var hs-var">n'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
</span><span class="hs-identifier hs-var">int2Double</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679100883"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-841"></span><span>    </span><span id="local-6989586621679100887"><span class="annot"><span class="annottext">k' :: Double
</span><a href="#local-6989586621679100887"><span class="hs-identifier hs-var hs-var">k'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
</span><span class="hs-identifier hs-var">int2Double</span></span><span> </span><span class="annot"><span class="annottext">Int
Support Binomial
</span><a href="#local-6989586621679100886"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-842"></span><span>
</span><span id="line-843"></span><span class="hs-comment">-- beta geometric0</span><span>
</span><span id="line-844"></span><span class="hs-comment">-- ---------------</span><span>
</span><span id="line-845"></span><span>
</span><span id="line-846"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Conjugate"><span class="hs-identifier hs-type">Conjugate</span></a></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Beta"><span class="hs-identifier hs-type">Beta</span></a></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Geometric0"><span class="hs-identifier hs-type">Geometric0</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-847"></span><span>  </span><span id="local-6989586621679100900"><span class="annot"><span class="annottext">priorSingleton :: Beta
</span><a href="Inference.Conjugate.html#priorSingleton"><span class="hs-identifier hs-var hs-var hs-var">priorSingleton</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Beta
</span><a href="Inference.Conjugate.html#Beta"><span class="hs-identifier hs-var">Beta</span></a></span><span>
</span><span id="line-848"></span><span>  </span><span id="local-6989586621679100904"><span class="annot"><span class="annottext">updatePrior :: Geometric0 -&gt; Params Beta -&gt; Support Geometric0 -&gt; Params Beta
</span><a href="Inference.Conjugate.html#updatePrior"><span class="hs-identifier hs-var hs-var hs-var">updatePrior</span></a></span></span><span> </span><span class="annot"><span class="annottext">Geometric0
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679100905"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100905"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679100906"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100906"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679100907"><span class="annot"><span class="annottext">Support Geometric0
</span><a href="#local-6989586621679100907"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100905"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100906"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
</span><span class="hs-identifier hs-var">int2Double</span></span><span> </span><span class="annot"><span class="annottext">Int
Support Geometric0
</span><a href="#local-6989586621679100907"><span class="hs-identifier hs-var">k</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-849"></span><span>  </span><span id="local-6989586621679100919"><span class="annot"><span class="annottext">predLogP :: Geometric0 -&gt; Params Beta -&gt; Support Geometric0 -&gt; Double
</span><a href="Inference.Conjugate.html#predLogP"><span class="hs-identifier hs-var hs-var hs-var">predLogP</span></a></span></span><span> </span><span class="annot"><span class="annottext">Geometric0
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679100920"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100920"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679100921"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100921"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679100922"><span class="annot"><span class="annottext">Support Geometric0
</span><a href="#local-6989586621679100922"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-850"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">log</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100920"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
</span><span class="hs-identifier hs-var">logGamma</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100920"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100921"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
</span><span class="hs-identifier hs-var">logGamma</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100923"><span class="hs-identifier hs-var">k'</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100921"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-851"></span><span>      </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
</span><span class="hs-identifier hs-var">logGamma</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100921"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
</span><span class="hs-identifier hs-var">logGamma</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100920"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100921"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100923"><span class="hs-identifier hs-var">k'</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-852"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-853"></span><span>    </span><span id="local-6989586621679100923"><span class="annot"><span class="annottext">k' :: Double
</span><a href="#local-6989586621679100923"><span class="hs-identifier hs-var hs-var">k'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
</span><span class="hs-identifier hs-var">int2Double</span></span><span> </span><span class="annot"><span class="annottext">Int
Support Geometric0
</span><a href="#local-6989586621679100922"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-854"></span><span>
</span><span id="line-855"></span><span class="hs-comment">-- beta geometric1</span><span>
</span><span id="line-856"></span><span class="hs-comment">-- ---------------</span><span>
</span><span id="line-857"></span><span>
</span><span id="line-858"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Conjugate"><span class="hs-identifier hs-type">Conjugate</span></a></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Beta"><span class="hs-identifier hs-type">Beta</span></a></span><span> </span><span class="annot"><a href="Inference.Conjugate.html#Geometric1"><span class="hs-identifier hs-type">Geometric1</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-859"></span><span>  </span><span id="local-6989586621679100935"><span class="annot"><span class="annottext">priorSingleton :: Beta
</span><a href="Inference.Conjugate.html#priorSingleton"><span class="hs-identifier hs-var hs-var hs-var">priorSingleton</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Beta
</span><a href="Inference.Conjugate.html#Beta"><span class="hs-identifier hs-var">Beta</span></a></span><span>
</span><span id="line-860"></span><span>  </span><span id="local-6989586621679100941"><span class="annot"><span class="annottext">updatePrior :: Geometric1 -&gt; Params Beta -&gt; Support Geometric1 -&gt; Params Beta
</span><a href="Inference.Conjugate.html#updatePrior"><span class="hs-identifier hs-var hs-var hs-var">updatePrior</span></a></span></span><span> </span><span class="annot"><span class="annottext">Geometric1
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679100942"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100942"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679100943"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100943"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679100944"><span class="annot"><span class="annottext">Support Geometric1
</span><a href="#local-6989586621679100944"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100942"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100943"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
</span><span class="hs-identifier hs-var">int2Double</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
Support Geometric1
</span><a href="#local-6989586621679100944"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-861"></span><span>  </span><span id="local-6989586621679100958"><span class="annot"><span class="annottext">predLogP :: Geometric1 -&gt; Params Beta -&gt; Support Geometric1 -&gt; Double
</span><a href="Inference.Conjugate.html#predLogP"><span class="hs-identifier hs-var hs-var hs-var">predLogP</span></a></span></span><span> </span><span class="annot"><span class="annottext">Geometric1
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679100959"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100959"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679100960"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100960"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679100961"><span class="annot"><span class="annottext">Support Geometric1
</span><a href="#local-6989586621679100961"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-862"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">log</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100959"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
</span><span class="hs-identifier hs-var">logGamma</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100959"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100960"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
</span><span class="hs-identifier hs-var">logGamma</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100962"><span class="hs-identifier hs-var">k'</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100960"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-863"></span><span>      </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Double
</span><span class="hs-identifier hs-var">logGamma</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100960"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
</span><span class="hs-identifier hs-var">logGamma</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100959"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100960"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679100962"><span class="hs-identifier hs-var">k'</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-864"></span><span>   </span><span class="hs-keyword">where</span><span>
</span><span id="line-865"></span><span>    </span><span id="local-6989586621679100962"><span class="annot"><span class="annottext">k' :: Double
</span><a href="#local-6989586621679100962"><span class="hs-identifier hs-var hs-var">k'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Double
</span><span class="hs-identifier hs-var">int2Double</span></span><span> </span><span class="annot"><span class="annottext">Int
Support Geometric1
</span><a href="#local-6989586621679100961"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span>
</span><span id="line-866"></span><span>
</span><span id="line-867"></span><span class="hs-comment">-- dirichlet categorical</span><span>
</span><span id="line-868"></span><span class="hs-comment">-- ---------------------</span><span>
</span><span id="line-869"></span><span>
</span><span id="line-870"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679098580"><span class="annot"><a href="Inference.Conjugate.html#Conjugate"><span class="hs-identifier hs-type">Conjugate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Dirichlet"><span class="hs-identifier hs-type">Dirichlet</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098580"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Inference.Conjugate.html#Categorical"><span class="hs-identifier hs-type">Categorical</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098580"><span class="hs-identifier hs-type">n</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-871"></span><span>  </span><span id="local-6989586621679100974"><span class="annot"><span class="annottext">priorSingleton :: Dirichlet n
</span><a href="Inference.Conjugate.html#priorSingleton"><span class="hs-identifier hs-var hs-var hs-var">priorSingleton</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Dirichlet n
forall (n :: Nat). Dirichlet n
</span><a href="Inference.Conjugate.html#Dirichlet"><span class="hs-identifier hs-var">Dirichlet</span></a></span><span>
</span><span id="line-872"></span><span>  </span><span id="local-6989586621679100980"><span class="annot"><span class="annottext">updatePrior :: Categorical n
-&gt; Params (Dirichlet n)
-&gt; Support (Categorical n)
-&gt; Params (Dirichlet n)
</span><a href="Inference.Conjugate.html#updatePrior"><span class="hs-identifier hs-var hs-var hs-var">updatePrior</span></a></span></span><span> </span><span class="annot"><span class="annottext">Categorical n
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679100981"><span class="annot"><span class="annottext">Params (Dirichlet n)
</span><a href="#local-6989586621679100981"><span class="hs-identifier hs-var">counts</span></a></span></span><span> </span><span id="local-6989586621679100982"><span class="annot"><span class="annottext">Support (Categorical n)
</span><a href="#local-6989586621679100982"><span class="hs-identifier hs-var">obs</span></a></span></span><span>
</span><span id="line-873"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
Support (Categorical n)
</span><a href="#local-6989586621679100982"><span class="hs-identifier hs-var">obs</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span>
</span><span id="line-874"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
Support (Categorical n)
</span><a href="#local-6989586621679100982"><span class="hs-identifier hs-var">obs</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="annot"><span class="annottext">Vector Double -&gt; Int
forall a. Vector a -&gt; Int
</span><span class="hs-identifier hs-var">V.length</span></span><span> </span><span class="annot"><span class="annottext">Vector Double
Params (Dirichlet n)
</span><a href="#local-6989586621679100981"><span class="hs-identifier hs-var">counts</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-875"></span><span>        </span><span class="annot"><span class="annottext">Vector Double
Params (Dirichlet n)
</span><a href="#local-6989586621679100981"><span class="hs-identifier hs-var">counts</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Double -&gt; [(Int, Double)] -&gt; Vector Double
forall a. Vector a -&gt; [(Int, a)] -&gt; Vector a
</span><span class="hs-operator hs-var">V.//</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
Support (Categorical n)
</span><a href="#local-6989586621679100982"><span class="hs-identifier hs-var">obs</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector Double
Params (Dirichlet n)
</span><a href="#local-6989586621679100981"><span class="hs-identifier hs-var">counts</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Double -&gt; Int -&gt; Double
forall a. Vector a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">V.!</span></span><span> </span><span class="annot"><span class="annottext">Int
Support (Categorical n)
</span><a href="#local-6989586621679100982"><span class="hs-identifier hs-var">obs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-876"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-877"></span><span>        </span><span class="annot"><span class="annottext">Params (Dirichlet n)
</span><a href="#local-6989586621679100981"><span class="hs-identifier hs-var">counts</span></a></span><span>
</span><span id="line-878"></span><span>  </span><span id="local-6989586621679100990"><span class="annot"><span class="annottext">predLogP :: Categorical n
-&gt; Params (Dirichlet n) -&gt; Support (Categorical n) -&gt; Double
</span><a href="Inference.Conjugate.html#predLogP"><span class="hs-identifier hs-var hs-var hs-var">predLogP</span></a></span></span><span> </span><span class="annot"><span class="annottext">Categorical n
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679100991"><span class="annot"><span class="annottext">Params (Dirichlet n)
</span><a href="#local-6989586621679100991"><span class="hs-identifier hs-var">counts</span></a></span></span><span> </span><span id="local-6989586621679100992"><span class="annot"><span class="annottext">Support (Categorical n)
</span><a href="#local-6989586621679100992"><span class="hs-identifier hs-var">obs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-879"></span><span>    </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">log</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double -&gt; Maybe Double -&gt; Double
forall a. a -&gt; Maybe a -&gt; a
</span><span class="hs-identifier hs-var">fromMaybe</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">(Maybe Double -&gt; Double) -&gt; Maybe Double -&gt; Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Vector Double
Params (Dirichlet n)
</span><a href="#local-6989586621679100991"><span class="hs-identifier hs-var">counts</span></a></span><span> </span><span class="annot"><span class="annottext">Vector Double -&gt; Int -&gt; Maybe Double
forall a. Vector a -&gt; Int -&gt; Maybe a
</span><span class="hs-operator hs-var">V.!?</span></span><span> </span><span class="annot"><span class="annottext">Int
Support (Categorical n)
</span><a href="#local-6989586621679100992"><span class="hs-identifier hs-var">obs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double
forall a. Floating a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">log</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Vector Double -&gt; Double
forall a. Num a =&gt; Vector a -&gt; a
</span><span class="hs-identifier hs-var">V.sum</span></span><span> </span><span class="annot"><span class="annottext">Vector Double
Params (Dirichlet n)
</span><a href="#local-6989586621679100991"><span class="hs-identifier hs-var">counts</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-880"></span><span>
</span><span id="line-881"></span><span class="hs-comment">-- utilities and helpers</span><span>
</span><span id="line-882"></span><span class="hs-comment">-- =====================</span><span>
</span><span id="line-883"></span><span>
</span><span id="line-884"></span><span id="local-6989586621679098111"><span id="local-6989586621679098112"><span class="annot"><a href="Inference.Conjugate.html#replicateMWithI"><span class="hs-identifier hs-type">replicateMWithI</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Applicative</span></span><span> </span><span class="annot"><a href="#local-6989586621679098111"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679098111"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679098112"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679098111"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679098112"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-885"></span><span id="replicateMWithI"><span class="annot"><span class="annottext">replicateMWithI :: forall (m :: * -&gt; *) a.
Applicative m =&gt;
Int -&gt; (Int -&gt; m a) -&gt; m [a]
</span><a href="Inference.Conjugate.html#replicateMWithI"><span class="hs-identifier hs-var hs-var">replicateMWithI</span></a></span></span><span> </span><span id="local-6989586621679101002"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679101002"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621679101003"><span class="annot"><span class="annottext">Int -&gt; m a
</span><a href="#local-6989586621679101003"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Int -&gt; m a) -&gt; [Int] -&gt; m [a]
forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
forall (f :: * -&gt; *) a b.
Applicative f =&gt;
(a -&gt; f b) -&gt; [a] -&gt; f [b]
</span><span class="hs-identifier hs-var">traverse</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; m a
</span><a href="#local-6989586621679101003"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679101002"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">]</span><span>
</span><span id="line-886"></span></pre></body></html>