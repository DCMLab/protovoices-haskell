<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# language DeriveGeneric #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# language GeneralizedNewtypeDeriving #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# language OverloadedStrings #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# language PackageImports #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# language ScopedTypeVariables #-}</span><span>
</span><span id="line-6"></span><span>
</span><span id="line-7"></span><span class="annot"><span class="hs-comment">{- |
A progress bar in the terminal.

A progress bar conveys the progress of a task. Use a progress bar to
provide a visual cue that processing is underway.
-}</span></span><span>
</span><span id="line-13"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="System.ProgressBar.html"><span class="hs-identifier">System.ProgressBar</span></a></span><span>
</span><span id="line-14"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- * Getting started</span></span><span>
</span><span id="line-15"></span><span>      </span><span class="annot"><span class="hs-comment">-- $start</span></span><span>
</span><span id="line-16"></span><span>
</span><span id="line-17"></span><span>      </span><span class="annot"><span class="hs-comment">-- * Example</span></span><span>
</span><span id="line-18"></span><span>      </span><span class="annot"><span class="hs-comment">-- $example</span></span><span>
</span><span id="line-19"></span><span>
</span><span id="line-20"></span><span>      </span><span class="annot"><span class="hs-comment">-- * Progress bars</span></span><span>
</span><span id="line-21"></span><span>      </span><span class="annot"><a href="System.ProgressBar.html#ProgressBar"><span class="hs-identifier">ProgressBar</span></a></span><span>
</span><span id="line-22"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.ProgressBar.html#newProgressBar"><span class="hs-identifier">newProgressBar</span></a></span><span>
</span><span id="line-23"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.ProgressBar.html#hNewProgressBar"><span class="hs-identifier">hNewProgressBar</span></a></span><span>
</span><span id="line-24"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.ProgressBar.html#renderProgressBar"><span class="hs-identifier">renderProgressBar</span></a></span><span>
</span><span id="line-25"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.ProgressBar.html#updateProgress"><span class="hs-identifier">updateProgress</span></a></span><span>
</span><span id="line-26"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.ProgressBar.html#incProgress"><span class="hs-identifier">incProgress</span></a></span><span>
</span><span id="line-27"></span><span>      </span><span class="annot"><span class="hs-comment">-- * Options</span></span><span>
</span><span id="line-28"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.ProgressBar.html#Style"><span class="hs-identifier">Style</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.ProgressBar.html#EscapeCode"><span class="hs-identifier">EscapeCode</span></a></span><span>
</span><span id="line-30"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.ProgressBar.html#OnComplete"><span class="hs-identifier">OnComplete</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.ProgressBar.html#defStyle"><span class="hs-identifier">defStyle</span></a></span><span>
</span><span id="line-32"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.ProgressBar.html#ProgressBarWidth"><span class="hs-identifier">ProgressBarWidth</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span>      </span><span class="annot"><span class="hs-comment">-- * Progress</span></span><span>
</span><span id="line-34"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.ProgressBar.html#Progress"><span class="hs-identifier">Progress</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span>      </span><span class="annot"><span class="hs-comment">-- * Labels</span></span><span>
</span><span id="line-36"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.ProgressBar.html#Label"><span class="hs-identifier">Label</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.ProgressBar.html#Timing"><span class="hs-identifier">Timing</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.ProgressBar.html#msg"><span class="hs-identifier">msg</span></a></span><span>
</span><span id="line-39"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.ProgressBar.html#percentage"><span class="hs-identifier">percentage</span></a></span><span>
</span><span id="line-40"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.ProgressBar.html#exact"><span class="hs-identifier">exact</span></a></span><span>
</span><span id="line-41"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.ProgressBar.html#elapsedTime"><span class="hs-identifier">elapsedTime</span></a></span><span>
</span><span id="line-42"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.ProgressBar.html#remainingTime"><span class="hs-identifier">remainingTime</span></a></span><span>
</span><span id="line-43"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.ProgressBar.html#totalTime"><span class="hs-identifier">totalTime</span></a></span><span>
</span><span id="line-44"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.ProgressBar.html#renderDuration"><span class="hs-identifier">renderDuration</span></a></span><span>
</span><span id="line-45"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="hs-string">&quot;base&quot;</span><span> </span><span class="annot"><span class="hs-identifier">Control.Concurrent.MVar</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">MVar</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">newMVar</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">modifyMVar_</span></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="hs-string">&quot;base&quot;</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">when</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="hs-string">&quot;base&quot;</span><span> </span><span class="annot"><span class="hs-identifier">Data.Int</span></span><span>       </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Int64</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="hs-string">&quot;base&quot;</span><span> </span><span class="annot"><span class="hs-identifier">Data.Monoid</span></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Monoid</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">mempty</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="hs-string">&quot;base&quot;</span><span> </span><span class="annot"><span class="hs-identifier">Data.Ratio</span></span><span>     </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Ratio</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(%)</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="hs-string">&quot;base&quot;</span><span> </span><span class="annot"><span class="hs-identifier">Data.Semigroup</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Semigroup</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(&lt;&gt;)</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="hs-string">&quot;base&quot;</span><span> </span><span class="annot"><span class="hs-identifier">Data.String</span></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">IsString</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">fromString</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="hs-string">&quot;base&quot;</span><span> </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span>   </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Generic</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="hs-string">&quot;base&quot;</span><span> </span><span class="annot"><span class="hs-identifier">System.IO</span></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">Handle</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">stderr</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">hFlush</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="hs-string">&quot;deepseq&quot;</span><span> </span><span class="annot"><span class="hs-identifier">Control.DeepSeq</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">NFData</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">rnf</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-string">&quot;terminal-size&quot;</span><span> </span><span class="annot"><span class="hs-identifier">System.Console.Terminal.Size</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">TS</span></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-string">&quot;text&quot;</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text.Lazy</span></span><span>             </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">TL</span></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-string">&quot;text&quot;</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text.Lazy.Builder</span></span><span>     </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">TLB</span></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-string">&quot;text&quot;</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text.Lazy.Builder.Int</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">TLB</span></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-string">&quot;text&quot;</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text.Lazy.IO</span></span><span>          </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">TL</span></span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="hs-string">&quot;time&quot;</span><span> </span><span class="annot"><span class="hs-identifier">Data.Time.Clock</span></span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier">UTCTime</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">NominalDiffTime</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">diffUTCTime</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">getCurrentTime</span></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span class="hs-comment">-- | A terminal progress bar.</span><span>
</span><span id="line-67"></span><span class="hs-comment">--</span><span>
</span><span id="line-68"></span><span class="hs-comment">-- A 'ProgressBar' value contains the state of a progress bar.</span><span>
</span><span id="line-69"></span><span class="hs-comment">--</span><span>
</span><span id="line-70"></span><span class="hs-comment">-- Create a progress bar with 'newProgressBar' or 'hNewProgressBar'.</span><span>
</span><span id="line-71"></span><span class="hs-comment">-- Update a progress bar with 'updateProgress' or 'incProgress'.</span><span>
</span><span id="line-72"></span><span class="hs-keyword">data</span><span> </span><span id="ProgressBar"><span class="annot"><a href="System.ProgressBar.html#ProgressBar"><span class="hs-identifier hs-var">ProgressBar</span></a></span></span><span> </span><span id="local-6989586621679063682"><span class="annot"><a href="#local-6989586621679063682"><span class="hs-identifier hs-type">s</span></a></span></span><span>
</span><span id="line-73"></span><span>   </span><span class="hs-glyph">=</span><span> </span><span id="ProgressBar"><span class="annot"><a href="System.ProgressBar.html#ProgressBar"><span class="hs-identifier hs-var">ProgressBar</span></a></span></span><span>
</span><span id="line-74"></span><span>     </span><span class="hs-special">{</span><span> </span><span id="pbStyle"><span class="annot"><span class="annottext">forall s. ProgressBar s -&gt; Style s
</span><a href="System.ProgressBar.html#pbStyle"><span class="hs-identifier hs-var hs-var">pbStyle</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="System.ProgressBar.html#Style"><span class="hs-identifier hs-type">Style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063682"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span>     </span><span class="hs-special">,</span><span> </span><span id="pbStateMv"><span class="annot"><span class="annottext">forall s. ProgressBar s -&gt; MVar (State s)
</span><a href="System.ProgressBar.html#pbStateMv"><span class="hs-identifier hs-var hs-var">pbStateMv</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MVar</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="System.ProgressBar.html#State"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063682"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span>     </span><span class="hs-special">,</span><span> </span><span id="pbRefreshDelay"><span class="annot"><span class="annottext">forall s. ProgressBar s -&gt; Double
</span><a href="System.ProgressBar.html#pbRefreshDelay"><span class="hs-identifier hs-var hs-var">pbRefreshDelay</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-77"></span><span>     </span><span class="hs-special">,</span><span> </span><span id="pbStartTime"><span class="annot"><span class="annottext">forall s. ProgressBar s -&gt; UTCTime
</span><a href="System.ProgressBar.html#pbStartTime"><span class="hs-identifier hs-var hs-var">pbStartTime</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">UTCTime</span></span><span>
</span><span id="line-78"></span><span>     </span><span class="hs-special">,</span><span> </span><span id="pbHandle"><span class="annot"><span class="annottext">forall s. ProgressBar s -&gt; Handle
</span><a href="System.ProgressBar.html#pbHandle"><span class="hs-identifier hs-var hs-var">pbHandle</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Handle</span></span><span>
</span><span id="line-79"></span><span>     </span><span class="hs-special">}</span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679063697"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="#local-6989586621679063697"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="System.ProgressBar.html#ProgressBar"><span class="hs-identifier hs-type">ProgressBar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063697"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-82"></span><span>    </span><span id="local-6989586621679063883"><span class="annot"><span class="annottext">rnf :: ProgressBar s -&gt; ()
</span><span class="hs-identifier hs-var hs-var hs-var">rnf</span></span></span><span> </span><span id="local-6989586621679063884"><span class="annot"><span class="annottext">ProgressBar s
</span><a href="#local-6989586621679063884"><span class="hs-identifier hs-var">pb</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="annot"><span class="annottext">ProgressBar s -&gt; Style s
forall s. ProgressBar s -&gt; Style s
</span><a href="System.ProgressBar.html#pbStyle"><span class="hs-identifier hs-var">pbStyle</span></a></span><span> </span><span class="annot"><span class="annottext">ProgressBar s
</span><a href="#local-6989586621679063884"><span class="hs-identifier hs-var">pb</span></a></span><span>
</span><span id="line-83"></span><span>        </span><span class="annot"><span class="annottext">Style s -&gt; () -&gt; ()
forall a b. a -&gt; b -&gt; b
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="annot"><span class="annottext">ProgressBar s -&gt; MVar (State s)
forall s. ProgressBar s -&gt; MVar (State s)
</span><a href="System.ProgressBar.html#pbStateMv"><span class="hs-identifier hs-var">pbStateMv</span></a></span><span> </span><span class="annot"><span class="annottext">ProgressBar s
</span><a href="#local-6989586621679063884"><span class="hs-identifier hs-var">pb</span></a></span><span>
</span><span id="line-84"></span><span>        </span><span class="annot"><span class="annottext">MVar (State s) -&gt; () -&gt; ()
forall a b. a -&gt; b -&gt; b
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="annot"><span class="annottext">ProgressBar s -&gt; Double
forall s. ProgressBar s -&gt; Double
</span><a href="System.ProgressBar.html#pbRefreshDelay"><span class="hs-identifier hs-var">pbRefreshDelay</span></a></span><span> </span><span class="annot"><span class="annottext">ProgressBar s
</span><a href="#local-6989586621679063884"><span class="hs-identifier hs-var">pb</span></a></span><span>
</span><span id="line-85"></span><span>        </span><span class="annot"><span class="annottext">Double -&gt; () -&gt; ()
forall a b. a -&gt; b -&gt; b
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="annot"><span class="annottext">ProgressBar s -&gt; UTCTime
forall s. ProgressBar s -&gt; UTCTime
</span><a href="System.ProgressBar.html#pbStartTime"><span class="hs-identifier hs-var">pbStartTime</span></a></span><span> </span><span class="annot"><span class="annottext">ProgressBar s
</span><a href="#local-6989586621679063884"><span class="hs-identifier hs-var">pb</span></a></span><span>
</span><span id="line-86"></span><span>        </span><span class="hs-comment">-- pbHandle is ignored</span><span>
</span><span id="line-87"></span><span>        </span><span class="annot"><span class="annottext">UTCTime -&gt; () -&gt; ()
forall a b. a -&gt; b -&gt; b
</span><span class="hs-operator hs-var">`seq`</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span class="annot"><span class="hs-comment">-- | State of a progress bar.</span></span><span>
</span><span id="line-90"></span><span class="hs-keyword">data</span><span> </span><span id="State"><span class="annot"><a href="System.ProgressBar.html#State"><span class="hs-identifier hs-var">State</span></a></span></span><span> </span><span id="local-6989586621679063701"><span class="annot"><a href="#local-6989586621679063701"><span class="hs-identifier hs-type">s</span></a></span></span><span>
</span><span id="line-91"></span><span>   </span><span class="hs-glyph">=</span><span> </span><span id="State"><span class="annot"><a href="System.ProgressBar.html#State"><span class="hs-identifier hs-var">State</span></a></span></span><span>
</span><span id="line-92"></span><span>     </span><span class="hs-special">{</span><span> </span><span id="stProgress"><span class="annot"><span class="annottext">forall s. State s -&gt; Progress s
</span><a href="System.ProgressBar.html#stProgress"><span class="hs-identifier hs-var hs-var">stProgress</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="System.ProgressBar.html#Progress"><span class="hs-identifier hs-type">Progress</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063701"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span>       </span><span class="annot"><span class="hs-comment">-- ^ Current progress.</span></span><span>
</span><span id="line-94"></span><span>     </span><span class="hs-special">,</span><span> </span><span id="stRenderTime"><span class="annot"><span class="annottext">forall s. State s -&gt; UTCTime
</span><a href="System.ProgressBar.html#stRenderTime"><span class="hs-identifier hs-var hs-var">stRenderTime</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">UTCTime</span></span><span>
</span><span id="line-95"></span><span>       </span><span class="annot"><span class="hs-comment">-- ^ Moment in time of last render.</span></span><span>
</span><span id="line-96"></span><span>     </span><span class="hs-special">}</span><span>
</span><span id="line-97"></span><span>
</span><span id="line-98"></span><span class="annot"><span class="hs-comment">-- | An amount of progress.</span></span><span>
</span><span id="line-99"></span><span class="hs-keyword">data</span><span> </span><span id="Progress"><span class="annot"><a href="System.ProgressBar.html#Progress"><span class="hs-identifier hs-var">Progress</span></a></span></span><span> </span><span id="local-6989586621679063705"><span class="annot"><a href="#local-6989586621679063705"><span class="hs-identifier hs-type">s</span></a></span></span><span>
</span><span id="line-100"></span><span>   </span><span class="hs-glyph">=</span><span> </span><span id="Progress"><span class="annot"><a href="System.ProgressBar.html#Progress"><span class="hs-identifier hs-var">Progress</span></a></span></span><span>
</span><span id="line-101"></span><span>     </span><span class="hs-special">{</span><span> </span><span id="progressDone"><span class="annot"><span class="annottext">forall s. Progress s -&gt; Int
</span><a href="System.ProgressBar.html#progressDone"><span class="hs-identifier hs-var hs-var">progressDone</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-102"></span><span>       </span><span class="annot"><span class="hs-comment">-- ^ Amount of work completed.</span></span><span>
</span><span id="line-103"></span><span>     </span><span class="hs-special">,</span><span> </span><span id="progressTodo"><span class="annot"><span class="annottext">forall s. Progress s -&gt; Int
</span><a href="System.ProgressBar.html#progressTodo"><span class="hs-identifier hs-var hs-var">progressTodo</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-104"></span><span>       </span><span class="annot"><span class="hs-comment">-- ^ Total amount of work.</span></span><span>
</span><span id="line-105"></span><span>     </span><span class="hs-special">,</span><span> </span><span id="progressCustom"><span class="annot"><span class="annottext">forall s. Progress s -&gt; s
</span><a href="System.ProgressBar.html#progressCustom"><span class="hs-identifier hs-var hs-var">progressCustom</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679063705"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-106"></span><span>       </span><span class="hs-comment">-- ^ A value which is used by custom labels. The builtin labels</span><span>
</span><span id="line-107"></span><span>       </span><span class="hs-comment">-- do not care about this field. You can ignore it by using the</span><span>
</span><span id="line-108"></span><span>       </span><span class="hs-comment">-- unit value '()'.</span><span>
</span><span id="line-109"></span><span>     </span><span class="hs-special">}</span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span id="local-6989586621679063709"><span class="annot"><a href="System.ProgressBar.html#progressFinished"><span class="hs-identifier hs-type">progressFinished</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.ProgressBar.html#Progress"><span class="hs-identifier hs-type">Progress</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063709"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span></span><span>
</span><span id="line-112"></span><span id="progressFinished"><span class="annot"><span class="annottext">progressFinished :: forall s. Progress s -&gt; Bool
</span><a href="System.ProgressBar.html#progressFinished"><span class="hs-identifier hs-var hs-var">progressFinished</span></a></span></span><span> </span><span id="local-6989586621679063895"><span class="annot"><span class="annottext">Progress s
</span><a href="#local-6989586621679063895"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Progress s -&gt; Int
forall s. Progress s -&gt; Int
</span><a href="System.ProgressBar.html#progressDone"><span class="hs-identifier hs-var">progressDone</span></a></span><span> </span><span class="annot"><span class="annottext">Progress s
</span><a href="#local-6989586621679063895"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Progress s -&gt; Int
forall s. Progress s -&gt; Int
</span><a href="System.ProgressBar.html#progressTodo"><span class="hs-identifier hs-var">progressTodo</span></a></span><span> </span><span class="annot"><span class="annottext">Progress s
</span><a href="#local-6989586621679063895"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span class="hs-comment">-- | Creates a progress bar.</span><span>
</span><span id="line-115"></span><span class="hs-comment">--</span><span>
</span><span id="line-116"></span><span class="hs-comment">-- The progress bar is drawn immediately. Update the progress bar with</span><span>
</span><span id="line-117"></span><span class="hs-comment">-- 'updateProgress' or 'incProgress'. Do not output anything to your</span><span>
</span><span id="line-118"></span><span class="hs-comment">-- terminal between updates. It will mess up the animation.</span><span>
</span><span id="line-119"></span><span class="hs-comment">--</span><span>
</span><span id="line-120"></span><span class="hs-comment">-- The progress bar is written to 'stderr'. Write to another handle</span><span>
</span><span id="line-121"></span><span class="hs-comment">-- with 'hNewProgressBar'.</span><span>
</span><span id="line-122"></span><span id="local-6989586621679063712"><span class="annot"><a href="System.ProgressBar.html#newProgressBar"><span class="hs-identifier hs-type">newProgressBar</span></a></span><span>
</span><span id="line-123"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.ProgressBar.html#Style"><span class="hs-identifier hs-type">Style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063712"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Visual style of the progress bar.</span></span><span>
</span><span id="line-124"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Maximum refresh rate in Hertz.</span></span><span>
</span><span id="line-125"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="System.ProgressBar.html#Progress"><span class="hs-identifier hs-type">Progress</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063712"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Initial progress.</span></span><span>
</span><span id="line-126"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="System.ProgressBar.html#ProgressBar"><span class="hs-identifier hs-type">ProgressBar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063712"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-127"></span><span id="newProgressBar"><span class="annot"><span class="annottext">newProgressBar :: forall s. Style s -&gt; Double -&gt; Progress s -&gt; IO (ProgressBar s)
</span><a href="System.ProgressBar.html#newProgressBar"><span class="hs-identifier hs-var hs-var">newProgressBar</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; Style s -&gt; Double -&gt; Progress s -&gt; IO (ProgressBar s)
forall s.
Handle -&gt; Style s -&gt; Double -&gt; Progress s -&gt; IO (ProgressBar s)
</span><a href="System.ProgressBar.html#hNewProgressBar"><span class="hs-identifier hs-var">hNewProgressBar</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stderr</span></span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span class="hs-comment">-- | Creates a progress bar which outputs to the given handle.</span><span>
</span><span id="line-130"></span><span class="hs-comment">--</span><span>
</span><span id="line-131"></span><span class="hs-comment">-- See 'newProgressBar'.</span><span>
</span><span id="line-132"></span><span id="local-6989586621679063714"><span class="annot"><a href="System.ProgressBar.html#hNewProgressBar"><span class="hs-identifier hs-type">hNewProgressBar</span></a></span><span>
</span><span id="line-133"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Handle</span></span><span>
</span><span id="line-134"></span><span>       </span><span class="hs-comment">-- ^ File handle on which the progress bar is drawn. Usually</span><span>
</span><span id="line-135"></span><span>       </span><span class="hs-comment">-- you select a standard stream like 'stderr' or 'stdout'.</span><span>
</span><span id="line-136"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="System.ProgressBar.html#Style"><span class="hs-identifier hs-type">Style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063714"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Visual style of the progress bar.</span></span><span>
</span><span id="line-137"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Maximum refresh rate in Hertz.</span></span><span>
</span><span id="line-138"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="System.ProgressBar.html#Progress"><span class="hs-identifier hs-type">Progress</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063714"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Initial progress.</span></span><span>
</span><span id="line-139"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="System.ProgressBar.html#ProgressBar"><span class="hs-identifier hs-type">ProgressBar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063714"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-140"></span><span id="hNewProgressBar"><span class="annot"><span class="annottext">hNewProgressBar :: forall s.
Handle -&gt; Style s -&gt; Double -&gt; Progress s -&gt; IO (ProgressBar s)
</span><a href="System.ProgressBar.html#hNewProgressBar"><span class="hs-identifier hs-var hs-var">hNewProgressBar</span></a></span></span><span> </span><span id="local-6989586621679063905"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679063905"><span class="hs-identifier hs-var">hndl</span></a></span></span><span> </span><span id="local-6989586621679063906"><span class="annot"><span class="annottext">Style s
</span><a href="#local-6989586621679063906"><span class="hs-identifier hs-var">style</span></a></span></span><span> </span><span id="local-6989586621679063907"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679063907"><span class="hs-identifier hs-var">maxRefreshRate</span></a></span></span><span> </span><span id="local-6989586621679063908"><span class="annot"><span class="annottext">Progress s
</span><a href="#local-6989586621679063908"><span class="hs-identifier hs-var">initProgress</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-141"></span><span>    </span><span id="local-6989586621679063909"><span class="annot"><a href="#local-6989586621679063909"><span class="hs-identifier hs-var">style'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Style s -&gt; IO (Style s)
forall s. Style s -&gt; IO (Style s)
</span><a href="System.ProgressBar.html#updateWidth"><span class="hs-identifier hs-var">updateWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Style s
</span><a href="#local-6989586621679063906"><span class="hs-identifier hs-var">style</span></a></span><span>
</span><span id="line-142"></span><span>
</span><span id="line-143"></span><span>    </span><span id="local-6989586621679063911"><span class="annot"><a href="#local-6989586621679063911"><span class="hs-identifier hs-var">startTime</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">getCurrentTime</span></span><span>
</span><span id="line-144"></span><span>    </span><span class="annot"><a href="System.ProgressBar.html#hPutProgressBar"><span class="hs-identifier hs-type">hPutProgressBar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063905"><span class="hs-identifier hs-type">hndl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063909"><span class="hs-identifier hs-type">style'</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063908"><span class="hs-identifier hs-type">initProgress</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="System.ProgressBar.html#Timing"><span class="hs-identifier hs-type">Timing</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063911"><span class="hs-identifier hs-type">startTime</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063911"><span class="hs-identifier hs-type">startTime</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span>    </span><span id="local-6989586621679063914"><span class="annot"><a href="#local-6989586621679063914"><span class="hs-identifier hs-var">stateMv</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">newMVar</span></span><span>
</span><span id="line-147"></span><span>      </span><span class="annot"><a href="System.ProgressBar.html#State"><span class="hs-identifier hs-type">State</span></a></span><span>
</span><span id="line-148"></span><span>      </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="System.ProgressBar.html#stProgress"><span class="hs-identifier hs-var">stProgress</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679063908"><span class="hs-identifier hs-type">initProgress</span></a></span><span>
</span><span id="line-149"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.ProgressBar.html#stRenderTime"><span class="hs-identifier hs-var">stRenderTime</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679063911"><span class="hs-identifier hs-type">startTime</span></a></span><span>
</span><span id="line-150"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-151"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><a href="System.ProgressBar.html#ProgressBar"><span class="hs-identifier hs-type">ProgressBar</span></a></span><span>
</span><span id="line-152"></span><span>         </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="System.ProgressBar.html#pbStyle"><span class="hs-identifier hs-var">pbStyle</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679063909"><span class="hs-identifier hs-type">style'</span></a></span><span>
</span><span id="line-153"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.ProgressBar.html#pbStateMv"><span class="hs-identifier hs-var">pbStateMv</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679063914"><span class="hs-identifier hs-type">stateMv</span></a></span><span>
</span><span id="line-154"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.ProgressBar.html#pbRefreshDelay"><span class="hs-identifier hs-var">pbRefreshDelay</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">recip</span></span><span> </span><span class="annot"><a href="#local-6989586621679063907"><span class="hs-identifier hs-type">maxRefreshRate</span></a></span><span>
</span><span id="line-155"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.ProgressBar.html#pbStartTime"><span class="hs-identifier hs-var">pbStartTime</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679063911"><span class="hs-identifier hs-type">startTime</span></a></span><span>
</span><span id="line-156"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="System.ProgressBar.html#pbHandle"><span class="hs-identifier hs-var">pbHandle</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679063905"><span class="hs-identifier hs-type">hndl</span></a></span><span>
</span><span id="line-157"></span><span>         </span><span class="hs-special">}</span><span>
</span><span id="line-158"></span><span>
</span><span id="line-159"></span><span class="annot"><span class="hs-comment">-- | Update the width based on the current terminal.</span></span><span>
</span><span id="line-160"></span><span id="local-6989586621679063716"><span class="annot"><a href="System.ProgressBar.html#updateWidth"><span class="hs-identifier hs-type">updateWidth</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.ProgressBar.html#Style"><span class="hs-identifier hs-type">Style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063716"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="System.ProgressBar.html#Style"><span class="hs-identifier hs-type">Style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063716"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-161"></span><span id="updateWidth"><span class="annot"><span class="annottext">updateWidth :: forall s. Style s -&gt; IO (Style s)
</span><a href="System.ProgressBar.html#updateWidth"><span class="hs-identifier hs-var hs-var">updateWidth</span></a></span></span><span> </span><span id="local-6989586621679063920"><span class="annot"><span class="annottext">Style s
</span><a href="#local-6989586621679063920"><span class="hs-identifier hs-var">style</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-162"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Style s -&gt; ProgressBarWidth
forall s. Style s -&gt; ProgressBarWidth
</span><a href="System.ProgressBar.html#styleWidth"><span class="hs-identifier hs-var">styleWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Style s
</span><a href="#local-6989586621679063920"><span class="hs-identifier hs-var">style</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-163"></span><span>      </span><span class="annot"><a href="System.ProgressBar.html#ConstantWidth"><span class="hs-identifier hs-type">ConstantWidth</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Style s -&gt; IO (Style s)
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">Style s
</span><a href="#local-6989586621679063920"><span class="hs-identifier hs-var">style</span></a></span><span>
</span><span id="line-164"></span><span>      </span><span class="annot"><a href="System.ProgressBar.html#TerminalWidth"><span class="hs-identifier hs-type">TerminalWidth</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-165"></span><span>        </span><span id="local-6989586621679063924"><span class="annot"><a href="#local-6989586621679063924"><span class="hs-identifier hs-var">mbWindow</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO (Maybe (Window Int))
forall n. Integral n =&gt; IO (Maybe (Window n))
</span><span class="hs-identifier hs-var">TS.size</span></span><span>
</span><span id="line-166"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">pure</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><a href="#local-6989586621679063924"><span class="hs-identifier hs-type">mbWindow</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-167"></span><span>          </span><span class="annot"><span class="annottext">Maybe (Window Int)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Style s
</span><a href="#local-6989586621679063920"><span class="hs-identifier hs-var">style</span></a></span><span>
</span><span id="line-168"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679063926"><span class="annot"><span class="annottext">Window Int
</span><a href="#local-6989586621679063926"><span class="hs-identifier hs-var">window</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Style s
</span><a href="#local-6989586621679063920"><span class="hs-identifier hs-var">style</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><a href="System.ProgressBar.html#styleWidth"><span class="hs-identifier hs-var">styleWidth</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="System.ProgressBar.html#TerminalWidth"><span class="hs-identifier hs-type">TerminalWidth</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-var">TS.width</span></span><span> </span><span class="annot"><a href="#local-6989586621679063926"><span class="hs-identifier hs-type">window</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-169"></span><span>
</span><span id="line-170"></span><span class="hs-comment">-- | Change the progress of a progress bar.</span><span>
</span><span id="line-171"></span><span class="hs-comment">--</span><span>
</span><span id="line-172"></span><span class="hs-comment">-- This function is thread safe. Multiple threads may update a single</span><span>
</span><span id="line-173"></span><span class="hs-comment">-- progress bar at the same time.</span><span>
</span><span id="line-174"></span><span class="hs-comment">--</span><span>
</span><span id="line-175"></span><span class="hs-comment">-- There is a maximum refresh rate. This means that some updates might not be drawn.</span><span>
</span><span id="line-176"></span><span class="annot"><a href="System.ProgressBar.html#updateProgress"><span class="hs-identifier hs-type">updateProgress</span></a></span><span>
</span><span id="line-177"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679063733"><span class="annot"><a href="#local-6989586621679063733"><span class="hs-identifier hs-type">s</span></a></span></span><span>
</span><span id="line-178"></span><span>     </span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="System.ProgressBar.html#ProgressBar"><span class="hs-identifier hs-type">ProgressBar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063733"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Progress bar to update.</span></span><span>
</span><span id="line-179"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="System.ProgressBar.html#Progress"><span class="hs-identifier hs-type">Progress</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063733"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="System.ProgressBar.html#Progress"><span class="hs-identifier hs-type">Progress</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063733"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-comment">-- ^ Function to change the progress.</span></span><span>
</span><span id="line-180"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-181"></span><span id="updateProgress"><span class="annot"><span class="annottext">updateProgress :: forall s. ProgressBar s -&gt; (Progress s -&gt; Progress s) -&gt; IO ()
</span><a href="System.ProgressBar.html#updateProgress"><span class="hs-identifier hs-var hs-var">updateProgress</span></a></span></span><span> </span><span id="local-6989586621679063935"><span class="annot"><span class="annottext">ProgressBar s
</span><a href="#local-6989586621679063935"><span class="hs-identifier hs-var">progressBar</span></a></span></span><span> </span><span id="local-6989586621679063936"><span class="annot"><span class="annottext">Progress s -&gt; Progress s
</span><a href="#local-6989586621679063936"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-182"></span><span>    </span><span id="local-6989586621679063937"><span class="annot"><a href="#local-6989586621679063937"><span class="hs-identifier hs-var">updateTime</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO UTCTime
</span><span class="hs-identifier hs-var">getCurrentTime</span></span><span>
</span><span id="line-183"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">modifyMVar_</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="System.ProgressBar.html#pbStateMv"><span class="hs-identifier hs-var">pbStateMv</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063935"><span class="hs-identifier hs-type">progressBar</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-type">$</span></span><span> </span><span class="annot"><a href="#local-6989586621679063938"><span class="hs-identifier hs-type">renderAndUpdate</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063937"><span class="hs-identifier hs-type">updateTime</span></a></span><span>
</span><span id="line-184"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-185"></span><span>    </span><span class="annot"><a href="#local-6989586621679063938"><span class="hs-identifier hs-type">renderAndUpdate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UTCTime</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="System.ProgressBar.html#State"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063733"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="System.ProgressBar.html#State"><span class="hs-identifier hs-type">State</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063733"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>    </span><span id="local-6989586621679063938"><span class="annot"><span class="annottext">renderAndUpdate :: UTCTime -&gt; State s -&gt; IO (State s)
</span><a href="#local-6989586621679063938"><span class="hs-identifier hs-var hs-var">renderAndUpdate</span></a></span></span><span> </span><span id="local-6989586621679063939"><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679063939"><span class="hs-identifier hs-var">updateTime</span></a></span></span><span> </span><span id="local-6989586621679063940"><span class="annot"><span class="annottext">State s
</span><a href="#local-6989586621679063940"><span class="hs-identifier hs-var">state</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-187"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679063941"><span class="hs-identifier hs-var">shouldRender</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-188"></span><span>          </span><span class="annot"><span class="annottext">Handle -&gt; Style s -&gt; Progress s -&gt; Timing -&gt; IO ()
forall s. Handle -&gt; Style s -&gt; Progress s -&gt; Timing -&gt; IO ()
</span><a href="System.ProgressBar.html#hPutProgressBar"><span class="hs-identifier hs-var">hPutProgressBar</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679063942"><span class="hs-identifier hs-var">hndl</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProgressBar s -&gt; Style s
forall s. ProgressBar s -&gt; Style s
</span><a href="System.ProgressBar.html#pbStyle"><span class="hs-identifier hs-var">pbStyle</span></a></span><span> </span><span class="annot"><span class="annottext">ProgressBar s
</span><a href="#local-6989586621679063935"><span class="hs-identifier hs-var">progressBar</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Progress s
</span><a href="#local-6989586621679063943"><span class="hs-identifier hs-var">newProgress</span></a></span><span> </span><span class="annot"><span class="annottext">Timing
</span><a href="#local-6989586621679063944"><span class="hs-identifier hs-var">timing</span></a></span><span>
</span><span id="line-189"></span><span>        </span><span class="annot"><span class="annottext">State s -&gt; IO (State s)
forall a. a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><a href="System.ProgressBar.html#State"><span class="hs-identifier hs-type">State</span></a></span><span>
</span><span id="line-190"></span><span>             </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">stProgress :: Progress s
</span><a href="System.ProgressBar.html#stProgress"><span class="hs-identifier hs-var">stProgress</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Progress s
</span><a href="#local-6989586621679063943"><span class="hs-identifier hs-var">newProgress</span></a></span><span>
</span><span id="line-191"></span><span>             </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">stRenderTime :: UTCTime
</span><a href="System.ProgressBar.html#stRenderTime"><span class="hs-identifier hs-var">stRenderTime</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679063941"><span class="hs-identifier hs-var">shouldRender</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679063939"><span class="hs-identifier hs-var">updateTime</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">State s -&gt; UTCTime
forall s. State s -&gt; UTCTime
</span><a href="System.ProgressBar.html#stRenderTime"><span class="hs-identifier hs-var">stRenderTime</span></a></span><span> </span><span class="annot"><span class="annottext">State s
</span><a href="#local-6989586621679063940"><span class="hs-identifier hs-var">state</span></a></span><span>
</span><span id="line-192"></span><span>             </span><span class="hs-special">}</span><span>
</span><span id="line-193"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-194"></span><span>        </span><span id="local-6989586621679063944"><span class="annot"><span class="annottext">timing :: Timing
</span><a href="#local-6989586621679063944"><span class="hs-identifier hs-var hs-var">timing</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="System.ProgressBar.html#Timing"><span class="hs-identifier hs-type">Timing</span></a></span><span>
</span><span id="line-195"></span><span>                 </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">timingStart :: UTCTime
</span><a href="System.ProgressBar.html#timingStart"><span class="hs-identifier hs-var">timingStart</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProgressBar s -&gt; UTCTime
forall s. ProgressBar s -&gt; UTCTime
</span><a href="System.ProgressBar.html#pbStartTime"><span class="hs-identifier hs-var">pbStartTime</span></a></span><span> </span><span class="annot"><span class="annottext">ProgressBar s
</span><a href="#local-6989586621679063935"><span class="hs-identifier hs-var">progressBar</span></a></span><span>
</span><span id="line-196"></span><span>                 </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">timingLastUpdate :: UTCTime
</span><a href="System.ProgressBar.html#timingLastUpdate"><span class="hs-identifier hs-var">timingLastUpdate</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679063939"><span class="hs-identifier hs-var">updateTime</span></a></span><span>
</span><span id="line-197"></span><span>                 </span><span class="hs-special">}</span><span>
</span><span id="line-198"></span><span>
</span><span id="line-199"></span><span>        </span><span id="local-6989586621679063941"><span class="annot"><span class="annottext">shouldRender :: Bool
</span><a href="#local-6989586621679063941"><span class="hs-identifier hs-var hs-var">shouldRender</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679063948"><span class="hs-identifier hs-var">tooFast</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679063950"><span class="hs-identifier hs-var">finished</span></a></span><span>
</span><span id="line-200"></span><span>        </span><span id="local-6989586621679063948"><span class="annot"><span class="annottext">tooFast :: Bool
</span><a href="#local-6989586621679063948"><span class="hs-identifier hs-var hs-var">tooFast</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679063953"><span class="hs-identifier hs-var">secSinceLastRender</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">ProgressBar s -&gt; Double
forall s. ProgressBar s -&gt; Double
</span><a href="System.ProgressBar.html#pbRefreshDelay"><span class="hs-identifier hs-var">pbRefreshDelay</span></a></span><span> </span><span class="annot"><span class="annottext">ProgressBar s
</span><a href="#local-6989586621679063935"><span class="hs-identifier hs-var">progressBar</span></a></span><span>
</span><span id="line-201"></span><span>        </span><span id="local-6989586621679063950"><span class="annot"><span class="annottext">finished :: Bool
</span><a href="#local-6989586621679063950"><span class="hs-identifier hs-var hs-var">finished</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Progress s -&gt; Bool
forall s. Progress s -&gt; Bool
</span><a href="System.ProgressBar.html#progressFinished"><span class="hs-identifier hs-var">progressFinished</span></a></span><span> </span><span class="annot"><span class="annottext">Progress s
</span><a href="#local-6989586621679063943"><span class="hs-identifier hs-var">newProgress</span></a></span><span>
</span><span id="line-202"></span><span>
</span><span id="line-203"></span><span>        </span><span id="local-6989586621679063943"><span class="annot"><span class="annottext">newProgress :: Progress s
</span><a href="#local-6989586621679063943"><span class="hs-identifier hs-var hs-var">newProgress</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Progress s -&gt; Progress s
</span><a href="#local-6989586621679063936"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(Progress s -&gt; Progress s) -&gt; Progress s -&gt; Progress s
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">State s -&gt; Progress s
forall s. State s -&gt; Progress s
</span><a href="System.ProgressBar.html#stProgress"><span class="hs-identifier hs-var">stProgress</span></a></span><span> </span><span class="annot"><span class="annottext">State s
</span><a href="#local-6989586621679063940"><span class="hs-identifier hs-var">state</span></a></span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span>        </span><span class="hs-comment">-- Amount of time that passed since last render, in seconds.</span><span>
</span><span id="line-206"></span><span>        </span><span class="annot"><a href="#local-6989586621679063953"><span class="hs-identifier hs-type">secSinceLastRender</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Double</span></span><span>
</span><span id="line-207"></span><span>        </span><span id="local-6989586621679063953"><span class="annot"><span class="annottext">secSinceLastRender :: Double
</span><a href="#local-6989586621679063953"><span class="hs-identifier hs-var hs-var">secSinceLastRender</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NominalDiffTime -&gt; Double
forall a b. (Real a, Fractional b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">realToFrac</span></span><span> </span><span class="annot"><span class="annottext">(NominalDiffTime -&gt; Double) -&gt; NominalDiffTime -&gt; Double
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">UTCTime -&gt; UTCTime -&gt; NominalDiffTime
</span><span class="hs-identifier hs-var">diffUTCTime</span></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679063939"><span class="hs-identifier hs-var">updateTime</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">State s -&gt; UTCTime
forall s. State s -&gt; UTCTime
</span><a href="System.ProgressBar.html#stRenderTime"><span class="hs-identifier hs-var">stRenderTime</span></a></span><span> </span><span class="annot"><span class="annottext">State s
</span><a href="#local-6989586621679063940"><span class="hs-identifier hs-var">state</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span>    </span><span id="local-6989586621679063942"><span class="annot"><span class="annottext">hndl :: Handle
</span><a href="#local-6989586621679063942"><span class="hs-identifier hs-var hs-var">hndl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProgressBar s -&gt; Handle
forall s. ProgressBar s -&gt; Handle
</span><a href="System.ProgressBar.html#pbHandle"><span class="hs-identifier hs-var">pbHandle</span></a></span><span> </span><span class="annot"><span class="annottext">ProgressBar s
</span><a href="#local-6989586621679063935"><span class="hs-identifier hs-var">progressBar</span></a></span><span>
</span><span id="line-210"></span><span>
</span><span id="line-211"></span><span class="hs-comment">-- | Increment the progress of an existing progress bar.</span><span>
</span><span id="line-212"></span><span class="hs-comment">--</span><span>
</span><span id="line-213"></span><span class="hs-comment">-- See 'updateProgress' for more information.</span><span>
</span><span id="line-214"></span><span id="local-6989586621679063739"><span class="annot"><a href="System.ProgressBar.html#incProgress"><span class="hs-identifier hs-type">incProgress</span></a></span><span>
</span><span id="line-215"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.ProgressBar.html#ProgressBar"><span class="hs-identifier hs-type">ProgressBar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063739"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Progress bar which needs an update.</span></span><span>
</span><span id="line-216"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Amount by which to increment the progress.</span></span><span>
</span><span id="line-217"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-218"></span><span id="incProgress"><span class="annot"><span class="annottext">incProgress :: forall s. ProgressBar s -&gt; Int -&gt; IO ()
</span><a href="System.ProgressBar.html#incProgress"><span class="hs-identifier hs-var hs-var">incProgress</span></a></span></span><span> </span><span id="local-6989586621679063957"><span class="annot"><span class="annottext">ProgressBar s
</span><a href="#local-6989586621679063957"><span class="hs-identifier hs-var">pb</span></a></span></span><span> </span><span id="local-6989586621679063958"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679063958"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ProgressBar s -&gt; (Progress s -&gt; Progress s) -&gt; IO ()
forall s. ProgressBar s -&gt; (Progress s -&gt; Progress s) -&gt; IO ()
</span><a href="System.ProgressBar.html#updateProgress"><span class="hs-identifier hs-var">updateProgress</span></a></span><span> </span><span class="annot"><span class="annottext">ProgressBar s
</span><a href="#local-6989586621679063957"><span class="hs-identifier hs-var">pb</span></a></span><span> </span><span class="annot"><span class="annottext">((Progress s -&gt; Progress s) -&gt; IO ())
-&gt; (Progress s -&gt; Progress s) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679063959"><span class="annot"><span class="annottext">Progress s
</span><a href="#local-6989586621679063959"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Progress s
</span><a href="#local-6989586621679063959"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">{</span><span> </span><span class="annot"><a href="System.ProgressBar.html#progressDone"><span class="hs-identifier hs-var">progressDone</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="System.ProgressBar.html#progressDone"><span class="hs-identifier hs-var">progressDone</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063959"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><a href="#local-6989586621679063958"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-219"></span><span>
</span><span id="line-220"></span><span id="local-6989586621679063718"><span class="annot"><a href="System.ProgressBar.html#hPutProgressBar"><span class="hs-identifier hs-type">hPutProgressBar</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Handle</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="System.ProgressBar.html#Style"><span class="hs-identifier hs-type">Style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063718"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="System.ProgressBar.html#Progress"><span class="hs-identifier hs-type">Progress</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063718"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="System.ProgressBar.html#Timing"><span class="hs-identifier hs-type">Timing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-221"></span><span id="hPutProgressBar"><span class="annot"><span class="annottext">hPutProgressBar :: forall s. Handle -&gt; Style s -&gt; Progress s -&gt; Timing -&gt; IO ()
</span><a href="System.ProgressBar.html#hPutProgressBar"><span class="hs-identifier hs-var hs-var">hPutProgressBar</span></a></span></span><span> </span><span id="local-6989586621679063967"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679063967"><span class="hs-identifier hs-var">hndl</span></a></span></span><span> </span><span id="local-6989586621679063968"><span class="annot"><span class="annottext">Style s
</span><a href="#local-6989586621679063968"><span class="hs-identifier hs-var">style</span></a></span></span><span> </span><span id="local-6989586621679063969"><span class="annot"><span class="annottext">Progress s
</span><a href="#local-6989586621679063969"><span class="hs-identifier hs-var">progress</span></a></span></span><span> </span><span id="local-6989586621679063970"><span class="annot"><span class="annottext">Timing
</span><a href="#local-6989586621679063970"><span class="hs-identifier hs-var">timing</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-222"></span><span>    </span><span class="annot"><span class="annottext">Handle -&gt; Text -&gt; IO ()
</span><span class="hs-identifier hs-var">TL.hPutStr</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679063967"><span class="hs-identifier hs-var">hndl</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; IO ()) -&gt; Text -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Style s -&gt; Progress s -&gt; Timing -&gt; Text
forall s. Style s -&gt; Progress s -&gt; Timing -&gt; Text
</span><a href="System.ProgressBar.html#renderProgressBar"><span class="hs-identifier hs-var">renderProgressBar</span></a></span><span> </span><span class="annot"><span class="annottext">Style s
</span><a href="#local-6989586621679063968"><span class="hs-identifier hs-var">style</span></a></span><span> </span><span class="annot"><span class="annottext">Progress s
</span><a href="#local-6989586621679063969"><span class="hs-identifier hs-var">progress</span></a></span><span> </span><span class="annot"><span class="annottext">Timing
</span><a href="#local-6989586621679063970"><span class="hs-identifier hs-var">timing</span></a></span><span>
</span><span id="line-223"></span><span>    </span><span class="annot"><span class="annottext">Handle -&gt; Text -&gt; IO ()
</span><span class="hs-identifier hs-var">TL.hPutStr</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679063967"><span class="hs-identifier hs-var">hndl</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; IO ()) -&gt; Text -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-224"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Progress s -&gt; Bool
forall s. Progress s -&gt; Bool
</span><a href="System.ProgressBar.html#progressFinished"><span class="hs-identifier hs-var">progressFinished</span></a></span><span> </span><span class="annot"><span class="annottext">Progress s
</span><a href="#local-6989586621679063969"><span class="hs-identifier hs-var">progress</span></a></span><span>
</span><span id="line-225"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Style s -&gt; OnComplete
forall s. Style s -&gt; OnComplete
</span><a href="System.ProgressBar.html#styleOnComplete"><span class="hs-identifier hs-var">styleOnComplete</span></a></span><span> </span><span class="annot"><span class="annottext">Style s
</span><a href="#local-6989586621679063968"><span class="hs-identifier hs-var">style</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-226"></span><span>             </span><span class="annot"><span class="annottext">OnComplete
</span><a href="System.ProgressBar.html#WriteNewline"><span class="hs-identifier hs-var">WriteNewline</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;\n&quot;</span></span><span>
</span><span id="line-227"></span><span>             </span><span class="hs-comment">-- Move to beginning of line and then clear everything to</span><span>
</span><span id="line-228"></span><span>             </span><span class="hs-comment">-- the right of the cursor.</span><span>
</span><span id="line-229"></span><span>             </span><span class="annot"><span class="annottext">OnComplete
</span><a href="System.ProgressBar.html#Clear"><span class="hs-identifier hs-var">Clear</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;\r\ESC[K&quot;</span></span><span>
</span><span id="line-230"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;\r&quot;</span></span><span>
</span><span id="line-231"></span><span>    </span><span class="annot"><span class="annottext">Handle -&gt; IO ()
</span><span class="hs-identifier hs-var">hFlush</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679063967"><span class="hs-identifier hs-var">hndl</span></a></span><span>
</span><span id="line-232"></span><span>
</span><span id="line-233"></span><span class="hs-comment">-- | Renders a progress bar.</span><span>
</span><span id="line-234"></span><span class="hs-comment">--</span><span>
</span><span id="line-235"></span><span class="hs-comment">-- &gt;&gt;&gt; let t = UTCTime (ModifiedJulianDay 0) 0</span><span>
</span><span id="line-236"></span><span class="hs-comment">-- &gt;&gt;&gt; renderProgressBar defStyle (Progress 30 100 ()) (Timing t t)</span><span>
</span><span id="line-237"></span><span class="hs-comment">-- &quot;[============&gt;..............................]  30%&quot;</span><span>
</span><span id="line-238"></span><span class="hs-comment">--</span><span>
</span><span id="line-239"></span><span class="hs-comment">-- Note that this function can not use 'TerminalWidth' because it</span><span>
</span><span id="line-240"></span><span class="hs-comment">-- doesn't use 'IO'. Use 'newProgressBar' or 'hNewProgressBar' to get</span><span>
</span><span id="line-241"></span><span class="hs-comment">-- automatic width.</span><span>
</span><span id="line-242"></span><span id="local-6989586621679063743"><span class="annot"><a href="System.ProgressBar.html#renderProgressBar"><span class="hs-identifier hs-type">renderProgressBar</span></a></span><span>
</span><span id="line-243"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.ProgressBar.html#Style"><span class="hs-identifier hs-type">Style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063743"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-244"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="System.ProgressBar.html#Progress"><span class="hs-identifier hs-type">Progress</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063743"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Current progress.</span></span><span>
</span><span id="line-245"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="System.ProgressBar.html#Timing"><span class="hs-identifier hs-type">Timing</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Timing information.</span></span><span>
</span><span id="line-246"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TL.Text</span></span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Textual representation of the 'Progress' in the given 'Style'.</span></span><span>
</span><span id="line-247"></span><span id="renderProgressBar"><span class="annot"><span class="annottext">renderProgressBar :: forall s. Style s -&gt; Progress s -&gt; Timing -&gt; Text
</span><a href="System.ProgressBar.html#renderProgressBar"><span class="hs-identifier hs-var hs-var">renderProgressBar</span></a></span></span><span> </span><span id="local-6989586621679064005"><span class="annot"><span class="annottext">Style s
</span><a href="#local-6989586621679064005"><span class="hs-identifier hs-var">style</span></a></span></span><span> </span><span id="local-6989586621679064006"><span class="annot"><span class="annottext">Progress s
</span><a href="#local-6989586621679064006"><span class="hs-identifier hs-var">progress</span></a></span></span><span> </span><span id="local-6989586621679064007"><span class="annot"><span class="annottext">Timing
</span><a href="#local-6989586621679064007"><span class="hs-identifier hs-var">timing</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Text
</span><span class="hs-identifier hs-var">TL.concat</span></span><span>
</span><span id="line-248"></span><span>    </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Style s -&gt; EscapeCode s
forall s. Style s -&gt; EscapeCode s
</span><a href="System.ProgressBar.html#styleEscapePrefix"><span class="hs-identifier hs-var">styleEscapePrefix</span></a></span><span> </span><span class="annot"><span class="annottext">Style s
</span><a href="#local-6989586621679064005"><span class="hs-identifier hs-var">style</span></a></span><span> </span><span class="annot"><span class="annottext">Progress s
</span><a href="#local-6989586621679064006"><span class="hs-identifier hs-var">progress</span></a></span><span>
</span><span id="line-249"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679064010"><span class="hs-identifier hs-var">prefixLabel</span></a></span><span>
</span><span id="line-250"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679064011"><span class="hs-identifier hs-var">prefixPad</span></a></span><span>
</span><span id="line-251"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Style s -&gt; EscapeCode s
forall s. Style s -&gt; EscapeCode s
</span><a href="System.ProgressBar.html#styleEscapeOpen"><span class="hs-identifier hs-var">styleEscapeOpen</span></a></span><span> </span><span class="annot"><span class="annottext">Style s
</span><a href="#local-6989586621679064005"><span class="hs-identifier hs-var">style</span></a></span><span> </span><span class="annot"><span class="annottext">Progress s
</span><a href="#local-6989586621679064006"><span class="hs-identifier hs-var">progress</span></a></span><span>
</span><span id="line-252"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Style s -&gt; Text
forall s. Style s -&gt; Text
</span><a href="System.ProgressBar.html#styleOpen"><span class="hs-identifier hs-var">styleOpen</span></a></span><span> </span><span class="annot"><span class="annottext">Style s
</span><a href="#local-6989586621679064005"><span class="hs-identifier hs-var">style</span></a></span><span>
</span><span id="line-253"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Style s -&gt; EscapeCode s
forall s. Style s -&gt; EscapeCode s
</span><a href="System.ProgressBar.html#styleEscapeDone"><span class="hs-identifier hs-var">styleEscapeDone</span></a></span><span> </span><span class="annot"><span class="annottext">Style s
</span><a href="#local-6989586621679064005"><span class="hs-identifier hs-var">style</span></a></span><span> </span><span class="annot"><span class="annottext">Progress s
</span><a href="#local-6989586621679064006"><span class="hs-identifier hs-var">progress</span></a></span><span>
</span><span id="line-254"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">TL.replicate</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679064016"><span class="hs-identifier hs-var">completed</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; Text -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Text
</span><span class="hs-identifier hs-var">TL.singleton</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Text) -&gt; Char -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Style s -&gt; Char
forall s. Style s -&gt; Char
</span><a href="System.ProgressBar.html#styleDone"><span class="hs-identifier hs-var">styleDone</span></a></span><span> </span><span class="annot"><span class="annottext">Style s
</span><a href="#local-6989586621679064005"><span class="hs-identifier hs-var">style</span></a></span><span>
</span><span id="line-255"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Style s -&gt; EscapeCode s
forall s. Style s -&gt; EscapeCode s
</span><a href="System.ProgressBar.html#styleEscapeCurrent"><span class="hs-identifier hs-var">styleEscapeCurrent</span></a></span><span> </span><span class="annot"><span class="annottext">Style s
</span><a href="#local-6989586621679064005"><span class="hs-identifier hs-var">style</span></a></span><span> </span><span class="annot"><span class="annottext">Progress s
</span><a href="#local-6989586621679064006"><span class="hs-identifier hs-var">progress</span></a></span><span>
</span><span id="line-256"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679064020"><span class="hs-identifier hs-var">remaining</span></a></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Int64 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679064016"><span class="hs-identifier hs-var">completed</span></a></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Int64 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><span class="hs-number">0</span></span><span>
</span><span id="line-257"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Text
</span><span class="hs-identifier hs-var">TL.singleton</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Text) -&gt; Char -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Style s -&gt; Char
forall s. Style s -&gt; Char
</span><a href="System.ProgressBar.html#styleCurrent"><span class="hs-identifier hs-var">styleCurrent</span></a></span><span> </span><span class="annot"><span class="annottext">Style s
</span><a href="#local-6989586621679064005"><span class="hs-identifier hs-var">style</span></a></span><span>
</span><span id="line-258"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-259"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Style s -&gt; EscapeCode s
forall s. Style s -&gt; EscapeCode s
</span><a href="System.ProgressBar.html#styleEscapeTodo"><span class="hs-identifier hs-var">styleEscapeTodo</span></a></span><span> </span><span class="annot"><span class="annottext">Style s
</span><a href="#local-6989586621679064005"><span class="hs-identifier hs-var">style</span></a></span><span> </span><span class="annot"><span class="annottext">Progress s
</span><a href="#local-6989586621679064006"><span class="hs-identifier hs-var">progress</span></a></span><span>
</span><span id="line-260"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">TL.replicate</span></span><span>
</span><span id="line-261"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679064020"><span class="hs-identifier hs-var">remaining</span></a></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Int64 -&gt; Int64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679064016"><span class="hs-identifier hs-var">completed</span></a></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Int64 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Int64
</span><span class="hs-number">1</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Int64
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-262"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Text
</span><span class="hs-identifier hs-var">TL.singleton</span></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Text) -&gt; Char -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Style s -&gt; Char
forall s. Style s -&gt; Char
</span><a href="System.ProgressBar.html#styleTodo"><span class="hs-identifier hs-var">styleTodo</span></a></span><span> </span><span class="annot"><span class="annottext">Style s
</span><a href="#local-6989586621679064005"><span class="hs-identifier hs-var">style</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-263"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Style s -&gt; EscapeCode s
forall s. Style s -&gt; EscapeCode s
</span><a href="System.ProgressBar.html#styleEscapeClose"><span class="hs-identifier hs-var">styleEscapeClose</span></a></span><span> </span><span class="annot"><span class="annottext">Style s
</span><a href="#local-6989586621679064005"><span class="hs-identifier hs-var">style</span></a></span><span> </span><span class="annot"><span class="annottext">Progress s
</span><a href="#local-6989586621679064006"><span class="hs-identifier hs-var">progress</span></a></span><span>
</span><span id="line-264"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Style s -&gt; Text
forall s. Style s -&gt; Text
</span><a href="System.ProgressBar.html#styleClose"><span class="hs-identifier hs-var">styleClose</span></a></span><span> </span><span class="annot"><span class="annottext">Style s
</span><a href="#local-6989586621679064005"><span class="hs-identifier hs-var">style</span></a></span><span>
</span><span id="line-265"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Style s -&gt; EscapeCode s
forall s. Style s -&gt; EscapeCode s
</span><a href="System.ProgressBar.html#styleEscapePostfix"><span class="hs-identifier hs-var">styleEscapePostfix</span></a></span><span> </span><span class="annot"><span class="annottext">Style s
</span><a href="#local-6989586621679064005"><span class="hs-identifier hs-var">style</span></a></span><span> </span><span class="annot"><span class="annottext">Progress s
</span><a href="#local-6989586621679064006"><span class="hs-identifier hs-var">progress</span></a></span><span>
</span><span id="line-266"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679064029"><span class="hs-identifier hs-var">postfixPad</span></a></span><span>
</span><span id="line-267"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679064030"><span class="hs-identifier hs-var">postfixLabel</span></a></span><span>
</span><span id="line-268"></span><span>    </span><span class="hs-special">]</span><span>
</span><span id="line-269"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-270"></span><span>    </span><span id="local-6989586621679064033"><span class="annot"><span class="annottext">todo :: Int64
</span><a href="#local-6989586621679064033"><span class="hs-identifier hs-var hs-var">todo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int64) -&gt; Int -&gt; Int64
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Progress s -&gt; Int
forall s. Progress s -&gt; Int
</span><a href="System.ProgressBar.html#progressTodo"><span class="hs-identifier hs-var">progressTodo</span></a></span><span> </span><span class="annot"><span class="annottext">Progress s
</span><a href="#local-6989586621679064006"><span class="hs-identifier hs-var">progress</span></a></span><span>
</span><span id="line-271"></span><span>    </span><span id="local-6989586621679064036"><span class="annot"><span class="annottext">done :: Int64
</span><a href="#local-6989586621679064036"><span class="hs-identifier hs-var hs-var">done</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int64) -&gt; Int -&gt; Int64
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Progress s -&gt; Int
forall s. Progress s -&gt; Int
</span><a href="System.ProgressBar.html#progressDone"><span class="hs-identifier hs-var">progressDone</span></a></span><span> </span><span class="annot"><span class="annottext">Progress s
</span><a href="#local-6989586621679064006"><span class="hs-identifier hs-var">progress</span></a></span><span>
</span><span id="line-272"></span><span>    </span><span class="hs-comment">-- Amount of (visible) characters that should be used to display to progress bar.</span><span>
</span><span id="line-273"></span><span>    </span><span id="local-6989586621679064039"><span class="annot"><span class="annottext">width :: Int64
</span><a href="#local-6989586621679064039"><span class="hs-identifier hs-var hs-var">width</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int64
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Int64) -&gt; Int -&gt; Int64
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ProgressBarWidth -&gt; Int
</span><a href="System.ProgressBar.html#getProgressBarWidth"><span class="hs-identifier hs-var">getProgressBarWidth</span></a></span><span> </span><span class="annot"><span class="annottext">(ProgressBarWidth -&gt; Int) -&gt; ProgressBarWidth -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Style s -&gt; ProgressBarWidth
forall s. Style s -&gt; ProgressBarWidth
</span><a href="System.ProgressBar.html#styleWidth"><span class="hs-identifier hs-var">styleWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Style s
</span><a href="#local-6989586621679064005"><span class="hs-identifier hs-var">style</span></a></span><span>
</span><span id="line-274"></span><span>
</span><span id="line-275"></span><span>    </span><span class="hs-comment">-- Amount of work completed.</span><span>
</span><span id="line-276"></span><span>    </span><span class="annot"><a href="#local-6989586621679064041"><span class="hs-identifier hs-type">fraction</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ratio</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span>
</span><span id="line-277"></span><span>    </span><span id="local-6989586621679064041"><span class="annot"><span class="annottext">fraction :: Ratio Int64
</span><a href="#local-6989586621679064041"><span class="hs-identifier hs-var hs-var">fraction</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679064033"><span class="hs-identifier hs-var">todo</span></a></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Int64 -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679064036"><span class="hs-identifier hs-var">done</span></a></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Int64 -&gt; Ratio Int64
forall a. Integral a =&gt; a -&gt; a -&gt; Ratio a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679064033"><span class="hs-identifier hs-var">todo</span></a></span><span>
</span><span id="line-278"></span><span>             </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Int64 -&gt; Ratio Int64
forall a. Integral a =&gt; a -&gt; a -&gt; Ratio a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><span class="hs-number">1</span></span><span>
</span><span id="line-279"></span><span>
</span><span id="line-280"></span><span>    </span><span class="hs-comment">-- Amount of characters available to visualize the progress.</span><span>
</span><span id="line-281"></span><span>    </span><span id="local-6989586621679064045"><span class="annot"><span class="annottext">effectiveWidth :: Int64
</span><a href="#local-6989586621679064045"><span class="hs-identifier hs-var hs-var">effectiveWidth</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Int64 -&gt; Int64
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">max</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">(Int64 -&gt; Int64) -&gt; Int64 -&gt; Int64
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679064039"><span class="hs-identifier hs-var">width</span></a></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Int64 -&gt; Int64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679064047"><span class="hs-identifier hs-var">usedSpace</span></a></span><span>
</span><span id="line-282"></span><span>    </span><span class="hs-comment">-- Amount of printing characters needed to visualize everything except the bar .</span><span>
</span><span id="line-283"></span><span>    </span><span id="local-6989586621679064047"><span class="annot"><span class="annottext">usedSpace :: Int64
</span><a href="#local-6989586621679064047"><span class="hs-identifier hs-var hs-var">usedSpace</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>   </span><span class="annot"><span class="annottext">Text -&gt; Int64
</span><span class="hs-identifier hs-var">TL.length</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Style s -&gt; Text
forall s. Style s -&gt; Text
</span><a href="System.ProgressBar.html#styleOpen"><span class="hs-identifier hs-var">styleOpen</span></a></span><span>  </span><span class="annot"><span class="annottext">Style s
</span><a href="#local-6989586621679064005"><span class="hs-identifier hs-var">style</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-284"></span><span>                </span><span class="annot"><span class="annottext">Int64 -&gt; Int64 -&gt; Int64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Int64
</span><span class="hs-identifier hs-var">TL.length</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Style s -&gt; Text
forall s. Style s -&gt; Text
</span><a href="System.ProgressBar.html#styleClose"><span class="hs-identifier hs-var">styleClose</span></a></span><span> </span><span class="annot"><span class="annottext">Style s
</span><a href="#local-6989586621679064005"><span class="hs-identifier hs-var">style</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-285"></span><span>                </span><span class="annot"><span class="annottext">Int64 -&gt; Int64 -&gt; Int64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Int64
</span><span class="hs-identifier hs-var">TL.length</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679064010"><span class="hs-identifier hs-var">prefixLabel</span></a></span><span>
</span><span id="line-286"></span><span>                </span><span class="annot"><span class="annottext">Int64 -&gt; Int64 -&gt; Int64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Int64
</span><span class="hs-identifier hs-var">TL.length</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679064030"><span class="hs-identifier hs-var">postfixLabel</span></a></span><span>
</span><span id="line-287"></span><span>                </span><span class="annot"><span class="annottext">Int64 -&gt; Int64 -&gt; Int64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Int64
</span><span class="hs-identifier hs-var">TL.length</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679064011"><span class="hs-identifier hs-var">prefixPad</span></a></span><span>
</span><span id="line-288"></span><span>                </span><span class="annot"><span class="annottext">Int64 -&gt; Int64 -&gt; Int64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Int64
</span><span class="hs-identifier hs-var">TL.length</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679064029"><span class="hs-identifier hs-var">postfixPad</span></a></span><span>
</span><span id="line-289"></span><span>
</span><span id="line-290"></span><span>    </span><span class="hs-comment">-- Number of characters needed to represent the amount of work</span><span>
</span><span id="line-291"></span><span>    </span><span class="hs-comment">-- that is completed. Note that this can not always be represented</span><span>
</span><span id="line-292"></span><span>    </span><span class="hs-comment">-- by an integer.</span><span>
</span><span id="line-293"></span><span>    </span><span class="annot"><a href="#local-6989586621679064054"><span class="hs-identifier hs-type">numCompletedChars</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ratio</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span>
</span><span id="line-294"></span><span>    </span><span id="local-6989586621679064054"><span class="annot"><span class="annottext">numCompletedChars :: Ratio Int64
</span><a href="#local-6989586621679064054"><span class="hs-identifier hs-var hs-var">numCompletedChars</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ratio Int64
</span><a href="#local-6989586621679064041"><span class="hs-identifier hs-var">fraction</span></a></span><span> </span><span class="annot"><span class="annottext">Ratio Int64 -&gt; Ratio Int64 -&gt; Ratio Int64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679064045"><span class="hs-identifier hs-var">effectiveWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Int64 -&gt; Ratio Int64
forall a. Integral a =&gt; a -&gt; a -&gt; Ratio a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-295"></span><span>
</span><span id="line-296"></span><span>    </span><span class="annot"><a href="#local-6989586621679064016"><span class="hs-identifier hs-type">completed</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679064020"><span class="hs-identifier hs-type">remaining</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int64</span></span><span>
</span><span id="line-297"></span><span>    </span><span id="local-6989586621679064016"><span class="annot"><span class="annottext">completed :: Int64
</span><a href="#local-6989586621679064016"><span class="hs-identifier hs-var hs-var">completed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Int64 -&gt; Int64
forall a. Ord a =&gt; a -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">min</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679064045"><span class="hs-identifier hs-var">effectiveWidth</span></a></span><span> </span><span class="annot"><span class="annottext">(Int64 -&gt; Int64) -&gt; Int64 -&gt; Int64
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Ratio Int64 -&gt; Int64
forall b. Integral b =&gt; Ratio Int64 -&gt; b
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">floor</span></span><span> </span><span class="annot"><span class="annottext">Ratio Int64
</span><a href="#local-6989586621679064054"><span class="hs-identifier hs-var">numCompletedChars</span></a></span><span>
</span><span id="line-298"></span><span>    </span><span id="local-6989586621679064020"><span class="annot"><span class="annottext">remaining :: Int64
</span><a href="#local-6989586621679064020"><span class="hs-identifier hs-var hs-var">remaining</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679064045"><span class="hs-identifier hs-var">effectiveWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Int64 -&gt; Int64
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679064016"><span class="hs-identifier hs-var">completed</span></a></span><span>
</span><span id="line-299"></span><span>
</span><span id="line-300"></span><span>    </span><span class="annot"><a href="#local-6989586621679064010"><span class="hs-identifier hs-type">prefixLabel</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679064030"><span class="hs-identifier hs-type">postfixLabel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TL.Text</span></span><span>
</span><span id="line-301"></span><span>    </span><span id="local-6989586621679064010"><span class="annot"><span class="annottext">prefixLabel :: Text
</span><a href="#local-6989586621679064010"><span class="hs-identifier hs-var hs-var">prefixLabel</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label s -&gt; Progress s -&gt; Timing -&gt; Text
forall s. Label s -&gt; Progress s -&gt; Timing -&gt; Text
</span><a href="System.ProgressBar.html#runLabel"><span class="hs-identifier hs-var">runLabel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Style s -&gt; Label s
forall s. Style s -&gt; Label s
</span><a href="System.ProgressBar.html#stylePrefix"><span class="hs-identifier hs-var">stylePrefix</span></a></span><span>  </span><span class="annot"><span class="annottext">Style s
</span><a href="#local-6989586621679064005"><span class="hs-identifier hs-var">style</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Progress s
</span><a href="#local-6989586621679064006"><span class="hs-identifier hs-var">progress</span></a></span><span> </span><span class="annot"><span class="annottext">Timing
</span><a href="#local-6989586621679064007"><span class="hs-identifier hs-var">timing</span></a></span><span>
</span><span id="line-302"></span><span>    </span><span id="local-6989586621679064030"><span class="annot"><span class="annottext">postfixLabel :: Text
</span><a href="#local-6989586621679064030"><span class="hs-identifier hs-var hs-var">postfixLabel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label s -&gt; Progress s -&gt; Timing -&gt; Text
forall s. Label s -&gt; Progress s -&gt; Timing -&gt; Text
</span><a href="System.ProgressBar.html#runLabel"><span class="hs-identifier hs-var">runLabel</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Style s -&gt; Label s
forall s. Style s -&gt; Label s
</span><a href="System.ProgressBar.html#stylePostfix"><span class="hs-identifier hs-var">stylePostfix</span></a></span><span> </span><span class="annot"><span class="annottext">Style s
</span><a href="#local-6989586621679064005"><span class="hs-identifier hs-var">style</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Progress s
</span><a href="#local-6989586621679064006"><span class="hs-identifier hs-var">progress</span></a></span><span> </span><span class="annot"><span class="annottext">Timing
</span><a href="#local-6989586621679064007"><span class="hs-identifier hs-var">timing</span></a></span><span>
</span><span id="line-303"></span><span>
</span><span id="line-304"></span><span>    </span><span class="annot"><a href="#local-6989586621679064011"><span class="hs-identifier hs-type">prefixPad</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679064029"><span class="hs-identifier hs-type">postfixPad</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TL.Text</span></span><span>
</span><span id="line-305"></span><span>    </span><span id="local-6989586621679064011"><span class="annot"><span class="annottext">prefixPad :: Text
</span><a href="#local-6989586621679064011"><span class="hs-identifier hs-var hs-var">prefixPad</span></a></span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><a href="System.ProgressBar.html#pad"><span class="hs-identifier hs-var">pad</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679064010"><span class="hs-identifier hs-var">prefixLabel</span></a></span><span>
</span><span id="line-306"></span><span>    </span><span id="local-6989586621679064029"><span class="annot"><span class="annottext">postfixPad :: Text
</span><a href="#local-6989586621679064029"><span class="hs-identifier hs-var hs-var">postfixPad</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text
</span><a href="System.ProgressBar.html#pad"><span class="hs-identifier hs-var">pad</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679064030"><span class="hs-identifier hs-var">postfixLabel</span></a></span><span>
</span><span id="line-307"></span><span>
</span><span id="line-308"></span><span class="annot"><a href="System.ProgressBar.html#pad"><span class="hs-identifier hs-type">pad</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TL.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TL.Text</span></span><span>
</span><span id="line-309"></span><span id="pad"><span class="annot"><span class="annottext">pad :: Text -&gt; Text
</span><a href="System.ProgressBar.html#pad"><span class="hs-identifier hs-var hs-var">pad</span></a></span></span><span> </span><span id="local-6989586621679064062"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679064062"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Bool
</span><span class="hs-identifier hs-var">TL.null</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679064062"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier hs-var">TL.empty</span></span><span>
</span><span id="line-310"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Text
</span><span class="hs-identifier hs-var">TL.singleton</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span>
</span><span id="line-311"></span><span>
</span><span id="line-312"></span><span class="annot"><span class="hs-comment">-- | Width of progress bar in characters.</span></span><span>
</span><span id="line-313"></span><span class="hs-keyword">data</span><span> </span><span id="ProgressBarWidth"><span class="annot"><a href="System.ProgressBar.html#ProgressBarWidth"><span class="hs-identifier hs-var">ProgressBarWidth</span></a></span></span><span>
</span><span id="line-314"></span><span>   </span><span class="hs-glyph">=</span><span> </span><span id="ConstantWidth"><span class="annot"><a href="System.ProgressBar.html#ConstantWidth"><span class="hs-identifier hs-var">ConstantWidth</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-315"></span><span>     </span><span class="annot"><span class="hs-comment">-- ^ A constant width.</span></span><span>
</span><span id="line-316"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span id="TerminalWidth"><span class="annot"><a href="System.ProgressBar.html#TerminalWidth"><span class="hs-identifier hs-var">TerminalWidth</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-317"></span><span>     </span><span class="hs-comment">-- ^ Use the entire width of the terminal.</span><span>
</span><span id="line-318"></span><span>     </span><span class="hs-comment">--</span><span>
</span><span id="line-319"></span><span>     </span><span class="hs-comment">-- Identical to 'ConstantWidth' if the width of the terminal can</span><span>
</span><span id="line-320"></span><span>     </span><span class="hs-comment">-- not be determined.</span><span>
</span><span id="line-321"></span><span>     </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679064066"><span id="local-6989586621679064068"><span class="annot"><span class="annottext">(forall x. ProgressBarWidth -&gt; Rep ProgressBarWidth x)
-&gt; (forall x. Rep ProgressBarWidth x -&gt; ProgressBarWidth)
-&gt; Generic ProgressBarWidth
forall x. Rep ProgressBarWidth x -&gt; ProgressBarWidth
forall x. ProgressBarWidth -&gt; Rep ProgressBarWidth x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x. ProgressBarWidth -&gt; Rep ProgressBarWidth x
from :: forall x. ProgressBarWidth -&gt; Rep ProgressBarWidth x
$cto :: forall x. Rep ProgressBarWidth x -&gt; ProgressBarWidth
to :: forall x. Rep ProgressBarWidth x -&gt; ProgressBarWidth
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-322"></span><span>
</span><span id="line-323"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679064074"><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="System.ProgressBar.html#ProgressBarWidth"><span class="hs-identifier hs-type">ProgressBarWidth</span></a></span></span><span>
</span><span id="line-324"></span><span>
</span><span id="line-325"></span><span class="annot"><a href="System.ProgressBar.html#getProgressBarWidth"><span class="hs-identifier hs-type">getProgressBarWidth</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.ProgressBar.html#ProgressBarWidth"><span class="hs-identifier hs-type">ProgressBarWidth</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-326"></span><span id="getProgressBarWidth"><span class="annot"><span class="annottext">getProgressBarWidth :: ProgressBarWidth -&gt; Int
</span><a href="System.ProgressBar.html#getProgressBarWidth"><span class="hs-identifier hs-var hs-var">getProgressBarWidth</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="System.ProgressBar.html#ConstantWidth"><span class="hs-identifier hs-type">ConstantWidth</span></a></span><span> </span><span id="local-6989586621679064090"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679064090"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679064090"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-327"></span><span class="annot"><a href="System.ProgressBar.html#getProgressBarWidth"><span class="hs-identifier hs-var">getProgressBarWidth</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="System.ProgressBar.html#TerminalWidth"><span class="hs-identifier hs-type">TerminalWidth</span></a></span><span> </span><span id="local-6989586621679064091"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679064091"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679064091"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-328"></span><span>
</span><span id="line-329"></span><span class="annot"><span class="hs-comment">{- | Visual style of a progress bar.

The style determines how a progress bar is rendered to text.

The textual representation of a progress bar follows the following template:

\&lt;__prefix__&gt;\&lt;__open__&gt;\&lt;__done__&gt;\&lt;__current__&gt;\&lt;__todo__&gt;\&lt;__close__&gt;\&lt;__postfix__&gt;

Where \&lt;__done__&gt; and \&lt;__todo__&gt; are repeated as often as necessary.

Consider the following progress bar

&gt; &quot;Working [=======&gt;.................]  30%&quot;

This bar can be specified using the following style:

@
'Style'
{ 'styleOpen'    = \&quot;[&quot;
, 'styleClose'   = \&quot;]&quot;
, 'styleDone'    = \'='
, 'styleCurrent' = \'&gt;'
, 'styleTodo'    = \'.'
, 'stylePrefix'  = 'msg' \&quot;Working&quot;
, 'stylePostfix' = 'percentage'
, 'styleWidth'   = 'ConstantWidth' 40
, 'styleEscapeOpen'    = const 'TL.empty'
, 'styleEscapeClose'   = const 'TL.empty'
, 'styleEscapeDone'    = const 'TL.empty'
, 'styleEscapeCurrent' = const 'TL.empty'
, 'styleEscapeTodo'    = const 'TL.empty'
, 'styleEscapePrefix'  = const 'TL.empty'
, 'styleEscapePostfix' = const 'TL.empty'
, 'styleOnComplete' = 'WriteNewline'
}
@
-}</span></span><span>
</span><span id="line-366"></span><span class="hs-keyword">data</span><span> </span><span id="Style"><span class="annot"><a href="System.ProgressBar.html#Style"><span class="hs-identifier hs-var">Style</span></a></span></span><span> </span><span id="local-6989586621679063725"><span class="annot"><a href="#local-6989586621679063725"><span class="hs-identifier hs-type">s</span></a></span></span><span>
</span><span id="line-367"></span><span>   </span><span class="hs-glyph">=</span><span> </span><span id="Style"><span class="annot"><a href="System.ProgressBar.html#Style"><span class="hs-identifier hs-var">Style</span></a></span></span><span>
</span><span id="line-368"></span><span>     </span><span class="hs-special">{</span><span> </span><span id="styleOpen"><span class="annot"><span class="annottext">forall s. Style s -&gt; Text
</span><a href="System.ProgressBar.html#styleOpen"><span class="hs-identifier hs-var hs-var">styleOpen</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">TL.Text</span></span><span>
</span><span id="line-369"></span><span>       </span><span class="annot"><span class="hs-comment">-- ^ Bar opening symbol.</span></span><span>
</span><span id="line-370"></span><span>     </span><span class="hs-special">,</span><span> </span><span id="styleClose"><span class="annot"><span class="annottext">forall s. Style s -&gt; Text
</span><a href="System.ProgressBar.html#styleClose"><span class="hs-identifier hs-var hs-var">styleClose</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">TL.Text</span></span><span>
</span><span id="line-371"></span><span>       </span><span class="annot"><span class="hs-comment">-- ^ Bar closing symbol</span></span><span>
</span><span id="line-372"></span><span>     </span><span class="hs-special">,</span><span> </span><span id="styleDone"><span class="annot"><span class="annottext">forall s. Style s -&gt; Char
</span><a href="System.ProgressBar.html#styleDone"><span class="hs-identifier hs-var hs-var">styleDone</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span>
</span><span id="line-373"></span><span>       </span><span class="annot"><span class="hs-comment">-- ^ Completed work.</span></span><span>
</span><span id="line-374"></span><span>     </span><span class="hs-special">,</span><span> </span><span id="styleCurrent"><span class="annot"><span class="annottext">forall s. Style s -&gt; Char
</span><a href="System.ProgressBar.html#styleCurrent"><span class="hs-identifier hs-var hs-var">styleCurrent</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span>
</span><span id="line-375"></span><span>       </span><span class="annot"><span class="hs-comment">-- ^ Symbol used to denote the current amount of work that has been done.</span></span><span>
</span><span id="line-376"></span><span>     </span><span class="hs-special">,</span><span> </span><span id="styleTodo"><span class="annot"><span class="annottext">forall s. Style s -&gt; Char
</span><a href="System.ProgressBar.html#styleTodo"><span class="hs-identifier hs-var hs-var">styleTodo</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span>
</span><span id="line-377"></span><span>       </span><span class="annot"><span class="hs-comment">-- ^ Work not yet completed.</span></span><span>
</span><span id="line-378"></span><span>     </span><span class="hs-special">,</span><span> </span><span id="stylePrefix"><span class="annot"><span class="annottext">forall s. Style s -&gt; Label s
</span><a href="System.ProgressBar.html#stylePrefix"><span class="hs-identifier hs-var hs-var">stylePrefix</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.ProgressBar.html#Label"><span class="hs-identifier hs-type">Label</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063725"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-379"></span><span>       </span><span class="annot"><span class="hs-comment">-- ^ Prefixed label.</span></span><span>
</span><span id="line-380"></span><span>     </span><span class="hs-special">,</span><span> </span><span id="stylePostfix"><span class="annot"><span class="annottext">forall s. Style s -&gt; Label s
</span><a href="System.ProgressBar.html#stylePostfix"><span class="hs-identifier hs-var hs-var">stylePostfix</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.ProgressBar.html#Label"><span class="hs-identifier hs-type">Label</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063725"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-381"></span><span>       </span><span class="annot"><span class="hs-comment">-- ^ Postfixed label.</span></span><span>
</span><span id="line-382"></span><span>     </span><span class="hs-special">,</span><span> </span><span id="styleWidth"><span class="annot"><span class="annottext">forall s. Style s -&gt; ProgressBarWidth
</span><a href="System.ProgressBar.html#styleWidth"><span class="hs-identifier hs-var hs-var">styleWidth</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="System.ProgressBar.html#ProgressBarWidth"><span class="hs-identifier hs-type">ProgressBarWidth</span></a></span><span>
</span><span id="line-383"></span><span>       </span><span class="annot"><span class="hs-comment">-- ^ Total width of the progress bar.</span></span><span>
</span><span id="line-384"></span><span>     </span><span class="hs-special">,</span><span> </span><span id="styleEscapeOpen"><span class="annot"><span class="annottext">forall s. Style s -&gt; EscapeCode s
</span><a href="System.ProgressBar.html#styleEscapeOpen"><span class="hs-identifier hs-var hs-var">styleEscapeOpen</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.ProgressBar.html#EscapeCode"><span class="hs-identifier hs-type">EscapeCode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063725"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-385"></span><span>       </span><span class="annot"><span class="hs-comment">-- ^ Escape code printed just before the 'styleOpen' symbol.</span></span><span>
</span><span id="line-386"></span><span>     </span><span class="hs-special">,</span><span> </span><span id="styleEscapeClose"><span class="annot"><span class="annottext">forall s. Style s -&gt; EscapeCode s
</span><a href="System.ProgressBar.html#styleEscapeClose"><span class="hs-identifier hs-var hs-var">styleEscapeClose</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.ProgressBar.html#EscapeCode"><span class="hs-identifier hs-type">EscapeCode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063725"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-387"></span><span>       </span><span class="annot"><span class="hs-comment">-- ^ Escape code printed just before the 'styleClose' symbol.</span></span><span>
</span><span id="line-388"></span><span>     </span><span class="hs-special">,</span><span> </span><span id="styleEscapeDone"><span class="annot"><span class="annottext">forall s. Style s -&gt; EscapeCode s
</span><a href="System.ProgressBar.html#styleEscapeDone"><span class="hs-identifier hs-var hs-var">styleEscapeDone</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.ProgressBar.html#EscapeCode"><span class="hs-identifier hs-type">EscapeCode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063725"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-389"></span><span>       </span><span class="annot"><span class="hs-comment">-- ^ Escape code printed just before the first 'styleDone' character.</span></span><span>
</span><span id="line-390"></span><span>     </span><span class="hs-special">,</span><span> </span><span id="styleEscapeCurrent"><span class="annot"><span class="annottext">forall s. Style s -&gt; EscapeCode s
</span><a href="System.ProgressBar.html#styleEscapeCurrent"><span class="hs-identifier hs-var hs-var">styleEscapeCurrent</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.ProgressBar.html#EscapeCode"><span class="hs-identifier hs-type">EscapeCode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063725"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-391"></span><span>       </span><span class="annot"><span class="hs-comment">-- ^ Escape code printed just before the 'styleCurrent' character.</span></span><span>
</span><span id="line-392"></span><span>     </span><span class="hs-special">,</span><span> </span><span id="styleEscapeTodo"><span class="annot"><span class="annottext">forall s. Style s -&gt; EscapeCode s
</span><a href="System.ProgressBar.html#styleEscapeTodo"><span class="hs-identifier hs-var hs-var">styleEscapeTodo</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.ProgressBar.html#EscapeCode"><span class="hs-identifier hs-type">EscapeCode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063725"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-393"></span><span>       </span><span class="annot"><span class="hs-comment">-- ^ Escape code printed just before the first 'styleTodo' character.</span></span><span>
</span><span id="line-394"></span><span>     </span><span class="hs-special">,</span><span> </span><span id="styleEscapePrefix"><span class="annot"><span class="annottext">forall s. Style s -&gt; EscapeCode s
</span><a href="System.ProgressBar.html#styleEscapePrefix"><span class="hs-identifier hs-var hs-var">styleEscapePrefix</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.ProgressBar.html#EscapeCode"><span class="hs-identifier hs-type">EscapeCode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063725"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-395"></span><span>       </span><span class="annot"><span class="hs-comment">-- ^ Escape code printed just before the 'stylePrefix' label.</span></span><span>
</span><span id="line-396"></span><span>     </span><span class="hs-special">,</span><span> </span><span id="styleEscapePostfix"><span class="annot"><span class="annottext">forall s. Style s -&gt; EscapeCode s
</span><a href="System.ProgressBar.html#styleEscapePostfix"><span class="hs-identifier hs-var hs-var">styleEscapePostfix</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.ProgressBar.html#EscapeCode"><span class="hs-identifier hs-type">EscapeCode</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063725"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-397"></span><span>       </span><span class="annot"><span class="hs-comment">-- ^ Escape code printed just before the 'stylePostfix' label.</span></span><span>
</span><span id="line-398"></span><span>     </span><span class="hs-special">,</span><span> </span><span id="styleOnComplete"><span class="annot"><span class="annottext">forall s. Style s -&gt; OnComplete
</span><a href="System.ProgressBar.html#styleOnComplete"><span class="hs-identifier hs-var hs-var">styleOnComplete</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="System.ProgressBar.html#OnComplete"><span class="hs-identifier hs-type">OnComplete</span></a></span><span>
</span><span id="line-399"></span><span>       </span><span class="annot"><span class="hs-comment">-- ^ What happens when progress is finished.</span></span><span>
</span><span id="line-400"></span><span>     </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679064095"><span id="local-6989586621679064097"><span class="annot"><span class="annottext">(forall x. Style s -&gt; Rep (Style s) x)
-&gt; (forall x. Rep (Style s) x -&gt; Style s) -&gt; Generic (Style s)
forall x. Rep (Style s) x -&gt; Style s
forall x. Style s -&gt; Rep (Style s) x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
forall s x. Rep (Style s) x -&gt; Style s
forall s x. Style s -&gt; Rep (Style s) x
$cfrom :: forall s x. Style s -&gt; Rep (Style s) x
from :: forall x. Style s -&gt; Rep (Style s) x
$cto :: forall s x. Rep (Style s) x -&gt; Style s
to :: forall x. Rep (Style s) x -&gt; Style s
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-401"></span><span>
</span><span id="line-402"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679063798"><span id="local-6989586621679064101"><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="#local-6989586621679063798"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="System.ProgressBar.html#Style"><span class="hs-identifier hs-type">Style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063798"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-403"></span><span>
</span><span id="line-404"></span><span class="hs-comment">-- | An escape code is a sequence of bytes which the terminal looks</span><span>
</span><span id="line-405"></span><span class="hs-comment">-- for and interprets as commands, not as character codes.</span><span>
</span><span id="line-406"></span><span class="hs-comment">--</span><span>
</span><span id="line-407"></span><span class="hs-comment">-- It is vital that the output of this function, when send to the</span><span>
</span><span id="line-408"></span><span class="hs-comment">-- terminal, does not result in characters being drawn.</span><span>
</span><span id="line-409"></span><span class="hs-keyword">type</span><span> </span><span id="EscapeCode"><span class="annot"><a href="System.ProgressBar.html#EscapeCode"><span class="hs-identifier hs-var">EscapeCode</span></a></span></span><span> </span><span id="local-6989586621679064157"><span class="annot"><a href="#local-6989586621679064157"><span class="hs-identifier hs-type">s</span></a></span></span><span>
</span><span id="line-410"></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="System.ProgressBar.html#Progress"><span class="hs-identifier hs-type">Progress</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064157"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Current progress bar state.</span></span><span>
</span><span id="line-411"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TL.Text</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Resulting escape code. Must be non-printable.</span></span><span>
</span><span id="line-412"></span><span>
</span><span id="line-413"></span><span class="annot"><span class="hs-comment">-- | What happens when a progress bar is finished.</span></span><span>
</span><span id="line-414"></span><span class="hs-keyword">data</span><span> </span><span id="OnComplete"><span class="annot"><a href="System.ProgressBar.html#OnComplete"><span class="hs-identifier hs-var">OnComplete</span></a></span></span><span>
</span><span id="line-415"></span><span>   </span><span class="hs-glyph">=</span><span> </span><span id="WriteNewline"><span class="annot"><a href="System.ProgressBar.html#WriteNewline"><span class="hs-identifier hs-var">WriteNewline</span></a></span></span><span>
</span><span id="line-416"></span><span>     </span><span class="hs-comment">-- ^ Write a new line when the progress bar is finished. The</span><span>
</span><span id="line-417"></span><span>     </span><span class="hs-comment">-- completed progress bar will remain visible.</span><span>
</span><span id="line-418"></span><span>   </span><span class="hs-glyph">|</span><span> </span><span id="Clear"><span class="annot"><a href="System.ProgressBar.html#Clear"><span class="hs-identifier hs-var">Clear</span></a></span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ Clear the progress bar once it is finished.</span></span><span>
</span><span id="line-419"></span><span>     </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679064159"><span id="local-6989586621679064161"><span class="annot"><span class="annottext">(forall x. OnComplete -&gt; Rep OnComplete x)
-&gt; (forall x. Rep OnComplete x -&gt; OnComplete) -&gt; Generic OnComplete
forall x. Rep OnComplete x -&gt; OnComplete
forall x. OnComplete -&gt; Rep OnComplete x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cfrom :: forall x. OnComplete -&gt; Rep OnComplete x
from :: forall x. OnComplete -&gt; Rep OnComplete x
$cto :: forall x. Rep OnComplete x -&gt; OnComplete
to :: forall x. Rep OnComplete x -&gt; OnComplete
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Generic</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-420"></span><span>
</span><span id="line-421"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679064164"><span class="annot"><span class="hs-identifier hs-type">NFData</span></span><span> </span><span class="annot"><a href="System.ProgressBar.html#OnComplete"><span class="hs-identifier hs-type">OnComplete</span></a></span></span><span>
</span><span id="line-422"></span><span>
</span><span id="line-423"></span><span class="hs-comment">-- | The default style.</span><span>
</span><span id="line-424"></span><span class="hs-comment">--</span><span>
</span><span id="line-425"></span><span class="hs-comment">-- This style shows the progress as a percentage. It does not use any</span><span>
</span><span id="line-426"></span><span class="hs-comment">-- escape sequences.</span><span>
</span><span id="line-427"></span><span class="hs-comment">--</span><span>
</span><span id="line-428"></span><span class="hs-comment">-- Override some fields of the default instead of specifying all the</span><span>
</span><span id="line-429"></span><span class="hs-comment">-- fields of a 'Style' record.</span><span>
</span><span id="line-430"></span><span id="local-6989586621679063801"><span class="annot"><a href="System.ProgressBar.html#defStyle"><span class="hs-identifier hs-type">defStyle</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.ProgressBar.html#Style"><span class="hs-identifier hs-type">Style</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063801"><span class="hs-identifier hs-type">s</span></a></span></span><span>
</span><span id="line-431"></span><span id="defStyle"><span class="annot"><span class="annottext">defStyle :: forall s. Style s
</span><a href="System.ProgressBar.html#defStyle"><span class="hs-identifier hs-var hs-var">defStyle</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-432"></span><span>    </span><span class="annot"><a href="System.ProgressBar.html#Style"><span class="hs-identifier hs-type">Style</span></a></span><span>
</span><span id="line-433"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">styleOpen :: Text
</span><a href="System.ProgressBar.html#styleOpen"><span class="hs-identifier hs-var">styleOpen</span></a></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;[&quot;</span></span><span>
</span><span id="line-434"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">styleClose :: Text
</span><a href="System.ProgressBar.html#styleClose"><span class="hs-identifier hs-var">styleClose</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;]&quot;</span></span><span>
</span><span id="line-435"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">styleDone :: Char
</span><a href="System.ProgressBar.html#styleDone"><span class="hs-identifier hs-var">styleDone</span></a></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'='</span></span><span>
</span><span id="line-436"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">styleCurrent :: Char
</span><a href="System.ProgressBar.html#styleCurrent"><span class="hs-identifier hs-var">styleCurrent</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'&gt;'</span></span><span>
</span><span id="line-437"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">styleTodo :: Char
</span><a href="System.ProgressBar.html#styleTodo"><span class="hs-identifier hs-var">styleTodo</span></a></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'.'</span></span><span>
</span><span id="line-438"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">stylePrefix :: Label s
</span><a href="System.ProgressBar.html#stylePrefix"><span class="hs-identifier hs-var">stylePrefix</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label s
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-439"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">stylePostfix :: Label s
</span><a href="System.ProgressBar.html#stylePostfix"><span class="hs-identifier hs-var">stylePostfix</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label s
forall s. Label s
</span><a href="System.ProgressBar.html#percentage"><span class="hs-identifier hs-var">percentage</span></a></span><span>
</span><span id="line-440"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">styleWidth :: ProgressBarWidth
</span><a href="System.ProgressBar.html#styleWidth"><span class="hs-identifier hs-var">styleWidth</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ProgressBarWidth
</span><a href="System.ProgressBar.html#TerminalWidth"><span class="hs-identifier hs-var">TerminalWidth</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">50</span></span><span>
</span><span id="line-441"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">styleEscapeOpen :: EscapeCode s
</span><a href="System.ProgressBar.html#styleEscapeOpen"><span class="hs-identifier hs-var">styleEscapeOpen</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; EscapeCode s
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier hs-var">TL.empty</span></span><span>
</span><span id="line-442"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">styleEscapeClose :: EscapeCode s
</span><a href="System.ProgressBar.html#styleEscapeClose"><span class="hs-identifier hs-var">styleEscapeClose</span></a></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; EscapeCode s
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier hs-var">TL.empty</span></span><span>
</span><span id="line-443"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">styleEscapeDone :: EscapeCode s
</span><a href="System.ProgressBar.html#styleEscapeDone"><span class="hs-identifier hs-var">styleEscapeDone</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; EscapeCode s
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier hs-var">TL.empty</span></span><span>
</span><span id="line-444"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">styleEscapeCurrent :: EscapeCode s
</span><a href="System.ProgressBar.html#styleEscapeCurrent"><span class="hs-identifier hs-var">styleEscapeCurrent</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; EscapeCode s
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier hs-var">TL.empty</span></span><span>
</span><span id="line-445"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">styleEscapeTodo :: EscapeCode s
</span><a href="System.ProgressBar.html#styleEscapeTodo"><span class="hs-identifier hs-var">styleEscapeTodo</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; EscapeCode s
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier hs-var">TL.empty</span></span><span>
</span><span id="line-446"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">styleEscapePrefix :: EscapeCode s
</span><a href="System.ProgressBar.html#styleEscapePrefix"><span class="hs-identifier hs-var">styleEscapePrefix</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; EscapeCode s
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier hs-var">TL.empty</span></span><span>
</span><span id="line-447"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">styleEscapePostfix :: EscapeCode s
</span><a href="System.ProgressBar.html#styleEscapePostfix"><span class="hs-identifier hs-var">styleEscapePostfix</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; EscapeCode s
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier hs-var">TL.empty</span></span><span>
</span><span id="line-448"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">styleOnComplete :: OnComplete
</span><a href="System.ProgressBar.html#styleOnComplete"><span class="hs-identifier hs-var">styleOnComplete</span></a></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OnComplete
</span><a href="System.ProgressBar.html#WriteNewline"><span class="hs-identifier hs-var">WriteNewline</span></a></span><span>
</span><span id="line-449"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-450"></span><span>
</span><span id="line-451"></span><span class="hs-comment">-- | A label is a part of a progress bar that changes based on the progress.</span><span>
</span><span id="line-452"></span><span class="hs-comment">--</span><span>
</span><span id="line-453"></span><span class="hs-comment">-- Labels can be at the front (prefix) or at the back (postfix) of a progress bar.</span><span>
</span><span id="line-454"></span><span class="hs-comment">--</span><span>
</span><span id="line-455"></span><span class="hs-comment">-- Labels can use both the current amount of progress and the timing</span><span>
</span><span id="line-456"></span><span class="hs-comment">-- information to generate some text.</span><span>
</span><span id="line-457"></span><span class="hs-keyword">newtype</span><span> </span><span id="Label"><span class="annot"><a href="System.ProgressBar.html#Label"><span class="hs-identifier hs-var">Label</span></a></span></span><span> </span><span id="local-6989586621679063757"><span class="annot"><a href="#local-6989586621679063757"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Label"><span class="annot"><a href="System.ProgressBar.html#Label"><span class="hs-identifier hs-var">Label</span></a></span></span><span class="hs-special">{</span><span> </span><span id="runLabel"><span class="annot"><span class="annottext">forall s. Label s -&gt; Progress s -&gt; Timing -&gt; Text
</span><a href="System.ProgressBar.html#runLabel"><span class="hs-identifier hs-var hs-var">runLabel</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.ProgressBar.html#Progress"><span class="hs-identifier hs-type">Progress</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063757"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="System.ProgressBar.html#Timing"><span class="hs-identifier hs-type">Timing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TL.Text</span></span><span> </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679064181"><span class="annot"><span class="annottext">Label s -&gt; ()
(Label s -&gt; ()) -&gt; NFData (Label s)
forall s. Label s -&gt; ()
forall a. (a -&gt; ()) -&gt; NFData a
$crnf :: forall s. Label s -&gt; ()
rnf :: Label s -&gt; ()
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></span></span><span class="hs-special">)</span><span>
</span><span id="line-458"></span><span>
</span><span id="line-459"></span><span class="annot"><span class="hs-comment">-- | Combining labels combines their output.</span></span><span>
</span><span id="line-460"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679063815"><span id="local-6989586621679064186"><span id="local-6989586621679064190"><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="System.ProgressBar.html#Label"><span class="hs-identifier hs-type">Label</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063815"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-461"></span><span>    </span><span class="annot"><a href="System.ProgressBar.html#Label"><span class="hs-identifier hs-type">Label</span></a></span><span> </span><span id="local-6989586621679064196"><span class="annot"><span class="annottext">Progress s -&gt; Timing -&gt; Text
</span><a href="#local-6989586621679064196"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679064197"><span class="annot"><span class="annottext">&lt;&gt; :: Label s -&gt; Label s -&gt; Label s
</span><span class="hs-operator hs-var hs-var hs-var">&lt;&gt;</span></span></span><span> </span><span class="annot"><a href="System.ProgressBar.html#Label"><span class="hs-identifier hs-type">Label</span></a></span><span> </span><span id="local-6989586621679064198"><span class="annot"><span class="annottext">Progress s -&gt; Timing -&gt; Text
</span><a href="#local-6989586621679064198"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Progress s -&gt; Timing -&gt; Text) -&gt; Label s
forall s. (Progress s -&gt; Timing -&gt; Text) -&gt; Label s
</span><a href="System.ProgressBar.html#Label"><span class="hs-identifier hs-var">Label</span></a></span><span> </span><span class="annot"><span class="annottext">((Progress s -&gt; Timing -&gt; Text) -&gt; Label s)
-&gt; (Progress s -&gt; Timing -&gt; Text) -&gt; Label s
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679064199"><span class="annot"><span class="annottext">Progress s
</span><a href="#local-6989586621679064199"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span id="local-6989586621679064200"><span class="annot"><span class="annottext">Timing
</span><a href="#local-6989586621679064200"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Progress s -&gt; Timing -&gt; Text
</span><a href="#local-6989586621679064196"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Progress s
</span><a href="#local-6989586621679064199"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Timing
</span><a href="#local-6989586621679064200"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Progress s -&gt; Timing -&gt; Text
</span><a href="#local-6989586621679064198"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="annot"><span class="annottext">Progress s
</span><a href="#local-6989586621679064199"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Timing
</span><a href="#local-6989586621679064200"><span class="hs-identifier hs-var">t</span></a></span><span>
</span><span id="line-462"></span><span>
</span><span id="line-463"></span><span class="annot"><span class="hs-comment">-- | The mempty label always outputs an empty text.</span></span><span>
</span><span id="line-464"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679063803"><span id="local-6989586621679064206"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="System.ProgressBar.html#Label"><span class="hs-identifier hs-type">Label</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063803"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-465"></span><span>    </span><span id="local-6989586621679064209"><span class="annot"><span class="annottext">mempty :: Label s
</span><span class="hs-identifier hs-var hs-var hs-var">mempty</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Label s
forall s. Text -&gt; Label s
</span><a href="System.ProgressBar.html#msg"><span class="hs-identifier hs-var">msg</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier hs-var">TL.empty</span></span><span>
</span><span id="line-466"></span><span>    </span><span id="local-6989586621679064211"><span class="annot"><span class="annottext">mappend :: Label s -&gt; Label s -&gt; Label s
</span><span class="hs-identifier hs-var hs-var hs-var">mappend</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Label s -&gt; Label s -&gt; Label s
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">(&lt;&gt;)</span></span><span>
</span><span id="line-467"></span><span>
</span><span id="line-468"></span><span class="hs-comment">-- | Every string is a label which ignores its input and just outputs</span><span>
</span><span id="line-469"></span><span class="hs-comment">-- that string.</span><span>
</span><span id="line-470"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679063819"><span class="annot"><span class="hs-identifier hs-type">IsString</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="System.ProgressBar.html#Label"><span class="hs-identifier hs-type">Label</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063819"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-471"></span><span>    </span><span id="local-6989586621679064215"><span class="annot"><span class="annottext">fromString :: String -&gt; Label s
</span><span class="hs-identifier hs-var hs-var hs-var">fromString</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Label s
forall s. Text -&gt; Label s
</span><a href="System.ProgressBar.html#msg"><span class="hs-identifier hs-var">msg</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Label s) -&gt; (String -&gt; Text) -&gt; String -&gt; Label s
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Text
</span><span class="hs-identifier hs-var">TL.pack</span></span><span>
</span><span id="line-472"></span><span>
</span><span id="line-473"></span><span class="hs-comment">-- | Timing information about a 'ProgressBar'.</span><span>
</span><span id="line-474"></span><span class="hs-comment">--</span><span>
</span><span id="line-475"></span><span class="hs-comment">-- This information is used by 'Label's to calculate elapsed time, remaining time, total time, etc.</span><span>
</span><span id="line-476"></span><span class="hs-comment">--</span><span>
</span><span id="line-477"></span><span class="hs-comment">-- See 'elapsedTime', 'remainingTime' and 'totalTime'.</span><span>
</span><span id="line-478"></span><span class="hs-keyword">data</span><span> </span><span id="Timing"><span class="annot"><a href="System.ProgressBar.html#Timing"><span class="hs-identifier hs-var">Timing</span></a></span></span><span>
</span><span id="line-479"></span><span>   </span><span class="hs-glyph">=</span><span> </span><span id="Timing"><span class="annot"><a href="System.ProgressBar.html#Timing"><span class="hs-identifier hs-var">Timing</span></a></span></span><span>
</span><span id="line-480"></span><span>     </span><span class="hs-special">{</span><span> </span><span id="timingStart"><span class="annot"><span class="annottext">Timing -&gt; UTCTime
</span><a href="System.ProgressBar.html#timingStart"><span class="hs-identifier hs-var hs-var">timingStart</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">UTCTime</span></span><span>
</span><span id="line-481"></span><span>       </span><span class="hs-comment">-- ^ Moment in time when a progress bar was created. See</span><span>
</span><span id="line-482"></span><span>       </span><span class="hs-comment">-- 'newProgressBar'.</span><span>
</span><span id="line-483"></span><span>     </span><span class="hs-special">,</span><span> </span><span id="timingLastUpdate"><span class="annot"><span class="annottext">Timing -&gt; UTCTime
</span><a href="System.ProgressBar.html#timingLastUpdate"><span class="hs-identifier hs-var hs-var">timingLastUpdate</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">UTCTime</span></span><span>
</span><span id="line-484"></span><span>       </span><span class="annot"><span class="hs-comment">-- ^ Moment in time of the most recent progress update.</span></span><span>
</span><span id="line-485"></span><span>     </span><span class="hs-special">}</span><span>
</span><span id="line-486"></span><span>
</span><span id="line-487"></span><span class="hs-comment">-- | Static text.</span><span>
</span><span id="line-488"></span><span class="hs-comment">--</span><span>
</span><span id="line-489"></span><span class="hs-comment">-- The output does not depend on the input.</span><span>
</span><span id="line-490"></span><span class="hs-comment">--</span><span>
</span><span id="line-491"></span><span class="hs-comment">-- &gt;&gt;&gt; msg &quot;foo&quot; st</span><span>
</span><span id="line-492"></span><span class="hs-comment">-- &quot;foo&quot;</span><span>
</span><span id="line-493"></span><span id="local-6989586621679063817"><span class="annot"><a href="System.ProgressBar.html#msg"><span class="hs-identifier hs-type">msg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TL.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="System.ProgressBar.html#Label"><span class="hs-identifier hs-type">Label</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063817"><span class="hs-identifier hs-type">s</span></a></span></span><span>
</span><span id="line-494"></span><span id="msg"><span class="annot"><span class="annottext">msg :: forall s. Text -&gt; Label s
</span><a href="System.ProgressBar.html#msg"><span class="hs-identifier hs-var hs-var">msg</span></a></span></span><span> </span><span id="local-6989586621679064217"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679064217"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Progress s -&gt; Timing -&gt; Text) -&gt; Label s
forall s. (Progress s -&gt; Timing -&gt; Text) -&gt; Label s
</span><a href="System.ProgressBar.html#Label"><span class="hs-identifier hs-var">Label</span></a></span><span> </span><span class="annot"><span class="annottext">((Progress s -&gt; Timing -&gt; Text) -&gt; Label s)
-&gt; (Progress s -&gt; Timing -&gt; Text) -&gt; Label s
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="annot"><span class="annottext">Progress s
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Timing
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679064217"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-495"></span><span>
</span><span id="line-496"></span><span class="hs-comment">-- | Progress as a percentage.</span><span>
</span><span id="line-497"></span><span class="hs-comment">--</span><span>
</span><span id="line-498"></span><span class="hs-comment">-- &gt;&gt;&gt; runLabel $ percentage (Progress 30 100 ()) someTiming</span><span>
</span><span id="line-499"></span><span class="hs-comment">-- &quot; 30%&quot;</span><span>
</span><span id="line-500"></span><span class="hs-comment">--</span><span>
</span><span id="line-501"></span><span class="hs-comment">-- __Note__: if no work is to be done (todo == 0) the percentage will</span><span>
</span><span id="line-502"></span><span class="hs-comment">-- be shown as 100%.</span><span>
</span><span id="line-503"></span><span id="local-6989586621679063805"><span class="annot"><a href="System.ProgressBar.html#percentage"><span class="hs-identifier hs-type">percentage</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.ProgressBar.html#Label"><span class="hs-identifier hs-type">Label</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063805"><span class="hs-identifier hs-type">s</span></a></span></span><span>
</span><span id="line-504"></span><span id="percentage"><span class="annot"><span class="annottext">percentage :: forall s. Label s
</span><a href="System.ProgressBar.html#percentage"><span class="hs-identifier hs-var hs-var">percentage</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Progress s -&gt; Timing -&gt; Text) -&gt; Label s
forall s. (Progress s -&gt; Timing -&gt; Text) -&gt; Label s
</span><a href="System.ProgressBar.html#Label"><span class="hs-identifier hs-var">Label</span></a></span><span> </span><span class="annot"><span class="annottext">Progress s -&gt; Timing -&gt; Text
forall {s} {p}. Progress s -&gt; p -&gt; Text
</span><a href="#local-6989586621679064218"><span class="hs-identifier hs-var">render</span></a></span><span>
</span><span id="line-505"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-506"></span><span>    </span><span id="local-6989586621679064218"><span class="annot"><span class="annottext">render :: Progress s -&gt; p -&gt; Text
</span><a href="#local-6989586621679064218"><span class="hs-identifier hs-var hs-var">render</span></a></span></span><span> </span><span id="local-6989586621679064232"><span class="annot"><span class="annottext">Progress s
</span><a href="#local-6989586621679064232"><span class="hs-identifier hs-var">progress</span></a></span></span><span> </span><span id="local-6989586621679064233"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679064233"><span class="hs-identifier hs-var">_timing</span></a></span></span><span>
</span><span id="line-507"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679064234"><span class="hs-identifier hs-var">todo</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;100%&quot;</span></span><span>
</span><span id="line-508"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Char -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">TL.justifyRight</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><span class="hs-number">4</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; Text -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Text
</span><span class="hs-identifier hs-var">TLB.toLazyText</span></span><span> </span><span class="annot"><span class="annottext">(Builder -&gt; Text) -&gt; Builder -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-509"></span><span>                      </span><span class="annot"><span class="annottext">Int -&gt; Builder
forall a. Integral a =&gt; a -&gt; Builder
</span><span class="hs-identifier hs-var">TLB.decimal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ratio Int -&gt; Int
forall b. Integral b =&gt; Ratio Int -&gt; b
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">round</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679064239"><span class="hs-identifier hs-var">done</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Ratio Int
forall a. Integral a =&gt; a -&gt; a -&gt; Ratio a
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679064234"><span class="hs-identifier hs-var">todo</span></a></span><span> </span><span class="annot"><span class="annottext">Ratio Int -&gt; Ratio Int -&gt; Ratio Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Ratio Int
</span><span class="hs-number">100</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">)</span><span>
</span><span id="line-510"></span><span>                      </span><span class="annot"><span class="annottext">Builder -&gt; Builder -&gt; Builder
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; Builder
</span><span class="hs-identifier hs-var">TLB.singleton</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'%'</span></span><span>
</span><span id="line-511"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-512"></span><span>        </span><span id="local-6989586621679064239"><span class="annot"><span class="annottext">done :: Int
</span><a href="#local-6989586621679064239"><span class="hs-identifier hs-var hs-var">done</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Progress s -&gt; Int
forall s. Progress s -&gt; Int
</span><a href="System.ProgressBar.html#progressDone"><span class="hs-identifier hs-var">progressDone</span></a></span><span> </span><span class="annot"><span class="annottext">Progress s
</span><a href="#local-6989586621679064232"><span class="hs-identifier hs-var">progress</span></a></span><span>
</span><span id="line-513"></span><span>        </span><span id="local-6989586621679064234"><span class="annot"><span class="annottext">todo :: Int
</span><a href="#local-6989586621679064234"><span class="hs-identifier hs-var hs-var">todo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Progress s -&gt; Int
forall s. Progress s -&gt; Int
</span><a href="System.ProgressBar.html#progressTodo"><span class="hs-identifier hs-var">progressTodo</span></a></span><span> </span><span class="annot"><span class="annottext">Progress s
</span><a href="#local-6989586621679064232"><span class="hs-identifier hs-var">progress</span></a></span><span>
</span><span id="line-514"></span><span>
</span><span id="line-515"></span><span class="hs-comment">-- | Progress as a fraction of the total amount of work.</span><span>
</span><span id="line-516"></span><span class="hs-comment">--</span><span>
</span><span id="line-517"></span><span class="hs-comment">-- &gt;&gt;&gt; runLabel $ exact (Progress 30 100 ()) someTiming</span><span>
</span><span id="line-518"></span><span class="hs-comment">-- &quot; 30/100&quot;</span><span>
</span><span id="line-519"></span><span id="local-6989586621679064241"><span class="annot"><a href="System.ProgressBar.html#exact"><span class="hs-identifier hs-type">exact</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.ProgressBar.html#Label"><span class="hs-identifier hs-type">Label</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064241"><span class="hs-identifier hs-type">s</span></a></span></span><span>
</span><span id="line-520"></span><span id="exact"><span class="annot"><span class="annottext">exact :: forall s. Label s
</span><a href="System.ProgressBar.html#exact"><span class="hs-identifier hs-var hs-var">exact</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Progress s -&gt; Timing -&gt; Text) -&gt; Label s
forall s. (Progress s -&gt; Timing -&gt; Text) -&gt; Label s
</span><a href="System.ProgressBar.html#Label"><span class="hs-identifier hs-var">Label</span></a></span><span> </span><span class="annot"><span class="annottext">Progress s -&gt; Timing -&gt; Text
forall {s} {p}. Progress s -&gt; p -&gt; Text
</span><a href="#local-6989586621679064242"><span class="hs-identifier hs-var">render</span></a></span><span>
</span><span id="line-521"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-522"></span><span>    </span><span id="local-6989586621679064242"><span class="annot"><span class="annottext">render :: Progress s -&gt; p -&gt; Text
</span><a href="#local-6989586621679064242"><span class="hs-identifier hs-var hs-var">render</span></a></span></span><span> </span><span id="local-6989586621679064246"><span class="annot"><span class="annottext">Progress s
</span><a href="#local-6989586621679064246"><span class="hs-identifier hs-var">progress</span></a></span></span><span> </span><span id="local-6989586621679064247"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679064247"><span class="hs-identifier hs-var">_timing</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-523"></span><span>        </span><span class="annot"><span class="annottext">Int64 -&gt; Char -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">TL.justifyRight</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; Int64
</span><span class="hs-identifier hs-var">TL.length</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679064248"><span class="hs-identifier hs-var">todoStr</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679064249"><span class="hs-identifier hs-var">doneStr</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;/&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679064248"><span class="hs-identifier hs-var">todoStr</span></a></span><span>
</span><span id="line-524"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-525"></span><span>        </span><span id="local-6989586621679064248"><span class="annot"><span class="annottext">todoStr :: Text
</span><a href="#local-6989586621679064248"><span class="hs-identifier hs-var hs-var">todoStr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Text
</span><span class="hs-identifier hs-var">TLB.toLazyText</span></span><span> </span><span class="annot"><span class="annottext">(Builder -&gt; Text) -&gt; Builder -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Builder
forall a. Integral a =&gt; a -&gt; Builder
</span><span class="hs-identifier hs-var">TLB.decimal</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679064251"><span class="hs-identifier hs-var">todo</span></a></span><span>
</span><span id="line-526"></span><span>        </span><span id="local-6989586621679064249"><span class="annot"><span class="annottext">doneStr :: Text
</span><a href="#local-6989586621679064249"><span class="hs-identifier hs-var hs-var">doneStr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Text
</span><span class="hs-identifier hs-var">TLB.toLazyText</span></span><span> </span><span class="annot"><span class="annottext">(Builder -&gt; Text) -&gt; Builder -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Builder
forall a. Integral a =&gt; a -&gt; Builder
</span><span class="hs-identifier hs-var">TLB.decimal</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679064253"><span class="hs-identifier hs-var">done</span></a></span><span>
</span><span id="line-527"></span><span>
</span><span id="line-528"></span><span>        </span><span id="local-6989586621679064253"><span class="annot"><span class="annottext">done :: Int
</span><a href="#local-6989586621679064253"><span class="hs-identifier hs-var hs-var">done</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Progress s -&gt; Int
forall s. Progress s -&gt; Int
</span><a href="System.ProgressBar.html#progressDone"><span class="hs-identifier hs-var">progressDone</span></a></span><span> </span><span class="annot"><span class="annottext">Progress s
</span><a href="#local-6989586621679064246"><span class="hs-identifier hs-var">progress</span></a></span><span>
</span><span id="line-529"></span><span>        </span><span id="local-6989586621679064251"><span class="annot"><span class="annottext">todo :: Int
</span><a href="#local-6989586621679064251"><span class="hs-identifier hs-var hs-var">todo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Progress s -&gt; Int
forall s. Progress s -&gt; Int
</span><a href="System.ProgressBar.html#progressTodo"><span class="hs-identifier hs-var">progressTodo</span></a></span><span> </span><span class="annot"><span class="annottext">Progress s
</span><a href="#local-6989586621679064246"><span class="hs-identifier hs-var">progress</span></a></span><span>
</span><span id="line-530"></span><span>
</span><span id="line-531"></span><span class="hs-comment">-- | Amount of time that has elapsed.</span><span>
</span><span id="line-532"></span><span class="hs-comment">--</span><span>
</span><span id="line-533"></span><span class="hs-comment">-- Time starts when a progress bar is created.</span><span>
</span><span id="line-534"></span><span class="hs-comment">--</span><span>
</span><span id="line-535"></span><span class="hs-comment">-- The user must supply a function which actually renders the amount</span><span>
</span><span id="line-536"></span><span class="hs-comment">-- of time that has elapsed. You can use 'renderDuration' or</span><span>
</span><span id="line-537"></span><span class="hs-comment">-- @formatTime@ from time &gt;= 1.9.</span><span>
</span><span id="line-538"></span><span id="local-6989586621679063833"><span class="annot"><a href="System.ProgressBar.html#elapsedTime"><span class="hs-identifier hs-type">elapsedTime</span></a></span><span>
</span><span id="line-539"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NominalDiffTime</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TL.Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-540"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="System.ProgressBar.html#Label"><span class="hs-identifier hs-type">Label</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063833"><span class="hs-identifier hs-type">s</span></a></span></span><span>
</span><span id="line-541"></span><span id="elapsedTime"><span class="annot"><span class="annottext">elapsedTime :: forall s. (NominalDiffTime -&gt; Text) -&gt; Label s
</span><a href="System.ProgressBar.html#elapsedTime"><span class="hs-identifier hs-var hs-var">elapsedTime</span></a></span></span><span> </span><span id="local-6989586621679064254"><span class="annot"><span class="annottext">NominalDiffTime -&gt; Text
</span><a href="#local-6989586621679064254"><span class="hs-identifier hs-var">formatNDT</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Progress s -&gt; Timing -&gt; Text) -&gt; Label s
forall s. (Progress s -&gt; Timing -&gt; Text) -&gt; Label s
</span><a href="System.ProgressBar.html#Label"><span class="hs-identifier hs-var">Label</span></a></span><span> </span><span class="annot"><span class="annottext">Progress s -&gt; Timing -&gt; Text
forall {p}. p -&gt; Timing -&gt; Text
</span><a href="#local-6989586621679064255"><span class="hs-identifier hs-var">render</span></a></span><span>
</span><span id="line-542"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-543"></span><span>    </span><span id="local-6989586621679064255"><span class="annot"><span class="annottext">render :: p -&gt; Timing -&gt; Text
</span><a href="#local-6989586621679064255"><span class="hs-identifier hs-var hs-var">render</span></a></span></span><span> </span><span id="local-6989586621679064256"><span class="annot"><span class="annottext">p
</span><a href="#local-6989586621679064256"><span class="hs-identifier hs-var">_progress</span></a></span></span><span> </span><span id="local-6989586621679064257"><span class="annot"><span class="annottext">Timing
</span><a href="#local-6989586621679064257"><span class="hs-identifier hs-var">timing</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NominalDiffTime -&gt; Text
</span><a href="#local-6989586621679064254"><span class="hs-identifier hs-var">formatNDT</span></a></span><span> </span><span class="annot"><span class="annottext">NominalDiffTime
</span><a href="#local-6989586621679064258"><span class="hs-identifier hs-var">dt</span></a></span><span>
</span><span id="line-544"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-545"></span><span>        </span><span class="annot"><a href="#local-6989586621679064258"><span class="hs-identifier hs-type">dt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NominalDiffTime</span></span><span>
</span><span id="line-546"></span><span>        </span><span id="local-6989586621679064258"><span class="annot"><span class="annottext">dt :: NominalDiffTime
</span><a href="#local-6989586621679064258"><span class="hs-identifier hs-var hs-var">dt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UTCTime -&gt; UTCTime -&gt; NominalDiffTime
</span><span class="hs-identifier hs-var">diffUTCTime</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Timing -&gt; UTCTime
</span><a href="System.ProgressBar.html#timingLastUpdate"><span class="hs-identifier hs-var">timingLastUpdate</span></a></span><span> </span><span class="annot"><span class="annottext">Timing
</span><a href="#local-6989586621679064257"><span class="hs-identifier hs-var">timing</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Timing -&gt; UTCTime
</span><a href="System.ProgressBar.html#timingStart"><span class="hs-identifier hs-var">timingStart</span></a></span><span> </span><span class="annot"><span class="annottext">Timing
</span><a href="#local-6989586621679064257"><span class="hs-identifier hs-var">timing</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-547"></span><span>
</span><span id="line-548"></span><span class="hs-comment">-- | Estimated remaining time.</span><span>
</span><span id="line-549"></span><span class="hs-comment">--</span><span>
</span><span id="line-550"></span><span class="hs-comment">-- Tells you how much longer some task is expected to take.</span><span>
</span><span id="line-551"></span><span class="hs-comment">--</span><span>
</span><span id="line-552"></span><span class="hs-comment">-- This label uses a simple estimation algorithm. It assumes progress</span><span>
</span><span id="line-553"></span><span class="hs-comment">-- is linear. To prevent nonsense results it won't estimate remaining</span><span>
</span><span id="line-554"></span><span class="hs-comment">-- time until at least 1 second of work has been done.</span><span>
</span><span id="line-555"></span><span class="hs-comment">--</span><span>
</span><span id="line-556"></span><span class="hs-comment">-- When it refuses to estimate the remaining time it will show an</span><span>
</span><span id="line-557"></span><span class="hs-comment">-- alternative message instead.</span><span>
</span><span id="line-558"></span><span class="hs-comment">--</span><span>
</span><span id="line-559"></span><span class="hs-comment">-- The user must supply a function which actually renders the amount</span><span>
</span><span id="line-560"></span><span class="hs-comment">-- of time that has elapsed. Use 'renderDuration' or @formatTime@ from</span><span>
</span><span id="line-561"></span><span class="hs-comment">-- the time &gt;= 1.9 package.</span><span>
</span><span id="line-562"></span><span id="local-6989586621679063836"><span class="annot"><a href="System.ProgressBar.html#remainingTime"><span class="hs-identifier hs-type">remainingTime</span></a></span><span>
</span><span id="line-563"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NominalDiffTime</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TL.Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-564"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TL.Text</span></span><span>
</span><span id="line-565"></span><span>       </span><span class="hs-comment">-- ^ Alternative message when remaining time can't be</span><span>
</span><span id="line-566"></span><span>       </span><span class="hs-comment">-- calculated (yet).</span><span>
</span><span id="line-567"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="System.ProgressBar.html#Label"><span class="hs-identifier hs-type">Label</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679063836"><span class="hs-identifier hs-type">s</span></a></span></span><span>
</span><span id="line-568"></span><span id="remainingTime"><span class="annot"><span class="annottext">remainingTime :: forall s. (NominalDiffTime -&gt; Text) -&gt; Text -&gt; Label s
</span><a href="System.ProgressBar.html#remainingTime"><span class="hs-identifier hs-var hs-var">remainingTime</span></a></span></span><span> </span><span id="local-6989586621679064259"><span class="annot"><span class="annottext">NominalDiffTime -&gt; Text
</span><a href="#local-6989586621679064259"><span class="hs-identifier hs-var">formatNDT</span></a></span></span><span> </span><span id="local-6989586621679064260"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679064260"><span class="hs-identifier hs-var">altMsg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Progress s -&gt; Timing -&gt; Text) -&gt; Label s
forall s. (Progress s -&gt; Timing -&gt; Text) -&gt; Label s
</span><a href="System.ProgressBar.html#Label"><span class="hs-identifier hs-var">Label</span></a></span><span> </span><span class="annot"><span class="annottext">Progress s -&gt; Timing -&gt; Text
forall {s}. Progress s -&gt; Timing -&gt; Text
</span><a href="#local-6989586621679064261"><span class="hs-identifier hs-var">render</span></a></span><span>
</span><span id="line-569"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-570"></span><span>    </span><span id="local-6989586621679064261"><span class="annot"><span class="annottext">render :: Progress s -&gt; Timing -&gt; Text
</span><a href="#local-6989586621679064261"><span class="hs-identifier hs-var hs-var">render</span></a></span></span><span> </span><span id="local-6989586621679064277"><span class="annot"><span class="annottext">Progress s
</span><a href="#local-6989586621679064277"><span class="hs-identifier hs-var">progress</span></a></span></span><span> </span><span id="local-6989586621679064278"><span class="annot"><span class="annottext">Timing
</span><a href="#local-6989586621679064278"><span class="hs-identifier hs-var">timing</span></a></span></span><span>
</span><span id="line-571"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Progress s -&gt; Int
forall s. Progress s -&gt; Int
</span><a href="System.ProgressBar.html#progressDone"><span class="hs-identifier hs-var">progressDone</span></a></span><span> </span><span class="annot"><span class="annottext">Progress s
</span><a href="#local-6989586621679064277"><span class="hs-identifier hs-var">progress</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679064260"><span class="hs-identifier hs-var">altMsg</span></a></span><span>
</span><span id="line-572"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">NominalDiffTime
</span><a href="#local-6989586621679064279"><span class="hs-identifier hs-var">dt</span></a></span><span> </span><span class="annot"><span class="annottext">NominalDiffTime -&gt; NominalDiffTime -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">NominalDiffTime
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NominalDiffTime -&gt; Text
</span><a href="#local-6989586621679064259"><span class="hs-identifier hs-var">formatNDT</span></a></span><span> </span><span class="annot"><span class="annottext">NominalDiffTime
</span><a href="#local-6989586621679064280"><span class="hs-identifier hs-var">estimatedRemainingTime</span></a></span><span>
</span><span id="line-573"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679064260"><span class="hs-identifier hs-var">altMsg</span></a></span><span>
</span><span id="line-574"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-575"></span><span>        </span><span id="local-6989586621679064280"><span class="annot"><span class="annottext">estimatedRemainingTime :: NominalDiffTime
</span><a href="#local-6989586621679064280"><span class="hs-identifier hs-var hs-var">estimatedRemainingTime</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NominalDiffTime
</span><a href="#local-6989586621679064282"><span class="hs-identifier hs-var">estimatedTotalTime</span></a></span><span> </span><span class="annot"><span class="annottext">NominalDiffTime -&gt; NominalDiffTime -&gt; NominalDiffTime
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span> </span><span class="annot"><span class="annottext">NominalDiffTime
</span><a href="#local-6989586621679064279"><span class="hs-identifier hs-var">dt</span></a></span><span>
</span><span id="line-576"></span><span>        </span><span id="local-6989586621679064282"><span class="annot"><span class="annottext">estimatedTotalTime :: NominalDiffTime
</span><a href="#local-6989586621679064282"><span class="hs-identifier hs-var hs-var">estimatedTotalTime</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NominalDiffTime
</span><a href="#local-6989586621679064279"><span class="hs-identifier hs-var">dt</span></a></span><span> </span><span class="annot"><span class="annottext">NominalDiffTime -&gt; NominalDiffTime -&gt; NominalDiffTime
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">NominalDiffTime -&gt; NominalDiffTime
forall a. Fractional a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">recip</span></span><span> </span><span class="annot"><span class="annottext">NominalDiffTime
</span><a href="#local-6989586621679064285"><span class="hs-identifier hs-var">progressFraction</span></a></span><span>
</span><span id="line-577"></span><span>
</span><span id="line-578"></span><span>        </span><span class="annot"><a href="#local-6989586621679064285"><span class="hs-identifier hs-type">progressFraction</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NominalDiffTime</span></span><span>
</span><span id="line-579"></span><span>        </span><span id="local-6989586621679064285"><span class="annot"><span class="annottext">progressFraction :: NominalDiffTime
</span><a href="#local-6989586621679064285"><span class="hs-identifier hs-var hs-var">progressFraction</span></a></span></span><span>
</span><span id="line-580"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Progress s -&gt; Int
forall s. Progress s -&gt; Int
</span><a href="System.ProgressBar.html#progressTodo"><span class="hs-identifier hs-var">progressTodo</span></a></span><span> </span><span class="annot"><span class="annottext">Progress s
</span><a href="#local-6989586621679064277"><span class="hs-identifier hs-var">progress</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NominalDiffTime
</span><span class="hs-number">1</span></span><span>
</span><span id="line-581"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; NominalDiffTime
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Progress s -&gt; Int
forall s. Progress s -&gt; Int
</span><a href="System.ProgressBar.html#progressDone"><span class="hs-identifier hs-var">progressDone</span></a></span><span> </span><span class="annot"><span class="annottext">Progress s
</span><a href="#local-6989586621679064277"><span class="hs-identifier hs-var">progress</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-582"></span><span>                      </span><span class="annot"><span class="annottext">NominalDiffTime -&gt; NominalDiffTime -&gt; NominalDiffTime
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; NominalDiffTime
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Progress s -&gt; Int
forall s. Progress s -&gt; Int
</span><a href="System.ProgressBar.html#progressTodo"><span class="hs-identifier hs-var">progressTodo</span></a></span><span> </span><span class="annot"><span class="annottext">Progress s
</span><a href="#local-6989586621679064277"><span class="hs-identifier hs-var">progress</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-583"></span><span>
</span><span id="line-584"></span><span>        </span><span class="annot"><a href="#local-6989586621679064279"><span class="hs-identifier hs-type">dt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NominalDiffTime</span></span><span>
</span><span id="line-585"></span><span>        </span><span id="local-6989586621679064279"><span class="annot"><span class="annottext">dt :: NominalDiffTime
</span><a href="#local-6989586621679064279"><span class="hs-identifier hs-var hs-var">dt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UTCTime -&gt; UTCTime -&gt; NominalDiffTime
</span><span class="hs-identifier hs-var">diffUTCTime</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Timing -&gt; UTCTime
</span><a href="System.ProgressBar.html#timingLastUpdate"><span class="hs-identifier hs-var">timingLastUpdate</span></a></span><span> </span><span class="annot"><span class="annottext">Timing
</span><a href="#local-6989586621679064278"><span class="hs-identifier hs-var">timing</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Timing -&gt; UTCTime
</span><a href="System.ProgressBar.html#timingStart"><span class="hs-identifier hs-var">timingStart</span></a></span><span> </span><span class="annot"><span class="annottext">Timing
</span><a href="#local-6989586621679064278"><span class="hs-identifier hs-var">timing</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-586"></span><span>
</span><span id="line-587"></span><span class="hs-comment">-- | Estimated total time.</span><span>
</span><span id="line-588"></span><span class="hs-comment">--</span><span>
</span><span id="line-589"></span><span class="hs-comment">-- This label uses a simple estimation algorithm. It assumes progress</span><span>
</span><span id="line-590"></span><span class="hs-comment">-- is linear. To prevent nonsense results it won't estimate the total</span><span>
</span><span id="line-591"></span><span class="hs-comment">-- time until at least 1 second of work has been done.</span><span>
</span><span id="line-592"></span><span class="hs-comment">--</span><span>
</span><span id="line-593"></span><span class="hs-comment">-- When it refuses to estimate the total time it will show an</span><span>
</span><span id="line-594"></span><span class="hs-comment">-- alternative message instead.</span><span>
</span><span id="line-595"></span><span class="hs-comment">--</span><span>
</span><span id="line-596"></span><span class="hs-comment">-- The user must supply a function which actually renders the total</span><span>
</span><span id="line-597"></span><span class="hs-comment">-- amount of time that a task will take. You can use 'renderDuration'</span><span>
</span><span id="line-598"></span><span class="hs-comment">-- or @formatTime@ from the time &gt;= 1.9 package.</span><span>
</span><span id="line-599"></span><span id="local-6989586621679064287"><span class="annot"><a href="System.ProgressBar.html#totalTime"><span class="hs-identifier hs-type">totalTime</span></a></span><span>
</span><span id="line-600"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NominalDiffTime</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TL.Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-601"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TL.Text</span></span><span>
</span><span id="line-602"></span><span>       </span><span class="hs-comment">-- ^ Alternative message when total time can't be calculated</span><span>
</span><span id="line-603"></span><span>       </span><span class="hs-comment">-- (yet).</span><span>
</span><span id="line-604"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="System.ProgressBar.html#Label"><span class="hs-identifier hs-type">Label</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679064287"><span class="hs-identifier hs-type">s</span></a></span></span><span>
</span><span id="line-605"></span><span id="totalTime"><span class="annot"><span class="annottext">totalTime :: forall s. (NominalDiffTime -&gt; Text) -&gt; Text -&gt; Label s
</span><a href="System.ProgressBar.html#totalTime"><span class="hs-identifier hs-var hs-var">totalTime</span></a></span></span><span> </span><span id="local-6989586621679064288"><span class="annot"><span class="annottext">NominalDiffTime -&gt; Text
</span><a href="#local-6989586621679064288"><span class="hs-identifier hs-var">formatNDT</span></a></span></span><span> </span><span id="local-6989586621679064289"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679064289"><span class="hs-identifier hs-var">altMsg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Progress s -&gt; Timing -&gt; Text) -&gt; Label s
forall s. (Progress s -&gt; Timing -&gt; Text) -&gt; Label s
</span><a href="System.ProgressBar.html#Label"><span class="hs-identifier hs-var">Label</span></a></span><span> </span><span class="annot"><span class="annottext">Progress s -&gt; Timing -&gt; Text
forall {s}. Progress s -&gt; Timing -&gt; Text
</span><a href="#local-6989586621679064290"><span class="hs-identifier hs-var">render</span></a></span><span>
</span><span id="line-606"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-607"></span><span>    </span><span id="local-6989586621679064290"><span class="annot"><span class="annottext">render :: Progress s -&gt; Timing -&gt; Text
</span><a href="#local-6989586621679064290"><span class="hs-identifier hs-var hs-var">render</span></a></span></span><span> </span><span id="local-6989586621679064303"><span class="annot"><span class="annottext">Progress s
</span><a href="#local-6989586621679064303"><span class="hs-identifier hs-var">progress</span></a></span></span><span> </span><span id="local-6989586621679064304"><span class="annot"><span class="annottext">Timing
</span><a href="#local-6989586621679064304"><span class="hs-identifier hs-var">timing</span></a></span></span><span>
</span><span id="line-608"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">NominalDiffTime
</span><a href="#local-6989586621679064305"><span class="hs-identifier hs-var">dt</span></a></span><span> </span><span class="annot"><span class="annottext">NominalDiffTime -&gt; NominalDiffTime -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&gt;</span></span><span> </span><span class="annot"><span class="annottext">NominalDiffTime
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NominalDiffTime -&gt; Text
</span><a href="#local-6989586621679064288"><span class="hs-identifier hs-var">formatNDT</span></a></span><span> </span><span class="annot"><span class="annottext">NominalDiffTime
</span><a href="#local-6989586621679064306"><span class="hs-identifier hs-var">estimatedTotalTime</span></a></span><span>
</span><span id="line-609"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Progress s -&gt; Int
forall s. Progress s -&gt; Int
</span><a href="System.ProgressBar.html#progressDone"><span class="hs-identifier hs-var">progressDone</span></a></span><span> </span><span class="annot"><span class="annottext">Progress s
</span><a href="#local-6989586621679064303"><span class="hs-identifier hs-var">progress</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679064289"><span class="hs-identifier hs-var">altMsg</span></a></span><span>
</span><span id="line-610"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679064289"><span class="hs-identifier hs-var">altMsg</span></a></span><span>
</span><span id="line-611"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-612"></span><span>        </span><span id="local-6989586621679064306"><span class="annot"><span class="annottext">estimatedTotalTime :: NominalDiffTime
</span><a href="#local-6989586621679064306"><span class="hs-identifier hs-var hs-var">estimatedTotalTime</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NominalDiffTime
</span><a href="#local-6989586621679064305"><span class="hs-identifier hs-var">dt</span></a></span><span> </span><span class="annot"><span class="annottext">NominalDiffTime -&gt; NominalDiffTime -&gt; NominalDiffTime
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">NominalDiffTime -&gt; NominalDiffTime
forall a. Fractional a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">recip</span></span><span> </span><span class="annot"><span class="annottext">NominalDiffTime
</span><a href="#local-6989586621679064309"><span class="hs-identifier hs-var">progressFraction</span></a></span><span>
</span><span id="line-613"></span><span>
</span><span id="line-614"></span><span>        </span><span class="annot"><a href="#local-6989586621679064309"><span class="hs-identifier hs-type">progressFraction</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NominalDiffTime</span></span><span>
</span><span id="line-615"></span><span>        </span><span id="local-6989586621679064309"><span class="annot"><span class="annottext">progressFraction :: NominalDiffTime
</span><a href="#local-6989586621679064309"><span class="hs-identifier hs-var hs-var">progressFraction</span></a></span></span><span>
</span><span id="line-616"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Progress s -&gt; Int
forall s. Progress s -&gt; Int
</span><a href="System.ProgressBar.html#progressTodo"><span class="hs-identifier hs-var">progressTodo</span></a></span><span> </span><span class="annot"><span class="annottext">Progress s
</span><a href="#local-6989586621679064303"><span class="hs-identifier hs-var">progress</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NominalDiffTime
</span><span class="hs-number">1</span></span><span>
</span><span id="line-617"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; NominalDiffTime
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Progress s -&gt; Int
forall s. Progress s -&gt; Int
</span><a href="System.ProgressBar.html#progressDone"><span class="hs-identifier hs-var">progressDone</span></a></span><span> </span><span class="annot"><span class="annottext">Progress s
</span><a href="#local-6989586621679064303"><span class="hs-identifier hs-var">progress</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-618"></span><span>                      </span><span class="annot"><span class="annottext">NominalDiffTime -&gt; NominalDiffTime -&gt; NominalDiffTime
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">/</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; NominalDiffTime
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">fromIntegral</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Progress s -&gt; Int
forall s. Progress s -&gt; Int
</span><a href="System.ProgressBar.html#progressTodo"><span class="hs-identifier hs-var">progressTodo</span></a></span><span> </span><span class="annot"><span class="annottext">Progress s
</span><a href="#local-6989586621679064303"><span class="hs-identifier hs-var">progress</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-619"></span><span>
</span><span id="line-620"></span><span>        </span><span class="annot"><a href="#local-6989586621679064305"><span class="hs-identifier hs-type">dt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NominalDiffTime</span></span><span>
</span><span id="line-621"></span><span>        </span><span id="local-6989586621679064305"><span class="annot"><span class="annottext">dt :: NominalDiffTime
</span><a href="#local-6989586621679064305"><span class="hs-identifier hs-var hs-var">dt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">UTCTime -&gt; UTCTime -&gt; NominalDiffTime
</span><span class="hs-identifier hs-var">diffUTCTime</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Timing -&gt; UTCTime
</span><a href="System.ProgressBar.html#timingLastUpdate"><span class="hs-identifier hs-var">timingLastUpdate</span></a></span><span> </span><span class="annot"><span class="annottext">Timing
</span><a href="#local-6989586621679064304"><span class="hs-identifier hs-var">timing</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Timing -&gt; UTCTime
</span><a href="System.ProgressBar.html#timingStart"><span class="hs-identifier hs-var">timingStart</span></a></span><span> </span><span class="annot"><span class="annottext">Timing
</span><a href="#local-6989586621679064304"><span class="hs-identifier hs-var">timing</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-622"></span><span>
</span><span id="line-623"></span><span class="hs-comment">-- | Show amount of time.</span><span>
</span><span id="line-624"></span><span class="hs-comment">--</span><span>
</span><span id="line-625"></span><span class="hs-comment">-- &gt; renderDuration (fromInteger 42)</span><span>
</span><span id="line-626"></span><span class="hs-comment">-- 42</span><span>
</span><span id="line-627"></span><span class="hs-comment">--</span><span>
</span><span id="line-628"></span><span class="hs-comment">-- &gt; renderDuration (fromInteger $ 5 * 60 + 42)</span><span>
</span><span id="line-629"></span><span class="hs-comment">-- 05:42</span><span>
</span><span id="line-630"></span><span class="hs-comment">--</span><span>
</span><span id="line-631"></span><span class="hs-comment">-- &gt; renderDuration (fromInteger $ 8 * 60 * 60 + 5 * 60 + 42)</span><span>
</span><span id="line-632"></span><span class="hs-comment">-- 08:05:42</span><span>
</span><span id="line-633"></span><span class="hs-comment">--</span><span>
</span><span id="line-634"></span><span class="hs-comment">-- Use the time &gt;= 1.9 package to get a formatTime function which</span><span>
</span><span id="line-635"></span><span class="hs-comment">-- accepts 'NominalDiffTime'.</span><span>
</span><span id="line-636"></span><span class="annot"><a href="System.ProgressBar.html#renderDuration"><span class="hs-identifier hs-type">renderDuration</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NominalDiffTime</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TL.Text</span></span><span>
</span><span id="line-637"></span><span id="renderDuration"><span class="annot"><span class="annottext">renderDuration :: NominalDiffTime -&gt; Text
</span><a href="System.ProgressBar.html#renderDuration"><span class="hs-identifier hs-var hs-var">renderDuration</span></a></span></span><span> </span><span id="local-6989586621679064310"><span class="annot"><span class="annottext">NominalDiffTime
</span><a href="#local-6989586621679064310"><span class="hs-identifier hs-var">dt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679064311"><span class="hs-identifier hs-var">hTxt</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679064312"><span class="hs-identifier hs-var">mTxt</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679064313"><span class="hs-identifier hs-var">sTxt</span></a></span><span>
</span><span id="line-638"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-639"></span><span>    </span><span id="local-6989586621679064311"><span class="annot"><span class="annottext">hTxt :: Text
</span><a href="#local-6989586621679064311"><span class="hs-identifier hs-var hs-var">hTxt</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679064321"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-640"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Text
forall {a}. Integral a =&gt; a -&gt; Text
</span><a href="#local-6989586621679064322"><span class="hs-identifier hs-var">renderDecimal</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679064321"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;:&quot;</span></span><span>
</span><span id="line-641"></span><span>    </span><span id="local-6989586621679064312"><span class="annot"><span class="annottext">mTxt :: Text
</span><a href="#local-6989586621679064312"><span class="hs-identifier hs-var hs-var">mTxt</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679064329"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-642"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Text
forall {a}. Integral a =&gt; a -&gt; Text
</span><a href="#local-6989586621679064322"><span class="hs-identifier hs-var">renderDecimal</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679064329"><span class="hs-identifier hs-var">m</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Text
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;:&quot;</span></span><span>
</span><span id="line-643"></span><span>    </span><span id="local-6989586621679064313"><span class="annot"><span class="annottext">sTxt :: Text
</span><a href="#local-6989586621679064313"><span class="hs-identifier hs-var hs-var">sTxt</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Text
forall {a}. Integral a =&gt; a -&gt; Text
</span><a href="#local-6989586621679064322"><span class="hs-identifier hs-var">renderDecimal</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679064331"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-644"></span><span>
</span><span id="line-645"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679064321"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679064321"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679064334"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679064334"><span class="hs-identifier hs-var">hRem</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679064335"><span class="hs-identifier hs-var">ts</span></a></span><span>   </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; (Int, Int)
forall a. Integral a =&gt; a -&gt; a -&gt; (a, a)
</span><span class="hs-operator hs-var">`quotRem`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">3600</span></span><span>
</span><span id="line-646"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679064329"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679064329"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679064331"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679064331"><span class="hs-identifier hs-var">s</span></a></span></span><span>   </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679064334"><span class="hs-identifier hs-var">hRem</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; (Int, Int)
forall a. Integral a =&gt; a -&gt; a -&gt; (a, a)
</span><span class="hs-operator hs-var">`quotRem`</span></span><span>   </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">60</span></span><span>
</span><span id="line-647"></span><span>
</span><span id="line-648"></span><span>    </span><span class="hs-comment">-- Total amount of seconds</span><span>
</span><span id="line-649"></span><span>    </span><span class="annot"><a href="#local-6989586621679064335"><span class="hs-identifier hs-type">ts</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-650"></span><span>    </span><span id="local-6989586621679064335"><span class="annot"><span class="annottext">ts :: Int
</span><a href="#local-6989586621679064335"><span class="hs-identifier hs-var hs-var">ts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NominalDiffTime -&gt; Int
forall b. Integral b =&gt; NominalDiffTime -&gt; b
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">round</span></span><span> </span><span class="annot"><span class="annottext">NominalDiffTime
</span><a href="#local-6989586621679064310"><span class="hs-identifier hs-var">dt</span></a></span><span>
</span><span id="line-651"></span><span>
</span><span id="line-652"></span><span>    </span><span id="local-6989586621679064322"><span class="annot"><span class="annottext">renderDecimal :: a -&gt; Text
</span><a href="#local-6989586621679064322"><span class="hs-identifier hs-var hs-var">renderDecimal</span></a></span></span><span> </span><span id="local-6989586621679064357"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064357"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Char -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">TL.justifyRight</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'0'</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Text) -&gt; Text -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Builder -&gt; Text
</span><span class="hs-identifier hs-var">TLB.toLazyText</span></span><span> </span><span class="annot"><span class="annottext">(Builder -&gt; Text) -&gt; Builder -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Builder
forall a. Integral a =&gt; a -&gt; Builder
</span><span class="hs-identifier hs-var">TLB.decimal</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679064357"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-653"></span><span>
</span><span id="line-654"></span><span class="annot"><span class="hs-comment">{- $start

You want to perform some task which will take some time. You wish to
show the progress of this task in the terminal.

    1. Determine the total amount of work

    2. Create a progress bar with 'newProgressBar'

    3. For each unit of work:

        3a. Perform the work

        3b. Update the progress bar with 'incProgress'

Explore the 'Style' and the 'Label' types to see various ways in which
you can customize the progress bar.

You do not have to close the progress bar, or even finish the task. It
is perfectly fine to stop half way (maybe your task throws an
exception).

Just remember to avoid outputting text to the terminal while a
progress bar is active. It will mess up the output a bit.
-}</span></span><span>
</span><span id="line-679"></span><span>
</span><span id="line-680"></span><span class="annot"><span class="hs-comment">{- $example

Write a function which represents a unit of work. This could be a file
copy operation, a network operation or some other expensive
calculation. This example simply waits 1 second.

@
  work :: IO ()
  work = threadDelay 1000000 -- 1 second
@

And you define some work to be done. This could be a list of files to
process or some jobs that need to be processed.

@
  toBeDone :: [()]
  toBeDone = replicate 20 ()
@

Now create the progress bar. Use the default style and choose a
maximum refresh rate of 10 Hz. The initial progress is 0 work done out
of 20.

@
  pb &lt;- 'newProgressBar' 'defStyle' 10 ('Progress' 0 20 ())
@

Start performing the work while keeping the user informed of the progress:

@
  for_ toBeDone $ \() -&gt; do
    work             -- perform 1 unit of work
    'incProgress' pb 1 -- increment progress by 1
@

That's it! You get a nice animated progress bar in your terminal. It
will look like this:

@
[==========&gt;................................]  25%
@
-}</span></span><span>
</span><span id="line-722"></span></pre></body></html>