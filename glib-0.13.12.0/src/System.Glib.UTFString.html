<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings #-}</span><span>
</span><span id="line-4"></span><span class="hs-comment">--  GIMP Toolkit (GTK) UTF aware string marshalling</span><span>
</span><span id="line-5"></span><span class="hs-comment">--</span><span>
</span><span id="line-6"></span><span class="hs-comment">--  Author : Axel Simon</span><span>
</span><span id="line-7"></span><span class="hs-comment">--</span><span>
</span><span id="line-8"></span><span class="hs-comment">--  Created: 22 June 2001</span><span>
</span><span id="line-9"></span><span class="hs-comment">--</span><span>
</span><span id="line-10"></span><span class="hs-comment">--  Copyright (c) 1999..2002 Axel Simon</span><span>
</span><span id="line-11"></span><span class="hs-comment">--</span><span>
</span><span id="line-12"></span><span class="hs-comment">--  This library is free software; you can redistribute it and/or</span><span>
</span><span id="line-13"></span><span class="hs-comment">--  modify it under the terms of the GNU Lesser General Public</span><span>
</span><span id="line-14"></span><span class="hs-comment">--  License as published by the Free Software Foundation; either</span><span>
</span><span id="line-15"></span><span class="hs-comment">--  version 2.1 of the License, or (at your option) any later version.</span><span>
</span><span id="line-16"></span><span class="hs-comment">--</span><span>
</span><span id="line-17"></span><span class="hs-comment">--  This library is distributed in the hope that it will be useful,</span><span>
</span><span id="line-18"></span><span class="hs-comment">--  but WITHOUT ANY WARRANTY; without even the implied warranty of</span><span>
</span><span id="line-19"></span><span class="hs-comment">--  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span><span>
</span><span id="line-20"></span><span class="hs-comment">--  Lesser General Public License for more details.</span><span>
</span><span id="line-21"></span><span class="hs-comment">--</span><span>
</span><span id="line-22"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-23"></span><span class="hs-comment">-- Maintainer  : gtk2hs-users@lists.sourceforge.net</span><span>
</span><span id="line-24"></span><span class="hs-comment">-- Stability   : provisional</span><span>
</span><span id="line-25"></span><span class="hs-comment">-- Portability : portable (depends on GHC)</span><span>
</span><span id="line-26"></span><span class="hs-comment">--</span><span>
</span><span id="line-27"></span><span class="hs-comment">-- This module adds CString-like functions that handle UTF8 strings.</span><span>
</span><span id="line-28"></span><span class="hs-comment">--</span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="System.Glib.UTFString.html"><span class="hs-identifier">System.Glib.UTFString</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-31"></span><span>  </span><span class="annot"><a href="System.Glib.UTFString.html#GlibString"><span class="hs-identifier">GlibString</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>  </span><span class="annot"><a href="System.Glib.UTFString.html#readUTFString"><span class="hs-identifier">readUTFString</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>  </span><span class="annot"><a href="System.Glib.UTFString.html#readCString"><span class="hs-identifier">readCString</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>  </span><span class="annot"><a href="System.Glib.UTFString.html#withUTFStrings"><span class="hs-identifier">withUTFStrings</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>  </span><span class="annot"><a href="System.Glib.UTFString.html#withUTFStringArray"><span class="hs-identifier">withUTFStringArray</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>  </span><span class="annot"><a href="System.Glib.UTFString.html#withUTFStringArray0"><span class="hs-identifier">withUTFStringArray0</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-37"></span><span>  </span><span class="annot"><a href="System.Glib.UTFString.html#peekUTFStringArray"><span class="hs-identifier">peekUTFStringArray</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-38"></span><span>  </span><span class="annot"><a href="System.Glib.UTFString.html#peekUTFStringArray0"><span class="hs-identifier">peekUTFStringArray0</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span>  </span><span class="annot"><a href="System.Glib.UTFString.html#readUTFStringArray0"><span class="hs-identifier">readUTFStringArray0</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-40"></span><span>  </span><span class="annot"><a href="System.Glib.UTFString.html#UTFCorrection"><span class="hs-identifier">UTFCorrection</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-41"></span><span>  </span><span class="annot"><a href="System.Glib.UTFString.html#ofsToUTF"><span class="hs-identifier">ofsToUTF</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-42"></span><span>  </span><span class="annot"><a href="System.Glib.UTFString.html#ofsFromUTF"><span class="hs-identifier">ofsFromUTF</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span>  </span><span class="annot"><a href="System.Glib.UTFString.html#glibToString"><span class="hs-identifier">glibToString</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-45"></span><span>  </span><span class="annot"><a href="System.Glib.UTFString.html#stringToGlib"><span class="hs-identifier">stringToGlib</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span>  </span><span class="annot"><a href="System.Glib.UTFString.html#DefaultGlibString"><span class="hs-identifier">DefaultGlibString</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span>  </span><span class="annot"><a href="System.Glib.UTFString.html#GlibFilePath"><span class="hs-identifier">GlibFilePath</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-50"></span><span>  </span><span class="annot"><a href="System.Glib.UTFString.html#withUTFFilePaths"><span class="hs-identifier">withUTFFilePaths</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-51"></span><span>  </span><span class="annot"><a href="System.Glib.UTFString.html#withUTFFilePathArray"><span class="hs-identifier">withUTFFilePathArray</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-52"></span><span>  </span><span class="annot"><a href="System.Glib.UTFString.html#withUTFFilePathArray0"><span class="hs-identifier">withUTFFilePathArray0</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-53"></span><span>  </span><span class="annot"><a href="System.Glib.UTFString.html#peekUTFFilePathArray0"><span class="hs-identifier">peekUTFFilePathArray0</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-54"></span><span>  </span><span class="annot"><a href="System.Glib.UTFString.html#readUTFFilePathArray0"><span class="hs-identifier">readUTFFilePathArray0</span></a></span><span>
</span><span id="line-55"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Codec.Binary.UTF8.String</span></span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Applicative</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(&lt;$&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">liftM</span></span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Char</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ord</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">chr</span></span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">maybe</span></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.String</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">IsString</span></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Monoid</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Monoid</span></span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="System.Glib.FFI.html"><span class="hs-identifier">System.Glib.FFI</span></a></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">replace</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">length</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">pack</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">unpack</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Text</span></span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text.Foreign</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">T</span></span><span>
</span><span id="line-67"></span><span>       </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">withCStringLen</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">peekCStringLen</span></span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">useAsCString</span></span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text.Encoding</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">encodeUtf8</span></span><span class="hs-special">)</span><span>
</span><span id="line-70"></span><span>
</span><span id="line-71"></span><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">IsString</span></span><span> </span><span class="annot"><a href="#local-6989586621679079644"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="#local-6989586621679079644"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679079644"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="GlibString"><span class="annot"><a href="System.Glib.UTFString.html#GlibString"><span class="hs-identifier hs-var">GlibString</span></a></span></span><span> </span><span id="local-6989586621679079644"><span class="annot"><a href="#local-6989586621679079644"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-72"></span><span>    </span><span class="hs-comment">-- | Like 'withCString' but using the UTF-8 encoding.</span><span>
</span><span id="line-73"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-74"></span><span>    </span><span id="withUTFString"><span class="annot"><a href="System.Glib.UTFString.html#withUTFString"><span class="hs-identifier hs-type">withUTFString</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679079652"><span class="annot"><a href="#local-6989586621679079644"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679079652"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679079652"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span>    </span><span class="hs-comment">-- | Like 'withCStringLen' but using the UTF-8 encoding.</span><span>
</span><span id="line-77"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-78"></span><span>    </span><span id="withUTFStringLen"><span class="annot"><a href="System.Glib.UTFString.html#withUTFStringLen"><span class="hs-identifier hs-type">withUTFStringLen</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679079653"><span class="annot"><a href="#local-6989586621679079644"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CStringLen</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679079653"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679079653"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-79"></span><span>
</span><span id="line-80"></span><span>    </span><span class="hs-comment">-- | Like 'peekCString' but using the UTF-8 encoding.</span><span>
</span><span id="line-81"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-82"></span><span>    </span><span id="peekUTFString"><span class="annot"><a href="System.Glib.UTFString.html#peekUTFString"><span class="hs-identifier hs-type">peekUTFString</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679079644"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span>    </span><span class="hs-comment">-- | Like 'maybePeek' 'peekCString' but using the UTF-8 encoding to retrieve</span><span>
</span><span id="line-85"></span><span>    </span><span class="hs-comment">-- UTF-8 from a 'CString' which may be the 'nullPtr'.</span><span>
</span><span id="line-86"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-87"></span><span>    </span><span id="maybePeekUTFString"><span class="annot"><a href="System.Glib.UTFString.html#maybePeekUTFString"><span class="hs-identifier hs-type">maybePeekUTFString</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679079644"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span>    </span><span class="hs-comment">-- | Like 'peekCStringLen' but using the UTF-8 encoding.</span><span>
</span><span id="line-90"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-91"></span><span>    </span><span id="peekUTFStringLen"><span class="annot"><a href="System.Glib.UTFString.html#peekUTFStringLen"><span class="hs-identifier hs-type">peekUTFStringLen</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CStringLen</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679079644"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span>    </span><span class="hs-comment">-- | Like 'newCString' but using the UTF-8 encoding.</span><span>
</span><span id="line-94"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-95"></span><span>    </span><span id="newUTFString"><span class="annot"><a href="System.Glib.UTFString.html#newUTFString"><span class="hs-identifier hs-type">newUTFString</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679079644"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CString</span></span><span>
</span><span id="line-96"></span><span>
</span><span id="line-97"></span><span>    </span><span class="hs-comment">-- | Like  Define newUTFStringLen to emit UTF-8.</span><span>
</span><span id="line-98"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-99"></span><span>    </span><span id="newUTFStringLen"><span class="annot"><a href="System.Glib.UTFString.html#newUTFStringLen"><span class="hs-identifier hs-type">newUTFStringLen</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679079644"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CStringLen</span></span><span>
</span><span id="line-100"></span><span>
</span><span id="line-101"></span><span>    </span><span class="hs-comment">-- | Create a list of offset corrections.</span><span>
</span><span id="line-102"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-103"></span><span>    </span><span id="genUTFOfs"><span class="annot"><a href="System.Glib.UTFString.html#genUTFOfs"><span class="hs-identifier hs-type">genUTFOfs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679079644"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="System.Glib.UTFString.html#UTFCorrection"><span class="hs-identifier hs-type">UTFCorrection</span></a></span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span>    </span><span class="hs-comment">-- | Length of the string in characters</span><span>
</span><span id="line-106"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-107"></span><span>    </span><span id="stringLength"><span class="annot"><a href="System.Glib.UTFString.html#stringLength"><span class="hs-identifier hs-type">stringLength</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679079644"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-108"></span><span>
</span><span id="line-109"></span><span>    </span><span class="hs-comment">-- Escape percent signs (used in MessageDialog)</span><span>
</span><span id="line-110"></span><span>    </span><span id="unPrintf"><span class="annot"><a href="System.Glib.UTFString.html#unPrintf"><span class="hs-identifier hs-type">unPrintf</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679079644"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679079644"><span class="hs-identifier hs-type">s</span></a></span><span>
</span><span id="line-111"></span><span>
</span><span id="line-112"></span><span class="hs-comment">-- GTK+ has a lot of asserts that the ptr is not NULL even if the length is 0</span><span>
</span><span id="line-113"></span><span class="hs-comment">-- Until they fix this we need to fudge pointer values to keep the noise level</span><span>
</span><span id="line-114"></span><span class="hs-comment">-- in the logs.</span><span>
</span><span id="line-115"></span><span class="annot"><a href="System.Glib.UTFString.html#noNullPtrs"><span class="hs-identifier hs-type">noNullPtrs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CStringLen</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CStringLen</span></span><span>
</span><span id="line-116"></span><span id="noNullPtrs"><span class="annot"><span class="annottext">noNullPtrs :: CStringLen -&gt; CStringLen
</span><a href="System.Glib.UTFString.html#noNullPtrs"><span class="hs-identifier hs-var hs-var">noNullPtrs</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679079819"><span class="annot"><span class="annottext">Ptr CChar
</span><a href="#local-6989586621679079819"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Ptr CChar
</span><a href="#local-6989586621679079819"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr CChar -&gt; Ptr CChar -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Ptr CChar
forall a. Ptr a
</span><span class="hs-identifier hs-var">nullPtr</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ptr CChar -&gt; Int -&gt; Ptr CChar
forall a b. Ptr a -&gt; Int -&gt; Ptr b
</span><span class="hs-identifier hs-var">plusPtr</span></span><span> </span><span class="annot"><span class="annottext">Ptr CChar
</span><a href="#local-6989586621679079819"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span class="annot"><a href="System.Glib.UTFString.html#noNullPtrs"><span class="hs-identifier hs-var">noNullPtrs</span></a></span><span> </span><span id="local-6989586621679079822"><span class="annot"><span class="annottext">CStringLen
</span><a href="#local-6989586621679079822"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CStringLen
</span><a href="#local-6989586621679079822"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="System.Glib.UTFString.html#GlibString"><span class="hs-identifier hs-type">GlibString</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Char</span></span><span class="hs-special">]</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-120"></span><span>    </span><span id="local-6989586621679079847"><span class="annot"><span class="annottext">withUTFString :: forall a. [Char] -&gt; (Ptr CChar -&gt; IO a) -&gt; IO a
</span><a href="System.Glib.UTFString.html#withUTFString"><span class="hs-identifier hs-var hs-var hs-var">withUTFString</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; (Ptr CChar -&gt; IO a) -&gt; IO a
forall a. [Char] -&gt; (Ptr CChar -&gt; IO a) -&gt; IO a
</span><span class="hs-identifier hs-var">withCAString</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; (Ptr CChar -&gt; IO a) -&gt; IO a)
-&gt; ([Char] -&gt; [Char]) -&gt; [Char] -&gt; (Ptr CChar -&gt; IO a) -&gt; IO a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char]
</span><span class="hs-identifier hs-var">encodeString</span></span><span>
</span><span id="line-121"></span><span>    </span><span id="local-6989586621679079851"><span class="annot"><span class="annottext">withUTFStringLen :: forall a. [Char] -&gt; (CStringLen -&gt; IO a) -&gt; IO a
</span><a href="System.Glib.UTFString.html#withUTFStringLen"><span class="hs-identifier hs-var hs-var hs-var">withUTFStringLen</span></a></span></span><span> </span><span id="local-6989586621679079852"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679079852"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679079853"><span class="annot"><span class="annottext">CStringLen -&gt; IO a
</span><a href="#local-6989586621679079853"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; (CStringLen -&gt; IO a) -&gt; IO a
forall a. [Char] -&gt; (CStringLen -&gt; IO a) -&gt; IO a
</span><span class="hs-identifier hs-var">withCAStringLen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; [Char]
</span><span class="hs-identifier hs-var">encodeString</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679079852"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CStringLen -&gt; IO a
</span><a href="#local-6989586621679079853"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(CStringLen -&gt; IO a)
-&gt; (CStringLen -&gt; CStringLen) -&gt; CStringLen -&gt; IO a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CStringLen -&gt; CStringLen
</span><a href="System.Glib.UTFString.html#noNullPtrs"><span class="hs-identifier hs-var">noNullPtrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-122"></span><span>    </span><span id="local-6989586621679079856"><span class="annot"><span class="annottext">peekUTFString :: Ptr CChar -&gt; IO [Char]
</span><a href="System.Glib.UTFString.html#peekUTFString"><span class="hs-identifier hs-var hs-var hs-var">peekUTFString</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; [Char]) -&gt; IO [Char] -&gt; IO [Char]
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-identifier hs-var">liftM</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char]
</span><span class="hs-identifier hs-var">decodeString</span></span><span> </span><span class="annot"><span class="annottext">(IO [Char] -&gt; IO [Char])
-&gt; (Ptr CChar -&gt; IO [Char]) -&gt; Ptr CChar -&gt; IO [Char]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Ptr CChar -&gt; IO [Char]
</span><span class="hs-identifier hs-var">peekCAString</span></span><span>
</span><span id="line-123"></span><span>    </span><span id="local-6989586621679079860"><span class="annot"><span class="annottext">maybePeekUTFString :: Ptr CChar -&gt; IO (Maybe [Char])
</span><a href="System.Glib.UTFString.html#maybePeekUTFString"><span class="hs-identifier hs-var hs-var hs-var">maybePeekUTFString</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Maybe [Char] -&gt; Maybe [Char])
-&gt; IO (Maybe [Char]) -&gt; IO (Maybe [Char])
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-identifier hs-var">liftM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe [Char]
-&gt; ([Char] -&gt; Maybe [Char]) -&gt; Maybe [Char] -&gt; Maybe [Char]
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="annot"><span class="annottext">Maybe [Char]
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char] -&gt; Maybe [Char]
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Maybe [Char])
-&gt; ([Char] -&gt; [Char]) -&gt; [Char] -&gt; Maybe [Char]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char]
</span><span class="hs-identifier hs-var">decodeString</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO (Maybe [Char]) -&gt; IO (Maybe [Char]))
-&gt; (Ptr CChar -&gt; IO (Maybe [Char]))
-&gt; Ptr CChar
-&gt; IO (Maybe [Char])
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Ptr CChar -&gt; IO [Char]) -&gt; Ptr CChar -&gt; IO (Maybe [Char])
forall a b. (Ptr a -&gt; IO b) -&gt; Ptr a -&gt; IO (Maybe b)
</span><span class="hs-identifier hs-var">maybePeek</span></span><span> </span><span class="annot"><span class="annottext">Ptr CChar -&gt; IO [Char]
</span><span class="hs-identifier hs-var">peekCAString</span></span><span>
</span><span id="line-124"></span><span>    </span><span id="local-6989586621679079863"><span class="annot"><span class="annottext">peekUTFStringLen :: CStringLen -&gt; IO [Char]
</span><a href="System.Glib.UTFString.html#peekUTFStringLen"><span class="hs-identifier hs-var hs-var hs-var">peekUTFStringLen</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; [Char]) -&gt; IO [Char] -&gt; IO [Char]
forall (m :: * -&gt; *) a1 r. Monad m =&gt; (a1 -&gt; r) -&gt; m a1 -&gt; m r
</span><span class="hs-identifier hs-var">liftM</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char]
</span><span class="hs-identifier hs-var">decodeString</span></span><span> </span><span class="annot"><span class="annottext">(IO [Char] -&gt; IO [Char])
-&gt; (CStringLen -&gt; IO [Char]) -&gt; CStringLen -&gt; IO [Char]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CStringLen -&gt; IO [Char]
</span><span class="hs-identifier hs-var">peekCAStringLen</span></span><span>
</span><span id="line-125"></span><span>    </span><span id="local-6989586621679079865"><span class="annot"><span class="annottext">newUTFString :: [Char] -&gt; IO (Ptr CChar)
</span><a href="System.Glib.UTFString.html#newUTFString"><span class="hs-identifier hs-var hs-var hs-var">newUTFString</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; IO (Ptr CChar)
</span><span class="hs-identifier hs-var">newCAString</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; IO (Ptr CChar))
-&gt; ([Char] -&gt; [Char]) -&gt; [Char] -&gt; IO (Ptr CChar)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char]
</span><span class="hs-identifier hs-var">encodeString</span></span><span>
</span><span id="line-126"></span><span>    </span><span id="local-6989586621679079867"><span class="annot"><span class="annottext">newUTFStringLen :: [Char] -&gt; IO CStringLen
</span><a href="System.Glib.UTFString.html#newUTFStringLen"><span class="hs-identifier hs-var hs-var hs-var">newUTFStringLen</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; IO CStringLen
</span><span class="hs-identifier hs-var">newCAStringLen</span></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; IO CStringLen)
-&gt; ([Char] -&gt; [Char]) -&gt; [Char] -&gt; IO CStringLen
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; [Char]
</span><span class="hs-identifier hs-var">encodeString</span></span><span>
</span><span id="line-127"></span><span>    </span><span id="local-6989586621679079871"><span class="annot"><span class="annottext">genUTFOfs :: [Char] -&gt; UTFCorrection
</span><a href="System.Glib.UTFString.html#genUTFOfs"><span class="hs-identifier hs-var hs-var hs-var">genUTFOfs</span></a></span></span><span> </span><span id="local-6989586621679079872"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679079872"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; UTFCorrection
</span><a href="System.Glib.UTFString.html#UTFCorrection"><span class="hs-identifier hs-var">UTFCorrection</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; [Char] -&gt; [Int]
forall {a}. Num a =&gt; a -&gt; [Char] -&gt; [a]
</span><a href="#local-6989586621679079874"><span class="hs-identifier hs-var">gUO</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679079872"><span class="hs-identifier hs-var">str</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-129"></span><span>      </span><span id="local-6989586621679079874"><span class="annot"><span class="annottext">gUO :: a -&gt; [Char] -&gt; [a]
</span><a href="#local-6989586621679079874"><span class="hs-identifier hs-var hs-var">gUO</span></a></span></span><span> </span><span id="local-6989586621679079890"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679079890"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-130"></span><span>      </span><span class="annot"><a href="#local-6989586621679079874"><span class="hs-identifier hs-var">gUO</span></a></span><span> </span><span id="local-6989586621679079891"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679079891"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679079892"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679079892"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679079893"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679079893"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Int
</span><span class="hs-identifier hs-var">ord</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679079892"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0x007F</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; [Char] -&gt; [a]
</span><a href="#local-6989586621679079874"><span class="hs-identifier hs-var">gUO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679079891"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679079893"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-131"></span><span>                   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Int
</span><span class="hs-identifier hs-var">ord</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679079892"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0x07FF</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679079891"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">a -&gt; [Char] -&gt; [a]
</span><a href="#local-6989586621679079874"><span class="hs-identifier hs-var">gUO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679079891"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679079893"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-132"></span><span>                   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Char -&gt; Int
</span><span class="hs-identifier hs-var">ord</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679079892"><span class="hs-identifier hs-var">x</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">0xFFFF</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679079891"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679079891"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">a -&gt; [Char] -&gt; [a]
</span><a href="#local-6989586621679079874"><span class="hs-identifier hs-var">gUO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679079891"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679079893"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-133"></span><span>                   </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679079891"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679079891"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679079891"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">a -&gt; [a] -&gt; [a]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">a -&gt; [Char] -&gt; [a]
</span><a href="#local-6989586621679079874"><span class="hs-identifier hs-var">gUO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679079891"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">a
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679079893"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-134"></span><span>    </span><span id="local-6989586621679079898"><span class="annot"><span class="annottext">stringLength :: [Char] -&gt; Int
</span><a href="System.Glib.UTFString.html#stringLength"><span class="hs-identifier hs-var hs-var hs-var">stringLength</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span>
</span><span id="line-135"></span><span>    </span><span id="local-6989586621679079905"><span class="annot"><span class="annottext">unPrintf :: [Char] -&gt; [Char]
</span><a href="System.Glib.UTFString.html#unPrintf"><span class="hs-identifier hs-var hs-var hs-var">unPrintf</span></a></span></span><span> </span><span id="local-6989586621679079906"><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679079906"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char]
</span><a href="#local-6989586621679079906"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; (Char -&gt; [Char]) -&gt; [Char]
forall a b. [a] -&gt; (a -&gt; [b]) -&gt; [b]
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; [Char]
forall {m :: * -&gt; *}.
(IsString (m Char), Monad m) =&gt;
Char -&gt; m Char
</span><a href="#local-6989586621679079907"><span class="hs-identifier hs-var">replace</span></a></span><span>
</span><span id="line-136"></span><span>        </span><span class="hs-keyword">where</span><span>
</span><span id="line-137"></span><span>            </span><span id="local-6989586621679079907"><span class="annot"><span class="annottext">replace :: Char -&gt; m Char
</span><a href="#local-6989586621679079907"><span class="hs-identifier hs-var hs-var">replace</span></a></span></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'%'</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m Char
</span><span class="hs-string">&quot;%%&quot;</span></span><span>
</span><span id="line-138"></span><span>            </span><span class="annot"><a href="#local-6989586621679079907"><span class="hs-identifier hs-var">replace</span></a></span><span> </span><span id="local-6989586621679079918"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679079918"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char -&gt; m Char
forall a. a -&gt; m a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679079918"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-keyword">unsafe</span></span><span> </span><span class="annot"><span class="hs-string">&quot;string.h strlen&quot;</span></span><span> </span><span id="c_strlen"><span class="annot"><a href="System.Glib.UTFString.html#c_strlen"><span class="hs-identifier hs-var">c_strlen</span></a></span></span><span>
</span><span id="line-141"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CSize</span></span><span>
</span><span id="line-142"></span><span>
</span><span id="line-143"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="System.Glib.UTFString.html#GlibString"><span class="hs-identifier hs-type">GlibString</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-144"></span><span>    </span><span id="local-6989586621679079940"><span class="annot"><span class="annottext">withUTFString :: forall a. Text -&gt; (Ptr CChar -&gt; IO a) -&gt; IO a
</span><a href="System.Glib.UTFString.html#withUTFString"><span class="hs-identifier hs-var hs-var hs-var">withUTFString</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; (Ptr CChar -&gt; IO a) -&gt; IO a
forall a. ByteString -&gt; (Ptr CChar -&gt; IO a) -&gt; IO a
</span><span class="hs-identifier hs-var">useAsCString</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; (Ptr CChar -&gt; IO a) -&gt; IO a)
-&gt; (Text -&gt; ByteString) -&gt; Text -&gt; (Ptr CChar -&gt; IO a) -&gt; IO a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; ByteString
</span><span class="hs-identifier hs-var">encodeUtf8</span></span><span>
</span><span id="line-145"></span><span>    </span><span id="local-6989586621679079941"><span class="annot"><span class="annottext">withUTFStringLen :: forall a. Text -&gt; (CStringLen -&gt; IO a) -&gt; IO a
</span><a href="System.Glib.UTFString.html#withUTFStringLen"><span class="hs-identifier hs-var hs-var hs-var">withUTFStringLen</span></a></span></span><span> </span><span id="local-6989586621679079942"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679079942"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621679079943"><span class="annot"><span class="annottext">CStringLen -&gt; IO a
</span><a href="#local-6989586621679079943"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; (CStringLen -&gt; IO a) -&gt; IO a
forall a. Text -&gt; (CStringLen -&gt; IO a) -&gt; IO a
</span><span class="hs-identifier hs-var">T.withCStringLen</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679079942"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CStringLen -&gt; IO a
</span><a href="#local-6989586621679079943"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(CStringLen -&gt; IO a)
-&gt; (CStringLen -&gt; CStringLen) -&gt; CStringLen -&gt; IO a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">CStringLen -&gt; CStringLen
</span><a href="System.Glib.UTFString.html#noNullPtrs"><span class="hs-identifier hs-var">noNullPtrs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-146"></span><span>    </span><span id="local-6989586621679079948"><span class="annot"><span class="annottext">peekUTFString :: Ptr CChar -&gt; IO Text
</span><a href="System.Glib.UTFString.html#peekUTFString"><span class="hs-identifier hs-var hs-var hs-var">peekUTFString</span></a></span></span><span> </span><span id="local-6989586621679079949"><span class="annot"><span class="annottext">Ptr CChar
</span><a href="#local-6989586621679079949"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-147"></span><span>        </span><span id="local-6989586621679079950"><span class="annot"><a href="#local-6989586621679079950"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Ptr CChar -&gt; IO CSize
</span><a href="System.Glib.UTFString.html#c_strlen"><span class="hs-identifier hs-var">c_strlen</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr CChar
</span><a href="#local-6989586621679079949"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-148"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">T.peekCStringLen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679079949"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">fromIntegral</span></span><span> </span><span class="annot"><a href="#local-6989586621679079950"><span class="hs-identifier hs-type">len</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-149"></span><span>    </span><span id="local-6989586621679079952"><span class="annot"><span class="annottext">maybePeekUTFString :: Ptr CChar -&gt; IO (Maybe Text)
</span><a href="System.Glib.UTFString.html#maybePeekUTFString"><span class="hs-identifier hs-var hs-var hs-var">maybePeekUTFString</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Ptr CChar -&gt; IO Text) -&gt; Ptr CChar -&gt; IO (Maybe Text)
forall a b. (Ptr a -&gt; IO b) -&gt; Ptr a -&gt; IO (Maybe b)
</span><span class="hs-identifier hs-var">maybePeek</span></span><span> </span><span class="annot"><span class="annottext">Ptr CChar -&gt; IO Text
forall s. GlibString s =&gt; Ptr CChar -&gt; IO s
</span><a href="System.Glib.UTFString.html#peekUTFString"><span class="hs-identifier hs-var">peekUTFString</span></a></span><span>
</span><span id="line-150"></span><span>    </span><span id="local-6989586621679079953"><span class="annot"><span class="annottext">peekUTFStringLen :: CStringLen -&gt; IO Text
</span><a href="System.Glib.UTFString.html#peekUTFStringLen"><span class="hs-identifier hs-var hs-var hs-var">peekUTFStringLen</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CStringLen -&gt; IO Text
</span><span class="hs-identifier hs-var">T.peekCStringLen</span></span><span>
</span><span id="line-151"></span><span>    </span><span id="local-6989586621679079955"><span class="annot"><span class="annottext">newUTFString :: Text -&gt; IO (Ptr CChar)
</span><a href="System.Glib.UTFString.html#newUTFString"><span class="hs-identifier hs-var hs-var hs-var">newUTFString</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; IO (Ptr CChar)
forall s. GlibString s =&gt; s -&gt; IO (Ptr CChar)
</span><a href="System.Glib.UTFString.html#newUTFString"><span class="hs-identifier hs-var">newUTFString</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; IO (Ptr CChar))
-&gt; (Text -&gt; [Char]) -&gt; Text -&gt; IO (Ptr CChar)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; [Char]
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="hs-comment">-- TODO optimize</span><span>
</span><span id="line-152"></span><span>    </span><span id="local-6989586621679079957"><span class="annot"><span class="annottext">newUTFStringLen :: Text -&gt; IO CStringLen
</span><a href="System.Glib.UTFString.html#newUTFStringLen"><span class="hs-identifier hs-var hs-var hs-var">newUTFStringLen</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; IO CStringLen
forall s. GlibString s =&gt; s -&gt; IO CStringLen
</span><a href="System.Glib.UTFString.html#newUTFStringLen"><span class="hs-identifier hs-var">newUTFStringLen</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; IO CStringLen)
-&gt; (Text -&gt; [Char]) -&gt; Text -&gt; IO CStringLen
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; [Char]
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="hs-comment">-- TODO optimize</span><span>
</span><span id="line-153"></span><span>    </span><span id="local-6989586621679079959"><span class="annot"><span class="annottext">genUTFOfs :: Text -&gt; UTFCorrection
</span><a href="System.Glib.UTFString.html#genUTFOfs"><span class="hs-identifier hs-var hs-var hs-var">genUTFOfs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; UTFCorrection
forall s. GlibString s =&gt; s -&gt; UTFCorrection
</span><a href="System.Glib.UTFString.html#genUTFOfs"><span class="hs-identifier hs-var">genUTFOfs</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; UTFCorrection)
-&gt; (Text -&gt; [Char]) -&gt; Text -&gt; UTFCorrection
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Text -&gt; [Char]
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="hs-comment">-- TODO optimize</span><span>
</span><span id="line-154"></span><span>    </span><span id="local-6989586621679079960"><span class="annot"><span class="annottext">stringLength :: Text -&gt; Int
</span><a href="System.Glib.UTFString.html#stringLength"><span class="hs-identifier hs-var hs-var hs-var">stringLength</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Int
</span><span class="hs-identifier hs-var">T.length</span></span><span>
</span><span id="line-155"></span><span>    </span><span id="local-6989586621679079965"><span class="annot"><span class="annottext">unPrintf :: Text -&gt; Text
</span><a href="System.Glib.UTFString.html#unPrintf"><span class="hs-identifier hs-var hs-var hs-var">unPrintf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">HasCallStack =&gt; Text -&gt; Text -&gt; Text -&gt; Text
Text -&gt; Text -&gt; Text -&gt; Text
</span><span class="hs-identifier hs-var">T.replace</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;%&quot;</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;%%&quot;</span></span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span class="annot"><a href="System.Glib.UTFString.html#glibToString"><span class="hs-identifier hs-type">glibToString</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-158"></span><span id="glibToString"><span class="annot"><span class="annottext">glibToString :: Text -&gt; [Char]
</span><a href="System.Glib.UTFString.html#glibToString"><span class="hs-identifier hs-var hs-var">glibToString</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; [Char]
</span><span class="hs-identifier hs-var">T.unpack</span></span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span class="annot"><a href="System.Glib.UTFString.html#stringToGlib"><span class="hs-identifier hs-type">stringToGlib</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-161"></span><span id="stringToGlib"><span class="annot"><span class="annottext">stringToGlib :: [Char] -&gt; Text
</span><a href="System.Glib.UTFString.html#stringToGlib"><span class="hs-identifier hs-var hs-var">stringToGlib</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span class="hs-comment">-- | Like like 'peekUTFString' but then frees the string using g_free</span><span>
</span><span id="line-164"></span><span class="hs-comment">--</span><span>
</span><span id="line-165"></span><span id="local-6989586621679079966"><span class="annot"><a href="System.Glib.UTFString.html#readUTFString"><span class="hs-identifier hs-type">readUTFString</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.Glib.UTFString.html#GlibString"><span class="hs-identifier hs-type">GlibString</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079966"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679079966"><span class="hs-identifier hs-type">s</span></a></span></span><span>
</span><span id="line-166"></span><span id="readUTFString"><span class="annot"><span class="annottext">readUTFString :: forall s. GlibString s =&gt; Ptr CChar -&gt; IO s
</span><a href="System.Glib.UTFString.html#readUTFString"><span class="hs-identifier hs-var hs-var">readUTFString</span></a></span></span><span> </span><span id="local-6989586621679079972"><span class="annot"><span class="annottext">Ptr CChar
</span><a href="#local-6989586621679079972"><span class="hs-identifier hs-var">strPtr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-167"></span><span>  </span><span id="local-6989586621679079973"><span class="annot"><a href="#local-6989586621679079973"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Ptr CChar -&gt; IO s
forall s. GlibString s =&gt; Ptr CChar -&gt; IO s
</span><a href="System.Glib.UTFString.html#peekUTFString"><span class="hs-identifier hs-var">peekUTFString</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr CChar
</span><a href="#local-6989586621679079972"><span class="hs-identifier hs-var">strPtr</span></a></span><span>
</span><span id="line-168"></span><span>  </span><span class="annot"><a href="System.Glib.UTFString.html#g_free"><span class="hs-identifier hs-type">g_free</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079972"><span class="hs-identifier hs-type">strPtr</span></a></span><span>
</span><span id="line-169"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621679079973"><span class="hs-identifier hs-type">str</span></a></span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span class="hs-comment">-- | Like 'peekCString' but then frees the string using @g_free@.</span><span>
</span><span id="line-172"></span><span class="hs-comment">--</span><span>
</span><span id="line-173"></span><span class="annot"><a href="System.Glib.UTFString.html#readCString"><span class="hs-identifier hs-type">readCString</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-174"></span><span id="readCString"><span class="annot"><span class="annottext">readCString :: Ptr CChar -&gt; IO [Char]
</span><a href="System.Glib.UTFString.html#readCString"><span class="hs-identifier hs-var hs-var">readCString</span></a></span></span><span> </span><span id="local-6989586621679079976"><span class="annot"><span class="annottext">Ptr CChar
</span><a href="#local-6989586621679079976"><span class="hs-identifier hs-var">strPtr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-175"></span><span>  </span><span id="local-6989586621679079977"><span class="annot"><a href="#local-6989586621679079977"><span class="hs-identifier hs-var">str</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Ptr CChar -&gt; IO [Char]
</span><span class="hs-identifier hs-var">peekCAString</span></span><span> </span><span class="annot"><span class="annottext">Ptr CChar
</span><a href="#local-6989586621679079976"><span class="hs-identifier hs-var">strPtr</span></a></span><span>
</span><span id="line-176"></span><span>  </span><span class="annot"><a href="System.Glib.UTFString.html#g_free"><span class="hs-identifier hs-type">g_free</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079976"><span class="hs-identifier hs-type">strPtr</span></a></span><span>
</span><span id="line-177"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621679079977"><span class="hs-identifier hs-type">str</span></a></span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-keyword">unsafe</span></span><span> </span><span class="annot"><span class="hs-string">&quot;g_free&quot;</span></span><span>
</span><span id="line-180"></span><span>  </span><span id="g_free"><span class="annot"><a href="System.Glib.UTFString.html#g_free"><span class="hs-identifier hs-var">g_free</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679079694"><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><a href="#local-6989586621679079694"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span class="hs-comment">-- | Temporarily allocate a list of UTF-8 'CString's.</span><span>
</span><span id="line-183"></span><span class="hs-comment">--</span><span>
</span><span id="line-184"></span><span id="local-6989586621679079695"><span id="local-6989586621679079696"><span class="annot"><a href="System.Glib.UTFString.html#withUTFStrings"><span class="hs-identifier hs-type">withUTFStrings</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.Glib.UTFString.html#GlibString"><span class="hs-identifier hs-type">GlibString</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079695"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679079695"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">CString</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679079696"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679079696"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-185"></span><span id="withUTFStrings"><span class="annot"><span class="annottext">withUTFStrings :: forall s a. GlibString s =&gt; [s] -&gt; ([Ptr CChar] -&gt; IO a) -&gt; IO a
</span><a href="System.Glib.UTFString.html#withUTFStrings"><span class="hs-identifier hs-var hs-var">withUTFStrings</span></a></span></span><span> </span><span id="local-6989586621679079980"><span class="annot"><span class="annottext">[s]
</span><a href="#local-6989586621679079980"><span class="hs-identifier hs-var">hsStrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[s] -&gt; [Ptr CChar] -&gt; ([Ptr CChar] -&gt; IO a) -&gt; IO a
forall s a.
GlibString s =&gt;
[s] -&gt; [Ptr CChar] -&gt; ([Ptr CChar] -&gt; IO a) -&gt; IO a
</span><a href="#local-6989586621679079981"><span class="hs-identifier hs-var">withUTFStrings'</span></a></span><span> </span><span class="annot"><span class="annottext">[s]
</span><a href="#local-6989586621679079980"><span class="hs-identifier hs-var">hsStrs</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-186"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679079699"><span id="local-6989586621679079700"><span class="annot"><a href="#local-6989586621679079981"><span class="hs-identifier hs-type">withUTFStrings'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.Glib.UTFString.html#GlibString"><span class="hs-identifier hs-type">GlibString</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079699"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679079699"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">CString</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">CString</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679079700"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679079700"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-187"></span><span>        </span><span id="local-6989586621679079981"><span class="annot"><span class="annottext">withUTFStrings' :: forall s a.
GlibString s =&gt;
[s] -&gt; [Ptr CChar] -&gt; ([Ptr CChar] -&gt; IO a) -&gt; IO a
</span><a href="#local-6989586621679079981"><span class="hs-identifier hs-var hs-var">withUTFStrings'</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span id="local-6989586621679079985"><span class="annot"><span class="annottext">[Ptr CChar]
</span><a href="#local-6989586621679079985"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span id="local-6989586621679079986"><span class="annot"><span class="annottext">[Ptr CChar] -&gt; IO a
</span><a href="#local-6989586621679079986"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Ptr CChar] -&gt; IO a
</span><a href="#local-6989586621679079986"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Ptr CChar] -&gt; [Ptr CChar]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[Ptr CChar]
</span><a href="#local-6989586621679079985"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-188"></span><span>        </span><span class="annot"><a href="#local-6989586621679079981"><span class="hs-identifier hs-var">withUTFStrings'</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679079988"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679079988"><span class="hs-identifier hs-var">s</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679079989"><span class="annot"><span class="annottext">[s]
</span><a href="#local-6989586621679079989"><span class="hs-identifier hs-var">ss</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679079990"><span class="annot"><span class="annottext">[Ptr CChar]
</span><a href="#local-6989586621679079990"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span id="local-6989586621679079991"><span class="annot"><span class="annottext">[Ptr CChar] -&gt; IO a
</span><a href="#local-6989586621679079991"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">s -&gt; (Ptr CChar -&gt; IO a) -&gt; IO a
forall a. s -&gt; (Ptr CChar -&gt; IO a) -&gt; IO a
forall s a. GlibString s =&gt; s -&gt; (Ptr CChar -&gt; IO a) -&gt; IO a
</span><a href="System.Glib.UTFString.html#withUTFString"><span class="hs-identifier hs-var">withUTFString</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679079988"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr CChar -&gt; IO a) -&gt; IO a) -&gt; (Ptr CChar -&gt; IO a) -&gt; IO a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679079992"><span class="annot"><span class="annottext">Ptr CChar
</span><a href="#local-6989586621679079992"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-189"></span><span>                                         </span><span class="annot"><span class="annottext">[s] -&gt; [Ptr CChar] -&gt; ([Ptr CChar] -&gt; IO a) -&gt; IO a
forall s a.
GlibString s =&gt;
[s] -&gt; [Ptr CChar] -&gt; ([Ptr CChar] -&gt; IO a) -&gt; IO a
</span><a href="#local-6989586621679079981"><span class="hs-identifier hs-var">withUTFStrings'</span></a></span><span> </span><span class="annot"><span class="annottext">[s]
</span><a href="#local-6989586621679079989"><span class="hs-identifier hs-var">ss</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ptr CChar
</span><a href="#local-6989586621679079992"><span class="hs-identifier hs-var">c</span></a></span><span class="annot"><span class="annottext">Ptr CChar -&gt; [Ptr CChar] -&gt; [Ptr CChar]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Ptr CChar]
</span><a href="#local-6989586621679079990"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Ptr CChar] -&gt; IO a
</span><a href="#local-6989586621679079991"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-190"></span><span>
</span><span id="line-191"></span><span class="hs-comment">-- | Temporarily allocate an array of UTF-8 encoded 'CString's.</span><span>
</span><span id="line-192"></span><span class="hs-comment">--</span><span>
</span><span id="line-193"></span><span id="local-6989586621679079708"><span id="local-6989586621679079709"><span class="annot"><a href="System.Glib.UTFString.html#withUTFStringArray"><span class="hs-identifier hs-type">withUTFStringArray</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.Glib.UTFString.html#GlibString"><span class="hs-identifier hs-type">GlibString</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079708"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679079708"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679079709"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679079709"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-194"></span><span id="withUTFStringArray"><span class="annot"><span class="annottext">withUTFStringArray :: forall s a.
GlibString s =&gt;
[s] -&gt; (Ptr (Ptr CChar) -&gt; IO a) -&gt; IO a
</span><a href="System.Glib.UTFString.html#withUTFStringArray"><span class="hs-identifier hs-var hs-var">withUTFStringArray</span></a></span></span><span> </span><span id="local-6989586621679079997"><span class="annot"><span class="annottext">[s]
</span><a href="#local-6989586621679079997"><span class="hs-identifier hs-var">hsStr</span></a></span></span><span> </span><span id="local-6989586621679079998"><span class="annot"><span class="annottext">Ptr (Ptr CChar) -&gt; IO a
</span><a href="#local-6989586621679079998"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-195"></span><span>  </span><span class="annot"><span class="annottext">[s] -&gt; ([Ptr CChar] -&gt; IO a) -&gt; IO a
forall s a. GlibString s =&gt; [s] -&gt; ([Ptr CChar] -&gt; IO a) -&gt; IO a
</span><a href="System.Glib.UTFString.html#withUTFStrings"><span class="hs-identifier hs-var">withUTFStrings</span></a></span><span> </span><span class="annot"><span class="annottext">[s]
</span><a href="#local-6989586621679079997"><span class="hs-identifier hs-var">hsStr</span></a></span><span> </span><span class="annot"><span class="annottext">(([Ptr CChar] -&gt; IO a) -&gt; IO a) -&gt; ([Ptr CChar] -&gt; IO a) -&gt; IO a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679079999"><span class="annot"><span class="annottext">[Ptr CChar]
</span><a href="#local-6989586621679079999"><span class="hs-identifier hs-var">cStrs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-196"></span><span>  </span><span class="annot"><span class="annottext">[Ptr CChar] -&gt; (Ptr (Ptr CChar) -&gt; IO a) -&gt; IO a
forall a b. Storable a =&gt; [a] -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><span class="hs-identifier hs-var">withArray</span></span><span> </span><span class="annot"><span class="annottext">[Ptr CChar]
</span><a href="#local-6989586621679079999"><span class="hs-identifier hs-var">cStrs</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr (Ptr CChar) -&gt; IO a
</span><a href="#local-6989586621679079998"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span class="hs-comment">-- | Temporarily allocate a null-terminated array of UTF-8 encoded 'CString's.</span><span>
</span><span id="line-199"></span><span class="hs-comment">--</span><span>
</span><span id="line-200"></span><span id="local-6989586621679080001"><span id="local-6989586621679080002"><span class="annot"><a href="System.Glib.UTFString.html#withUTFStringArray0"><span class="hs-identifier hs-type">withUTFStringArray0</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.Glib.UTFString.html#GlibString"><span class="hs-identifier hs-type">GlibString</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080001"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679080001"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679080002"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679080002"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-201"></span><span id="withUTFStringArray0"><span class="annot"><span class="annottext">withUTFStringArray0 :: forall s a.
GlibString s =&gt;
[s] -&gt; (Ptr (Ptr CChar) -&gt; IO a) -&gt; IO a
</span><a href="System.Glib.UTFString.html#withUTFStringArray0"><span class="hs-identifier hs-var hs-var">withUTFStringArray0</span></a></span></span><span> </span><span id="local-6989586621679080006"><span class="annot"><span class="annottext">[s]
</span><a href="#local-6989586621679080006"><span class="hs-identifier hs-var">hsStr</span></a></span></span><span> </span><span id="local-6989586621679080007"><span class="annot"><span class="annottext">Ptr (Ptr CChar) -&gt; IO a
</span><a href="#local-6989586621679080007"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-202"></span><span>  </span><span class="annot"><span class="annottext">[s] -&gt; ([Ptr CChar] -&gt; IO a) -&gt; IO a
forall s a. GlibString s =&gt; [s] -&gt; ([Ptr CChar] -&gt; IO a) -&gt; IO a
</span><a href="System.Glib.UTFString.html#withUTFStrings"><span class="hs-identifier hs-var">withUTFStrings</span></a></span><span> </span><span class="annot"><span class="annottext">[s]
</span><a href="#local-6989586621679080006"><span class="hs-identifier hs-var">hsStr</span></a></span><span> </span><span class="annot"><span class="annottext">(([Ptr CChar] -&gt; IO a) -&gt; IO a) -&gt; ([Ptr CChar] -&gt; IO a) -&gt; IO a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679080008"><span class="annot"><span class="annottext">[Ptr CChar]
</span><a href="#local-6989586621679080008"><span class="hs-identifier hs-var">cStrs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-203"></span><span>  </span><span class="annot"><span class="annottext">Ptr CChar -&gt; [Ptr CChar] -&gt; (Ptr (Ptr CChar) -&gt; IO a) -&gt; IO a
forall a b. Storable a =&gt; a -&gt; [a] -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><span class="hs-identifier hs-var">withArray0</span></span><span> </span><span class="annot"><span class="annottext">Ptr CChar
forall a. Ptr a
</span><span class="hs-identifier hs-var">nullPtr</span></span><span> </span><span class="annot"><span class="annottext">[Ptr CChar]
</span><a href="#local-6989586621679080008"><span class="hs-identifier hs-var">cStrs</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr (Ptr CChar) -&gt; IO a
</span><a href="#local-6989586621679080007"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span class="hs-comment">-- | Convert an array (of the given length) of UTF-8 encoded 'CString's to a</span><span>
</span><span id="line-206"></span><span class="hs-comment">--   list of Haskell 'String's.</span><span>
</span><span id="line-207"></span><span class="hs-comment">--</span><span>
</span><span id="line-208"></span><span id="local-6989586621679079720"><span class="annot"><a href="System.Glib.UTFString.html#peekUTFStringArray"><span class="hs-identifier hs-type">peekUTFStringArray</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.Glib.UTFString.html#GlibString"><span class="hs-identifier hs-type">GlibString</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079720"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679079720"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-209"></span><span id="peekUTFStringArray"><span class="annot"><span class="annottext">peekUTFStringArray :: forall s. GlibString s =&gt; Int -&gt; Ptr (Ptr CChar) -&gt; IO [s]
</span><a href="System.Glib.UTFString.html#peekUTFStringArray"><span class="hs-identifier hs-var hs-var">peekUTFStringArray</span></a></span></span><span> </span><span id="local-6989586621679080017"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679080017"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span id="local-6989586621679080018"><span class="annot"><span class="annottext">Ptr (Ptr CChar)
</span><a href="#local-6989586621679080018"><span class="hs-identifier hs-var">cStrArr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-210"></span><span>  </span><span id="local-6989586621679080019"><span class="annot"><a href="#local-6989586621679080019"><span class="hs-identifier hs-var">cStrs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Ptr (Ptr CChar) -&gt; IO [Ptr CChar]
forall a. Storable a =&gt; Int -&gt; Ptr a -&gt; IO [a]
</span><span class="hs-identifier hs-var">peekArray</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679080017"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr (Ptr CChar)
</span><a href="#local-6989586621679080018"><span class="hs-identifier hs-var">cStrArr</span></a></span><span>
</span><span id="line-211"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="annot"><a href="System.Glib.UTFString.html#peekUTFString"><span class="hs-identifier hs-type">peekUTFString</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080019"><span class="hs-identifier hs-type">cStrs</span></a></span><span>
</span><span id="line-212"></span><span>
</span><span id="line-213"></span><span class="hs-comment">-- | Convert a null-terminated array of UTF-8 encoded 'CString's to a list of</span><span>
</span><span id="line-214"></span><span class="hs-comment">--   Haskell 'String's.</span><span>
</span><span id="line-215"></span><span class="hs-comment">--</span><span>
</span><span id="line-216"></span><span id="local-6989586621679079727"><span class="annot"><a href="System.Glib.UTFString.html#peekUTFStringArray0"><span class="hs-identifier hs-type">peekUTFStringArray0</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.Glib.UTFString.html#GlibString"><span class="hs-identifier hs-type">GlibString</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079727"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679079727"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-217"></span><span id="peekUTFStringArray0"><span class="annot"><span class="annottext">peekUTFStringArray0 :: forall s. GlibString s =&gt; Ptr (Ptr CChar) -&gt; IO [s]
</span><a href="System.Glib.UTFString.html#peekUTFStringArray0"><span class="hs-identifier hs-var hs-var">peekUTFStringArray0</span></a></span></span><span> </span><span id="local-6989586621679080029"><span class="annot"><span class="annottext">Ptr (Ptr CChar)
</span><a href="#local-6989586621679080029"><span class="hs-identifier hs-var">cStrArr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-218"></span><span>  </span><span id="local-6989586621679080030"><span class="annot"><a href="#local-6989586621679080030"><span class="hs-identifier hs-var">cStrs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Ptr CChar -&gt; Ptr (Ptr CChar) -&gt; IO [Ptr CChar]
forall a. (Storable a, Eq a) =&gt; a -&gt; Ptr a -&gt; IO [a]
</span><span class="hs-identifier hs-var">peekArray0</span></span><span> </span><span class="annot"><span class="annottext">Ptr CChar
forall a. Ptr a
</span><span class="hs-identifier hs-var">nullPtr</span></span><span> </span><span class="annot"><span class="annottext">Ptr (Ptr CChar)
</span><a href="#local-6989586621679080029"><span class="hs-identifier hs-var">cStrArr</span></a></span><span>
</span><span id="line-219"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="annot"><a href="System.Glib.UTFString.html#peekUTFString"><span class="hs-identifier hs-type">peekUTFString</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080030"><span class="hs-identifier hs-type">cStrs</span></a></span><span>
</span><span id="line-220"></span><span>
</span><span id="line-221"></span><span class="hs-comment">-- | Like 'peekUTFStringArray0' but then free the string array including all</span><span>
</span><span id="line-222"></span><span class="hs-comment">-- strings.</span><span>
</span><span id="line-223"></span><span class="hs-comment">--</span><span>
</span><span id="line-224"></span><span class="hs-comment">-- To be used when functions indicate that their return value should be freed</span><span>
</span><span id="line-225"></span><span class="hs-comment">-- with @g_strfreev@.</span><span>
</span><span id="line-226"></span><span class="hs-comment">--</span><span>
</span><span id="line-227"></span><span id="local-6989586621679080032"><span class="annot"><a href="System.Glib.UTFString.html#readUTFStringArray0"><span class="hs-identifier hs-type">readUTFStringArray0</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.Glib.UTFString.html#GlibString"><span class="hs-identifier hs-type">GlibString</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080032"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679080032"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-228"></span><span id="readUTFStringArray0"><span class="annot"><span class="annottext">readUTFStringArray0 :: forall s. GlibString s =&gt; Ptr (Ptr CChar) -&gt; IO [s]
</span><a href="System.Glib.UTFString.html#readUTFStringArray0"><span class="hs-identifier hs-var hs-var">readUTFStringArray0</span></a></span></span><span> </span><span id="local-6989586621679080045"><span class="annot"><span class="annottext">Ptr (Ptr CChar)
</span><a href="#local-6989586621679080045"><span class="hs-identifier hs-var">cStrArr</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Ptr (Ptr CChar)
</span><a href="#local-6989586621679080045"><span class="hs-identifier hs-var">cStrArr</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr (Ptr CChar) -&gt; Ptr (Ptr CChar) -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Ptr (Ptr CChar)
forall a. Ptr a
</span><span class="hs-identifier hs-var">nullPtr</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[s] -&gt; IO [s]
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-229"></span><span>                            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-230"></span><span>  </span><span id="local-6989586621679080046"><span class="annot"><a href="#local-6989586621679080046"><span class="hs-identifier hs-var">cStrs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Ptr CChar -&gt; Ptr (Ptr CChar) -&gt; IO [Ptr CChar]
forall a. (Storable a, Eq a) =&gt; a -&gt; Ptr a -&gt; IO [a]
</span><span class="hs-identifier hs-var">peekArray0</span></span><span> </span><span class="annot"><span class="annottext">Ptr CChar
forall a. Ptr a
</span><span class="hs-identifier hs-var">nullPtr</span></span><span> </span><span class="annot"><span class="annottext">Ptr (Ptr CChar)
</span><a href="#local-6989586621679080045"><span class="hs-identifier hs-var">cStrArr</span></a></span><span>
</span><span id="line-231"></span><span>  </span><span id="local-6989586621679080047"><span class="annot"><a href="#local-6989586621679080047"><span class="hs-identifier hs-var">strings</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="annot"><a href="System.Glib.UTFString.html#peekUTFString"><span class="hs-identifier hs-type">peekUTFString</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080046"><span class="hs-identifier hs-type">cStrs</span></a></span><span>
</span><span id="line-232"></span><span>  </span><span class="annot"><a href="System.Glib.UTFString.html#g_strfreev"><span class="hs-identifier hs-type">g_strfreev</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080045"><span class="hs-identifier hs-type">cStrArr</span></a></span><span>
</span><span id="line-233"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621679080047"><span class="hs-identifier hs-type">strings</span></a></span><span>
</span><span id="line-234"></span><span>
</span><span id="line-235"></span><span class="hs-keyword">foreign</span><span> </span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-keyword">ccall</span></span><span> </span><span class="annot"><span class="hs-keyword">unsafe</span></span><span> </span><span class="annot"><span class="hs-string">&quot;g_strfreev&quot;</span></span><span>
</span><span id="line-236"></span><span>  </span><span id="g_strfreev"><span class="annot"><a href="System.Glib.UTFString.html#g_strfreev"><span class="hs-identifier hs-var">g_strfreev</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679080049"><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><a href="#local-6989586621679080049"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span class="hs-comment">-- | Offset correction for String to UTF8 mapping.</span><span>
</span><span id="line-239"></span><span class="hs-comment">--</span><span>
</span><span id="line-240"></span><span class="hs-keyword">newtype</span><span> </span><span id="UTFCorrection"><span class="annot"><a href="System.Glib.UTFString.html#UTFCorrection"><span class="hs-identifier hs-var">UTFCorrection</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="UTFCorrection"><span class="annot"><a href="System.Glib.UTFString.html#UTFCorrection"><span class="hs-identifier hs-var">UTFCorrection</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span class="hs-special">]</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679080051"><span id="local-6989586621679080056"><span id="local-6989586621679080060"><span class="annot"><span class="annottext">Int -&gt; UTFCorrection -&gt; [Char] -&gt; [Char]
[UTFCorrection] -&gt; [Char] -&gt; [Char]
UTFCorrection -&gt; [Char]
(Int -&gt; UTFCorrection -&gt; [Char] -&gt; [Char])
-&gt; (UTFCorrection -&gt; [Char])
-&gt; ([UTFCorrection] -&gt; [Char] -&gt; [Char])
-&gt; Show UTFCorrection
forall a.
(Int -&gt; a -&gt; [Char] -&gt; [Char])
-&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; [Char] -&gt; [Char]) -&gt; Show a
$cshowsPrec :: Int -&gt; UTFCorrection -&gt; [Char] -&gt; [Char]
showsPrec :: Int -&gt; UTFCorrection -&gt; [Char] -&gt; [Char]
$cshow :: UTFCorrection -&gt; [Char]
show :: UTFCorrection -&gt; [Char]
$cshowList :: [UTFCorrection] -&gt; [Char] -&gt; [Char]
showList :: [UTFCorrection] -&gt; [Char] -&gt; [Char]
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span>
</span><span id="line-241"></span><span>
</span><span id="line-242"></span><span class="annot"><a href="System.Glib.UTFString.html#ofsToUTF"><span class="hs-identifier hs-type">ofsToUTF</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="System.Glib.UTFString.html#UTFCorrection"><span class="hs-identifier hs-type">UTFCorrection</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-243"></span><span id="ofsToUTF"><span class="annot"><span class="annottext">ofsToUTF :: Int -&gt; UTFCorrection -&gt; Int
</span><a href="System.Glib.UTFString.html#ofsToUTF"><span class="hs-identifier hs-var hs-var">ofsToUTF</span></a></span></span><span> </span><span id="local-6989586621679080065"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679080065"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="System.Glib.UTFString.html#UTFCorrection"><span class="hs-identifier hs-type">UTFCorrection</span></a></span><span> </span><span id="local-6989586621679080066"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679080066"><span class="hs-identifier hs-var">oc</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Int] -&gt; Int
</span><a href="#local-6989586621679080067"><span class="hs-identifier hs-var">oTU</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679080066"><span class="hs-identifier hs-var">oc</span></a></span><span>
</span><span id="line-244"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-245"></span><span>  </span><span id="local-6989586621679080067"><span class="annot"><span class="annottext">oTU :: [Int] -&gt; Int
</span><a href="#local-6989586621679080067"><span class="hs-identifier hs-var hs-var">oTU</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679080065"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-246"></span><span>  </span><span class="annot"><a href="#local-6989586621679080067"><span class="hs-identifier hs-var">oTU</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679080068"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679080068"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679080069"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679080069"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679080065"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679080068"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679080065"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-247"></span><span>             </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span class="annot"><span class="annottext">[Int] -&gt; Int
</span><a href="#local-6989586621679080067"><span class="hs-identifier hs-var">oTU</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679080069"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-248"></span><span>
</span><span id="line-249"></span><span class="annot"><a href="System.Glib.UTFString.html#ofsFromUTF"><span class="hs-identifier hs-type">ofsFromUTF</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="System.Glib.UTFString.html#UTFCorrection"><span class="hs-identifier hs-type">UTFCorrection</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Int</span></span><span>
</span><span id="line-250"></span><span id="ofsFromUTF"><span class="annot"><span class="annottext">ofsFromUTF :: Int -&gt; UTFCorrection -&gt; Int
</span><a href="System.Glib.UTFString.html#ofsFromUTF"><span class="hs-identifier hs-var hs-var">ofsFromUTF</span></a></span></span><span> </span><span id="local-6989586621679080070"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679080070"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="System.Glib.UTFString.html#UTFCorrection"><span class="hs-identifier hs-type">UTFCorrection</span></a></span><span> </span><span id="local-6989586621679080071"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679080071"><span class="hs-identifier hs-var">oc</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; [Int] -&gt; Int
forall {t}. (Ord t, Num t) =&gt; t -&gt; [t] -&gt; t
</span><a href="#local-6989586621679080072"><span class="hs-identifier hs-var">oFU</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679080070"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679080071"><span class="hs-identifier hs-var">oc</span></a></span><span>
</span><span id="line-251"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-252"></span><span>  </span><span id="local-6989586621679080072"><span class="annot"><span class="annottext">oFU :: t -&gt; [t] -&gt; t
</span><a href="#local-6989586621679080072"><span class="hs-identifier hs-var hs-var">oFU</span></a></span></span><span> </span><span id="local-6989586621679080081"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679080081"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679080081"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-253"></span><span>  </span><span class="annot"><a href="#local-6989586621679080072"><span class="hs-identifier hs-var">oFU</span></a></span><span> </span><span id="local-6989586621679080082"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679080082"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679080083"><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679080083"><span class="hs-identifier hs-var">x</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679080084"><span class="annot"><span class="annottext">[t]
</span><a href="#local-6989586621679080084"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679080082"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">t -&gt; t -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;=</span></span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679080083"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679080082"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-254"></span><span>               </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">t -&gt; [t] -&gt; t
</span><a href="#local-6989586621679080072"><span class="hs-identifier hs-var">oFU</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t
</span><a href="#local-6989586621679080082"><span class="hs-identifier hs-var">n</span></a></span><span class="annot"><span class="annottext">t -&gt; t -&gt; t
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-glyph hs-var">-</span></span><span class="annot"><span class="annottext">t
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[t]
</span><a href="#local-6989586621679080084"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-255"></span><span>
</span><span id="line-256"></span><span class="hs-keyword">type</span><span> </span><span id="DefaultGlibString"><span class="annot"><a href="System.Glib.UTFString.html#DefaultGlibString"><span class="hs-identifier hs-var">DefaultGlibString</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">T.Text</span></span><span>
</span><span id="line-257"></span><span>
</span><span id="line-258"></span><span class="hs-keyword">class</span><span> </span><span class="annot"><a href="#local-6989586621679079733"><span class="hs-identifier hs-type">fp</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">~</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="GlibFilePath"><span class="annot"><a href="System.Glib.UTFString.html#GlibFilePath"><span class="hs-identifier hs-var">GlibFilePath</span></a></span></span><span> </span><span id="local-6989586621679079733"><span class="annot"><a href="#local-6989586621679079733"><span class="hs-identifier hs-type">fp</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-259"></span><span>    </span><span id="withUTFFilePath"><span class="annot"><a href="System.Glib.UTFString.html#withUTFFilePath"><span class="hs-identifier hs-type">withUTFFilePath</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span id="local-6989586621679079735"><span class="annot"><a href="#local-6989586621679079733"><span class="hs-identifier hs-type">fp</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">CString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679079735"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679079735"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-260"></span><span>    </span><span id="peekUTFFilePath"><span class="annot"><a href="System.Glib.UTFString.html#peekUTFFilePath"><span class="hs-identifier hs-type">peekUTFFilePath</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679079733"><span class="hs-identifier hs-type">fp</span></a></span><span>
</span><span id="line-261"></span><span>
</span><span id="line-262"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="System.Glib.UTFString.html#GlibFilePath"><span class="hs-identifier hs-type">GlibFilePath</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">FilePath</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-263"></span><span>    </span><span id="local-6989586621679080096"><span class="annot"><span class="annottext">withUTFFilePath :: forall a. [Char] -&gt; (Ptr CChar -&gt; IO a) -&gt; IO a
</span><a href="System.Glib.UTFString.html#withUTFFilePath"><span class="hs-identifier hs-var hs-var hs-var">withUTFFilePath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; (Ptr CChar -&gt; IO a) -&gt; IO a
forall a. Text -&gt; (Ptr CChar -&gt; IO a) -&gt; IO a
forall s a. GlibString s =&gt; s -&gt; (Ptr CChar -&gt; IO a) -&gt; IO a
</span><a href="System.Glib.UTFString.html#withUTFString"><span class="hs-identifier hs-var">withUTFString</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; (Ptr CChar -&gt; IO a) -&gt; IO a)
-&gt; ([Char] -&gt; Text) -&gt; [Char] -&gt; (Ptr CChar -&gt; IO a) -&gt; IO a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Text
</span><span class="hs-identifier hs-var">T.pack</span></span><span>
</span><span id="line-264"></span><span>    </span><span id="local-6989586621679080100"><span class="annot"><span class="annottext">peekUTFFilePath :: Ptr CChar -&gt; IO [Char]
</span><a href="System.Glib.UTFString.html#peekUTFFilePath"><span class="hs-identifier hs-var hs-var hs-var">peekUTFFilePath</span></a></span></span><span> </span><span id="local-6989586621679080101"><span class="annot"><span class="annottext">Ptr CChar
</span><a href="#local-6989586621679080101"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; [Char]
</span><span class="hs-identifier hs-var">T.unpack</span></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; [Char]) -&gt; IO Text -&gt; IO [Char]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Ptr CChar -&gt; IO Text
forall s. GlibString s =&gt; Ptr CChar -&gt; IO s
</span><a href="System.Glib.UTFString.html#peekUTFString"><span class="hs-identifier hs-var">peekUTFString</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr CChar
</span><a href="#local-6989586621679080101"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-265"></span><span>
</span><span id="line-266"></span><span id="local-6989586621679079740"><span id="local-6989586621679079741"><span class="annot"><a href="System.Glib.UTFString.html#withUTFFilePaths"><span class="hs-identifier hs-type">withUTFFilePaths</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.Glib.UTFString.html#GlibFilePath"><span class="hs-identifier hs-type">GlibFilePath</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079740"><span class="hs-identifier hs-type">fp</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679079740"><span class="hs-identifier hs-type">fp</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">CString</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679079741"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679079741"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-267"></span><span id="withUTFFilePaths"><span class="annot"><span class="annottext">withUTFFilePaths :: forall fp a.
GlibFilePath fp =&gt;
[fp] -&gt; ([Ptr CChar] -&gt; IO a) -&gt; IO a
</span><a href="System.Glib.UTFString.html#withUTFFilePaths"><span class="hs-identifier hs-var hs-var">withUTFFilePaths</span></a></span></span><span> </span><span id="local-6989586621679080107"><span class="annot"><span class="annottext">[fp]
</span><a href="#local-6989586621679080107"><span class="hs-identifier hs-var">hsStrs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[fp] -&gt; [Ptr CChar] -&gt; ([Ptr CChar] -&gt; IO a) -&gt; IO a
forall fp a.
GlibFilePath fp =&gt;
[fp] -&gt; [Ptr CChar] -&gt; ([Ptr CChar] -&gt; IO a) -&gt; IO a
</span><a href="#local-6989586621679080108"><span class="hs-identifier hs-var">withUTFFilePath'</span></a></span><span> </span><span class="annot"><span class="annottext">[fp]
</span><a href="#local-6989586621679080107"><span class="hs-identifier hs-var">hsStrs</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-268"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679079744"><span id="local-6989586621679079745"><span class="annot"><a href="#local-6989586621679080108"><span class="hs-identifier hs-type">withUTFFilePath'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.Glib.UTFString.html#GlibFilePath"><span class="hs-identifier hs-type">GlibFilePath</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079744"><span class="hs-identifier hs-type">fp</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679079744"><span class="hs-identifier hs-type">fp</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">CString</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">CString</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679079745"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679079745"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-269"></span><span>        </span><span id="local-6989586621679080108"><span class="annot"><span class="annottext">withUTFFilePath' :: forall fp a.
GlibFilePath fp =&gt;
[fp] -&gt; [Ptr CChar] -&gt; ([Ptr CChar] -&gt; IO a) -&gt; IO a
</span><a href="#local-6989586621679080108"><span class="hs-identifier hs-var hs-var">withUTFFilePath'</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>       </span><span id="local-6989586621679080114"><span class="annot"><span class="annottext">[Ptr CChar]
</span><a href="#local-6989586621679080114"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span id="local-6989586621679080115"><span class="annot"><span class="annottext">[Ptr CChar] -&gt; IO a
</span><a href="#local-6989586621679080115"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Ptr CChar] -&gt; IO a
</span><a href="#local-6989586621679080115"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Ptr CChar] -&gt; [Ptr CChar]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">reverse</span></span><span> </span><span class="annot"><span class="annottext">[Ptr CChar]
</span><a href="#local-6989586621679080114"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-270"></span><span>        </span><span class="annot"><a href="#local-6989586621679080108"><span class="hs-identifier hs-var">withUTFFilePath'</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679080116"><span class="annot"><span class="annottext">fp
</span><a href="#local-6989586621679080116"><span class="hs-identifier hs-var">fp</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679080117"><span class="annot"><span class="annottext">[fp]
</span><a href="#local-6989586621679080117"><span class="hs-identifier hs-var">fps</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679080118"><span class="annot"><span class="annottext">[Ptr CChar]
</span><a href="#local-6989586621679080118"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span id="local-6989586621679080119"><span class="annot"><span class="annottext">[Ptr CChar] -&gt; IO a
</span><a href="#local-6989586621679080119"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">fp -&gt; (Ptr CChar -&gt; IO a) -&gt; IO a
forall a. fp -&gt; (Ptr CChar -&gt; IO a) -&gt; IO a
forall fp a. GlibFilePath fp =&gt; fp -&gt; (Ptr CChar -&gt; IO a) -&gt; IO a
</span><a href="System.Glib.UTFString.html#withUTFFilePath"><span class="hs-identifier hs-var">withUTFFilePath</span></a></span><span> </span><span class="annot"><span class="annottext">fp
</span><a href="#local-6989586621679080116"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="annot"><span class="annottext">((Ptr CChar -&gt; IO a) -&gt; IO a) -&gt; (Ptr CChar -&gt; IO a) -&gt; IO a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679080120"><span class="annot"><span class="annottext">Ptr CChar
</span><a href="#local-6989586621679080120"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-271"></span><span>                                            </span><span class="annot"><span class="annottext">[fp] -&gt; [Ptr CChar] -&gt; ([Ptr CChar] -&gt; IO a) -&gt; IO a
forall fp a.
GlibFilePath fp =&gt;
[fp] -&gt; [Ptr CChar] -&gt; ([Ptr CChar] -&gt; IO a) -&gt; IO a
</span><a href="#local-6989586621679080108"><span class="hs-identifier hs-var">withUTFFilePath'</span></a></span><span> </span><span class="annot"><span class="annottext">[fp]
</span><a href="#local-6989586621679080117"><span class="hs-identifier hs-var">fps</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Ptr CChar
</span><a href="#local-6989586621679080120"><span class="hs-identifier hs-var">c</span></a></span><span class="annot"><span class="annottext">Ptr CChar -&gt; [Ptr CChar] -&gt; [Ptr CChar]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="annot"><span class="annottext">[Ptr CChar]
</span><a href="#local-6989586621679080118"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Ptr CChar] -&gt; IO a
</span><a href="#local-6989586621679080119"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-272"></span><span>
</span><span id="line-273"></span><span id="local-6989586621679079748"><span id="local-6989586621679079749"><span class="annot"><a href="System.Glib.UTFString.html#withUTFFilePathArray"><span class="hs-identifier hs-type">withUTFFilePathArray</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.Glib.UTFString.html#GlibFilePath"><span class="hs-identifier hs-type">GlibFilePath</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079748"><span class="hs-identifier hs-type">fp</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679079748"><span class="hs-identifier hs-type">fp</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679079749"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679079749"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-274"></span><span id="withUTFFilePathArray"><span class="annot"><span class="annottext">withUTFFilePathArray :: forall fp a.
GlibFilePath fp =&gt;
[fp] -&gt; (Ptr (Ptr CChar) -&gt; IO a) -&gt; IO a
</span><a href="System.Glib.UTFString.html#withUTFFilePathArray"><span class="hs-identifier hs-var hs-var">withUTFFilePathArray</span></a></span></span><span> </span><span id="local-6989586621679080127"><span class="annot"><span class="annottext">[fp]
</span><a href="#local-6989586621679080127"><span class="hs-identifier hs-var">hsFP</span></a></span></span><span> </span><span id="local-6989586621679080128"><span class="annot"><span class="annottext">Ptr (Ptr CChar) -&gt; IO a
</span><a href="#local-6989586621679080128"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-275"></span><span>  </span><span class="annot"><span class="annottext">[fp] -&gt; ([Ptr CChar] -&gt; IO a) -&gt; IO a
forall fp a.
GlibFilePath fp =&gt;
[fp] -&gt; ([Ptr CChar] -&gt; IO a) -&gt; IO a
</span><a href="System.Glib.UTFString.html#withUTFFilePaths"><span class="hs-identifier hs-var">withUTFFilePaths</span></a></span><span> </span><span class="annot"><span class="annottext">[fp]
</span><a href="#local-6989586621679080127"><span class="hs-identifier hs-var">hsFP</span></a></span><span> </span><span class="annot"><span class="annottext">(([Ptr CChar] -&gt; IO a) -&gt; IO a) -&gt; ([Ptr CChar] -&gt; IO a) -&gt; IO a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679080129"><span class="annot"><span class="annottext">[Ptr CChar]
</span><a href="#local-6989586621679080129"><span class="hs-identifier hs-var">cStrs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-276"></span><span>  </span><span class="annot"><span class="annottext">[Ptr CChar] -&gt; (Ptr (Ptr CChar) -&gt; IO a) -&gt; IO a
forall a b. Storable a =&gt; [a] -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><span class="hs-identifier hs-var">withArray</span></span><span> </span><span class="annot"><span class="annottext">[Ptr CChar]
</span><a href="#local-6989586621679080129"><span class="hs-identifier hs-var">cStrs</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr (Ptr CChar) -&gt; IO a
</span><a href="#local-6989586621679080128"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-277"></span><span>
</span><span id="line-278"></span><span id="local-6989586621679080130"><span id="local-6989586621679080131"><span class="annot"><a href="System.Glib.UTFString.html#withUTFFilePathArray0"><span class="hs-identifier hs-type">withUTFFilePathArray0</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.Glib.UTFString.html#GlibFilePath"><span class="hs-identifier hs-type">GlibFilePath</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080130"><span class="hs-identifier hs-type">fp</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679080130"><span class="hs-identifier hs-type">fp</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679080131"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="annot"><a href="#local-6989586621679080131"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-279"></span><span id="withUTFFilePathArray0"><span class="annot"><span class="annottext">withUTFFilePathArray0 :: forall fp a.
GlibFilePath fp =&gt;
[fp] -&gt; (Ptr (Ptr CChar) -&gt; IO a) -&gt; IO a
</span><a href="System.Glib.UTFString.html#withUTFFilePathArray0"><span class="hs-identifier hs-var hs-var">withUTFFilePathArray0</span></a></span></span><span> </span><span id="local-6989586621679080138"><span class="annot"><span class="annottext">[fp]
</span><a href="#local-6989586621679080138"><span class="hs-identifier hs-var">hsFP</span></a></span></span><span> </span><span id="local-6989586621679080139"><span class="annot"><span class="annottext">Ptr (Ptr CChar) -&gt; IO a
</span><a href="#local-6989586621679080139"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-280"></span><span>  </span><span class="annot"><span class="annottext">[fp] -&gt; ([Ptr CChar] -&gt; IO a) -&gt; IO a
forall fp a.
GlibFilePath fp =&gt;
[fp] -&gt; ([Ptr CChar] -&gt; IO a) -&gt; IO a
</span><a href="System.Glib.UTFString.html#withUTFFilePaths"><span class="hs-identifier hs-var">withUTFFilePaths</span></a></span><span> </span><span class="annot"><span class="annottext">[fp]
</span><a href="#local-6989586621679080138"><span class="hs-identifier hs-var">hsFP</span></a></span><span> </span><span class="annot"><span class="annottext">(([Ptr CChar] -&gt; IO a) -&gt; IO a) -&gt; ([Ptr CChar] -&gt; IO a) -&gt; IO a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679080140"><span class="annot"><span class="annottext">[Ptr CChar]
</span><a href="#local-6989586621679080140"><span class="hs-identifier hs-var">cStrs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-281"></span><span>  </span><span class="annot"><span class="annottext">Ptr CChar -&gt; [Ptr CChar] -&gt; (Ptr (Ptr CChar) -&gt; IO a) -&gt; IO a
forall a b. Storable a =&gt; a -&gt; [a] -&gt; (Ptr a -&gt; IO b) -&gt; IO b
</span><span class="hs-identifier hs-var">withArray0</span></span><span> </span><span class="annot"><span class="annottext">Ptr CChar
forall a. Ptr a
</span><span class="hs-identifier hs-var">nullPtr</span></span><span> </span><span class="annot"><span class="annottext">[Ptr CChar]
</span><a href="#local-6989586621679080140"><span class="hs-identifier hs-var">cStrs</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr (Ptr CChar) -&gt; IO a
</span><a href="#local-6989586621679080139"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-282"></span><span>
</span><span id="line-283"></span><span id="local-6989586621679079754"><span class="annot"><a href="System.Glib.UTFString.html#peekUTFFilePathArray0"><span class="hs-identifier hs-type">peekUTFFilePathArray0</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.Glib.UTFString.html#GlibFilePath"><span class="hs-identifier hs-type">GlibFilePath</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679079754"><span class="hs-identifier hs-type">fp</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679079754"><span class="hs-identifier hs-type">fp</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-284"></span><span id="peekUTFFilePathArray0"><span class="annot"><span class="annottext">peekUTFFilePathArray0 :: forall fp. GlibFilePath fp =&gt; Ptr (Ptr CChar) -&gt; IO [fp]
</span><a href="System.Glib.UTFString.html#peekUTFFilePathArray0"><span class="hs-identifier hs-var hs-var">peekUTFFilePathArray0</span></a></span></span><span> </span><span id="local-6989586621679080151"><span class="annot"><span class="annottext">Ptr (Ptr CChar)
</span><a href="#local-6989586621679080151"><span class="hs-identifier hs-var">cStrArr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-285"></span><span>  </span><span id="local-6989586621679080152"><span class="annot"><a href="#local-6989586621679080152"><span class="hs-identifier hs-var">cStrs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Ptr CChar -&gt; Ptr (Ptr CChar) -&gt; IO [Ptr CChar]
forall a. (Storable a, Eq a) =&gt; a -&gt; Ptr a -&gt; IO [a]
</span><span class="hs-identifier hs-var">peekArray0</span></span><span> </span><span class="annot"><span class="annottext">Ptr CChar
forall a. Ptr a
</span><span class="hs-identifier hs-var">nullPtr</span></span><span> </span><span class="annot"><span class="annottext">Ptr (Ptr CChar)
</span><a href="#local-6989586621679080151"><span class="hs-identifier hs-var">cStrArr</span></a></span><span>
</span><span id="line-286"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="annot"><a href="System.Glib.UTFString.html#peekUTFFilePath"><span class="hs-identifier hs-type">peekUTFFilePath</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080152"><span class="hs-identifier hs-type">cStrs</span></a></span><span>
</span><span id="line-287"></span><span>
</span><span id="line-288"></span><span id="local-6989586621679080153"><span class="annot"><a href="System.Glib.UTFString.html#readUTFFilePathArray0"><span class="hs-identifier hs-type">readUTFFilePathArray0</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="System.Glib.UTFString.html#GlibFilePath"><span class="hs-identifier hs-type">GlibFilePath</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080153"><span class="hs-identifier hs-type">fp</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ptr</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IO</span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679080153"><span class="hs-identifier hs-type">fp</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-289"></span><span id="readUTFFilePathArray0"><span class="annot"><span class="annottext">readUTFFilePathArray0 :: forall fp. GlibFilePath fp =&gt; Ptr (Ptr CChar) -&gt; IO [fp]
</span><a href="System.Glib.UTFString.html#readUTFFilePathArray0"><span class="hs-identifier hs-var hs-var">readUTFFilePathArray0</span></a></span></span><span> </span><span id="local-6989586621679080169"><span class="annot"><span class="annottext">Ptr (Ptr CChar)
</span><a href="#local-6989586621679080169"><span class="hs-identifier hs-var">cStrArr</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Ptr (Ptr CChar)
</span><a href="#local-6989586621679080169"><span class="hs-identifier hs-var">cStrArr</span></a></span><span> </span><span class="annot"><span class="annottext">Ptr (Ptr CChar) -&gt; Ptr (Ptr CChar) -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Ptr (Ptr CChar)
forall a. Ptr a
</span><span class="hs-identifier hs-var">nullPtr</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[fp] -&gt; IO [fp]
forall a. a -&gt; IO a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-290"></span><span>                              </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-291"></span><span>  </span><span id="local-6989586621679080170"><span class="annot"><a href="#local-6989586621679080170"><span class="hs-identifier hs-var">cStrs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Ptr CChar -&gt; Ptr (Ptr CChar) -&gt; IO [Ptr CChar]
forall a. (Storable a, Eq a) =&gt; a -&gt; Ptr a -&gt; IO [a]
</span><span class="hs-identifier hs-var">peekArray0</span></span><span> </span><span class="annot"><span class="annottext">Ptr CChar
forall a. Ptr a
</span><span class="hs-identifier hs-var">nullPtr</span></span><span> </span><span class="annot"><span class="annottext">Ptr (Ptr CChar)
</span><a href="#local-6989586621679080169"><span class="hs-identifier hs-var">cStrArr</span></a></span><span>
</span><span id="line-292"></span><span>  </span><span id="local-6989586621679080171"><span class="annot"><a href="#local-6989586621679080171"><span class="hs-identifier hs-var">fps</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="hs-identifier hs-type">mapM</span></span><span> </span><span class="annot"><a href="System.Glib.UTFString.html#peekUTFFilePath"><span class="hs-identifier hs-type">peekUTFFilePath</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080170"><span class="hs-identifier hs-type">cStrs</span></a></span><span>
</span><span id="line-293"></span><span>  </span><span class="annot"><a href="System.Glib.UTFString.html#g_strfreev"><span class="hs-identifier hs-type">g_strfreev</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679080169"><span class="hs-identifier hs-type">cStrArr</span></a></span><span>
</span><span id="line-294"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">return</span></span><span> </span><span class="annot"><a href="#local-6989586621679080171"><span class="hs-identifier hs-type">fps</span></a></span><span>
</span><span id="line-295"></span></pre></body></html>